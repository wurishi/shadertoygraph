{"ver":"0.1","info":{"id":"wt2SDt","date":"1567656366","viewed":119,"name":"Random Cells","username":"gressettd","description":"What can we do with 1d voronoi?","likes":5,"published":1,"flags":0,"usePreview":0,"tags":["voronoi","tiling"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"const float JITTER = 3.0;          // jitter Voronoi amount. 1 = stay in cell\n\nfloat Random1D(float seed)\n{\n\treturn fract(sin(seed)*32767.0);\n}\n\n\nfloat Random2DS(vec2 p, float s)\n{\n\treturn fract(sin(dot(p,vec2(127.1,311.7)))*18.5453 * (1.0+s));\n}\n\n\n// Ala Fab. N.\n#define disp(p) ( -(JITTER-1.0)/2.0 + JITTER * (p) )\n\nvec2 Voronoi1D( vec2 u, float seed )\n{\n    vec2  n = floor( u );\n    float f = fract( u.x );\n\n\tvec2 m = vec2(1e5);\n    for( float g=-2.0; g<=2.0; g++ )\n        {\n            float o = Random2DS(n + vec2(g,0), seed);\n            float d = abs(g - f + disp(o));\n            if( d < m.x )\n                m = vec2( d, o );\n        }\n\n    return m;\n}\n\n\nvec4 RandomCell(vec2 uv, float scale, float seed)\n{\n    uv *= scale;\n    \n    vec2 vert = Voronoi1D(uv.yy, seed);\n    float vdist = vert.x;\n    float vid = vert.y;\n    \n    float hseed = Random1D(vert.y * seed)*100.0;\n    \n    vec2 horiz = Voronoi1D(vec2(uv.x + hseed, uv.y + hseed), seed);\n    float hdist = horiz.x;\n    float hid = horiz.y;\n        \n    vec4 rv = vec4(hid,vid,hdist,vdist);\n        \n    return rv;\n}\n\nvec4 RandomGrid(vec2 uv, float scale, int iterations, float lac, float seed)\n{\n    float dampen = 1.0 / (2.0 * scale);\n    vec4 rv = RandomCell(uv, scale, seed); \n    rv.xy *= dampen;\n    scale *= lac;\n    \n    for(int i=0; i<6 - 1; i++)\n    {\n\t\tdampen = 1.0 / (2.0 * scale);\n        vec4 cell = RandomCell(uv, scale, seed);\n        rv = vec4(rv.xy + (cell.xy*dampen), cell.wz);\n\t\t\n        scale *=lac;\n    }\n    \n   \n    return rv;\n}\n\n\nvoid mainImage( out vec4 O, vec2 U )\n{\n    vec2 p = (2.0 * U - iResolution.xy) / min(iResolution.x,iResolution.y);\n    \n\tp.y += iTime * 0.2;\n    float seed = Random1D(floor(iTime / 3.0)) + iDate.x + iDate.y;   \n    \n    vec4 cc = RandomGrid(p, 1.0, 6, 2.0, seed);\n    \n    float cellC = cc.z + cc.w;\n    vec3 col;\n    \n    // col = vec3(cc.x, cc.z, cc.w);\n    col = cc.xxy;\n        \n    O = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}