{"ver":"0.1","info":{"id":"sdSGDc","date":"1618030282","viewed":74,"name":"Julia Set 3D","username":"kithy","description":"julia set, fractal, raymarching","likes":3,"published":1,"flags":0,"usePreview":0,"tags":["raymarching","fractal","juliaset"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define ITR 10\n#define MAX_STEPS 64\n#define EPS 0.01\n\n\nfloat julia(vec3 p,vec3 c){\n\t\n\tfor(int i=0;i<ITR;i++){\n\t\tp=vec3(\n\t\t\tp.x*p.x-p.y*p.y-p.z*p.z,\n\t\t\t2.0*p.x*p.y,\n\t\t\t2.0*p.x*p.z\n\t\t\t)+c;\n\n\t\tif(length(p)>10.0) return 1.0-(float(i)/float(ITR));\n\t}\n\treturn -EPS;\n}\n\nvec2 rot(vec2 p,float angle){\n\treturn vec2(p.x*cos(angle)-p.y*sin(angle),p.y*cos(angle)+p.x*sin(angle));\n}\n\nfloat mainDist(vec3 p){\n\tvec3 r=p;\n\tr.xz=rot(r.xz,iTime*0.3);\n\tr.yz=rot(r.yz,iTime*0.3);\n\treturn julia(r,\n\t\tvec3(sin(iTime*0.3)*0.7,cos(iTime*0.4)*0.7,0.1)\n\t\t);\n}\n\nvec4 rayMarch(vec3 o,vec3 r){\n\tvec3 p=o;\n\tfloat t=0.0;\n\tfloat s;\n\tint i;\n\n\tfor(int i=0;i<MAX_STEPS;i++){\n\t\tp=o+r*t;\n\t\ts=mainDist(p);\n\t\tt+=s*EPS*10.0;\n\t\tif(s<EPS)break;\n\t}\n\treturn vec4(p,float(i));\n}\n\nvec3 genNormal(vec3 p){\n\treturn normalize(vec3(\n\t\tmainDist(vec3(p.x+EPS,p.y,p.z))-mainDist(vec3(p.x-EPS,p.y,p.z)),\n\t\tmainDist(vec3(p.x,p.y+EPS,p.z))-mainDist(vec3(p.x,p.y-EPS,p.z)),\n\t\tmainDist(vec3(p.x,p.y,p.z+EPS))-mainDist(vec3(p.x,p.y,p.z-EPS))\n\t\t));\n}\n\nvoid mainImage(out vec4 fragColor,in vec2 fragCoord){\n\tvec2 uv=(2.0*fragCoord.xy-iResolution.xy)/iResolution.y;\n\n\tvec3 cam=vec3(0.0,0.0,-1.8);\n\tvec3 ray=normalize(vec3(uv.xy*1.3,1.0));\n\n\tvec4 t=rayMarch(cam,ray);\n\tvec3 light=vec3(0.0,0.0,-2.0);\n\tvec3 toLight=normalize(light-t.xyz);\n\tvec3 normal=genNormal(t.xyz);\n\n\tfloat d=length(t.xyz-cam);\n\n\tfragColor=vec4(normal,1.0);\n}\n","name":"Image","description":"","type":"image"}]}