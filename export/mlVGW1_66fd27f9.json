{"ver":"0.1","info":{"id":"mlVGW1","date":"1683933710","viewed":67,"name":"simplest traffic simulator","username":"suwqymncwec","description":"buffer","likes":3,"published":1,"flags":32,"usePreview":0,"tags":["2d","simulation","automata"],"hasliked":0,"parentid":"-1","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void mainImage(out vec4 fragColor, in vec2 fragCoord) {\n    fragColor = texelFetch(iChannel0, ivec2(fragCoord), 0);\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"nearest","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"vec3 cell(in ivec2 p) {\n    ivec2 r = ivec2(textureSize(iChannel0, 0));\n    p = (p+r) % r;\n    return texelFetch(iChannel0, p, 0).xyz;\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord){\n    ivec2 px = ivec2(fragCoord);\n    vec3 c = cell(px);\n    vec3 col = c;\n\n    if (iFrame % 2 == 0) {\n        if (empty(c) && cell(px+ivec2(-1,0)).x == 1.) col = R;\n        else if (c.x == 1. && empty(cell(px+ivec2(1,0)))) col = D;\n    } else {     \n        if (empty(c) && cell(px+ivec2(0,-1)).z == 1.) col = B;\n        else if (c.z == 1. && empty(cell(px+ivec2(0,1)))) col = D;\n    }\n    \n    if (iFrame == 0) col = vec3(rand(fragCoord-.5));\n    \n\tfragColor = vec4(col, 1.0 );\n}","name":"Buffer A","description":"","type":"buffer"},{"inputs":[],"outputs":[],"code":"#define R vec3(1., 0., 0.)\n#define B vec3(0., 0., 1.)\n#define D vec3(0.)\n\n\nfloat rand(vec2 px){\n    float f = fract(sin(dot(px, vec2(12.9898, 78.233))) * 43758.5453);\n    return f > .5 ? 1. : 0.;\n}\n\nbool empty(vec3 c) { return c.x == 0. && c.z == 0.; }\n","name":"Common","description":"","type":"common"}]}