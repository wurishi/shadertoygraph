{"ver":"0.1","info":{"id":"fsGXDc","date":"1635414066","viewed":431,"name":"Watercolor star","username":"sinvec","description":"My second work using watercolor. Based on [url=https://www.shadertoy.com/view/NsKXRd]Confusing cubes[/url]. It's a little different from the original, but I guess it still looks nice.","likes":28,"published":1,"flags":0,"usePreview":1,"tags":["2d","geometry","isometric","watercolor","penrose"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGzn","filepath":"/media/a/0c7bf5fe9462d5bffbd11126e82908e39be3ce56220d900f633d58fb432e56f5.png","previewfilepath":"/media/ap/0c7bf5fe9462d5bffbd11126e82908e39be3ce56220d900f633d58fb432e56f5.png","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define PI 3.14159\n#define R (iResolution.xy)\n#define s(v,l) smoothstep(l/R.y,0.,v) // AA\n#define r(a) (mat2(cos(a),sin(a),-sin(a),cos(a))) // 2d rotation matrix\n\n\nfloat dtl(vec2 p, vec3 l) {return abs(l.x*p.x+l.y*p.y+l.z)/sqrt(l.x*l.x+l.y*l.y);}\n\n#define ST 1.73205 // sqrt(3.)\nfloat tirangle_grid (vec2 u, float a) {\n       float c = a*ST;\n       float fi = floor((u.y-ST*u.x) / c);\n       float d = min(dtl(u,vec3(ST,-1,fi*c)),dtl(u,vec3(ST,-1,(fi+1.)*c)));\n       fi = floor((u.y+ST*u.x) / c);\n       d = min(d,min(dtl(u,vec3(-ST,-1,fi*c)),dtl(u,vec3(-ST,-1,(fi+1.)*c))));\n       fi = abs(fract((u.y*2.)/c));\n       d = min(d,min(fi*c*.5,(1.-fi)*c*.5));\n       return d;\n}\n\n\nfloat udSegment(in vec2 p, in vec2 a, in vec2 b){\n    vec2 ba = b-a;\n    vec2 pa = p-a;\n    float h = clamp(dot(pa,ba)/dot(ba,ba), 0., 1.);\n    return length(pa-h*ba);\n}\n\nfloat fbm(vec2 p){\n    return texture(iChannel0, p*.001).x*.533 +\n           texture(iChannel0, p*.01).x*.267 +\n           texture(iChannel0, p*.3).x*.133 +\n           texture(iChannel0, p*.5).x*.067; \n}\n\nfloat watercolor (vec2 p) {\n       p*=15.;\n       vec2 q = vec2(0.);\n       q.x = fbm(p);\n       q.y = fbm( p + vec2(1.0));\n       vec2 r = vec2(0.);\n       r.x = fbm( p + 1.0*q + vec2(1.7,9.2));\n       r.y = fbm( p + 1.0*q + vec2(8.3,2.8));\n       float f = fbm(p+r);\n       return clamp(f,0.,1.);\n}\n\n\nvoid mainImage( out vec4 O, in vec2 E )\n{\n\n    vec2 u = 2.*(E - R*.5)/R.y;\n\n    vec3 col = vec3(1.);\n    \n    const float grid_size = .04; \n    const float h = grid_size*ST/2.;\n\n    vec3 layer1;\n    layer1 = mix(col, col*.7, texture(iChannel0, u*5.).x*.5);\n    layer1 += texture(iChannel0, (u+vec2(.125,.382))*5.).x*.2;\n    layer1 = mix(layer1, vec3(.95,.95,1.0)*col, texture(iChannel0, u*.02).x);\n    \n    vec3 gridlayer = mix(col, vec3(.85), s(tirangle_grid(u,grid_size)-.001,1.5));\n    \n    vec3 layer2;\n    layer2 = mix(gridlayer, gridlayer*.7, texture(iChannel0, u*5.).x*.5);\n    layer2 += texture(iChannel0, (u+vec2(.125,.382))*5.).x*.2;\n    layer2 = mix(layer2, vec3(.95,.95,1.0)*col, texture(iChannel0, u*.01).x);\n    \n    float a, b, c, f;\n    \n    float outline, d;\n    vec3 area; \n    \n    vec2 offs = -(vec2(fbm(u*16. + .61), fbm(u*16.)) - .5) * .1;\n    \n    mat3[4] tcs = mat3[4](\n        mat3(vec3(.678,1.00,.184), vec3(.196,.804,.196), vec3(.125,.545,.125)),\n        mat3(vec3(.529,.808,.921), vec3(.690,.878,.902), vec3(.118,.565,1.00)),\n        mat3(vec3(.933,.509,.933), vec3(.902,.659,.843), vec3(.749,.000,1.00)),\n        mat3(vec3(1.00,.702,.000), vec3(1.00,.749,.400), vec3(1.00,.352,.204))\n    );\n    \n    vec2 ub = u;\n    \n    vec3 layer3 = col;\n    vec3 layer4 = col;\n    \n    for(float i = 0.; i < 12.; i++) {\n    \n        b = mod(i+1., 2.) == 0. ? 2. * h : 1.5 * grid_size;\n        a = (mod(i+2., 2.) == 0. ? 12.*ST : 18. ) * grid_size;\n        c = a * ST;\n        f = b / ST;\n    \n        area = vec3(999.); \n        outline = 999.;\n        u *= r( - PI / 6.);\n        \n        d = udSegment(u, vec2(-a/2.-4.*f, -c/6.-2.*b), vec2(-a/2.-2.*f, -c/6.-2.*b));\n        area.x = min(area.x, d);\n        \n        d = udSegment(u, vec2(-a/2.-5.*f, -c/6.-b), vec2(-a/2.-f, -c/6.-b));\n        area.xy = min(area.xy, vec2(d));\n        \n        d = udSegment(u, vec2(-a/2.-2.*f, -c/6.),vec2(-a/2., -c/6.));\n        area.yz = min(area.yz, vec2(d));\n        \n        d = udSegment(u, vec2(-a/2., -c/6.),vec2(0., c/3.));\n        area.z = min(area.z, d);\n        \n        d = udSegment(u, vec2(-a/2.-2.*f, -c/6.), vec2(-f, c/3.+b));\n        area.yz = min(area.yz, vec2(d));\n        \n        d = udSegment(u, vec2(-a/2.-5.*f, -c/6.-b), vec2(-2.*f, c/3.+2.*b));\n        area.y = min(area.y, d);\n        \n        d = udSegment(u, vec2(-a/2.-5.*f, -c/6.-b), vec2(-a/2.-4.*f, -c/6.-2.*b));\n        area.x = min(area.x, d);\n\n        outline = min(min(area.x, area.y), area.z);\n\n        area.x = min(area.x, udSegment(u, vec2(-a/2.-2.*b/ST, -a*ST/6.-2.*b), vec2(-a/2.-b/ST, -a*ST/6.-b)));\n        area.y = min(area.y, udSegment(u, vec2(-a/2.-b/ST, -a*ST/6.-b), vec2(-a/2., -a*ST/6.)));\n        area.z = min(area.z, udSegment(u, vec2(0., a*ST/3.), vec2(-b/ST, a*ST/3.+b)));\n        area.y = min(area.y, udSegment(u, vec2(-b/ST, a*ST/3.+b), vec2(-2.*b/ST, a*ST/3.+2.*b)));\n        \n        area.x *= sign(3.5 - step(-ST*u.x-4.*a*ST/6.-6.*b, u.y)\n                           - step(ST*u.x+a*ST/3., u.y)\n                           - step(-a*ST/6.-2.*b, u.y)\n                           - step(u.y, -a*ST/6.-b));\n        area.y *= sign(3.5 - step(ST*u.x+a*ST/3., u.y)\n                           - step(u.y, ST*u.x+a*ST/3.+4.*b)\n                           - step(-a*ST/6.-b, u.y)\n                           - step(u.y, -a*ST/6.)) *\n                  sign(3.5 - step(u.y, ST*u.x+a*ST/3.+4.*b)\n                           - step(ST*u.x+a*ST/3.+2.*b, u.y)\n                           - step(-a*ST/6., u.y)\n                           - step(u.y, -ST*u.x+a*ST/3.));\n        area.z *= sign(3.5 - step(ST*u.x+a*ST/3., u.y)\n                           - step(u.y, ST*u.x+a*ST/3.+2.*b)\n                           - step(-a*ST/6., u.y)\n                           - step(u.y, -ST*u.x+a*ST/3.));            \n        \n        layer4 = mix(layer4, layer2, s(area.x+offs.x*2.,50.));\n        layer4 = mix(layer4, layer2, s(area.y+offs.x*2.,50.));\n        layer4 = mix(layer4, layer2, s(area.z+offs.x*2.,50.));\n        layer3 = mix(layer3, mix(layer1, tcs[int(mod(i, 4.))][int(mod(floor(i/4.)+0.,3.))], watercolor(ub)*.5), s(area.x+offs.y,10.));\n        layer3 = mix(layer3, mix(layer1, tcs[int(mod(i, 4.))][int(mod(floor(i/4.)+1.,3.))], watercolor(ub)*.5), s(area.y+offs.y,10.));\n        layer3 = mix(layer3, mix(layer1, tcs[int(mod(i, 4.))][int(mod(floor(i/4.)+2.,3.))], watercolor(ub)*.5), s(area.z+offs.y,10.));\n        \n        layer3 = mix(layer3, layer3*.9, s(outline-.0001,1.5));\n    }\n    \n    col = layer4*layer3;\n\n    col = mix(col, col*.1, .2/(abs(R.x-E.x)+.2));\n    col = mix(col, col*.1, .2/(abs(E.x)+.2));\n    col = mix(col, col*.1, .2/(abs(R.y-E.y)+.2));\n    col = mix(col, col*.1, .2/(abs(E.y)+.2));\n\n    O = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}