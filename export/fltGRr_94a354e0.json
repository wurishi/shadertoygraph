{"ver":"0.1","info":{"id":"fltGRr","date":"1635669228","viewed":143,"name":"Neural Representation SDF","username":"playbyan1453","description":"Inspired by Blackle Mori, and after some experiments I found GoingDigital's python notebook, it uses TensorFlow wich I quite familiar with. And IBL lighting using cubemap uses textureGrad function might be not perfect but it works.","likes":4,"published":1,"flags":0,"usePreview":0,"tags":["raymarching","ibl","neural","bunny"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XsX3zn","filepath":"/media/a/94284d43be78f00eb6b298e6d78656a1b34e2b91b34940d02f1ca8b22310e8a0.png","previewfilepath":"/media/ap/94284d43be78f00eb6b298e6d78656a1b34e2b91b34940d02f1ca8b22310e8a0.png","type":"cubemap","channel":0,"sampler":{"filter":"mipmap","wrap":"clamp","vflip":"false","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define tmax 1e1\n#define tmin 1e-4\n#define steps 512\n#define quality 1\n\n// Dataset is: 256*256*4 points\n// Start learning rate: 1e-4\n// End learning rate: 1e-6\n#if quality == 0\n// Units: 24 Layers: 6 Epochs: 50000 Loss: 1.4261e-05\nfloat map(vec3 p) {\n  if(length(p) > 1.) return length(p)-.8;\n  vec4 x=vec4(p, 1),\n    f00=sin(x*mat4(-1.5999,-2.5914,-.7599,-4.793,-3.049,-4.1408,3.3068,-1.974,1.3066,-.3169,-4.3831,6.833,-1.8908,-2.9935,.5513,-1.1552)),\n    f01=sin(x*mat4(-1.3314,-2.8548,-2.9009,-2.5008,-3.6348,3.385,2.8227,-5.0386,1.892,.2461,-4.996,-5.4165,2.0769,2.5684,-2.2824,-6.50)),\n    f02=sin(x*mat4(-.9596,3.5335,-.4607,-.2059,3.0365,.5744,-1.4317,-5.1206,-.2395,2.9698,3.9412,-5.5074,.0897,.7943,-2.7382,7.4214)),\n    f03=sin(x*mat4(-2.7114,3.7704,1.3981,-2.5701,2.7818,-.0788,1.7671,4.3844,1.3239,-1.1801,-2.8339,-4.6204,4.4712,-4.4757,1.4523,-2.4019)),\n    f04=sin(x*mat4(.8331,-2.3085,-.7191,-2.2149,2.6197,-4.615,2.3476,3.183,1.7517,4.8075,-1.4632,-6.3522,-1.8216,-4.0138,-3.1445,-4.4172)),\n    f05=sin(x*mat4(4.3482,-1.2844,-.3542,7.0332,3.0232,-2.2309,-.7108,-.6451,2.4217,-4.4643,-2.2124,-3.8248,4.0014,2.1971,2.6236,-5.3794)),\n    f10=sin(mat4(-.0396,.0372,-.11,.3183,-.3147,.2152,.2625,.1466,.048,.3773,.294,-.1383,.0388,.6109,.043,-.203)*f00+mat4(.0909,-.364,.1455,-.0924,-.2764,.3031,.752,.0834,-.0865,.3924,.0746,-.0666,.2753,-.1824,.1924,-.0704)*f01+mat4(-.1752,-.1775,.2839,-.2114,-.3294,.0901,-.1719,.2472,-.1012,.1597,.1996,.3014,-.2756,-.0631,.2411,-.5324)*f02+mat4(.0126,-.2618,-.0119,.1852,.1272,.1444,-.0541,.2089,-.2403,-.4293,-.0022,.1001,-.0844,-.0999,.0528,.1618)*f03+mat4(.3929,.2365,.4362,.446,.156,.4162,-.359,-.3475,-.3134,.0732,-.5433,.1453,.032,-.1865,.1189,-.1815)*f04+mat4(.2604,.0399,.1549,.2342,.3422,.5605,-.1164,-.1316,.0168,-.1608,.0534,-.0288,.1976,-.2433,-.4238,.4466)*f05+vec4(4.3964,9.3818,5.3109,9.1061)),\n    f11=sin(mat4(.3022,-.2196,-.1345,-.1521,-.2315,.1404,.1717,-.3566,.3195,-.4513,-.3617,.0606,-.0497,.3403,-.3334,-.3557)*f00+mat4(-.2943,.1565,.2489,-.4643,.0225,.3056,-.0752,-.1396,.0941,-.0048,.2025,.2461,.2893,.3831,.3958,.1941)*f01+mat4(-.3464,.0738,-.1755,.1369,.457,.1279,-.2785,.3287,.5238,.3586,.2579,-.0072,-.1282,.1077,.3797,.173)*f02+mat4(.1106,-.118,-.1766,-.4172,.2776,-.0589,-.0524,-.024,.4298,.4492,-.0921,-.3489,-.3722,.1302,.1003,.2702)*f03+mat4(.2003,-.2906,-.1253,-.454,-.2232,-.0567,.3455,-.174,-.3781,.1232,-.031,-.3179,-.1344,.0863,.2365,.0427)*f04+mat4(-.0384,-.3289,-.1322,.2603,.1002,-.3368,.1605,.2552,.0688,-.4143,.1411,.4656,.2798,-.2191,.0929,.0504)*f05+vec4(-3.3937,5.4875,-2.7522,-4.7849)),\n    f12=sin(mat4(.1295,.0114,-.1432,-.1529,.2637,.0645,-.0042,.2749,-.3053,.2775,-.2941,-.1611,-.0787,.5159,.1369,.4198)*f00+mat4(-.5983,.2117,.3553,.332,-.2221,.056,.2935,.0108,.0679,-.3532,.2341,.0994,.3209,.0534,-.1424,.3842)*f01+mat4(-.2732,-.0958,-.3702,.3219,.3102,-.1937,-.1567,-.2889,.1978,.1666,.1292,-.2589,.0348,.375,-.5646,.2399)*f02+mat4(.2804,.4297,-.4857,-.3698,-.0199,.4091,.1933,-.5577,-.2722,.1211,.1616,.0788,.3004,-.1756,-.0424,.5116)*f03+mat4(-.1575,-.0282,-.3858,.4251,-.1547,.0972,-.1394,-.151,.0589,-.2231,-.3883,-.1754,-.1574,-.2416,-.2026,.1813)*f04+mat4(-.1483,-.185,-.0309,.1733,-.0414,.1231,.1948,-.4241,.0808,-.266,-.2053,-.0423,-.2261,-.1297,.1297,-.1609)*f05+vec4(2.8016,4.6425,-3.8331,1.9444)),\n    f13=sin(mat4(.1734,.4056,-.0787,.6486,-.2001,-.0182,.2817,-.2814,-.1829,-.1999,-.2149,-.2972,.2651,.2902,-.0775,-.3363)*f00+mat4(.1022,.3413,-.0489,-.1753,-.079,-.3392,.2017,-.1294,-.2018,-.1392,.1392,.1655,-.0721,.4635,-.608,.0933)*f01+mat4(-.2798,-.3965,.2581,.4311,.1355,.5379,-.4849,.5011,-.1958,.0935,.1278,.3795,.357,.2649,.0367,.4249)*f02+mat4(-.1765,-.0214,-.2473,.4711,-.2305,.2099,-.0309,.3127,.1452,-.2709,-.1373,.0855,.1956,-.0288,.439,-.521)*f03+mat4(.0503,.1859,-.2601,.3892,-.2873,-.0549,.0858,.1834,-.2747,.0831,-.0572,.3678,.2053,-.0193,.2886,-.1885)*f04+mat4(-.2803,.0194,-.3292,-.3643,-.2654,-.0926,.2583,-.2357,-.3483,.3268,-.2002,.2299,-.2164,-.182,-.0625,-.0579)*f05+vec4(-6.8999,-.5858,8.5594,7.4143)),\n    f14=sin(mat4(-.3376,.4251,.1377,.0981,-.0479,.1546,-.301,.2907,-.1525,.2278,-.0967,.4228,-.1296,.0787,.1473,.2018)*f00+mat4(.1143,-.3011,.6337,-.0138,.1582,-.1075,-.167,.198,.3923,-.3031,-.1233,-.5431,-.5369,-.3634,-.1731,-.3606)*f01+mat4(-.1564,-.2917,.5189,-.1131,.0062,.2649,-.2013,-.3018,.2293,.0046,-.2401,-.2686,.0153,.1486,-.1113,-.0144)*f02+mat4(-.3337,-.0471,-.1421,-.1189,.2087,-.0649,.2024,.398,-.15,.3555,.0535,.0146,.2076,.1026,.1937,-.447)*f03+mat4(-.3876,.2519,.4501,-.5971,-.3458,.0686,-.1942,-.0057,.2009,.0481,.2804,.2001,.2596,-.2737,.1108,.28)*f04+mat4(.6559,.0889,-.5129,.0829,.4981,-.5261,.1672,.2564,.085,-.0827,.1084,-.0095,.2425,.2963,-.4185,.1428)*f05+vec4(-3.5212,-9.5402,1.5006,-2.1427)),\n    f15=sin(mat4(.469,-.0996,-.0929,.3565,.1134,.0654,.2186,.1356,.0767,.0018,-.2093,.1086,-.1184,.0866,.0862,.378)*f00+mat4(.3503,-.4405,-.1305,-.255,-.1872,-.1671,-.0886,-.0467,.068,.023,.2845,-.0219,-.2037,-.0309,-.3114,.1748)*f01+mat4(-.4637,-.3829,-.2214,.3426,.1093,-.444,.3072,-.3722,.2131,.0822,.4693,-.1673,.5191,.1353,-.3618,.0453)*f02+mat4(-.1044,-.1548,.0863,-.3913,-.1095,-.5563,.4564,.3755,.2711,-.3286,.263,-.2726,-.2543,-.3624,-.276,-.0297)*f03+mat4(-.1414,.4487,.2008,-.4101,.4196,.403,.0292,.3799,.4585,.0328,.3762,.148,.3457,-.2667,.2435,.052)*f04+mat4(.0278,.1481,.3582,.2631,.335,.3486,-.0578,-.1592,.1044,.291,.4231,.1525,-.1166,.1251,.2142,-.1886)*f05+vec4(6.4899,6.0192,1.9308,8.9951)),\n    f20=sin(mat4(-.0782,.1658,-.0903,.1913,.2457,.0557,-.0514,-.1419,.1147,.2805,-.0174,.2706,-.2729,.3521,.5924,.1354)*f10+mat4(.0696,-.1527,-.3817,.0947,.1934,-.5286,-.3877,-.1091,-.1484,-.2212,.0309,.3047,-.0016,.2329,-.3082,.3584)*f11+mat4(-.0572,.4406,-.2143,.3451,-.0764,.1185,-.3584,.4641,.0471,-.3874,.0931,-.4972,.3282,.525,.5177,-.4417)*f12+mat4(.26,-.1087,-.1543,-.0537,.2513,.2506,.1165,.4884,-.3221,-.1207,-.105,-.3838,.3579,-.4444,-.2895,.3601)*f13+mat4(.1668,.1612,.0371,.3832,-.1882,-.2037,-.1596,.1537,-.0924,.5141,-.4447,.1814,.3047,-.4144,-.1732,-.0192)*f14+mat4(-.1133,.1697,.3944,-.248,.3028,-.6654,-.2835,-.0372,-.5088,.0576,.0382,.0141,-.0072,.3895,-.0375,-.4717)*f15+vec4(1.6399,7.9995,-1.525,-8.5159)),\n    f21=sin(mat4(-.0805,-.1145,.1234,.038,-.1407,-.138,-.3586,.4138,-.1074,-.3004,-.2538,.2391,.4132,-.4121,.3046,.0064)*f10+mat4(-.3898,.2821,.3431,-.3363,-.2212,-.2967,-.411,.3736,-.4874,.1945,-.5179,-.2667,-.0734,.3037,.1164,.2981)*f11+mat4(.4047,-.4608,-.0539,-.1716,-.7163,-.3416,.3348,.1606,-.0582,-.3167,-.2828,-.0505,.1927,.3508,.0568,.0062)*f12+mat4(.2704,-.4773,.0766,-.0258,.5754,-.4702,-.3217,.1962,.1052,-.4308,.4967,-.2306,-.3776,-.2236,.467,-.2152)*f13+mat4(.4865,.6947,-.5171,-.3733,.0739,-.2687,-.3664,.35,.0723,-.0342,-.2198,-.0098,-.5828,.2415,.3863,-.077)*f14+mat4(-.0988,-.3431,-.4015,-.1631,.4223,-.2209,-.3687,-.1057,-.0562,-.1161,-.3275,.4036,-.3086,-.1212,-.6168,-.2277)*f15+vec4(9.8831,.5838,-5.4477,-9.3998)),\n    f22=sin(mat4(-.4196,.2015,.0367,.3133,-.4547,-.396,.3768,-.0464,-.076,-.3156,.0522,-.0642,-.4686,.1924,.1231,.2076)*f10+mat4(-.4171,.0562,.2618,.099,-.0756,.1322,.2063,.3899,.3582,-.6292,.4341,-.1223,-.4351,.1316,.4258,-.0969)*f11+mat4(.3392,.1342,.3192,-.2774,-.5019,.1458,.4115,.2263,.358,-.4658,.0546,-.2653,-.1577,-.3049,-.2214,.4007)*f12+mat4(.0663,-.4718,.2774,-.0572,.3386,-.0559,-.1152,.3093,.2225,.6032,-.2614,-.3745,-.2946,-.2612,-.0668,-.2189)*f13+mat4(.5099,.2342,.079,-.1695,-.1405,-.0443,.0602,-.0046,.0328,.1021,.0144,-.0323,.4574,-.093,-.3644,.2247)*f14+mat4(-.0698,-.3419,-.4798,.2408,.0234,.2857,.5483,-.3325,.5281,.1191,.0815,.3226,-.1621,.1761,.0139,.2304)*f15+vec4(6.2943,1.376,4.7276,6.9647)),\n    f23=sin(mat4(.4426,.3591,-.0053,-.3463,.1564,.1441,.219,-.394,-.2952,-.3399,-.3199,.1088,-.1745,.3138,-.6288,-.2658)*f10+mat4(-.2489,-.2426,.4313,.3489,.0222,.2075,.3402,-.5361,.2636,-.0914,.2186,-.2002,-.3091,-.0799,.0465,-.2376)*f11+mat4(-.5471,.2229,.1162,-.4541,.1725,.4098,.0619,.0062,-.121,.2882,-.3446,.2413,.0516,-.1244,.1048,.3118)*f12+mat4(-.1804,-.4401,-.5245,-.2608,.0039,.0877,-.0375,.3845,.4469,.1243,-.042,.0712,.381,-.181,-.3905,-.1419)*f13+mat4(.0537,.148,.4724,.6296,-.3581,-.0692,-.0321,.458,.1515,-.3732,.004,-.2919,.0806,.3336,.0859,.0531)*f14+mat4(.0058,-.1357,-.1909,-.2026,.0081,.1138,.1219,-.3176,.0939,.26,.1412,-.3443,.1629,.1879,.3479,.573)*f15+vec4(-9.7575,-7.0496,1.5846,9.2192)),\n    f24=sin(mat4(-.1364,.2881,-.2741,.2895,.1813,.7818,-.0575,.3214,-.1188,-.1904,.2009,.3205,.4732,.085,-.1602,.4273)*f10+mat4(-.2296,-.2862,-.4091,-.2808,-.6034,.3364,.2805,-.34,.3481,-.0245,.1809,-.3588,.3683,.4474,.4379,.303)*f11+mat4(.1069,.2679,-.4253,.3549,-.1548,-.0621,.2408,.118,.0413,-.0373,-.3174,.0062,.0444,-.1694,.1026,.4513)*f12+mat4(-.3222,-.0375,.1005,.3937,.1755,.1657,.3305,.1729,-.3155,-.1849,.3774,-.0715,.0181,.2823,-.5545,.0611)*f13+mat4(-.2041,-.3881,-.1692,-.0399,.4302,.0763,.4841,-.164,-.2858,.0067,-.3356,-.2336,.0143,-.077,-.0256,.3027)*f14+mat4(-.0795,-.0905,-.3041,.0075,.5844,.0055,-.0528,.0124,-.1862,-.3305,-.5538,-.0813,-.6838,-.3995,-.088,-.0179)*f15+vec4(5.546,4.424,7.1731,-6.3713)),\n    f25=sin(mat4(.3414,.2534,-.3037,.5912,.0467,-.2076,-.0805,.1245,.2078,-.0791,-.5625,.0679,-.1603,.4301,-.2282,.8343)*f10+mat4(.2945,-.1115,-.002,-.2834,.3248,-.5576,.3197,-.3653,-.2068,-.4105,.1747,.234,-.3463,-.5395,-.1653,.0154)*f11+mat4(.0986,.319,-.0152,-.0244,-.3054,-.0139,.5809,-.1914,-.1326,.3046,-.4456,.0918,-.0354,.3061,.4407,-.1667)*f12+mat4(-.2805,-.0595,-.1712,-.1695,-.3449,.2194,-.2219,-.2806,.1304,.3733,.533,-.2934,.365,-.216,-.2296,.1753)*f13+mat4(.348,-.1276,-.4717,.4277,-.0691,-.0957,.027,-.2966,.3981,.3568,-.2461,.2064,-.3729,-.4098,.0297,-.3311)*f14+mat4(.3715,-.1353,.3699,.2909,-.0708,-.1336,-.1992,.2097,-.0544,-.4981,-.0845,-.237,-.2605,.1938,-.1782,.2379)*f15+vec4(3.5483,5.0268,2.9754,8.6997)),\n    f30=sin(mat4(.0357,-.1089,.2415,-.3767,.1767,-.4133,.5173,-.0824,.3869,-.3731,-.006,-.5716,.1916,-.3479,-.2006,-.6516)*f20+mat4(-.0938,.1585,.4348,.5059,-.2651,.2543,.1712,.1584,.3501,.2355,-.5537,.5277,-.2312,.0476,-.3527,-.431)*f21+mat4(.2154,.0324,-.1039,.1316,-.1367,.1396,-.2703,.2846,-.3227,.5095,.5627,.3475,-.2701,-.4077,-.0661,-.4685)*f22+mat4(-.4744,.0315,.5091,-.0559,.2038,-.3424,.1461,.2264,.0078,.1521,-.0436,-.36,.4829,.0131,-.2038,-.0403)*f23+mat4(-.475,-.2037,-.1468,-.1605,-.4839,.2318,-.0605,.0688,-.0096,.1812,.083,.2112,.0291,-.5172,.1245,-.073)*f24+mat4(-.3723,.0186,.2973,.0622,-.0505,-.2186,-.3101,.0622,-.0359,-.0433,.1821,-.2129,-.2392,.0605,.4297,-.2348)*f25+vec4(7.9676,-1.4287,8.6316,-8.4493)),\n    f31=sin(mat4(-.5104,-.3437,.0223,-.0205,.182,.0667,.0319,-.1103,-.276,-.1694,.0582,.0833,-.1142,-.0778,-.2062,-.2546)*f20+mat4(.0585,-.051,.4059,-.2587,.2955,-.4072,.3945,-.3452,-.3303,.2523,.4108,-.1582,.0268,-.5471,.2322,.2623)*f21+mat4(-.2388,-.2413,.2265,.1055,-.0234,.1107,.4369,-.052,.4438,-.3607,.2751,-.0252,-.4555,-.1572,-.09,-.3687)*f22+mat4(-.1058,.0025,.4255,-.035,.3915,.3791,.4435,-.389,-.116,.0643,-.0625,.4197,.171,-.2685,.3655,-.0516)*f23+mat4(.3849,.1895,-.5472,.1921,.059,.1671,.05,-.3759,-.1392,.2753,.3951,.3184,.1195,-.2044,.1927,-.3538)*f24+mat4(-.1945,-.2144,-.2337,-.4786,-.149,.1739,-.5747,-.0866,-.4396,-.2281,.2706,-.2022,-.498,-.107,-.3357,-.2821)*f25+vec4(6.6321,-9.9618,4.9617,.0037)),\n    f32=sin(mat4(.4517,.1391,-.4433,-.4221,-.0212,.3326,-.1298,.1601,.0594,-.2343,.06,-.0238,.0953,-.0968,-.6121,.151)*f20+mat4(-.375,.0205,.5067,.2822,.0636,.1184,.2753,-.0396,.4384,-.1553,-.3112,.164,-.0969,-.3848,-.2409,-.1237)*f21+mat4(.335,.5862,-.0725,-.3007,-.1764,.1378,-.641,-.1789,-.2444,-.0423,-.2318,-.4384,-.3295,-.1797,-.2644,.3709)*f22+mat4(.1468,.2838,-.0179,.1677,.2078,-.4386,.3666,-.4553,.4515,.3268,-.2092,.4907,.1785,.059,.0745,-.4199)*f23+mat4(-.4068,-.0235,-.0984,-.1411,.0066,.1346,.2694,-.3914,-.1967,.2792,.1412,-.1879,.0487,-.5213,-.2064,-.3329)*f24+mat4(.4713,.3868,.508,-.3795,-.2581,.0093,-.0602,.1003,-.301,.1585,.155,.4241,-.4324,.1899,.3025,-.1827)*f25+vec4(-2.4271,-9.9355,3.6235,2.7876)),\n    f33=sin(mat4(-.1284,-.0687,.15,.3051,.3525,.1147,-.1304,-.329,-.315,-.0726,.1102,.2761,.2628,-.3544,-.2216,.248)*f20+mat4(.3122,-.1083,-.035,.0558,.2442,.3756,-.3019,.2283,.1907,-.2424,-.2291,.1551,-.0542,.1521,.2099,-.125)*f21+mat4(.1894,-.2517,.363,-.3834,.1454,-.3467,.4493,-.6364,-.2439,.4467,-.0879,-.4417,.1548,-.5377,-.3298,.234)*f22+mat4(.2064,.1592,.284,.3644,-.2492,-.0173,-.2514,-.2167,-.4619,-.1043,.2412,.1497,.3997,-.5633,.3831,.3739)*f23+mat4(.0232,-.2597,-.1004,.113,-.2913,.2777,-.3874,-.2961,.0277,.1601,.1146,.031,-.157,.519,.4388,-.5125)*f24+mat4(-.1745,-.05,-.129,.2036,.4194,-.1312,.1261,.1288,.4293,.2606,-.2343,.1963,-.064,-.2904,.6206,-.7461)*f25+vec4(6.5413,.126,-6.9392,.8852)),\n    f34=sin(mat4(-.3436,-.065,-.2843,.2882,-.0378,.2617,.0442,-.4852,-.4959,.3491,.4293,-.3314,.4016,.1323,-.1521,-.0734)*f20+mat4(.1438,-.0467,-.5675,-.3621,-.5459,-.3927,-.0905,.0955,-.2884,-.392,-.033,.0294,.1881,-.1976,.3686,.2755)*f21+mat4(-.2153,.5244,-.4484,.0437,-.3089,-.118,.7891,-.3537,-.1922,.1494,.1885,-.1102,-.2872,-.1212,-.2301,.1745)*f22+mat4(-.0151,-.2924,.1703,-.3282,.2046,-.1869,.1415,.3787,-.4706,.2693,-.0176,.2895,.2215,.3326,.4035,.2627)*f23+mat4(.2326,-.4552,-.1622,.0996,.0801,.0807,.0999,-.3661,-.3089,-.4737,-.0113,-.1199,.0427,.0676,-.1077,-.5353)*f24+mat4(.1091,.2154,.2013,-.3957,.4329,.0863,-.6135,.0803,-.0158,-.1154,-.1999,.162,.2834,-.0389,-.0785,.0705)*f25+vec4(-3.6345,-5.9407,4.3076,2.5805)),\n    f35=sin(mat4(.4593,-.0378,.5159,-.1848,.2917,.0644,-.3346,.0225,.362,.1627,.2209,-.3789,.4214,-.0507,.2174,-.1863)*f20+mat4(-.3641,.3963,-.2819,.1424,-.264,-.6009,.2325,-.0981,-.5311,-.3442,.0352,-.2403,-.2983,.4688,-.142,-.4733)*f21+mat4(.3323,.2337,-.259,-.2746,-.1718,-.227,.2784,-.1542,.2243,-.0124,.519,.3005,-.5492,-.3992,-.2531,-.3219)*f22+mat4(.0922,.2574,.2776,.1302,.3056,.5408,-.0063,-.40,.2903,-.1293,.3984,-.0925,-.1113,-.1503,.1752,-.4228)*f23+mat4(-.1641,.0329,.0445,-.0219,-.014,-.2798,-.3826,.034,-.0623,.5619,-.1571,-.1671,-.044,-.1316,.0532,.0775)*f24+mat4(-.0634,.1069,-.0276,-.0169,-.3965,-.5649,.2644,-.3086,-.1159,-.2435,.3504,-.3276,.5235,.0885,.1031,.5178)*f25+vec4(5.6755,-6.1623,.503,3.1087)),\n    f40=sin(mat4(-.2982,-.2718,-.2847,.2264,-.3942,-.4774,.246,.41,-.113,-.4259,-.5359,-.0136,.0219,.3659,.0914,-.1506)*f30+mat4(.3667,.314,-.4575,.4239,.0813,.0748,.3802,.2432,.0057,.1322,.457,-.0634,-.1545,-.162,-.1229,-.4654)*f31+mat4(-.1627,.044,-.073,.3037,-.4537,-.337,-.0031,-.5518,-.5949,.4039,.1441,.1064,-.428,-.1182,-.5284,.0169)*f32+mat4(-.0672,-.1269,.054,.1545,.0199,.1363,-.4247,.1308,-.3308,.0672,.2905,.2949,.1463,-.054,-.342,.2077)*f33+mat4(.027,.0194,.1404,.0863,-.4676,-.2288,-.331,.0611,.4474,-.3766,.3708,.2168,.1992,-.0294,-.5156,.2012)*f34+mat4(-.4868,-.0919,-.197,-.4146,-.0987,.1466,.1447,-.4527,-.4753,.4129,.1918,.3889,-.3564,-.4182,.1591,-.5418)*f35+vec4(2.9679,.6242,-8.018,4.7656)),\n    f41=sin(mat4(-.2449,.175,.0819,.2571,.1309,-.3928,-.3604,.287,-.1044,.2243,.0739,-.4157,-.0292,-.2465,-.0272,.0937)*f30+mat4(-.1924,.2109,.1603,-.0187,.1866,-.415,.2172,-.5965,.034,-.2864,-.5342,-.4079,.0858,-.0395,.3341,-.4362)*f31+mat4(-.4247,.3523,.3084,.52,-.0068,.4735,.0383,.018,-.136,-.5101,-.0777,-.2069,.0129,.0322,-.332,-.175)*f32+mat4(-.1827,-.4442,-.43,-.3112,-.0127,-.4239,-.1282,.538,.0911,-.1143,.364,-.2088,.367,.3074,.107,.0655)*f33+mat4(.3535,-.3351,-.1933,-.2993,-.1943,-.0313,.3892,-.1516,-.1734,.2644,-.2034,.5219,-.4883,.0374,-.3564,-.2491)*f34+mat4(.4357,.2191,-.0929,-.0267,.4964,.3372,.2244,-.0567,-.3893,.3921,.345,-.0529,.3512,-.1861,.5498,-.3761)*f35+vec4(7.8372,1.0341,-7.4797,3.4855)),\n    f42=sin(mat4(-.0283,.1772,-.0607,-.0907,.4739,.4146,.0238,.0782,.1614,.3476,-.2775,-.2674,.2121,.0676,-.1354,.5211)*f30+mat4(-.1815,.2728,-.2588,-.2388,.2528,-.3378,.425,-.2159,-.0467,-.388,-.301,-.0878,.3853,.3126,-.2472,.3549)*f31+mat4(.1209,-.0511,-.0321,-.5477,-.2685,-.2574,.1262,.0728,-.0267,-.0764,.522,-.1849,.1205,-.3673,.4592,-.4736)*f32+mat4(.199,.0382,-.1954,.069,-.4207,.0042,-.1615,-.0786,-.4698,.4511,.2011,.4801,-.1544,-.0265,-.4162,.2535)*f33+mat4(-.2674,-.223,.0897,-.3421,.3115,.0153,-.4276,.2941,.4164,-.0861,-.2279,.273,.3348,-.3553,.1256,.3529)*f34+mat4(-.5857,-.2308,.1187,.2624,.3124,.0443,.3638,.3607,-.1858,.2338,-.3117,.074,-.3067,-.2986,.0501,.3356)*f35+vec4(8.2717,-6.7485,-3.1517,-1.2446)),\n    f43=sin(mat4(.4164,-.2261,-.8019,-.2559,-.0944,.1647,-.1898,.2983,.264,.00,.2081,-.2348,-.0756,.5272,.3663,-.2353)*f30+mat4(.2282,.0786,-.0666,-.1568,.3861,-.05,.0346,-.3402,-.3255,.0812,-.2613,-.512,.2877,.183,.564,-.2338)*f31+mat4(.0033,.1012,.536,-.0943,.0738,.183,.2217,.3995,-.1985,.0326,.5266,.2702,.0975,-.5737,.009,-.1357)*f32+mat4(-.3448,.2845,.0475,.1495,.2502,.3766,-.0184,-.1552,.3832,.4205,.3192,-.2253,-.0382,-.0649,-.4069,.4438)*f33+mat4(-.30,-.1323,.0442,.1015,.3848,.1823,-.4906,-.2398,-.1964,-.0027,.353,.1064,-.035,.7972,-.5327,.2729)*f34+mat4(-.1287,.154,.3029,-.103,-.5152,-.4719,.2406,-.1728,.1061,-.0609,-.1336,-.264,-.2568,-.3568,.2708,.2735)*f35+vec4(.8577,4.6324,7.7999,-.1456)),\n    f44=sin(mat4(-.3803,-.197,-.0525,.3888,-.2362,-.4497,-.3119,.2413,-.5147,-.2085,-.218,.5138,-.3849,-.0223,.2104,.1926)*f30+mat4(.1071,-.2181,.2228,-.0222,.1968,.2034,-.2096,.0401,-.0012,.1259,-.0207,.3886,.4106,-.0852,-.1152,-.2496)*f31+mat4(.0684,-.366,-.2308,.2204,.1014,.334,.394,-.2874,-.1979,.4371,.186,-.1577,.3953,-.1055,.2334,.1181)*f32+mat4(.2858,-.3982,-.1051,-.2249,.0659,.0416,-.2264,-.2092,.2319,-.4611,.2297,.4798,-.3909,.2388,.2565,-.3311)*f33+mat4(-.4256,.365,-.2711,-.0541,-.0396,-.3511,.2145,.4764,.3155,-.3923,-.4493,-.3203,.3951,.4159,.0023,.1105)*f34+mat4(-.1512,.2501,.1437,-.0336,.257,-.2619,-.183,.1746,-.0951,-.4207,-.1996,.2565,.3586,-.1181,.3017,.4053)*f35+vec4(-9.7258,7.0812,2.7605,-5.0138)),\n    f45=sin(mat4(-.1231,-.2363,-.3741,.2319,-.3664,.257,-.4384,-.3741,-.1024,-.0109,-.0008,.296,-.0389,-.2252,.3125,.297)*f30+mat4(-.194,.2538,.2664,-.3225,.5236,.0427,-.3475,-.1083,-.1039,-.3647,.0772,-.6024,-.3062,.5013,-.303,-.3172)*f31+mat4(-.4146,.367,-.048,.0176,-.3678,-.1927,.5747,-.1757,-.0839,.0145,.2059,.3485,.3485,-.12,-.1448,.0963)*f32+mat4(-.1616,-.4323,.3674,.618,.2973,-.2218,.0774,.0425,-.4865,-.1551,-.3833,-.3025,-.3155,.1277,.2853,.2398)*f33+mat4(.2846,-.225,-.0934,.393,.0398,.0442,-.022,.1669,-.2225,-.0622,-.1953,.0664,-.357,.6316,.4058,-.1182)*f34+mat4(.1172,.291,.3591,-.062,-.028,.3992,.0354,.0223,.5511,-.364,-.2797,.0236,-.3794,.3338,.2523,.2542)*f35+vec4(-.1335,-1.0642,1.0332,-.6296)),\n    f50=sin(mat4(.1725,-.3511,-.1025,-.336,-.3465,.3249,.304,-.4546,.2836,.2577,.0901,.4666,.132,-.0173,.4087,.3893)*f40+mat4(.0989,-.1538,.0489,-.0996,.125,-.2166,-.05,.5234,.0049,-.2557,.5256,.2359,-.04,-.3062,-.2544,-.2528)*f41+mat4(.2554,.4818,.1204,-.4237,-.3289,.3877,.2558,-.4976,-.3633,-.3289,.225,.1999,.3397,.0437,-.318,-.1412)*f42+mat4(-.1851,-.3573,.338,-.0387,-.286,-.26,.1874,-.5223,-.2743,.319,-.5306,-.085,-.3179,.3589,-.1983,-.2316)*f43+mat4(-.1638,.0743,.3452,-.2244,-.3701,-.3268,-.3573,-.3501,-.4223,-.1084,-.1486,-.4398,.324,.2579,-.0804,.507)*f44+mat4(-.2425,.0243,.2287,-.0603,-.3514,.2655,-.3929,-.1666,-.2485,.3249,-.0742,.1402,.0717,-.4145,.1811,.547)*f45+vec4(-2.4985,-4.3149,7.8104,3.5936)),\n    f51=sin(mat4(.3995,.3135,.0335,.2514,-.0011,.3068,-.2948,-.2703,.0249,.1455,.2616,.1994,.2947,-.0441,-.3482,.2487)*f40+mat4(.2728,.5196,.3234,.2785,-.342,-.116,-.3408,.2001,.1849,-.468,.2779,-.082,.4727,-.3033,.1606,.2624)*f41+mat4(.1374,.0041,.4564,.1153,.3552,.1718,.2413,.3146,-.293,.2943,.1457,-.3401,.3296,.0154,.0767,-.139)*f42+mat4(-.1264,.1521,-.413,-.3752,.2256,-.1999,.0957,.4253,.2128,-.3135,-.2723,-.254,.1218,.3387,.1816,.3367)*f43+mat4(-.242,.3241,-.2485,.1975,-.5434,.2576,-.0654,-.3434,-.1099,-.4757,-.2567,-.1263,.1094,.0014,.1694,.3944)*f44+mat4(.1146,-.3542,.1038,.345,-.5033,-.0057,.3653,.1798,.13,-.1581,.0453,-.1754,-.0671,-.4016,.3555,-.1622)*f45+vec4(7.9017,4.1185,1.6005,-9.984)),\n    f52=sin(mat4(-.155,-.0262,.2287,.1978,-.1813,.3312,-.0721,-.0599,.4823,.0881,.2304,-.419,-.126,-.3298,-.4679,-.0566)*f40+mat4(-.2362,.1085,.1959,-.1893,.2288,-.2963,-.094,-.2195,.4262,.3905,-.3141,-.0497,.1266,.1727,-.3487,-.1387)*f41+mat4(.1146,.3576,-.2345,-.2726,-.2038,-.2101,-.5213,.0,.0535,-.404,.0546,.4397,.0155,-.2892,-.202,.2765)*f42+mat4(-.3225,.013,.2566,.5203,.3995,.009,.0447,-.0781,.1412,.1975,-.2586,.0125,.2654,.2037,.3824,.1503)*f43+mat4(.0464,-.3108,.1433,.3741,.4892,.3117,.4563,-.0253,-.3334,-.1662,.5713,-.3187,.005,.0299,.3769,-.3806)*f44+mat4(.0763,.416,-.3464,.4478,.1769,-.1254,-.5091,.0682,.4674,.4576,-.1482,-.1842,-.1722,-.0873,-.0472,.0889)*f45+vec4(7.3103,8.6246,6.6191,4.0456)),\n    f53=sin(mat4(.1255,-.053,-.1651,.332,-.2632,.1748,-.1243,.0458,.2028,.4582,.0891,-.3238,-.178,.084,.3663,.274)*f40+mat4(.3676,-.5532,.1746,.1967,-.2498,-.2112,.3041,-.4193,.1464,.3393,-.0338,-.3956,.3707,-.3474,-.2713,.3881)*f41+mat4(-.4141,-.5121,.1107,.5867,-.1151,.0522,.0328,-.1912,.0821,.1145,-.4246,.0537,.2533,.0525,-.2848,.3792)*f42+mat4(.2431,.2535,.4416,.4403,-.0036,.0156,.339,-.3912,-.5179,.1491,-.0403,-.335,-.2467,-.2339,-.4435,.0123)*f43+mat4(-.1082,.1126,.4595,.0401,.1621,-.101,-.2932,-.3859,.361,-.304,.3951,-.3239,-.3581,-.3988,-.3152,.1679)*f44+mat4(-.0674,-.0521,-.4653,.2841,-.2016,-.2901,-.1002,.3672,.4827,-.3368,.2566,-.246,-.2857,.0369,-.1644,-.546)*f45+vec4(-7.5493,9.7168,8.5505,4.1711)),\n    f54=sin(mat4(.2642,-.062,-.4131,.5545,.2888,.5235,.1783,.4177,-.2251,-.271,-.0459,-.4369,.4855,.3756,.3059,.1063)*f40+mat4(.0028,-.1153,.0521,.1158,-.1273,-.5974,.0107,.252,-.12,-.1407,.1865,-.1611,.048,.5271,-.4131,.3234)*f41+mat4(.1267,.0825,-.2675,.0231,-.3646,-.4667,.0417,.1107,.2483,.3901,.3618,.2484,.3758,-.1169,-.0672,-.0245)*f42+mat4(-.4066,-.3698,-.0961,.4071,.202,-.4405,.0957,-.0097,.3356,.3181,-.1096,-.2123,.0559,-.5176,.0399,-.0025)*f43+mat4(.1439,.0711,-.4068,-.1552,-.1928,-.4361,-.0716,.5319,.3322,.0998,.1565,-.4069,.3366,-.2972,.3493,.5872)*f44+mat4(-.2089,-.456,-.1647,.2874,.4307,-.2489,-.2628,.1032,-.0607,-.079,.0965,.1706,.032,-.3187,-.3464,-.1898)*f45+vec4(-.9522,-4.7879,-3.3533,2.3485)),\n    f55=sin(mat4(-.283,-.2661,-.3013,.2385,.0907,-.3558,-.3234,.0431,.0086,.279,-.3663,-.3304,.0506,.0931,.1586,-.3362)*f40+mat4(-.4877,-.5359,-.2656,-.2416,.4458,.0302,-.077,-.3621,-.1727,.1462,.3847,-.0904,-.2763,-.3148,-.3637,-.456)*f41+mat4(-.3609,.1381,.4347,-.04,.394,-.2611,-.4487,-.1118,.2284,.3741,-.3848,-.6681,.1367,.0163,-.3683,.3338)*f42+mat4(.307,-.3282,.4175,-.0482,-.1193,-.4131,.4458,-.3893,-.4216,-.2384,.3685,.0259,.13,.1943,.3225,-.2098)*f43+mat4(.1235,.0379,-.3678,-.5206,.0202,.2872,-.1207,-.3895,.1591,.1607,.0304,.0562,-.4542,-.2554,.0049,-.0277)*f44+mat4(.4784,-.0907,-.3248,-.6784,-.2956,-.0851,-.0571,-.04,.3936,-.3879,.0721,.403,-.463,-.379,.5013,-.1845)*f45+vec4(2.9987,6.6606,-8.188,-3.606));\n  return dot(vec4(.1067,-.4852,.1926,.0809),f50)+dot(vec4(-.3773,.04,-.4641,-.0595),f51)+dot(vec4(-.1275,.2661,-.2473,.4345),f52)+dot(vec4(-.178,-.1137,.4711,.1562),f53)+dot(vec4(-.4269,-.0222,-.4766,.1315),f54)+dot(vec4(-.1023,-.3051,-.158,.065),f55)+1.756;\n}\n#elif quality == 1\n// Units: 12 Layers: 3 Epochs: 25000 Loss: 1.0743e-04\nfloat map(vec3 p) {\n  if(length(p) > 1.) return length(p)-.8;\n  vec4 x=vec4(p, 1),\n    f00=sin(x*mat4(-1.3497,-2.61,.5995,-10.6288,3.2519,-4.0954,5.4096,4.5967,1.5785,-2.1819,3.5504,-5.7938,3.4122,3.3519,-1.8157,-6.3553)),\n    f01=sin(x*mat4(-1.1169,2.5928,-2.0646,-.8364,-1.459,1.4139,.1221,-5.6453,3.023,-2.2806,-1.0281,7.14,-1.8537,2.7749,2.9444,-2.1264)),\n    f02=sin(x*mat4(4.3529,3.8182,-.2447,1.6216,-.6057,.6959,-1.3658,3.5768,-1.7431,4.2184,2.7728,.3658,2.5822,-.1761,.5244,-7.872)),\n    f10=sin(mat4(.6268,.7741,.8002,-.1867,-.0969,.2182,-.0234,.103,-.7211,-.2214,-.316,.1736,.0243,.156,-.0715,.5135)*f00+mat4(-1.2356,.5685,-.4359,.0727,-.3554,-.0442,.7263,-.7764,.3848,-.3009,-.1683,.7964,.3398,.6944,-.1859,-.3343)*f01+mat4(.1822,.0476,-.0157,-.1157,-.2404,1.2358,1.6439,-.7058,.3895,-.0561,-.1552,.0328,1.5033,.1426,-.4343,.0379)*f02+vec4(-6.4832,-13.2078,-8.6655,12.3254)),\n    f11=sin(mat4(-.6394,-.2693,.6358,.1624,-.249,.0141,.0788,.2595,-.0788,-.7847,-.1189,.0009,.2974,-.7097,-.0584,.42)*f00+mat4(.0322,-.1939,.3773,.0469,.8243,-.2156,.966,.0555,-.84,.7816,-.4075,.1174,1.2601,-.9161,.0463,-.6586)*f01+mat4(-.2634,-.1491,.1268,-.1558,-.566,-.858,1.2774,-.5228,.6821,-.9523,.0914,-.0695,.3491,-.3651,.4505,-.1507)*f02+vec4(11.1936,10.3493,-5.7107,2.7625)),\n    f12=sin(mat4(-.3602,-.5507,-.4081,-.5526,-.1764,.0047,-.0461,.0427,-.6011,.7002,.9449,-.2702,-.1931,-.034,.3342,.1863)*f00+mat4(-.1782,.6201,1.4958,-.613,1.3561,.6427,.7845,.9488,-.3071,.229,.0964,-.1514,-.6891,.0097,-.3769,.1702)*f01+mat4(-.3103,-.0834,.1621,.1017,.7531,1.1526,.3201,1.9363,.0246,-.028,.2364,-.1309,.4159,.6163,-1.0226,-.6067)*f02+vec4(-6.6057,-12.3299,-.8657,-2.7578)),\n    f20=sin(mat4(-.0525,.0977,.0642,-.1461,-.5834,.4148,-.6551,.2866,.1875,.1641,.2984,-.4211,1.0318,-.8373,-.3212,.654)*f10+mat4(-.5537,.6507,.1614,.1438,-.2686,.2305,-.3948,.1079,-.7547,.859,.519,-.3779,.1082,-.041,.0037,.1262)*f11+mat4(-.4904,.4109,.4589,-.1856,.0481,.1771,-1.1849,-.377,-.1774,.2406,.6696,-.3895,.3264,-.444,-.4156,-.4954)*f12+vec4(2.5065,-11.9959,-10.2575,-13.1298)),\n    f21=sin(mat4(.0755,1.0219,.1432,.4773,-.0317,-.3126,.3397,.1384,.4067,.0612,.8309,-.056,-1.5425,-.8461,.5092,.4293)*f10+mat4(.0879,.1075,-.103,.0596,-.3524,.6811,.0861,.5674,-.5095,1.3127,-.9149,1.7472,-2.4446,-.3888,-.2527,.779)*f11+mat4(.0707,-1.7261,-.0226,-.7449,1.3893,-.6994,1.0202,-.0103,.5519,.1795,.2524,.1153,-1.9183,.1257,.0994,.7121)*f12+vec4(13.3359,12.7853,8.1493,9.7989)),\n    f22=sin(mat4(-.3866,.4384,.0329,.0294,.9867,.0831,-1.0965,-.1886,.7546,.2638,.8183,-.6298,2.0335,.0944,1.3405,.2353)*f10+mat4(.5787,-.1161,-.4087,-.0802,-.4765,-.0438,-.4065,.14,1.361,.5141,-.5887,.4499,.1582,.1839,.231,.2785)*f11+mat4(-.1944,.1365,-.9464,.021,.154,.2343,.7307,.1472,-.538,.4699,-.1801,-.258,.4333,-.573,.5312,.0532)*f12+vec4(-9.2285,2.0792,-7.0489,-8.4893));\n  return dot(vec4(-.4136,.3016,.0965,-.2787),f20)+dot(vec4(.0362,-.0562,.0821,-.104),f21)+dot(vec4(-.0454,-.1745,-.108,.3944),f22)+.6627;\n}\n#endif\n\nvec3 normal(vec3 p, float e) {\n    vec2 h = vec2( 1,-1) * 0.5773;\n    return normalize(h.xyy * map(p + h.xyy * e)+\n                     h.yyx * map(p + h.yyx * e)+\n                     h.yxy * map(p + h.yxy * e)+\n                     h.xxx * map(p + h.xxx * e));\n}\n\nfloat raymarch(vec3 ro, vec3 rd) {\n    float t = 0.0;\n    for(int i = 0; i < steps; i++) {\n        vec3 p = ro + rd * t;\n        float d = map(p);\n        t += d;\n        if(t > tmax || abs(d) < tmin) break;\n    }\n    return t;\n}\n\nmat3 cam(vec3 at, vec3 ro) {\n    vec3 z = normalize(at - ro);\n    vec3 x = normalize(cross(vec3(0, 1, 0), z));\n    vec3 y = cross(z, x);\n    return mat3(x, y, z);\n}\n\nvoid mainImage(out vec4 fragColor, vec2 fragCoord) {\n    vec2 uv = (2.0*fragCoord.xy-iResolution.xy)/max(iResolution.x, iResolution.y);\n    vec2 ux = (2.0*fragCoord.xy+vec2(1, 0)-iResolution.xy)/max(iResolution.x, iResolution.y);\n    vec2 uy = (2.0*fragCoord.xy+vec2(0, 1)-iResolution.xy)/max(iResolution.x, iResolution.y);\n    \n    vec3 at = vec3(0, 0, 0);\n    vec3 ro = vec3(sin(iTime*0.5)*3.0, 0, -cos(iTime*0.5)*3.0);\n    mat3 ca = cam(at, ro);\n    vec3 rd  = normalize(ca * vec3(uv, 1));\n    vec3 rdx = normalize(ca * vec3(ux, 1));\n    vec3 rdy = normalize(ca * vec3(uy, 1));\n    vec3 drddx = rdx - rd;\n    vec3 drddy = rdy - rd;\n    \n    float t = raymarch(ro, rd);\n    vec3 col = textureGrad(iChannel0, rd, drddx, drddy).xyz;\n    \n    if(t < tmax) {\n        vec3 p = ro + rd * t;\n        vec3 nor = normal(p, tmin * t);\n        vec3 lig = normalize(vec3(1, 1, -1));\n        float texSize = float(textureSize(iChannel0, 0).x);\n              texSize*= texSize;\n        vec3 amb = textureGrad(iChannel0, nor, vec3(-texSize-nor), vec3(texSize+nor)).xyz;\n        vec3 dif = amb + max(0.0, dot(nor, lig)) * 0.5;\n        float r = 0.25;\n        vec3 spc = pow(max(0.0, dot(normalize(lig-rd), nor)), 25.0) * vec3(1);\n        spc += textureGrad(iChannel0, reflect(rd, nor), (reflect(rdx, nor) - rd) * r, (reflect(rdy, nor) - rd) * r).xyz;\n        col = mix(spc, dif, max(0.0, dot(nor, -rd))*0.6+0.4);\n    }\n    \n    fragColor = vec4(col, 1.0);\n}","name":"Image","description":"","type":"image"}]}