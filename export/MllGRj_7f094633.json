{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[{"channel":0,"type":"cubemap","id":"XsfGzn","filepath":"/media/a/585f9546c092f53ded45332b343144396c0b2d70d9965f585ebc172080d8aa58.jpg","sampler":{"filter":"linear","wrap":"clamp","vflip":"false","srgb":"false","internal":"byte"}},{"channel":1,"type":"texture","id":"Xsf3zn","filepath":"/media/a/f735bee5b64ef98879dc618b016ecf7939a5756040c2cde21ccb15e69a6e1cfb.png","sampler":{"filter":"mipmap","wrap":"repeat","vflip":"false","srgb":"false","internal":"byte"}}],"code":"float noise(vec3 x) {\n    vec3 p = floor(x), f = fract(x);\n\tvec2 rg = texture(iChannel1, (p.xy+vec2(37.0,17.0)*p.z + f.xy)/256.0).yx;\n\treturn mix( rg.x, rg.y, f.z );\n}\n\nfloat Flame(vec3 p) {\n    float d = 0., k = .5;\n    p.y += iTime*.01;\n\tfor(int i=0;i<5; i++) d += noise(p*1000.)/k, p+=p, k+=k;\n\treturn d;\n}\n\n#define S sin(p.z*.2)*vec4(1,2,0,0)\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n    vec4 p = vec4(fragCoord,0.,1.)/iResolution.xyxy-.5, d=p, t, c, n;\n    p.z += iTime*4.;\n    p -= S;\n    for(float i=1.5; i>0.; i-=.01)\n    {\n        n = mod(c=p+S, 8.)-4.;\n        t = abs(mod(c=p+S, 8.)-4.);\n        float x = step(0., c.y), y,\n        flame = 0.,\n        r = (step(2.6, t.x) - step(2.8, t.x)) * x,\n        wood = step(t.x, 0.8) * step(2.8, t.z) + step(2.8, t.x) * x;\n        c = texture(iChannel0, (c.y*t.x > 3. ? t.zxy:t.yzx)-3.);\n        \n        // Floor/Ceiling & side wall\n        x = min(t.x+.2, t.y) - c.x*(1.-r) - r*.8;\n        \n        // Torch stand\n        x = min(x, y=max(n.y, length(t.xz-vec2(1,0))-.2));\n        if(x == y) wood = 1.;\n        \n        // Flame & Smoke\n        vec3 uv = vec3(abs(n.x), n.y, n.z)-vec3(1,3.8,0);\n        x = min(x, y=length(uv)+.2-Flame(n.xyz*.005)*.9/(n.y-.4));\n        flame = x/y * n.y * n.y * .1;\n        \n        fragColor = p.wyyw*.02 + mix(c, vec4(.5), r) * mix(mix(p/p, vec4(6,3,1,0), flame), vec4(1,.5,.2,1), wood ) * i*i/p.w;\n        if(x<.01) { // Wall light\n            fragColor += max(vec4(0.), vec4(1.-length(n.xyz-vec3(0,2,1))*.45)*vec4(5.,3.,1.,1)*1. / p.w);\n            break;\n        }\n        p -= d*x*.5;\n     }\n}\n","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"MllGRj","date":"1423439095","viewed":510,"name":"Hell Carting","username":"Trisomie21","description":"Derived from https://www.shadertoy.com/view/4tf3Rj# (Cheap flames & ceiling smoke)","likes":15,"published":1,"flags":0,"usePreview":0,"tags":["raymarching","noise","displacement","cubemap"],"hasliked":0,"parentid":"","parentname":""}}