{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[],"code":"float hash(float x)\n{\n\treturn fract(21654.6512 * sin(385.51 * x));\n}\n\nfloat hash(vec2 p)\n{\n\treturn fract(1654.65157 * sin(15.5134763 * p.x + 45.5173247 * p.y+ 5.21789));\n}\n\nvec2 hash2(vec2 p)\n{\n\treturn vec2(hash(p*.754),hash(1.5743*p+4.5476351));\n}\nvec2 add = vec2(1.0, 0.0);\n\nvec2 noise2(vec2 x)\n{\n    vec2 p = floor(x);\n    vec2 f = fract(x);\n    f = f*f*(3.0-2.0*f);\n    \n    vec2 res = mix(mix( hash2(p),          hash2(p + add.xy),f.x),\n                    mix( hash2(p + add.yx), hash2(p + add.xx),f.x),f.y);\n    return res;\n}\n\nvec2 fbm2(vec2 x)\n{\n    vec2 r = vec2(0.0);\n    float a = 1.0;\n    \n    for (int i = 0; i < 8; i++)\n    {\n        r += noise2(x) * a;\n        x *= 2.;\n        a *= .5;\n    }\n     \n    return r;\n}\n\n\nfloat dseg( vec2 ba, vec2 pa )\n{\n\t\n\tfloat h = clamp( dot(pa,ba)/dot(ba,ba), -0.2, 1. );\t\n\treturn length( pa - ba*h );\n}\n\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\t\n\t\n\tvec2 p = 2.*fragCoord.xy/iResolution.yy-1.;\n    vec2 d;\n    vec2 tgt = vec2(1., -1.);\n    float c=0.;\n    if(p.y>=0.)\n        c= (1.-(fbm2((p+.2)*p.y+.1*iTime)).x)*p.y;\n\telse \n        c = (1.-(fbm2(p+.2+.1*iTime)).x)*p.y*p.y;\n\tvec3 col=vec3(0.),col1 = c*vec3(.3,.5,1.);\n    float mdist = 100000.;\n    \n    float t = hash(floor(5.*iTime));\n    tgt+=4.*hash2(tgt+t)-1.5;\n    if(hash(t+2.3)>.6)\n\tfor (int i=0; i<100; i++) {\n\t\t\n\t\tvec2 dtgt = tgt-p;\t\t\n\t\td = .05*(vec2(-.5, -1.)+hash2(vec2(float(i), t)));\n        float dist =dseg(d,dtgt);\n\t\tmdist = min(mdist,dist);\n\t\ttgt -= d;\n\t\tc=exp(-.5*dist)+exp(-55.*mdist);\n        col=c*vec3(.7,.8,1.);\n\t}\n    col+=col1;\n\tfragColor = vec4(col, 0.0);\n}","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"Xll3R2","date":"1423396246","viewed":2210,"name":"Stormy flight","username":"guil","description":"Experiment with lightning effect\n","likes":27,"published":1,"flags":0,"usePreview":0,"tags":["2d","lightning","storm"],"hasliked":0,"parentid":"","parentname":""}}