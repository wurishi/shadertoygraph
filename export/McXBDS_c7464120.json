{"ver":"0.1","info":{"id":"McXBDS","date":"1724380435","viewed":50,"name":"E8 Lattice","username":"Boogaloo","description":"The E8 root lattice, i.e. all points in R^8 where the coordinates sum to an even integer and the coordinates are either all integers or all half integers. Perspective is continuously rotating in the non-xyz directions. Hold mouse for blurred view.","likes":1,"published":1,"flags":0,"usePreview":0,"tags":["lattice","e8","liegroup"],"hasliked":0,"parentid":"MfffWS","parentname":"Fork tEESSST Boogaloo 556"},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define T (iTime+3.)*.5\n\nfloat dist8(float[8] a, float[8] b){\nfloat d=0.;\nfor(int i=0;i<8;i++){\nd+=pow(a[i]-b[i],2.);}\nreturn sqrt(d);\n}\n\nfloat sum8(float[8] a){\nfloat s=0.;\nfor(int i=0;i<8;i++){\ns+=a[i];\n}\nreturn s;\n}\n\nfloat[8] norm8(float[8] a){\nfloat[8] b;\nfloat len = dist8(a,b);\nfor(int i=0;i<8;i++){\nb[i]=a[i]/len;}\nreturn b;\n}\n\nfloat[8] round8(float[8] a){\nfloat[8] b;\nfor(int i=0;i<8;i++){\nb[i]=round(a[i]);}\nreturn b;\n}\n\nfloat[8] wround8(float[8] a){\nfloat[8] b=round8(a);\nint w=0;\nfloat m=0.;\nfor(int i=0;i<8;i++){\nif(abs(a[i]-b[i])>m){w=i;m=abs(a[i]-b[i]);}\n}\nif(a[w]-b[w]>0.){\nb[w]=b[w]+1.;\n}else{\nb[w]=b[w]-1.;\n}\nreturn b;}\n\nfloat sdf(float[8] p){\nfloat[8] a=round8(p);\nif(mod(sum8(a),2.)>0.){a=wround8(p);}\nfloat[8] p2;\nfor(int i=0;i<8;i++){\np2[i]=p[i]-.5;\n}\nfloat[8] b=round8(p2);\nif(mod(sum8(b),2.)>0.){b=wround8(p2);}\nreturn min(dist8(p,a),dist8(p,b))-.5;\n}\n//fast lattice algorithm by Conway and Sloane http://neilsloane.com/doc/Me83.pdf\n\nvec3 hsv( in vec3 c ){\n    vec3 rgb = clamp( abs(mod(c.x*6.0+vec3(0.0,4.0,2.0),6.0)-3.0)-1.0, 0.0, 1.0 );\n\trgb = rgb*rgb*(3.0-2.0*rgb);\n\treturn c.z * mix( vec3(1.0), rgb, c.y);}\n//smooth hsv from iq https://www.shadertoy.com/view/MsS3Wc\n\nvoid mainImage(out vec4 O, in vec2 I)\n{\n   vec2 uv = (I* 2. - iResolution.xy) / iResolution.y;\n   O=vec4(0.);\n   float[8] origin= float[8](0.,0.,-1.3,0.,0.,0.,0.,0.);\n   float[8] dir=norm8(float[8](uv.x,uv.y,1.,cos(.25*T),cos(.15*T),cos(.2*T),cos(.07*T),cos(.18*T)));\n   float t=0.;\n   for(int i=0;i<80;i++){\n   if(iMouse.z>0.&&i>40){break;}\n   float[8] r;\n   for(int j=0;j<8;j++){\n   r[j]=origin[j]+dir[j]*t;\n   }\n   float d=sdf(r);\n   t+=d;\n   vec3 a=vec3(1.);\n   if(d<.001){break;}\n   if(t>100.){break;}\n   }\n   O=vec4(hsv(vec3(log(t),1.,1.-.05*t)),0.);\n}\n//rendering roughly based on https://www.shadertoy.com/view/MfX3WH from kishimisu","name":"Image","description":"","type":"image"}]}