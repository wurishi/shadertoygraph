{"ver":"0.1","info":{"id":"mdBXzw","date":"1670055168","viewed":69,"name":"frist ray cast","username":"Kolya142","description":"w","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["raycasting"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XsX3zn","filepath":"/media/a/94284d43be78f00eb6b298e6d78656a1b34e2b91b34940d02f1ca8b22310e8a0.png","previewfilepath":"/media/ap/94284d43be78f00eb6b298e6d78656a1b34e2b91b34940d02f1ca8b22310e8a0.png","type":"cubemap","channel":0,"sampler":{"filter":"mipmap","wrap":"clamp","vflip":"false","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define rot(a) mat2(cos( a+ vec4(0,33,11,0) ))\nfloat f(vec2 uv) {\n    return sin(uv.x) * sin(uv.y);\n}\nvec3 castRay( const vec3 ro, const vec3 rd, float resT )\n{\n    float dt = 0.01f;\n    const float mint = 0.001f;\n    const float maxt = 20.0f;\n    float lh = 0.0f;\n    float ly = 0.0f;\n    for( float t = mint; t < maxt; t += dt )\n    {\n        vec3  p = ro + rd*t;\n        float h = f( p.xz );\n        if( p.y < h )\n        {\n            // interpolate the intersection distance\n            resT = t - dt + dt*(lh-ly)/(p.y-ly-h+lh);\n            return 0.5 + 0.5*cos(iTime+p.xzx+vec3(0,2,4)) * (min(maxt-t, 1.2)*.8);\n        }\n        // allow the error to be proportinal to the distance\n        dt = 0.01f*t;\n        lh = h;\n        ly = p.y;\n    }\n    return texture(iChannel0, rd).rgb;\n}\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // Normalized pixel coordinates (from 0 to 1)\n    vec2 vuv = fragCoord/iResolution.xy;\n    vuv.x *= iResolution.x / iResolution.y;\n    vuv.x -= .5;\n    vec2 uv = vuv * 2. - 1.;\n    vec2 M = (iMouse.xy/iResolution.xy - .5) * 2.;\n    vec3 rd = normalize(vec3(uv, 1.));\n    rd.yz *= rot(M.y);\n    rd.xz *= rot(M.x);\n    vec3 ro = vec3(0.);\n    ro.y = 2.;\n    ro.x += iTime;\n\n    // Time varying pixel color\n    vec3 col = castRay(ro, rd, 1.);\n\n    // Output to screen\n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}