{"ver":"0.1","info":{"id":"Nldyzj","date":"1660137762","viewed":105,"name":"radiant portal door","username":"nexor","description":".","likes":0,"published":1,"flags":48,"usePreview":0,"tags":["2d","multipass"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\nif(iFrame%2==1)discard;\n    fragColor = texture(iChannel0,fragCoord/iResolution.xy);\n}","name":"Image","description":"","type":"image"},{"inputs":[],"outputs":[],"code":"#define frame iFrame\n#define resolution iResolution.xy\n\nconst float pi = acos(-1.);\nconst float tau=pi*2.;\nmat2 rot(float a)\n{\n  float c=cos(a),s=sin(a);\n  return mat2(c,-s,s,c);\n}\nfloat rand(vec2 n) {\n\t\treturn fract(sin(dot(n, vec2(12.9898, 4.1414))) * 43758.5453);\n}\nfloat noise(vec2 p)\n{\n\t\tvec2 ip = floor(p);\n\t\t\tvec2 u = fract(p);\n\t\t\tu = u*u*(3.0-2.0*u);\n\t\t\tfloat res = mix(\n\t\t\t\t\tmix(rand(ip),rand(ip+vec2(1.0,0.0)),u.x),\n\t\t\t\t\t\tmix(rand(ip+vec2(0.0,1.0)),rand(ip+vec2(1.0,1.0)),u.x),u.y);\n\t\t\t\t\t\t\treturn res*res;\n}\nconst mat2 M =mat2(\n\t.74,-.52,\n\t.64,.73\n);\nfloat fbm(vec2 p)\n{\n    float f = 0.0;\n    f += 0.5000*noise( p ); p*=M*2.02;\n    f += 0.2500*noise( p ); p*=M*2.03;\n    f += 0.1250*noise( p ); p*=M*2.01;\n    f += 0.0625*noise( p );\n    f /= 0.9375;\n    return f;\n}\n\n\nfloat box(vec2 p, vec2 s)\n{\n  vec2 d = abs(p)-s;\n  return min(max(d.x,d.y),0.)+length(max(d,0.));\n}\n\nvec4 fetch(sampler2D s,vec2 p,vec2 res)\n{\n\tfloat mx = max(res.x, res.y);\n\tp=(p*mx+res.xy)/2.;\n\tp/=res.xy;\n\t//(2.*gl_FragCoord.xy-resolution.xy)/mx;\n\treturn texture(s,p);\n}","name":"Common","description":"","type":"common"},{"inputs":[{"id":"4dXGRr","filepath":"/presets/tex00.jpg","previewfilepath":"/presets/tex00.jpg","type":"keyboard","channel":2,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    float space = texelFetch(iChannel2,ivec2(32,1),0).x;\n\tfloat mx = max(resolution.x, resolution.y);\n\tvec2 uv = (2.*fragCoord.xy-resolution.xy)/mx;\n//\tvec3 buf=texelFetch(backbuffer,ivec2(gl_FragCoord.xy),0).rgb;\n\tvec3 col = vec3(0);\n\tfloat w=fwidth(uv.y);\n float d=1e3;\n float t=float(frame)/60.;\n vec2 p=uv,q=uv;\n float a=atan(uv.y,uv.x);\n float k=length(p);\n q*=rot(-t*.02\n -fbm(q*15.+fbm(q*2.)*2.)\n )*1.1;\n //q.x-=sin(t*150.)*.002;\n k=length(q);\n vec4 buf=fetch(iChannel0,q,resolution);\n //buf=pow(buf,vec4(2.2));\n d=box(p,vec2(.2,.3));\n d=pow(d,3.);\n d=1.-smoothstep(w,.0,d);\n col+=cos(vec3(3,5,7)*d*pi*30.)*.5+.5;\n //col*1.5-.5;\n //col+=\n \t//cos(vec3(2.,3.,5.)*a+k*15.+t*d*3.)*.5+.5;\n //col=mix(buf.rgb,col,.2);\n col=col*1.2-buf.rgb;\n //col = normalize(col)+.5;\n //col=.2+.8*col;\n //col=pow(col,vec3(1./2.2));\n if(space > 0. && iFrame%2==0)\n     return;\n else\n     fragColor = vec4(col, 1.0);\n}","name":"Buffer A","description":"","type":"buffer"}]}