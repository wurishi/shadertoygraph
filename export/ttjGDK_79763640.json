{"ver":"0.1","info":{"id":"ttjGDK","date":"1561210139","viewed":571,"name":"Escape tunnel","username":"kasari39","description":"using ifs and phantom mode","likes":21,"published":1,"flags":0,"usePreview":0,"tags":["raymarching","ifs","phantommode"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"precision highp float;\n\nmat2 rot(float a) {\n    float c = cos(a), s = sin(a);\n    return mat2(c,s,-s,c);\n}\n\nfloat box(vec3 p, vec3 b) {\n    vec3 d = abs(p) - b;\n    return length(max(d, 0.0));\n}\n\nfloat ifsBox(vec3 p) {\n    for(int i=0; i<6; i++) {\n        p = abs(p) - 1.0;\n        p.xz *= rot(0.7);\n        p.xy *= rot(0.8);\n    }\n    return box(p, vec3(0.0, 0.9, 0.2));\n}\n\nfloat map(vec3 p) {\n    float c = 8.0;\n\tp.z = mod(p.z, c) - c * 0.5;\n    return ifsBox(p);\n}\n\nvec3 hsv(float h, float s, float v) {\n\treturn ((clamp(abs(fract(h+vec3(0,2,1)/3.)*6.-3.)-1.,0.,1.)-1.)*s+1.)*v;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 p = (fragCoord.xy * 2.0 - iResolution.xy) / iResolution.y;\n\n    vec3 cPos = vec3(2.5*sin(0.4*iTime), 0.5*cos(1.3*iTime), -20.0*iTime);\n    vec3 cDir = vec3(0.0, 0.0, -1.0);\n    vec3 cUp  = vec3(0.0, 1.0, 0.0);\n    vec3 cSide = cross(cDir, cUp);\n\n    vec3 ray = normalize(cSide * p.x + cUp * p.y + cDir);\n\n    // Phantom Mode https://www.shadertoy.com/view/MtScWW by aiekick\n    float t = 0.0;\n    float acc = 0.0;\n    for (int i = 0; i < 199; i++){\n        vec3 pos = cPos + ray * t;\n        float dist = map(pos);\n\n    \tdist = max(abs(dist), 0.02);\n        float a = exp(-dist*3.0);\n        if (mod(pos.z-60.0*iTime, 50.0) < 8.0) {\n            a *= 5.0;\n        }\n    \tacc += a;\n\n    \tt += dist*0.5;\n        if (t > 100.0) break;\n    }\n\n    vec3 col = hsv(fract(0.06*iTime), 0.6, acc * 0.01);\n    fragColor = vec4(col, 1.0);\n}","name":"Image","description":"","type":"image"}]}