{"ver":"0.1","info":{"id":"XXXfDn","date":"1728233420","viewed":115,"name":"Le miracle des fleurs","username":"NinjaKoala","description":"Shadertoy port of \"Le miracle des fleurs\" 4k Linux intro by epoqe released at Deadline 2024.\nPouet: https://www.pouet.net/prod.php?which=98119\n","likes":16,"published":3,"flags":0,"usePreview":1,"tags":["2d","intro","demoscene","epoqe"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"/*\nFelt inspired to do some effect like this after working out a not too slow\nmethod for rendering parametric curves given by their derivative in:\nhttps://www.shadertoy.com/view/lXGXWK\n*/\n\nconst float i_event0=.0;\nconst float i_event1=i_event0+.8;\nconst float i_event2=i_event1+.6;\nconst float i_event3=i_event2+.7;\nconst float i_event4=i_event3+.9;\nconst float i_event5=i_event4+.5;\nconst float i_event6=i_event5+.2;\nconst float i_event7=i_event6+.3;\nconst float i_event8=i_event7+.5;\nconst float i_event9=i_event8+.5;\nconst float i_event10=i_event9+.5;\nconst float i_event11=i_event10+2.;\nconst float i_event12=i_event11+1.;\nconst float i_event13=i_event12+2.8;\nconst float i_event14=i_event13+6.4;\nconst float i_event15=i_event14+2.0;\nconst float i_event16=i_event15+2.3;\nconst float i_event17=i_event16+2.1;\nconst float i_event18=i_event17+1.6;\nconst float i_event19=i_event18+1.1;\nconst float i_event20=i_event19+.2;\nconst float i_event21=i_event20+.2;\nconst float i_event22=i_event21+.2;\nconst float i_event23=i_event22+.8;\nconst float i_event24=i_event23+1.2;\nconst float i_event25=i_event24+.1;\nconst float i_event26=i_event25+.3;\nconst float i_event27=i_event26+.3;\nconst float i_event28=i_event27+.3;\nconst float i_event29=i_event28+.3;\nconst float i_event30=i_event29+.3;\nconst float i_event31=i_event30+.3;\nconst float i_event32=i_event31+.3;\nconst float i_event33=i_event32+.3;\nconst float i_event34=i_event33+.3;\nconst float i_event35=i_event34+.3;\nconst float i_event36=i_event35+.3;\nconst float i_event37=i_event36+.3;\nconst float i_event38=i_event37+.3;\nconst float i_event39=i_event38+.3;\nconst float i_event40=i_event39+.3;\nconst float i_event41=i_event40+.3;\nconst float i_event42=i_event41+.3;\nconst float i_event43=i_event42+.3;\nconst float i_event44=i_event43+.3;\nconst float i_event45=i_event44+.3;\nconst float i_event46=i_event45+.3;\nconst float i_event47=i_event46+.3;\nconst float i_event48=i_event47+.7;\nconst float i_event49=i_event48+.5;\nconst float i_event50=i_event49+.5;\nconst float i_event51=i_event50+.5;\nconst float i_event52=i_event51+2.;\nconst float i_event53=i_event52+.5;\nconst float i_event54=i_event53+.5;\nconst float i_event55=i_event54+.5;\nconst float i_event56=i_event55+2.2;\nconst float i_event57=i_event56+.5;\nconst float i_event58=i_event57+.5;\nconst float i_event59=i_event58+.5;\nconst float i_event60=i_event59+2.;\nconst float i_event61=i_event60+.5;\nconst float i_event62=i_event61+.5;\nconst float i_event63=i_event62+.5;\nconst float i_event64=i_event63+.5;\nconst float i_event65=i_event64+.5;\nconst float i_event66=i_event65+1.6;\nconst float i_event67=i_event66+.6;\nconst float i_event68=i_event67+.6;\nconst float i_event69=i_event68+.6;\nconst float i_event70=i_event69+.6;\nconst float i_event71=i_event70+.6;\nconst float i_event72=i_event71+.8;\nconst float i_event73=i_event72+.9;\nconst float i_event74=i_event73+.6;\nconst float i_event75=i_event74+2.6;\nconst float i_event76=i_event75+.6;\n\n\nfloat eps = .002;\n\nfloat dt = .023;\n\nfloat tau = 6.28;\n\nfloat t0;\n\nvec3 parchment_col = vec3(.88,.82,.76);\nvec3 darker_parchment_col = vec3(.2,.1,.1);\nvec3 green = vec3(.3,.6,.4);\nvec3 red = vec3(.6,.15,.2);\n\nfloat hash2(vec2 v)\n{\n\tuint n = 1103515245u;\n\tuvec2 x = floatBitsToUint(v);\n\treturn 2.*(float(n * (((x = n * ((x >> 1) ^ x.yx)).y >> 3) ^ x.x)) / float(-1u))-1.;\n}\n\nmat2 rot(float deg){\n\treturn mat2(cos(deg),sin(deg),-sin(deg),cos(deg));\n}\n\nfloat fbm(vec2 x, int k)\n{\n\tfloat a, b, c, d;\n    float aa = 0.;\n    float bb = .5;\n    for (int i = 0; i < k; i++)\n    {\n\t\tvec2 p = floor(x);\n\t\tvec2 w = x-p;\n\t\tvec2 u = w*w*w*(w*(w*6.-15.)+10.);\n\n\t\ta = hash2(p);\n\t\tc = hash2(p+vec2(0,1));\n\t\tb = hash2(p+vec2(1,0));\n\t\td = hash2(p+vec2(1,1));\n\n        aa += bb*(2.*(a + (b-a)*u.x + (c-a)*u.y + (a - b - c + d)*u.x*u.y) - 1.);\n        bb *= .55;\n\t\tx *= 1.9*rot(.64);\n    }\n    \n\treturn aa;\n}\n\nfloat flower(vec2 p, vec2 mid, float t)\n{\n\tfloat r1 = hash2(mid);\n\tfloat r2 = hash2(mid.yx);\n\n\tp -= mid;\n\tp *= rot(r1);\n\n    float an = tau / (5.+floor(.5+r1));\n\tp *= rot(an*floor(.5+atan(p.y,p.x)/an));\n\n    p.y = abs(p.y);\n\n\tfloat val1=.01*(2.+r2);\n\tif(t == i_event75){\n\t\tval1 += .2;\n\t}\n\tfloat val2=(1.3+.1*r1)*val1;\n\tfloat val3=(1.6-.1*r2)*val1;\n\n\tval1 += smoothstep(-1.4,1.4,t0-t+1.4)-1.;\n\n\tfloat val4=.09;\n\tfloat val5=.002;\n\n    return abs(length(p-vec2(val1,-val2))-val3)-val4*length(p)-val5;\n}\n\nfloat random_spline(float t){\n\tfloat flt = floor(t);\n\tfloat cet = -floor(-t);\n\tfloat frt = t-flt;\n\n\tfloat mb = hash2(vec2(33.*cet));\n\tfloat ma = hash2(vec2(33.*flt));\n\tfloat a = hash2(vec2(flt));\n\tfloat b = hash2(vec2(cet));\n\n\tfloat c0=2.*a+ma-2.*b+mb;\n\tfloat c1=3.*b-mb-3.*a-2.*ma;\n\n\treturn frt * (frt * (frt * c0 + c1) + ma) + a;\n}\n\nfloat dir(float t, vec4 param){\n\tif(param.x == 0.){\n\t\treturn param.y+param.z*random_spline(param.w*t);\n\t}\n\n\treturn (exp(pow(param.y*t,param.z))-1.)*param.w+param.x;\n}\n\nvec2 i_diff(float t, vec4 param){\n\treturn rot(dir(t, param))[0];\n}\n\nfloat spiral_distance(vec2 uv, vec2 p0, float len, vec4 param, float offset, out float min_t, out vec2 tip){\n    float dis = 1.;\n\n\tfloat dt3 = len / floor(.5 + len / dt);\n\n\tmin_t = 0.;\n    \n    vec2 p = p0;\n    for(float t=offset;t<len+offset+eps;t+=dt3){\n        vec2 tang = i_diff(t+dt3*.5,param);\n        float tang2 = dot(tang,tang);\n\n        float dt4 = min(max(dot(tang,uv-p)/tang2,0.),dt3);\n        vec2 p2 = p + dt4 * i_diff(t+dt4*.5,param);\n        \n\t\tfloat cur_dis = length(uv-p2);\n\t\tif(cur_dis < dis){\n\t\t\tdis = cur_dis;\n\t\t\tmin_t = t+dt4;\n\t\t}\n        p += dt3 * tang;\n        dis = min(dis,length(uv-p2));\n    }\n\ttip = p;\n    \n    return dis;\n}\n\nfloat tendril(vec2 uv, vec2 p0, float len, vec4 param, float leaf_len, float offset, float offset2, out vec2 tip){\n\tfloat min_t;\n\n\tfloat dis = spiral_distance(uv,p0,len,param,offset,min_t,tip);\n\n\tfloat t = min_t-offset-len+leaf_len-dt;\n\tfloat d = leaf_len;\n\tfloat r = 3.*leaf_len;\n\n\tfloat x = -d + 2.*t;\n\n\tfloat leaf_thickness = sqrt(r*r-x*x)-sqrt(r*r-d*d);\n\n\tif(t<0. || t>d){\n\t\tleaf_thickness = 0.;\n\t}\n\n\treturn dis-.01*(len-min_t+offset+offset2+.1)-leaf_thickness;\n}\n\nfloat long_branch(vec2 uv, vec2 p0, float i_event, float extent, float leaf_dis, vec4 params){\n\tfloat dis = 1.;\n\tfloat len = min(extent, t0-i_event);\n\n\tvec2 p1 = p0;\n\tvec2 tip;\n\tfor(int i=0;i<-int(-extent/leaf_dis);i++){\n\t\tfloat bt1 = float(i)*leaf_dis;\n\t\tif(len > bt1){\n\t\t\tp0 = p1;\n\t\t\tdis = min(dis,tendril(uv,p0,min(leaf_dis,len-bt1),params,i == -int(-extent/leaf_dis)-1 ? smoothstep(.9*extent,extent,len)*.07 : 0.,bt1,max(0.,len-bt1-leaf_dis),p1));\n\t\t\tif(len - bt1 < 2.5){\n\t\t\t\tfloat min_t;\n\t\t\t\tfloat len2 = min(len-bt1,.15);\n\t\t\t\tdis = min(dis, tendril(uv,p0,len2,vec4(dir(bt1,params),5,1,(i%2)*2-1),smoothstep(.07,.15,len2)*.05,0.,0.,tip));\n\t\t\t}\n\t\t}\n\t\tif(len < bt1){\n\t\t\treturn dis;\n\t\t}\n\t}\n\n\treturn dis;\n}\n\nfloat flowers(vec2 uv, float x, float t, float dt, float dx, float n){\n\tfloat dis = 1.;\n\tfloat x1 = x;\n\n\tfor(int i=0;i<int(n);i++){\n\t\tdis = min(dis, flower(uv, vec2(x1,7.2+.3*hash2(vec2(x1))), float(i)*dt+t));\n\t\tx1+=dx;\n\t}\n\n\treturn dis;\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord){\n\n\tvec2 vuv = gl_FragCoord.xy/iResolution.xy;\n\n\tvec2 uv = gl_FragCoord.xy/iResolution.y;\n\tvec2 p0 = vec2(1.5,0);\n\tvec2 tip;\n\n\tvuv *= 1.-vuv.yx;\n    \n    float border = 1./iResolution.y;\n\n\tt0 = iTime;\n\tuv.x += .44*t0;\n\tif(t0 > i_event10){\n\t\tuv += (t0-i_event10)*vec2(.15,.62);\n\t}\n\tif(t0 > i_event13){\n\t\tuv += (t0-i_event13)*vec2(-.1,-.11);\n\t}\n\tif(t0 > i_event14){\n\t\tuv += (t0-i_event14)*vec2(.19,-.52);\n\t}\n\n    float dis = 1.;\n\tfloat len;\n\n\tif(t0 < i_event8){\n\t\tlen = min((t0-i_event0)*3.,1.3);\n\t\tdis = min(dis,tendril(uv,p0,len,vec4(1.5,1.5,1.5,1),0.,0.,0.,tip));\n\n\t\tlen = min((t0-i_event1)*3.,1.3);\n\t\tdis = min(dis,tendril(uv,p0,len,vec4(1.5,1.2,2.,-1),0.,0.,0.,tip));\n\n\t\tlen = min((t0-i_event2)*3.,1.3);\n\t\tdis = min(dis,tendril(uv,p0,len,vec4(1.5,1.03,2.5,1),0.,0.,0.,tip));\n\t}\n\n\tif(t0 < i_event11){\n\t\tp0 = vec2(2.5,0);\n\n\t\tlen = min((t0-i_event3)*3.,1.3);\n\t\tdis = min(dis,tendril(uv,p0,len,vec4(1.8,1.5,1.4,1),0.,0.,0.,tip));\n\n\t\tlen = min((t0-i_event4)*3.,1.3);\n\t\tdis = min(dis,tendril(uv,p0,len,vec4(1.8,1.2,1.8,-1),0.,0.,0.,tip));\n\t}\n\n\tif(t0 < i_event12){\n\t\tp0 = vec2(3,0);\n\t\tlen = min((t0-i_event5)*3.,1.3);\n\t\tdis = min(dis,tendril(uv,p0,len,vec4(1.2,1.8,1.3,-1),0.,0.,0.,tip));\n\n\t\tlen = min((t0-i_event6)*3.,1.3);\n\t\tdis = min(dis,tendril(uv,p0,len,vec4(1.2,1.,2.8,1),0.,0.,0.,tip));\n\n\t\tlen = min((t0-i_event7)*3.,1.3);\n\t\tdis = min(dis,tendril(uv,p0,len,vec4(1.2,1.1,2.5,-1),0.,0.,0.,tip));\n\t}\n\n\tif(t0 < i_event29){\n\t\tp0 = vec2(16.5,7.8);\n\t\tlen = min((t0-i_event19)*3.,1.3);\n\t\tdis = min(dis,tendril(uv,p0,len,vec4(-1.5,1.5,1.5,1),0.,0.,0.,tip));\n\n\t\tlen = min((t0-i_event20)*3.,1.3);\n\t\tdis = min(dis,tendril(uv,p0,len,vec4(-1.5,1.2,2.1,-1),0.,0.,0.,tip));\n\n\t\tp0 = vec2(17.1,6.7);\n\t\tlen = min((t0-i_event21)*3.,1.3);\n\t\tdis = min(dis,tendril(uv,p0,len,vec4(1.3,1.7,1.3,1),0.,0.,0.,tip));\n\n\t\tlen = min((t0-i_event22)*3.,1.3);\n\t\tdis = min(dis,tendril(uv,p0,len,vec4(1.3,1.1,2.6,-1),0.,0.,0.,tip));\n\t}\n\n\tp0 = vec2(23.9,6.6);\n\tlen = min((t0-i_event49)*3.,1.3);\n\tdis = min(dis,tendril(uv,p0,len,vec4(1.3,1.1,2.6,-1),0.,0.,0.,tip));\n\n\tlen = min((t0-i_event48)*3.,1.3);\n\tdis = min(dis,tendril(uv,p0,len,vec4(1.3,1.7,1.3,1),0.,0.,0.,tip));\n\n\tlen = min((t0-i_event51)*3.,1.3);\n\tdis = min(dis,tendril(uv,p0,len,vec4(1.3,1.2,1.8,1),0.,0.,0.,tip));\n\n\tlen = min((t0-i_event50)*3.,1.3);\n\tdis = min(dis,tendril(uv,p0,len,vec4(1.3,.9,4.2,1),0.,0.,0.,tip));\n\n\tp0 = vec2(26,7.7);\n\tlen = min((t0-i_event52)*3.,1.3);\n\tdis = min(dis,tendril(uv,p0,len,vec4(-1,1.2,1.8,-1),0.,0.,0.,tip));\n\n\tlen = min((t0-i_event53)*3.,1.3);\n\tdis = min(dis,tendril(uv,p0,len,vec4(-1,1.1,2.6,1),0.,0.,0.,tip));\n\n\tlen = min((t0-i_event54)*3.,1.3);\n\tdis = min(dis,tendril(uv,p0,len,vec4(-1,.9,4.2,-1),0.,0.,0.,tip));\n\n\tlen = min((t0-i_event55)*3.,1.3);\n\tdis = min(dis,tendril(uv,p0,len,vec4(-1,.8,5.3,1),0.,0.,0.,tip));\n\n\tp0 = vec2(31.3,7.7);\n\tlen = min((t0-i_event60)*3.,1.3);\n\tdis = min(dis,tendril(uv,p0,len,vec4(-2,1.2,1.8,-1),0.,0.,0.,tip));\n\n\tlen = min((t0-i_event62)*3.,1.3);\n\tdis = min(dis,tendril(uv,p0,len,vec4(-2,.9,4.2,-1),0.,0.,0.,tip));\n\n\tlen = min((t0-i_event63)*3.,1.3);\n\tdis = min(dis,tendril(uv,p0,len,vec4(-2,1.5,1.5,1),0.,0.,0.,tip));\n\n\tlen = min((t0-i_event61)*3.,1.3);\n\tdis = min(dis,tendril(uv,p0,len,vec4(-2,1,3.3,1),0.,0.,0.,tip));\n\n\tp0 = vec2(28.9,6.5);\n\tlen = min((t0-i_event56)*3.,1.3);\n\tdis = min(dis,tendril(uv,p0,len,vec4(2,1.2,1.8,1),0.,0.,0.,tip));\n\n\tlen = min((t0-i_event59)*3.,1.3);\n\tdis = min(dis,tendril(uv,p0,len,vec4(2,1.5,1.5,-1),0.,0.,0.,tip));\n\n\tlen = min((t0-i_event57)*3.,1.3);\n\tdis = min(dis,tendril(uv,p0,len,vec4(2,1,3.3,1),0.,0.,0.,tip));\n\n\tlen = min((t0-i_event58)*3.,1.3);\n\tdis = min(dis,tendril(uv,p0,len,vec4(2,.9,4.2,-1),0.,0.,0.,tip));\n\n\tif(t0 < i_event13) dis = min(dis, long_branch(uv,vec2(3.45,-.2),i_event9,5.,.5,vec4(0,.9,.9,2)));\n\tif(t0 < i_event14) dis = min(dis, long_branch(uv,vec2(5.83,4.2),i_event13,5.,.5,vec4(0,.6,.9,2.2)));\n\tif(t0 < i_event17) dis = min(dis, long_branch(uv,vec2(10.9,6.7),i_event15,2.5,.1,vec4(0,.4,1.3,2)));\n\tif(t0 < i_event18) dis = min(dis, long_branch(uv,vec2(12.9,7.9),i_event16,2.,.25,vec4(0,-.6,1.2,6)));\n\tif(t0 < i_event16) dis = min(dis, long_branch(uv,vec2(9,7.9),i_event14,2.5,.25,vec4(0,-.3,1.3,4)));\n\tif(t0 < i_event23) dis = min(dis, long_branch(uv,vec2(14.4,7.8),i_event17,2.5,.25,vec4(0,-.55,2,-5)));\n\n\tif(t0 < i_event44){\n\t\tdis = min(dis, long_branch(uv,vec2(17.5,6.7),i_event23,5.,.25,vec4(0,.4,2,-2)));\n\t\tdis = min(dis, long_branch(uv,vec2(18,7.8),i_event24,5.,.25,vec4(0,-.5,2,2)));\n\t}\n\n\tparchment_col += .03*fbm(uv*3., 5);\n\n\tfragColor.rgb = mix(green, parchment_col, smoothstep(-border,border,dis));\n\n\tdis = 1.;\n\tdis = min(dis, flower(uv, vec2(18,7), i_event25));\n\tdis = min(dis, flower(uv, vec2(18.2,6.8), i_event26));\n\tdis = min(dis, flower(uv, vec2(18.6,6.9), i_event27));\n\tdis = min(dis, flower(uv, vec2(18.4,7.5), i_event28));\n\tdis = min(dis, flower(uv, vec2(18.75,7.4), i_event29));\n\tdis = min(dis, flower(uv, vec2(19,7.35), i_event30));\n\tdis = min(dis, flower(uv, vec2(19.25,6.95), i_event31));\n\tdis = min(dis, flower(uv, vec2(19.6,7), i_event32));\n\tdis = min(dis, flower(uv, vec2(19.85,7.31), i_event33));\n\tdis = min(dis, flower(uv, vec2(20.25,7.45), i_event34));\n\tdis = min(dis, flower(uv, vec2(20.55,7.54), i_event35));\n\tdis = min(dis, flower(uv, vec2(19.9,7), i_event36));\n\tdis = min(dis, flower(uv, vec2(20.16,7.2), i_event37));\n\tdis = min(dis, flower(uv, vec2(20.3,6.9), i_event38));\n\tdis = min(dis, flower(uv, vec2(20.65,6.9), i_event39));\n\tdis = min(dis, flower(uv, vec2(20.7,7.2), i_event40));\n\n\tdis = min(dis, flowers(uv, 21., i_event41, .3, .3, 7.));\n\tdis = min(dis, flowers(uv, 33., i_event66, .6, .5, 10.));\n\n\tdis = min(dis, flower(uv, vec2(38.34,6.94), i_event75));\n\n\tfragColor.rgb = mix(red, fragColor.rgb, smoothstep(-border,border,dis));\n\tfragColor.rgb = mix(darker_parchment_col, fragColor.rgb, pow(vuv.x * vuv.y * 15.,.25));\n\tfragColor.rgb -= max(0.,t0-i_event76);\n}","name":"Image","description":"","type":"image"}]}