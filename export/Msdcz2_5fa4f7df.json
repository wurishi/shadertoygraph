{"ver":"0.1","info":{"id":"Msdcz2","date":"1519645660","viewed":229,"name":"Minimal Fluid Simulation","username":"OccamsLaser","description":"Golfed fluid sim\n\nyou need to restart the shader to start it...\n\ntakes the texture in iChannel0 of Buf D as the color of the fluid\n\ntakes the rb components of the texture in iChannel1 of Buf A as the motion of the fluid","likes":0,"published":1,"flags":32,"usePreview":0,"tags":["kernel","multipass"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4sXGR8","filepath":"/media/previz/buffer02.png","previewfilepath":"/media/previz/buffer02.png","type":"buffer","channel":2,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XdfGR8","filepath":"/media/previz/buffer03.png","previewfilepath":"/media/previz/buffer03.png","type":"buffer","channel":3,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void mainImage(out Q f, V p){f=texelFetch(D,I(2.*floor(p/2.)+V(1.)),0);}","name":"Image","description":"","type":"image"},{"inputs":[],"outputs":[],"code":"#define R iResolution.xy\n#define A iChannel0\n#define B iChannel1\n#define C iChannel2\n#define D iChannel3\n#define V vec2\n#define Q vec4\n#define I ivec2\n#define H sampler2D\n#define K(b) texelFetch(b,I(p),0)\n#define T(o) texelFetch(h,W(V(p+o),z),0)\n#define S(s) Q u=T(s*V(0.,2.));Q d=T(s*V(0.,-2.));Q l=T(s*V(-2.,0.));Q r=T(s*V(2.,0.));Q c=texelFetch(h,I(p),0);\n\nI W(V c, V r) {c.x=c.x<0.?c.x+r.x:(c.x>=r.x?c.x-r.x:c.x);c.y=c.y<0.?c.y+r.y:(c.y>=r.y?c.y-r.y:c.y);return I(c);}\n\nQ a(H s, H h, V p, V q, V z) {\n\tV u = K(s).xy; V b = p-V(0.5)-u;\n    p = b-q; V m = fract(p/2.); p = 2.*floor(p/2.)+q;\n    Q v = T(V(0.)); Q x = T(V(0.,2.)); Q w = T(V(2.,0.)); Q y = T(V(2.));  \n    return mix(mix(v,w,m.x),mix(x,y,m.x),m.y);\n}\n\nQ d(H h, V p, V z) { S(1.) return Q(c.xy,-2.*((r.x-l.x)+(u.y-d.y)),0.); }\nQ j(H h, V p, V z) { S(2.) return Q(c.xy,(u.z+d.z+l.z+r.z+c.z)/4.,0.); }\nQ g(H h, V p, V z) { S(1.) return c-Q(V(r.z-l.z,u.z-d.z)/2.,0.,0.); }","name":"Common","description":"","type":"common"},{"inputs":[{"id":"XdX3Rn","filepath":"/media/a/52d2a8f514c4fd2d9866587f4d7b2a5bfa1a11a0e772077d7682deb8b3b517e5.jpg","previewfilepath":"/media/ap/52d2a8f514c4fd2d9866587f4d7b2a5bfa1a11a0e772077d7682deb8b3b517e5.jpg","type":"texture","channel":1,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4sXGR8","filepath":"/media/previz/buffer02.png","previewfilepath":"/media/previz/buffer02.png","type":"buffer","channel":2,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XdfGR8","filepath":"/media/previz/buffer03.png","previewfilepath":"/media/previz/buffer03.png","type":"buffer","channel":3,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"void mainImage(out Q f, V p){f=I(p)%2==I(0)?(iFrame<1?a(B,B,p,V(0.),R):a(C,C,p,V(0.),R)):j(D,p+(int(p.x)%2<1?V(1.,-1.):V(-1.,0.)),R);}","name":"Buffer A","description":"","type":"buffer"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"XsXGR8","channel":0}],"code":"void mainImage(out Q f, V p){f=I(p.x)%2==I(0)?d(A,p,R):j(A,p,R);}","name":"Buffer B","description":"","type":"buffer"},{"inputs":[{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4sXGR8","channel":0}],"code":"void mainImage(out Q f, V p){f=int(p.x)%2==int(p.y)%2?(int(p.x)%2==0?Q(K(B).xy,K(B).z/4.,0.):g(B,p,R)):j(B,p,R);}","name":"Buffer C","description":"","type":"buffer"},{"inputs":[{"id":"4sfGRn","filepath":"/media/a/fb918796edc3d2221218db0811e240e72e340350008338b0c07a52bd353666a6.jpg","previewfilepath":"/media/ap/fb918796edc3d2221218db0811e240e72e340350008338b0c07a52bd353666a6.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4sXGR8","filepath":"/media/previz/buffer02.png","previewfilepath":"/media/previz/buffer02.png","type":"buffer","channel":2,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XdfGR8","filepath":"/media/previz/buffer03.png","previewfilepath":"/media/previz/buffer03.png","type":"buffer","channel":3,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"XdfGR8","channel":0}],"code":"void mainImage(out Q f, V p){f=(I(p)%2==I(1))?(iFrame<1?K(A):a(C,D,p,V(1.),R)):j(C,p,R);}","name":"Buffer D","description":"","type":"buffer"}]}