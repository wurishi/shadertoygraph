{"ver":"0.1","info":{"id":"flsXz7","date":"1625375837","viewed":365,"name":"2D perlin noise demo","username":"yunhai","description":"drag screen to resize","likes":9,"published":1,"flags":0,"usePreview":0,"tags":["noise"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define iR iResolution.xy\n#define PIXW (5.+iMouse.x/iR.x*10.)/iR.y\n#define SS(a,b,t) smoothstep(a,b,t)\nconst float PI=3.14159265;\nconst float ATR=PI/180.;\nvec2 randDir(vec2 id,float time)\n{\n    id+=vec2(3,181);\n    float t=time+PI*2.*fract(sin(83.*id.x)*(id.y)*(414.-id.y*5.));\n    return vec2(cos(t),sin(t));\n}\nmat2 getRot(float a){return mat2(cos(a),sin(a),-sin(a),cos(a));}\nfloat dVec(vec2 uv,vec2 dir)\n{\n    float t=clamp(dot(uv,dir)/dot(dir,dir),0.,1.);\n    t=SS(.02,.02-2.*PIXW,length(uv-dir*t));\n    float o=.8,ang=60.*ATR,ldir=length(dir);\n    vec2 op=dir*o;\n    vec2 r=dir/ldir,\n         l=getRot(ang)*r;r=getRot(-ang)*r;\n    float a=ldir*(1.01-o)*cos(ang)*1.4;\n    float tri=\n    min(min(SS(a,a-PIXW,dot(r,uv-op)),\n        SS(a,a-PIXW,dot(l,uv-op))),\n        SS(ldir*o,ldir*o+PIXW,dot(uv,dir/ldir)));\n    return max(t,tri);\n}\nfloat pnoise(vec2 uv)\n{\n    vec2 id=floor(uv);uv=fract(uv);\n    vec2 of=vec2(1,0);\n    float t=iTime;\n    float a=dot(uv-of.yy,randDir(id+of.yy,t)),\n          b=dot(uv-of.xy,randDir(id+of.xy,t)),\n          c=dot(uv-of.yx,randDir(id+of.yx,t)),\n          d=dot(uv-of.xx,randDir(id+of.xx,t));\n    uv=uv*uv*(vec2(3)-2.*uv);//f'(0)=f'(1)=0\n    a=mix(a,b,uv.x),b=mix(c,d,uv.x);      \n    return mix(a,b,uv.y)/1.4+.5;\n}\nfloat fbm(vec2 uv,int level)\n{\n    float res=0.;\n    if(level==1)\n        res=pnoise(uv);\n    else\n    {\n        res+=pnoise(uv);\n        res+=pnoise(uv*2.)*.5;\n        res+=pnoise(uv*4.)*.25;\n        res+=pnoise(uv*8.)*.125;\n        res*=.5;\n    }\n    return res;\n}\nvoid mainImage( out vec4 O, in vec2 C )\n{\n    vec2 uv= C*PIXW;\n    //draw gradient vec\n    vec2 cid=floor(uv+.5),cuv=(fract(uv+.5)-.5);\n    float t01=clamp(sin(iTime*.8)*1.+.5,0.,1.),\n          grad=min(1.,SS(.03,.025,length(cuv))+\n                      dVec(cuv,.48*randDir(cid,iTime)));\n    \n    float perlin=mix(fbm(uv,1),1.,grad*t01);\n    float fbm=fbm(uv,2);\n    \n    O.rgb=vec3(mix(perlin,fbm,step(.5,C.x/iR.x)));\n    \n}","name":"Image","description":"","type":"image"}]}