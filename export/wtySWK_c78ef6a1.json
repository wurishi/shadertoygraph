{"ver":"0.1","info":{"id":"wtySWK","date":"1583584822","viewed":184,"name":"Testing textureLod performance","username":"alint","description":"Testing texture and textureLod performance with large offsets due to the impact of cache misses.","likes":1,"published":1,"flags":0,"usePreview":0,"tags":["test","performance","texturelod"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dfGRn","filepath":"/media/a/8de3a3924cb95bd0e95a443fff0326c869f9d4979cd1d5b6e94e2a01f5be53e9.jpg","previewfilepath":"/media/ap/8de3a3924cb95bd0e95a443fff0326c869f9d4979cd1d5b6e94e2a01f5be53e9.jpg","type":"texture","channel":0,"sampler":{"filter":"nearest","wrap":"repeat","vflip":"false","srgb":"false","internal":"byte"},"published":1},{"id":"XdX3Rn","filepath":"/media/a/52d2a8f514c4fd2d9866587f4d7b2a5bfa1a11a0e772077d7682deb8b3b517e5.jpg","previewfilepath":"/media/ap/52d2a8f514c4fd2d9866587f4d7b2a5bfa1a11a0e772077d7682deb8b3b517e5.jpg","type":"texture","channel":2,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"false","srgb":"false","internal":"byte"},"published":1},{"id":"4dX3Rn","filepath":"/media/a/bd6464771e47eed832c5eb2cd85cdc0bfc697786b903bfd30f890f9d4fc36657.jpg","previewfilepath":"/media/ap/bd6464771e47eed832c5eb2cd85cdc0bfc697786b903bfd30f890f9d4fc36657.jpg","type":"texture","channel":1,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"false","srgb":"false","internal":"byte"},"published":1},{"id":"4dXGzr","filepath":"/media/a/08b42b43ae9d3c0605da11d0eac86618ea888e62cdd9518ee8b9097488b31560.png","previewfilepath":"/media/ap/08b42b43ae9d3c0605da11d0eac86618ea888e62cdd9518ee8b9097488b31560.png","type":"texture","channel":3,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"false","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\n#define TEXTURE_ACCESS 0\n#define TEST_MODE 0\n\n// 512 resolution, nearest filtering, 1 texel step\n#define TEST_512_NEAREST 0\n// 512 resolution, mimap filtering, 1 texel step\n#define TEST_512_MIPMAP 1\n// 1024 resolution, 3 channels, mimap filtering, 1 texel step\n#define TEST_1024_3_MIPMAP 2\n// 1024 resolution, 4 channels, mimap filtering, 1 texel step\n#define TEST_1024_4_MIPMAP 3\n// 1024 resolution, 4 channels, mimap filtering, 32 texels step\n#define TEST_1024_4_MIPMAP_32 4\n\n#if TEST_MODE == TEST_512_NEAREST\n#define iTestChannel iChannel0\n#define texelSize (1.0 / 512.0)\n#elif TEST_MODE == TEST_512_MIPMAP\n#define iTestChannel iChannel1\n#define texelSize (1.0 / 512.0)\n#elif TEST_MODE == TEST_1024_3_MIPMAP\n#define iTestChannel iChannel2\n#define texelSize (1.0 / 1024.0)\n#elif TEST_MODE == TEST_1024_4_MIPMAP\n#define iTestChannel iChannel3\n#define texelSize (1.0 / 1024.0)\n#elif TEST_MODE == TEST_1024_4_MIPMAP_32\n#define iTestChannel iChannel3\n// 32 texel step\n#define texelSize (32.0 / 1024.0)\n#endif\n\n#define COUNT (32 * 512)\n\n//              \t\t\t  \t  GTX 2080   iPHONE 7 \n//      \t\t\t\t\t\t  32 x 512   8 x 512 samples\n//             \t\t\t\t      ------    --------\n// texture    - 512 nearest :      49 fps    24 fps\n// textureLod - 512 nearest : \t   49 fps    23 fps\n// texture    - 512 mipmap :       26 fps    11 fps\n// textureLod - 512 mipmap : \t   48 fps    20 fps\n// texture    - 3x1024 mipmap :    27 fps    11 fps\n// textureLod - 3x1024 mipmap :    46 fps    10 fps\n// texture    - 4x1024 mipmap :    27 fps    11 fps\n// textureLod - 4x1024 mipmap :    46 fps    10 fps\n// texture    - 4x1024x32 mipmap : 19 fps    3.9 fps\n// textureLod - 4x1024x32 mipmap : 14 fps    1.5 fps\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 uv = fragCoord.xy / iResolution.xy;\n\t\n    vec4 col = vec4(0.0);\n    for(int i = 0; i < COUNT; i++)\n    {\n        float offset = float(i) * texelSize;\n#if TEXTURE_ACCESS == 0\n    \tcol += texture(iTestChannel, vec2(uv.x - offset, uv.y + offset));\n#else\n        col += textureLod(iTestChannel, vec2(uv.x - offset, uv.y + offset), 0.0);\n#endif\n    }\n\tcol /= float(COUNT);\n\t\n    fragColor = col;\n}","name":"Image","description":"","type":"image"}]}