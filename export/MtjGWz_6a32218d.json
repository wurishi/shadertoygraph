{"ver":"0.1","info":{"id":"MtjGWz","date":"1428296403","viewed":169,"name":"spheres with oscillating spec","username":"ballzac","description":"No idea how much of what I've done here is how it would 'normally' be done.\n\nEach sphere is just drawn on top of the previously drawn sphere. I will need to work out how to do occlusion properly to be able to, say, get two spheres to orbit each other.","likes":0,"published":1,"flags":0,"usePreview":0,"tags":["sphere","specular","diffuse"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[],"code":"#define PI 3.14159264359\n\n\nfloat mag ( vec3 v )\n{\n return  sqrt(dot(v,v));   \n}\n\nvec3 sphere( vec3 c, float r, vec3 obs, vec3 Lpos, vec2 uv, vec3 diffuse_col,vec3 spec_col,vec3 I )\n{\n    \n    if((uv.x-c.x)*(uv.x-c.x)+(uv.y-c.y)*(uv.y-c.y) < r*r) {\n             \n            vec3 s = vec3(uv,c.z-sqrt(r*r-(uv.x-c.x)*(uv.x-c.x)-(uv.y-c.y)*(uv.y-c.y)));//surface point\n            float test = dot(s-obs,s-c);\n            float t1 = acos(dot(obs-s,s-c)/(mag(s-obs)*mag(s-c)));\n            float t2 = acos(dot(Lpos-s,s-c)/(mag(Lpos-s)*mag(s-c))); \n\n            vec2 diffspec = vec2(0.,0.);\n\n            {\n             diffspec.x += abs(t1-t2)/(PI);//diffuse\n             diffspec.y += diffspec.x*diffspec.x*diffspec.x*diffspec.x*1.;//specular\n                diffspec/=2.;\n\n            }\n\n            vec3 colour = diffuse_col*diffspec.x+spec_col*diffspec.y;\n            return abs(colour);\n    }else{\n        return I;\n    }\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    float time = iTime;\n\tvec2 uv = (fragCoord.xy / iResolution.x - vec2(0.5,0.5))*2.0;\n    \n    \n    \n    vec3 obs = vec3(uv.x,uv.y,2.);\n    vec3 Lpos = vec3(5.,1.,-10.);//light position\n    vec3 Lcol = vec3(1.*sin(time)*sin(time),1.*sin(time*1.235)*sin(time*1.235),1.*sin(time*5.));\n    \n    vec3 c;\n    float r;\n    vec3 I =vec3(0.,0.,0.);\n    \n    r = 0.4*sin(time*0.25)*sin(time*0.25)+0.1;\n    c = vec3(-0.5+0.5*cos(time/4.2)*cos(time/4.2),-0.3*sin(time*1.2),-r*10.);\n    I=  sphere( c, r, obs, Lpos, uv, vec3(0.,1.,1.),Lcol, I ) ;\n    \n    r = 0.2*sin(time/4.)*sin(time/4.)+0.02;\n    c = vec3(0.5*sin(time*0.47),-0.5*cos(time*1.2),-r*10.);\n    I=  sphere( c, r, obs, Lpos, uv, vec3(1.,0.,1.),Lcol, I ) ;\n    \n    r = 0.05*sin(time)*sin(time)+0.05;\n    c = vec3(0.6+0.1*cos(time/2.),-0.5+1.*sin(time/1.3),-r*10.);\n    I=  sphere( c, r, obs, Lpos, uv, vec3(1.,1.,0.),Lcol, I ) ;\n    \n    r = 0.06*cos(time*0.9)*cos(time*0.9)+0.045;\n    c = vec3(-1.1+1.2*mod(time,4.)/2.,-0.7,-r*10.);\n    I=  sphere( c, r, obs, Lpos, uv, vec3(1.,1.,1.),Lcol, I ) ;\n    \n    r = 0.06*cos(time*0.9)*cos(time*0.9)+0.045;\n    c = vec3(-1.1+1.2*mod(time,4.)/2.,0.,-r*10.);\n    I=  sphere( c, r, obs, Lpos, uv, vec3(1.,1.,1.),Lcol, I ) ;\n    \n    r = 0.3*sin(time*0.3)*sin(time*0.3)+0.1;\n    c = vec3(-0.6+0.6*cos(time/3.)*cos(time/3.),-0.3,-r*10.);\n    I=  sphere( c, r, obs, Lpos, uv, vec3(0.,1.,0.),Lcol, I ) ;\n    \n    r = 0.01*sin(time)*sin(time)+0.01;\n    c = vec3(0.6+0.2*cos(time/1.1),0.5+1.*sin(time/1.7),-r*10.);\n    I=  sphere( c, r, obs, Lpos, uv, vec3(1.,0.,0.),Lcol, I ) ;\n    \n    r = 0.02*sin(time*0.8)*sin(time*0.8)+0.02;\n    c = vec3(0.2+0.1*cos(time/1.4),0.3+0.9*sin(time/1.3),-r*10.);\n    I=  sphere( c, r, obs, Lpos, uv, vec3(1.,0.,0.),Lcol, I ) ;\n    \n    r = 0.04*cos(time*0.8)*cos(time*0.8)+0.03;\n    c = vec3(0.2+0.1*sin(time/1.4),0.3+0.9*cos(time/1.3),-r*10.);\n    I=  sphere( c, r, obs, Lpos, uv, vec3(0.3,0.4,0.7),Lcol, I ) ;\n    \n    r = 0.04*cos(time*0.8)*cos(time*0.8)+0.03;\n    c = vec3(-1.1+1.2*mod(time,2.),-0.5,-r*10.);\n    I=  sphere( c, r, obs, Lpos, uv, vec3(1.,1.,1.),Lcol, I ) ;\n    \n    \n    \n    \n    \n    r = 0.3*sin(time*0.15)*sin(time*0.15)+0.15;\n    c = vec3(-0.4+0.6*cos(time/4.1)*cos(time/4.1),-0.25*sin(time*1.1),-r*10.);\n    I=  sphere( c, r, obs, Lpos, uv, vec3(1.,0.2,1.),Lcol, I ) ;\n    \n    r = 0.22*sin(time/3.1)*sin(time/3.1)+0.022;\n    c = vec3(0.4*sin(time*0.44),-0.3*cos(time*1.1),-r*10.);\n    I=  sphere( c, r, obs, Lpos, uv, vec3(1.,0.,1.),Lcol, I ) ;\n    \n    r = 0.05*sin(time)*sin(time)+0.05;\n    c = vec3(0.3+0.2*cos(time/1.05),-0.35+1.6*sin(time/1.1),-r*10.);\n    I=  sphere( c, r, obs, Lpos, uv, vec3(1.,1.,0.),Lcol, I ) ;\n    \n    r = 0.06*cos(time*0.9)*cos(time*0.9)+0.045;\n    c = vec3(1.1-1.2*mod(time,4.)/2.,-0.9 ,-r*10.);\n    I=  sphere( c, r, obs, Lpos, uv, vec3(1.,1.,1.),Lcol, I ) ;\n    \n    r = 0.06*cos(time*0.9)*cos(time*0.9)+0.045;\n    c = vec3(1.1-1.2*mod(time,4.)/2.,-0.1,-r*10.);\n    I=  sphere( c, r, obs, Lpos, uv, vec3(1.,1.,1.),Lcol, I ) ;\n    \n    r = 0.35*sin(time*0.34)*sin(time*0.34)+0.1;\n    c = vec3(-0.7+0.5*cos(time/3.2)*cos(time/3.2),-0.2,-r*10.);\n    I=  sphere( c, r, obs, Lpos, uv, vec3(0.,1.,0.),Lcol, I ) ;\n    \n    r = 0.1*sin(time)*sin(time)+0.005;\n    c = vec3(0.4+0.3*cos(time/0.85),0.2+1.25*sin(time/1.2),-r*10.);\n    I=  sphere( c, r, obs, Lpos, uv, vec3(1.,0.,0.),Lcol, I ) ;\n    \n    r = 0.02*sin(time*0.97)*sin(time*0.97)+0.02;\n    c = vec3(0.3+0.15*cos(time/1.278),0.257+0.98*sin(time/1.1258),-r*10.);\n    I=  sphere( c, r, obs, Lpos, uv, vec3(1.,0.,0.),Lcol, I ) ;\n    \n    r = 0.03*cos(time*0.2)*cos(time*0.2)+0.04;\n    c = vec3(0.1+0.1*sin(time/1.4),-0.1*cos(time/1.3),-r*10.);\n    I=  sphere( c, r, obs, Lpos, uv, vec3(0.3,0.4,0.7),Lcol, I ) ;\n    \n    r = 0.04*cos(time*0.8)*cos(time*0.8)+0.03;\n    c = vec3(1.1-1.2*mod(time,2.),-0.8,-r*10.);\n    I=  sphere( c, r, obs, Lpos, uv, vec3(1.,1.,1.),Lcol, I ) ;\n    \n\tfragColor = vec4(I,1.);\n}","name":"","description":"","type":"image"}]}