{"ver":"0.1","info":{"id":"XsjcR3","date":"1493134860","viewed":178,"name":"Layered Worley noise","username":"cexcell","description":"simple layered worley noise","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["noise","worley"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// Determines how many cells there are\n#define NUM_CELLS 16.0\n\n// Arbitrary random, can be replaced with a function of your choice\nfloat rand(vec2 co){\n    return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\n// Returns the point in a given cell\nvec2 get_cell_point(ivec2 cell) {\n\tvec2 cell_base = vec2(cell) / NUM_CELLS;\n\tfloat noise_x = rand(vec2(cell));\n    float noise_y = rand(vec2(cell.yx));\n    return cell_base + (0.5 + 1.5 * vec2(noise_x, noise_y)) / NUM_CELLS;\n}\n\n// Performs worley noise by checking all adjacent cells\n// and comparing the distance to their points\nfloat worley(vec2 coord) {\n    ivec2 cell = ivec2(coord * NUM_CELLS);\n    float dist = 1.0;\n    \n    int num = 5;\n    int delta = num / 2;\n    \n    // Search in the surrounding 5x5 cell block\n    for (int x = 0; x < num; x++) { \n        for (int y = 0; y < num; y++) {\n        \tvec2 cell_point = get_cell_point(cell + ivec2(x-delta, y-delta));\n            dist = min(dist, distance(cell_point, coord));\n        }\n    }\n    \n    dist /= length(vec2(0.95 / NUM_CELLS));\n    dist = sqrt(1.0 - dist * dist);\n    dist *= dist * dist * dist * dist;\n    return dist;\n}\n\nfloat layered_worley(vec2 uv, int octaves) {\n    float worley1 = worley(uv);\n    uv *= 2.0;\n    \n    float blend = 0.25;\n    float res = worley1;\n    \n    for (int i = 0; i < octaves - 1; ++i)\n    {\n        res = res * (1.0 - blend) + 1.2 * blend * res * worley(uv);\n        uv *= 2.0;\n    }\n    \n    return res * 0.5;\n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 uv = fragCoord.xy / iResolution.xy;\n    uv.y *= iResolution.y / iResolution.x;\n    \n    float noise = layered_worley(uv, 3);\n\tfragColor = vec4(vec3(noise), 1.0);\n}","name":"Image","description":"","type":"image"}]}