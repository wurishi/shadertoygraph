{"ver":"0.1","info":{"id":"llByRw","date":"1508715797","viewed":263,"name":"The shining (ghosts trainees)","username":"Ping2_0","description":"ghost animation","likes":18,"published":1,"flags":32,"usePreview":0,"tags":["2d","pacman","animation","ghost","glslbug"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"/****\n * The Shining - Ghosts trainees\n * Ping2.0\n */\n\nstruct gData {\n\tfloat time;\n\tfloat drape;\n\tfloat blur;\n\tint style;\n\tvec2 pos;\n\tfloat invscale;\n\tfloat visible;\n\tvec3 color;\t\n\tvec4 glow;\n\tvec4 eyesDir;\n};\n\nstruct sData {\n\tgData[4] ghosts;\n\tvec4 diskMask; // radius, x, y\n\tvec2 shine;\n};\n\nsData sceneData;\n\n\n/* **\n * distances\n * https://iquilezles.org/articles/distfunctions\n */\n// union\nfloat opU( const float a, const float b ) {\n\treturn min(a, b);\n}\n// blended union: polynomial smooth min (k = 0.1);\nfloat poly_smin( float a, float b, float k ) {\n\tfloat h = clamp( 0.5+0.5*(b-a)/k, 0.0, 1.0 );\n\treturn mix( b, a, h ) - k*h*(1.0-h);\n}\nfloat sdEllipse( in vec2 p, in vec2 r ) {\n\treturn (length( p/r ) - 1.0) * min(r.x,r.y);\n}\nfloat sdCircle( vec2 p, float s ) {\n\treturn length(p)-s;\n}\nfloat sdBox( vec2 p, vec2 b ) {\n\tvec2 d = abs(p) - b;\n\treturn min(max(d.x,d.y),0.0) + length(max(d,0.0));\n}\nfloat udRoundBox( vec2 p, vec2 b, float r ) {return length(max(abs(p)-b,0.0))-r;}\nvec2 hash2( float n ) {\n\treturn fract(sin(vec2(n,n+1.0))*vec2(43758.5453123,22578.1459123));\n}\n/* **\n * other functions\n */\n// alpha for transparency\nfloat alp(float d, float blur) {\n\treturn smoothstep(blur, -blur, d);\n}\n// smoothstep alternative\nfloat linestep(float a, float b, float v) {\n\treturn (clamp(v, a, b)-a)/(b-a);\n}\n\n// shine shape\nfloat reflection(vec2 uv) {\n\tfloat d = sdEllipse(uv*vec2(1.0,1.-uv.x*1.)-vec2(-0.06, 0.29), vec2(0.1, 0.075));\n\tfloat de = sdEllipse(uv-vec2(-0.16, 0.), vec2(0.06, 0.28));\n\td = poly_smin(d, de, 0.1);\n\treturn d;\n}\n\nvec3 eye(const vec2 st, vec4 pei, vec3 currentColor, const float blur, const int style, bool left) {\n\tvec3 eyeColor = vec3(1);\n\tvec3 irisColor = vec3(0.,0.226,0.435);\n\n\t//bool happy = mod(iTime, 5.)>4.5;\n\tfloat dt =  sdEllipse(st-pei.xy, vec2(0.066,0.09));\n\tcurrentColor = mix(currentColor, eyeColor, alp(dt, 0.002*blur));\n\t// iris\n\tif(style==1) { // happy\n\t\t//float is = mod((-st.x+pei.z)*0.5, 0.05);\n\t\tfloat is = (st.x-pei.z)*0.5;\n\t\tdt = udRoundBox(vec2(0., is>0.0?is:-is)+st-pei.zw, vec2(0.025,0.005),0.008);\n\t} else if(style==2) { //\n\t\tpei.zw+=hash2(iTime)*0.01;\n\t\tfloat is = (st.x-pei.z)*0.45; // mod((0.07+st.x-pei.z)*0.5, 0.05);\n\t\tdt = udRoundBox(vec2(0., left?-is:is)+st-pei.zw, vec2(0.025,0.005),0.002);\n\t\t//dt = udRoundBox(st-pei.zw, vec2(0.025,0.001),0.003);\n\t} else if(style==3) { // sleep ...\n\t\t//float is = mod((0.05-st.x+pei.z)*0.5, 0.05);\n\t\tfloat is = (st.x-pei.z)*0.5;\n\t\tdt = udRoundBox(vec2(0., is>0.?-is+0.02:is+0.02)+st-pei.zw, vec2(0.025,0.005),0.008);\n\t} else {\n\t\tdt = udRoundBox(st-pei.zw, vec2(0.005,0.008),0.022);\n\t}\n\tcurrentColor = mix(currentColor, irisColor, alp(dt, 0.002*blur));\n\n\treturn currentColor;\n}\n\n//vec3 ghost2(const vec2 st, const vec3 bodyColor, vec3 currentColor, const vec4 eyesDir, const float time, const vec4 glow, const float drape, const int style, const float blur) {\nvoid ghost2(vec2 uv, inout vec3 currentColor, const gData g) {// const vec2 st, const vec3 bodyColor, vec3 currentColor, const vec4 eyesDir, const float time, const vec4 glow, const float drape, const int style, const float blur) {\n\tvec2 st = (uv-g.pos)*g.invscale;\n\tbool glowEnabled = g.glow.a>=0.;\n\tfloat mblur = 0.01*g.blur;\n\tif((abs(st.x)>(0.3+mblur) || abs(st.y)>(0.35+mblur)) && !glowEnabled) {\n\t\treturn; // currentColor;\n\t}\n\t// BODY\n\tvec2 stBody = st;\n\t// ... bottom waves\n\tfloat boty = stBody.y<-0.1 ? sin(g.time*3.480+stBody.x*17.320)*cos(g.time*5.848+stBody.x*10.448)*0.048 : 0./*0.05*/;\n\t// ... sides waves\n\tstBody.x +=4.*(stBody.x)*(-0.060*(stBody.y-0.44)*(+sin(g.time*2.+(stBody.y*5.936))));\n\t// ... top : head\n\tfloat dt = sdEllipse(stBody-vec2(0.000,0.10), vec2(0.220,0.232));\n\t// ... bottom : body\n\tfloat db = sdBox(stBody-vec2(0.,boty-0.09), vec2(0.220,0.200));\n\tfloat dBody = opU(dt,db);\n\tif(glowEnabled)\n\t\tcurrentColor = mix(currentColor, g.glow.rgb, alp(dBody, g.glow.a));\n\n\t// SHINE\n\tfloat d= reflection(stBody);\n\tfloat highlight = smoothstep(sceneData.shine.x, sceneData.shine.y, d); // smoothstep(0.003, -0.1, d); // smo\n\tvec3 speColor = mix(g.color, vec3(1), highlight);\n\n\t// DRAPE\n\tif(g.drape>0.) {\n\t\tdb = max(db, -sdCircle(stBody-vec2(0.,0.38), 0.35));\n\t\tif(db<0.) {\n\t\t\t// v3 sin + double mix\n\t\t\tfloat drapeVal = sin(stBody.x*32.+g.time*9.4); //-0.5;\n\t\t\tdrapeVal*=smoothstep(0.1, -0.5, stBody.y)*g.drape; // vertical smooth\n\t\t\tspeColor = mix(mix(speColor*0.9, speColor, linestep(-1., 0., drapeVal)), clamp(speColor*2.+vec3(0.25), 0., 1.), linestep(0., 1.5, drapeVal)); // double mix\n\t\t}\n\t}\n\tcurrentColor = mix(currentColor, speColor, alp(dBody, 0.0075*g.blur));\n\n\t// EYES\n\tvec3 eyeColor = vec3(1);\n\tvec3 irisColor = vec3(0.,0.226,0.435);\n\t// ... eyes offset\n\tfloat mye = +sin(g.time*5.)*0.0025;\n\n\tvec4 pei = vec4(0.03*g.eyesDir.x-0.08, 0.03*g.eyesDir.y+0.14+mye, -0.075+0.065*g.eyesDir.z, 0.14-mye*0.5+0.095*g.eyesDir.w);\n\tcurrentColor = eye(st, pei, currentColor, g.blur, g.style, false);\n\tpei.x+=0.178; pei.z+=0.173;\n\tcurrentColor = eye(st, pei, currentColor, g.blur, g.style, true);\n}\n\nivec2 id(int i) {\n\tint r = int(floor(iResolution.x));\n\t//return ivec2(mod(i, r), i / r);\n    return ivec2(i%r, i / r);\n}\nvec4 loadid(int i) {\n\treturn texelFetch(iChannel0, id(i), 0);\n}\n\nvoid loadGhost(int startid, out gData g) {\n\tvec4 v = loadid(startid);\n\tg.time  = v.x;\n\tg.drape = v.y;\n\tg.blur  = v.z;\n\tg.style = int(v.w);\n\n\tv = loadid(startid+1);\n\tg.pos      = v.xy;\n\tg.invscale = v.z;\n\tg.visible  = v.w;\n\n\tv = loadid(startid+2);\n\tg.color = v.xyz;\n\n\tv = loadid(startid+3);\n\tg.glow = v;\n\n\tv = loadid(startid+4);\n\tg.eyesDir = v;\n}\n\nvoid loadData(out sData s) {\n\tloadGhost(0, s.ghosts[0]);\n\tloadGhost(5, s.ghosts[1]);\n\tloadGhost(10, s.ghosts[2]);\n\tloadGhost(15, s.ghosts[3]);\n\tvec4 v= loadid(20);\n\ts.diskMask = v;\n\tv= loadid(21);\n\ts.shine = v.xy;\n}\n\nvoid ghost(const gData g, const vec2 uv, inout vec3 color) {\n\tif(g.visible>0.)\n\t\tghost2(uv, color, g);\n     \t// color = ghost2((uv-g.pos)*g.invscale, g.color, color, g.eyesDir, g.time, g.glow, g.drape, g.style, g.blur);\n}\n\nvoid ghosts(const vec2 uv, inout vec3 color) {\n\tghost(sceneData.ghosts[0], uv, color);\n\tghost(sceneData.ghosts[1], uv, color);\n\tghost(sceneData.ghosts[2], uv, color);\n\tghost(sceneData.ghosts[3], uv, color);\n}\n\nvoid back(in vec2 u, inout vec3 c) {\n\tfloat dgb = sceneData.ghosts[1].blur;\n\tu.y+=0.1;\n\tvec2 t = fract(u*(1.5+dgb*.25))/**(2.+u.y)*/;\n\tfloat di=(abs(u.y+0.42*dgb))*0.05;\n\tfloat b= 0.01+di/*+0.01*sceneData.ghosts[1].blur*/;\n\tfloat d;\n\n\tvec3 c0 = vec3(.042,0.530,0.159);\n\tvec3 c1 = vec3(.142,0.630,0.259);\n\tvec3 c2 = vec3(0.242,0.730, 0.359);\n\tvec3 c3 = vec3(0.342,0.830,0.459);\n\tvec3 c4 = vec3(0.442,0.930,0.559);\n\n\tfloat vlim = -(dgb-1.2)*0.04;\n\n\t// sky\n\tif(u.y>(0.3+vlim)) {\n\t\td = length(u-vec2(-0.75,0.5)); // -0.5;\n//\t   \tc = mix(vec3(0.5,0.5,0.8), vec3(0.,0.9,1), smoothstep(5., 0., d));\n\t   \tc = mix(vec3(.4,0.4,.8), vec3(0.5,0.7,0.8), smoothstep(5., 0., d));\n\n\t}\n\n\tif(u.y<(0.3+vlim)) {\n\t\td= length(t-vec2(0.5,+0.5))-1.;\n\t\tc=mix(c, c0, smoothstep(b, -b, d));\n\t}\n\n\tif(u.y<0.3+vlim) {\n\t\td= min(length(t-vec2(1.,+0.25))-0.8, length(t-vec2(-0.,+0.25))-0.8);\n\t\tc=mix(c, c1, smoothstep(b, -b, d));\n\t}\n\tif(u.y<0.5+vlim) {\n\t\td= length(t-vec2(0.5,+0.25))-0.6;\n\t\tc=mix(c, c2, smoothstep(b, -b, d));\n\t}\n\tif(u.y<0.4+vlim) {\n\t\td = min(length(t)-0.6, length(t-vec2(1.,0))-0.6);\n\t\tc=mix(c, c3, smoothstep(b, -b, d));\n\t}\n\tif(u.y<0.3) {\n\t\td = length(t-vec2(0.5,0))-0.4;\n\t\tc=mix(c, c4, smoothstep(b, -b, d));\n\t}\n\n\tif(u.y<0.2) {\n\t\td= length(t-vec2(0.5,-0.9))-1.;\n\t\tc=mix(c, c0, smoothstep(b, -b, d));\n\t}\n\tif(u.y<0.2) {\n\t\td= min(length(t-vec2(1.,-0.75))-0.8, length(t-vec2(-0.,-0.75))-0.8);\n\t\tc=mix(c, c1, smoothstep(b, -b, d));\n\t}\n\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // uv  [-1, 1]\n\tvec2 uv = (fragCoord.xy/iResolution.xy)*2.-1.;\n\t// aspect ratio \n\tuv.x *= iResolution.x/iResolution.y;\n\tloadData(sceneData);\n    \n    vec3 color;\n    if(sceneData.diskMask.x==0.)\n    \tcolor = vec3(0);\n    else {\n\t\tback(uv, color);\n\t\tghosts(uv, color);\n\t\tif(sceneData.diskMask.x>0.)\n\t\t\tcolor = mix(color, vec3(0.0), alp(sdCircle(uv-sceneData.diskMask.yz, sceneData.diskMask.x), -0.03));\n    }\n\tfragColor = vec4(color, 1.0);\n}\n","name":"Image","description":"","type":"image"},{"inputs":[],"outputs":[{"id":"4dXGR8","channel":0}],"code":"/****\n * The Shining - Ghosts trainees\n * Ping2.0\n */\nconst vec4 noglow = vec4(0.,0.,0., -1.);\nconst vec4 blueGlow = vec4(1., 1.5, 2., 0.15);\nconst vec4 whiteBGlow = vec4(5,5,5,0.02);\nconst vec4 btBGlow1 = vec4(1,-3, 10,0.05);\nconst vec4 btBGlow2 = vec4(5,-5,5,0.1);\n//const vec4 btBGlow3 = vec4(-5,-5,-5,0.025);\nconst vec4 nothing = vec4(0);\n\n// specular mode [0, 7]\n#define SPECULAR_MODE 2\n// specular modes\nconst vec2 mats[] = vec2[] (\n\t\tvec2(-0.020,-0.070),  // latex\n\t\tvec2(-0.03, -0.09),   // plastic\n\t\tvec2( 0.003,-0.1), \t  // gum\n\t\tvec2( 0.030,-0.070),  // high\n\t\tvec2( 0.010,-0.130),  // light\n\t\tvec2( 0.040,-0.150),  // natural\n\t\tvec2( 0.050,-0.180),  // ultra soft\n\t\tvec2(0.130,-0.090)    // big light\n);\nvec2 hash2( float n ) {\n\treturn fract(sin(vec2(n,n+1.0))*vec2(43758.5453123,22578.1459123));\n}\n\n// local time\nfloat lTime;\n#define T(t, v) lTime<t ? v :\n#define V24(a, b) vec4(a, b, a, b)\n\nfloat sval(float start, float end, float mn, float mx) {\n\treturn mn+smoothstep(start, end, lTime)*(mx-mn);\n}\nvec2 sval(float start, float end, vec2 mn, vec2 mx) {\n\treturn vec2(sval(start, end, mn.x, mx.x), sval(start, end, mn.y, mx.y));\n}\nvec4 sval4(float start, float end, vec2 mn, vec2 mx) {\n\tvec4 v4;\n\tv4.xy  = v4.zw = vec2(sval(start, end, mn.x, mx.x), sval(start, end, mn.y, mx.y));\n\treturn v4;\n}\n\nvec4 yes(const float time) {\n\tvec4 eyesdir = vec4(0);\n\tfloat v = sin(time)*0.6;\n\teyesdir.y  = v;\n\teyesdir.w  = v/3.;\n\treturn eyesdir;\n}\n\nvec4 no(const float time) {\n\tvec4 eyesdir = vec4(0);\n\tfloat v = sin(time)*0.6;\n\teyesdir.x  = v;\n\teyesdir.z  = v/2.;\n\treturn eyesdir;\n}\n\n\n// RED GHOST ANIM\nvec4 gen_gr(int id) {\n\tfloat time = lTime;\n\tif(id==0) {\n\t\tfloat drape=1.;\n\t\tfloat blur=1.1;\n\t\tint style= T(11.,  0)\n\t\t\t\t   T(13.,  1)\n\t\t\t\t   T(24.4, 0)\n\t\t\t\t   T(25.5, 3)\n\t\t\t\t   T(28.5, 0)\n\t\t\t\t   T(31.,  3)\n\t\t\t\t   T(39.3, 0)\n\t\t           T(40.,  3)\n\t\t           T(40.5, 0)\n\t\t           T(41.5, 1)\n\t\t           T(46.5, 0)\n\t\t\t\t   T(47.5, 1)\n\t\t\t\t   0;\n\t\treturn vec4(time, drape, blur, style);\n\t} else if(id ==1) {\n\t\t// pos + visibility\n\t\tvec2 rpos = T(12.5, vec2(0.43,-0.7))\n\t\t\t\t    T(13.5, sval(12.5, 13.5, vec2(0.43,-0.7), vec2(-0.42, 0)))\n\t\t\t\t    T(14.5, sval(13.5, 14.5, vec2(-0.42,0), vec2(-.2, 0.2)))\n\t\t\t\t    T(15.5, sval(14.5, 15.5, vec2(-.2, 0.2), vec2(-.4, 0.3)))\n\t\t\t\t    vec2(-.4, 0.3);\n\t\tfloat invscale = T(12.5,  0.2)\n\t\t\t\t         T(15.5, sval(12.5, 15.5, 0.2, 0.7)+0.05*sin(time))\n\t\t\t\t         0.7+0.05*sin(time);\n\t\tfloat visible = 1.;\n\t\treturn vec4(rpos, invscale, visible);\n\n\t} else if(id ==2) {\n\t\t// color + 1 unused\n\t\treturn vec4(1, 0.22, 0.2, 0);\n\t} else if(id ==3) {\n\t\tvec4 glow = T(28.821, noglow)\n\t\t\t\t\tT(32.,    vec4(blueGlow.xyz, sval(29., 31.5, 0., blueGlow.w)))\n\t\t\t\t\tT(47.6, blueGlow)\n\t\t\t\t\tnoglow;\n\t\treturn glow;\n\t} else if(id ==4) {\n        /* // memory exhausted bug (Windows ?)\n\t\tvec4 eyesDir =\n                T(4.   , sval4(2.5, 3., vec2(0), vec2(-1,0)))\n\t\t\t\tT(5.5  , sval4(4., 4.5, vec2(-1,0), vec2(0.8,0)))\n\t\t\t\tT(7.   , sval4(5.5, 6., vec2(0.8,0), vec2(0, .6)))\n\t\t\t\tT(8.5  , sval4(7., 7.5, vec2(0, .6), vec2(0, -.6)))\n\t\t\t\tT(11.  , sval4(8.5, 9., vec2(0, -.6), vec2(0)))\n\t\t\t\tT(12.5 , vec4(0))\n\t\t\t\tT(16.5 , sval4(12.5, 15.5, vec2(0), vec2(-.6, -0.5)))\n\t\t\t\tT(21.  , V24(-.6, -0.5))\n\t\t\t\tT(22.5 , sval4(21.5, 22., vec2(-.6, -0.5), vec2(0., 0.75)))\n\t\t\t\tT(23.5 , V24(0., 0.75) + no(time*12.))\n\t\t\t\tT(25.5 , sval4(23.5, 24.5, vec2(0., 0.75), vec2(0., -0.75)) + no(time*12.))\n\t\t\t\tT(26.  , sval4(25.5, 26., vec2(0., -0.75), vec2(-.6, -0.5)))\n\t\t\t\tT(27.5 , sval4(27., 27.5, vec2(-.6, -0.5), vec2(0)))\n\t\t\t\tT(32.5 , vec4(0))\n\t\t\t\tT(33.  , sval4(32.5, 33., vec2(0), vec2(-.6, -0.5)))\n\t\t\t\tT(35.672 , V24(-.6, -0.5))\n\t\t\t\tT(36.5 , sval4(35.672, 36.5, vec2(-.6, -0.5), vec2(.6, 0)))\n\t\t\t\tT(39.  , V24(.6, 0.1))\n\t\t\t\tT(40.5 , V24(.6, 0.1) + yes(time*8.))\n\t\t\t\tT(42.  , sval4(41.4, 42., vec2(.6, .1), vec2(0.6, -.5)))\n\t\t\t\tT(43.  , V24(.6, -.5))\n\t\t\t\tT(44.  , V24(.6, -.5) + yes(time*8.))\n\t\t\t\tT(50.  , V24(.6, -.5))\n\t\t\t\tT(51.  , sval4(50., 51., vec2(.6, -.5), vec2(-.8, -0.4)))\n\t\t\t\tT(58.8 , V24(-.8, -.4))\n\t\t\t\tT(59.5 , sval4(58.8, 59.5, vec2(-.8, -0.4), vec2(-.8, 0.75)))\n\t\t\t\tT(61.  , V24(-.8, 0.75)+no(time*7.2))\n\t\t\t\tT(62.  , sval4(61., 62., vec2(-.8, 0.75), vec2(0))+no(time*7.2))\n\t\t\t\tT(80.  , vec4(0)+no(time*7.2))\n\t\t\t\tvec4(0);\n\t\treturn eyesDir;\n*/\n/* // as expected by Fabrice the following code produces the same bug \n        float t = lTime;\n\t\tvec4 eyesDir;\n\t\tif(t<4.   ) eyesDir = sval4(2.5, 3., vec2(0), vec2(-1,0));\n\t\telse if(t<5.5  ) eyesDir = sval4(4., 4.5, vec2(-1,0), vec2(0.8,0));\n\t\telse if(t<7.   ) eyesDir = sval4(5.5, 6., vec2(0.8,0), vec2(0, .6));\n\t\telse if(t<8.5  ) eyesDir = sval4(7., 7.5, vec2(0, .6), vec2(0, -.6));\n\t\telse if(t<11.  ) eyesDir = sval4(8.5, 9., vec2(0, -.6), vec2(0));\n\t\telse if(t<12.5 ) eyesDir = vec4(0);\n\t\telse if(t<16.5 ) eyesDir = sval4(12.5, 15.5, vec2(0), vec2(-.6, -0.5));\n\t\telse if(t<21.  ) eyesDir = V24(-.6, -0.5);\n\t\telse if(t<22.5 ) eyesDir = sval4(21.5, 22., vec2(-.6, -0.5), vec2(0., 0.75));\n\t\telse if(t<23.5 ) eyesDir = V24(0., 0.75) + no(time*12.);\n\t\telse if(t<25.5 ) eyesDir = sval4(23.5, 24.5, vec2(0., 0.75), vec2(0., -0.75)) + no(time*12.);\n\t\telse if(t<26.  ) eyesDir = sval4(25.5, 26., vec2(0., -0.75), vec2(-.6, -0.5));\n\t\telse if(t<27.5 ) eyesDir = sval4(27., 27.5, vec2(-.6, -0.5), vec2(0));\n\t\telse if(t<32.5 ) eyesDir = vec4(0);\n\t\telse if(t<33.  ) eyesDir = sval4(32.5, 33., vec2(0), vec2(-.6, -0.5));\n\t\telse if(t<35.672) eyesDir = V24(-.6, -0.5);\n\t\telse if(t<36.5 ) eyesDir = sval4(35.672, 36.5, vec2(-.6, -0.5), vec2(.6, 0));\n\t\telse if(t<39.  ) eyesDir = V24(.6, 0.1);\n\t\telse if(t<40.5 ) eyesDir = V24(.6, 0.1) + yes(time*8.);\n\t\telse if(t<42.  ) eyesDir = sval4(41.4, 42., vec2(.6, .1), vec2(0.6, -.5));\n\t\telse if(t<43.  ) eyesDir = V24(.6, -.5);\n\t\telse if(t<44.  ) eyesDir = V24(.6, -.5) + yes(time*8.);\n\t\telse if(t<50.  ) eyesDir = V24(.6, -.5);\n\t\telse if(t<51.  ) eyesDir = sval4(50., 51., vec2(.6, -.5), vec2(-.8, -0.4));\n\t\telse if(t<58.8 ) eyesDir = V24(-.8, -.4);\n\t\telse if(t<59.5 ) eyesDir = sval4(58.8, 59.5, vec2(-.8, -0.4), vec2(-.8, 0.75));\n\t\telse if(t<61.  ) eyesDir = V24(-.8, 0.75)+no(time*7.2);\n\t\telse if(t<62.  ) eyesDir = sval4(61., 62., vec2(-.8, 0.75), vec2(0))+no(time*7.2);\n\t\telse if(t<80.  )eyesDir = vec4(0)+no(time*7.2);\n\t\telse eyesDir = vec4(0);\n        return eyesDir;\n*/\n\n        float t = lTime;\n\t\tif(t<4.   ) return sval4(2.5, 3., vec2(0), vec2(-1,0));\n\t\tif(t<5.5  ) return sval4(4., 4.5, vec2(-1,0), vec2(0.8,0));\n\t\tif(t<7.   ) return sval4(5.5, 6., vec2(0.8,0), vec2(0, .6));\n\t\tif(t<8.5  ) return sval4(7., 7.5, vec2(0, .6), vec2(0, -.6));\n\t\tif(t<11.  ) return sval4(8.5, 9., vec2(0, -.6), vec2(0));\n\t\tif(t<12.5 ) return vec4(0);\n\t\tif(t<16.5 ) return sval4(12.5, 15.5, vec2(0), vec2(-.6, -0.5));\n\t\tif(t<21.  ) return V24(-.6, -0.5);\n\t\tif(t<22.5 ) return sval4(21.5, 22., vec2(-.6, -0.5), vec2(0., 0.75));\n\t\tif(t<23.5 ) return V24(0., 0.75) + no(time*12.);\n\t\tif(t<25.5 ) return sval4(23.5, 24.5, vec2(0., 0.75), vec2(0., -0.75)) + no(time*12.);\n\t\tif(t<26.  ) return sval4(25.5, 26., vec2(0., -0.75), vec2(-.6, -0.5));\n\t\tif(t<27.5 ) return sval4(27., 27.5, vec2(-.6, -0.5), vec2(0));\n\t\tif(t<32.5 ) return vec4(0);\n\t\tif(t<33.  ) return sval4(32.5, 33., vec2(0), vec2(-.6, -0.5));\n\t\tif(t<35.672) return V24(-.6, -0.5);\n\t\tif(t<36.5 ) return sval4(35.672, 36.5, vec2(-.6, -0.5), vec2(.6, 0));\n\t\tif(t<39.  ) return V24(.6, 0.1);\n\t\tif(t<40.5 ) return V24(.6, 0.1) + yes(time*8.);\n\t\tif(t<42.  ) return sval4(41.4, 42., vec2(.6, .1), vec2(0.6, -.5));\n\t\tif(t<43.  ) return V24(.6, -.5);\n\t\tif(t<44.  ) return V24(.6, -.5) + yes(time*8.);\n\t\tif(t<50.  ) return V24(.6, -.5);\n\t\tif(t<51.  ) return sval4(50., 51., vec2(.6, -.5), vec2(-.8, -0.4));\n\t\tif(t<58.8 ) return V24(-.8, -.4);\n\t\tif(t<59.5 ) return sval4(58.8, 59.5, vec2(-.8, -0.4), vec2(-.8, 0.75));\n\t\tif(t<61.  ) return V24(-.8, 0.75)+no(time*7.2);\n\t\tif(t<62.  ) return sval4(61., 62., vec2(-.8, 0.75), vec2(0))+no(time*7.2);\n\t\tif(t<80.  )return vec4(0)+no(time*7.2);\n\t\treturn vec4(0);\n\n\t}\n\treturn nothing;\n}\n\n// BLUE GHOST ANIM\nvec4 gen_gb(int id) {\n\tfloat time = lTime*0.9+1.;\n\tif(id==0) {\n\t\tfloat drape=1.2;\n\t\tfloat blur= T(12.5,6.) T(15.5, sval(12.5, 15.5, 6., 1.2)) 1.2;\n\t\tint style= T(17. , 0)\n\t\t\t\t   T(18.5, 3)  // w\n\t\t\t\t   T(21. , 2 ) // \\/\n\t\t\t\t   T(21.5, 0)\n\t\t\t\t   T(22.5, 1)  // ^^\n\t\t\t\t   T(56.25, 0)\n\t\t\t\t   T(57., 3)\n\t\t\t\t   T(58.5, 2)\n\t\t\t\t   T(58.75, 0)\n\t\t\t\t   T(59., 3)\n\t\t\t\t   T(61., 2)\n\t\t\t\t   T(61.25, 0)\n\t\t\t\t   T(61.5, 3)\n\t\t\t\t   T(63.5, 2)\n\t\t\t\t   T(63.75, 0)\n\t\t\t\t   T(64., 3)\n\t\t\t\t   T(66., 2)\n\t\t\t\t   0;\n\t\treturn vec4(time, drape, blur, style);\n\t} else if(id ==1) {\n\t\t// pos + visibility\n\t\tvec2 rpos = T(18.5 , vec2(-1,0))\n\t\t\t\t\tT(21.  , vec2(-1,0) + hash2(time)*0.025 )\n\t\t\t\t\tT(57.  , vec2(-1,0) )\n\t\t\t\t\tT(58.5 , vec2(-1,0) + hash2(time)*0.025 )\n\t\t\t\t\tT(59.  , vec2(-1,0) )\n\t\t\t\t\tT(61.  , vec2(-1,0) + hash2(time)*0.025 )\n\t\t\t\t\tT(61.5 , vec2(-1,0) )\n\t\t\t\t\tT(63.5 , vec2(-1,0) + hash2(time)*0.025 )\n\t\t\t\t\tT(64.  , vec2(-1,0) )\n\t\t\t\t\tT(66.  , vec2(-1,0) + hash2(time)*0.025 )\n\t\t\t\t\tvec2(-1,0);\n\t\tfloat invscale = T(12.5 ,  1.2+0.05*sin(time))\n\t\t\t\t         T(15.5  , sval(12.5, 15.5, 1.2, 0.7)+0.05*sin(time))\n\t\t\t\t         0.7+0.05*sin(time);\n\t\tfloat visible = T(11. , 0.)  1.;\n\t\treturn vec4(rpos, invscale, visible);\n\t} else if(id ==2) {\n\t\t// color + 1 unused\n\t\treturn vec4(0., 0.901, 1., 0.);\n\t} else if(id ==3) {\n\t\tvec4 glow = T(21., noglow)\n\t\t\t\t    T(26.323, whiteBGlow)\n\t\t\t\t\tT(58.5, noglow)\n\t\t\t\t\tT(59., whiteBGlow)\n\t\t\t\t\tT(61., noglow)\n\t\t\t\t\tT(61.5, btBGlow1)\n\t\t\t\t\tT(63.5, noglow)\n\t\t\t\t\tT(64., btBGlow2)\n//\t\t\t\t\tT(66., noglow)\n//\t\t\t\t\tT(66.5, btBGlow3)\n\t\t\t\t\tnoglow;\n\t\treturn glow;\n\t} else if(id ==4) {\n\t\tvec4 eyesDir =\n\t\t        T(24.  , V24(1, .2))\n\t\t\t\tT(24.5 , sval4(24., 24.5, vec2(1, 0.2),vec2(0.7, 0.6)))\n\t\t\t\tT(32.75, V24(.7, .6))\n\t\t\t\tT(35.2 , V24(.6, .7) + yes(time*10.))\n\t\t\t\tT(36.  , V24(.6, .7))\n\t\t\t\tT(36.5 , sval4(36., 36.5, vec2(.6, .7),vec2(.7, .4)))\n\t\t\t\tT(41.6 , V24(.7, .4))\n\t\t\t\tT(42.  , sval4(41.6, 42., vec2(.7, .4),vec2(.8, -.1)))\n\t\t\t\tT(50.  , V24(.8, -.1) )\n\t\t\t\tT(51.  , sval4(50., 51., vec2(.8, -.1),vec2(.6, .7)))\n\t\t\t\tT(52.  , sval4(51., 52., vec2(.6, .7),vec2(0)))\n\t\t\t\tT(53.5 , sval4(53., 53.5, vec2(0), vec2(0, .75)))\n\t\t\t\tT(54.5 , sval4(53.5, 54.5, vec2(0, .75), vec2(0, -.75)))\n\t\t\t\tT(55.  , sval4(54.5, 55., vec2(0, -.75), vec2(0)))\n\t\t\t\tT(61.  , sval4(55.5, 56., vec2(0), vec2(0, .5)))\n\t\t\t\tT(66.  , V24(0, .5))\n\t\t\t\tvec4(0);\n\t\treturn eyesDir;\n\t}\n\treturn nothing;\n}\n\n// PINK GHOST ANIM\nvec4 gen_gp(int id) {\n\tfloat time = lTime+1.8;\n\tif(id==0) {\n\t\tfloat drape=1.1;\n\t\tfloat blur= T(12.5 , 6.) T(15.5 , sval(12.5, 15.5, 6., 1.2)) 1.2;\n\t\tint style= T(21.5 , 0)\n\t\t\t\t   T(23.  , 1)\n\t\t\t\t   T(37.  , 0)\n\t\t\t\t   T(39.  , 3)\n\t\t\t\t   T(39.4 , 0)\n\t\t\t\t   T(41.4 , 1)\n\t\t\t\t   T(44.4 , 0)\n\t\t\t\t   T(45.5 , 1)\n\t\t\t\t   0;\n\t\treturn vec4(time, drape, blur, style);\n\t} else if(id ==1) {\n\t\t// pos + visibility\n\t\tvec2 rpos = vec2(.3);\n\t\tfloat invscale = T(12.5 ,  1.2+0.05*sin(time))\n\t\t\t\t         T(15.5  , sval(12.5, 15.5, 1.2, 0.7)+0.05*sin(time))\n\t\t\t\t         0.7+0.05*sin(time);\n\t\tfloat visible = T(11. , 0. ) 1.;\n\t\treturn vec4(rpos, invscale, visible);\n\t} else if(id ==2) {\n\t\t// color + 1 unused\n\t\treturn vec4(0.988, 0.71, 1., 0);\n\t} else if(id ==3) {\n\t\tvec4 glow = T(37.  , noglow)\n\t\t\t\t    T(39. , vec4(blueGlow.xyz, sval(37., 39., 0., blueGlow.w)))\n\t\t\t\t\tT(49.5, blueGlow)\n\t\t\t\t\tnoglow;\n\t\treturn glow;\n\t} else if(id ==4) {\n\t\tvec4 eyesDir = T(21.5 , V24(-1, -0.1))\n\t\t\t\t       T(23.  , V24(-1, -0.1) + yes(time*40.))\n\t\t\t\t       T(24.  , V24(-1, -.1))\n\t\t\t\t\t   T(24.5 , sval4(24., 24.5, vec2(-1, -.1), vec2(-.8, .1)))\n\t\t\t\t\t   T(32.5 , V24(-.8, .1))\n\t\t\t\t\t   T(34.  , V24(-.8, .1) + yes(time*10.))\n\t\t\t\t\t   T(36.  , V24(-.8, .1))\n\t\t\t\t\t   T(36.5 , sval4(36., 36.5, vec2(-.8, .1), vec2(0)))\n\t\t\t\t\t   T(40.  , vec4(0))\n\t\t\t\t\t   T(41.4 , sval4(40., 41.4, vec2(0), vec2(-.6,0)))\n\t\t\t\t\t   T(42.  , sval4(41.4, 42., vec2(-.6, 0), vec2(0.3, -.5)))\n\t\t\t\t\t   T(43.5 , V24(.3, -.5))\n\t\t\t\t\t   T(45.  , V24(.3, -.5) + yes(time*20.))\n\t\t\t\t\t   T(47.5 , V24(.3, -.5))\n\t\t\t\t\t   T(48.  , sval4(47.5, 48., vec2(.3, -.5), vec2(-0.8, .1)))\n\t\t\t\t\t   T(50.  , V24(-0.8, .1))\n\t\t\t\t\t   T(51.  , sval4(50., 51., vec2(-0.8, .1), vec2(-1, -0.1)))\n\t\t\t\t\t   T(60.  , V24(-1, -0.1))\n\t\t\t\t\t   T(80.  , V24(-1, -0.1)+no(time*12.))\n   \t\t\t\t       V24(-1, -0.1);\n\t\treturn eyesDir;\n\t}\n\treturn nothing;\n}\n\n// ORANGE GHOST ANIM\nvec4 gen_go(int id) {\n\tfloat time = lTime*1.1+2.6;\n\tif(id==0) {\n\t\tfloat drape=1.;\n\t\tfloat blur= T(12.5 , 6.) T(15.5 , sval(12.5, 15.5, 6., 1.2)) 1.2;\n\t\tint style= T(21.5, 0)\n\t\t\t\t   T(23. , 1)\n\t\t\t\t   T(39. , 0)\n\t\t\t\t   T(41. , 1)\n\t\t\t\t   T(42. , 0)\n\t\t\t\t   T(44. , 3)\n\t\t\t\t   T(44.5, 0)\n\t\t\t\t   T(46.5, 1)\n\t\t\t\t   0;\n\t\treturn vec4(time, drape, blur, style);\n\t} else if(id ==1) {\n\t\t// pos + visibility\n\t\tvec2 rpos = vec2(0.5,-0.1);\n\t\tfloat invscale = T(12.5 , 1.2+0.05*sin(time))\n\t\t\t\t\t\t T(15.5 , sval(12.5, 15.5, 1.2, 0.7)+0.05*sin(time))\n\t\t\t\t         0.7+0.05*sin(time);\n\t\tfloat visible = T(11. , 0.) 1.;\n\t\treturn vec4(rpos, invscale, visible);\n\t} else if(id ==2) {\n\t\t// color + 1 unused\n\t\treturn vec4(0.973, 0.733, 0.333, 0);\n\t} else if(id ==3) {\n\t\tvec4 glow = T(42. , noglow)\n\t\t\t\t    T(44. , vec4(blueGlow.xyz, sval(42., 44., 0., blueGlow.w)))\n\t\t\t\t    T(49. , blueGlow)\n\t\t\t\t\tnoglow;\n\t\treturn glow;\n\t} else if(id ==4) {\n\t\tvec4 eyesDir = T(16.  , V24(-1, 0.1))\n\t\t\t\t       T(16.5 , V24(-1, 0.1) + yes(time*40.))\n\t\t\t\t\t   T(21.5 , V24(-1, 0.1))\n\t\t\t\t\t   T(23.  , V24(-1, 0.1) + yes(time*10.))\n\t\t\t\t       T(24.5 , V24(-1, 0.1))\n\t\t\t\t\t   T(25.  , sval4(24.5, 25., vec2(-1, .1), vec2(-.7, .5)))\n\t\t\t\t\t   T(32.5 , V24(-.7, .5))\n\t\t\t\t\t   T(33.5 , V24(-.7, .5) + yes(time*10.))\n\t\t\t\t\t   T(36.  , V24(-.7, .5))\n\t\t\t\t\t   T(36.5 , sval4(36., 36.5, vec2(-.7, .5), vec2(-.3, 0.6)))\n\t\t\t\t\t   T(38.  , V24(-.3, 0.6))\n\t\t\t\t\t   T(39.5 , V24(-.3, 0.6)+yes(time*15.))\n\t\t\t\t\t   T(41.5 , V24(-.3, 0.6))\n\t\t\t\t       T(42.  , sval4(41.5, 42., vec2(-.3, 0.6), vec2(0)))\n\t\t\t\t       T(46.  , vec4(0))\n\t\t\t\t       T(46.5 , sval4(46., 46.5, vec2(0), vec2(-.6, .5)))\n\t\t\t\t       T(50.  , V24(-.6, .5))\n\t\t\t\t\t   T(51.  , sval4(50., 51., vec2(-.6, .5), vec2(-1, .1)))\n\t\t\t\t\t   T(61., V24(-1, .1))\n\t\t\t\t\t   T(62., sval4(61., 62., vec2(-1., .1), vec2(0, -0.75)))\n\t\t\t\t\t   T(80., V24(0, -0.75)+no(time*8.4))\n   \t\t\t\t       V24(-1, 0.1);\n\t\treturn eyesDir;\n\t}\n\treturn nothing;\n}\nvec4 gen_g(const int id) {\n\tif(id<5) {\n\t\treturn gen_gp(id);\n\t} else if(id<10) {\n\t\treturn gen_go(id-5);\n\t} else if(id<15) {\n\t\treturn lTime<14.966 ? gen_gb(id-10) : gen_gr(id-10);\n\t} else {\n\t\treturn lTime<14.966 ? gen_gr(id-15) : gen_gb(id-15);\n\t}\n\treturn vec4(0);\n}\nvec4 gen_s(int id) {\n\tif(id==20) {\n\t\tfloat diskRadius = T(11.,  sval(1.5, 2.5, 0., 0.45))\n\t\t\t\t           T(12.5, sval(11., 12.5, 0.45, 2.5))\n\t\t\t\t           T(62.63, -1.)\n\t\t\t\t           T(64., sval(62.63, 64., 2.5, 0.45))\n\t\t\t\t           T(65.5,  0.5)\n\t\t\t\t           T(70.,  sval(65.5, 66., 0.5, 0.))\n\t\t\t\t           0.;\n\t\tvec2 diskPos = T(60., vec2(0)) vec2(-1.,\t0);\n\t\treturn vec4(diskRadius, diskPos,0);\n\t} else if(id==21) {\n\t\tvec2 spec = mats[SPECULAR_MODE]; // 2 4 5 0\n\t\treturn vec4(spec,0,0);\n\t}\n\treturn nothing;\n}\n\nvec4 gen(int id) {\n\tlTime = mod(iTime, 75.);\n\tif(id<20) return gen_g(id);\n\telse return gen_s(id);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    int id = int(floor(floor(fragCoord.x) + floor(fragCoord.y)*iResolution.x));\n\tif(id>21) discard;\n    fragColor = gen(id);\n}","name":"Buf A","description":"","type":"buffer"}]}