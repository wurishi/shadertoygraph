{"ver":"0.1","info":{"id":"tdtSRN","date":"1571610352","viewed":355,"name":"Ringmodulator","username":"LJ","description":"\"Once the powerplants of a society on the cusp of space travel, neutrino ring modulators were quickly abandoned when their catastrophic effects on the integrity of the quantum lattice were discovered.\"\nSee more: twitter.com/LJ_1102","likes":12,"published":1,"flags":64,"usePreview":0,"tags":["raymarching","sdf","cookiezine"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4sXGRn","filepath":"/media/a/95b90082f799f48677b4f206d856ad572f1d178c676269eac6347631d4447258.jpg","previewfilepath":"/media/ap/95b90082f799f48677b4f206d856ad572f1d178c676269eac6347631d4447258.jpg","type":"texture","channel":1,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XdXGzn","filepath":"/media/a/3083c722c0c738cad0f468383167a0d246f91af2bfa373e9c5c094fb8c8413e0.png","previewfilepath":"/media/ap/3083c722c0c738cad0f468383167a0d246f91af2bfa373e9c5c094fb8c8413e0.png","type":"texture","channel":2,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4sfGzn","filepath":"/media/a/793a105653fbdadabdc1325ca08675e1ce48ae5f12e37973829c87bea4be3232.png","previewfilepath":"/media/ap/793a105653fbdadabdc1325ca08675e1ce48ae5f12e37973829c87bea4be3232.png","type":"cubemap","channel":3,"sampler":{"filter":"mipmap","wrap":"clamp","vflip":"false","srgb":"false","internal":"byte"},"published":1},{"id":"ltfGDf","filepath":"https://soundcloud.com/olgapalomaki/a-dark-drop-excerpt-from-an-ambient-soundscape","previewfilepath":"https://soundcloud.com/olgapalomaki/a-dark-drop-excerpt-from-an-ambient-soundscape","type":"musicstream","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":0}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// @author Jan <LJ> Scheurer\n#define ANAGLYPH\n#define time iTime\n\nmat2 r2d(float a){float sa=sin(a),ca=cos(a);return mat2(ca,sa,-sa,ca);}\nfloat gn(vec2 p){p/=64.;float fi,n=0.;for(int i=1;i<4;i++)fi=float(i*i),n+=texture(iChannel2,p*fi).r/fi;return n;}\nfloat bmin(float a,float b,float k){return min(min(a,b),max(a,b)-k);}\nvec2 amod(vec2 p,float a){a=mod(atan(p.x,p.y),a)-a*.5;return vec2(sin(a),cos(a))*length(p);}\nfloat CABLES,TUBE;\nfloat map(vec3 p) {\n    vec3 o=p,w=p;w.xz=amod(w.xz,.785);\n    p.xz=abs(w.xz.yx)-2.9;\n    p.xz=max(abs(p.xz)-1.95,abs(p.x)-1.);\n    vec2 a=(o.xz*r2d(.345)).yx;p.x=max(p.x,o.y-1.);\n   \tfloat d=bmin(\n        bmin(\n            max(-w.z+6.1,-abs(max(a.x,p.z-3.))+.5),\n            step(max(abs(w.z-3.),p.y),.7)+abs(mod(max(o.y,abs(w.x+.01)-.2),.7)-.35)+.05,\n            .07\n        ),\n        min(\n            max(\n                abs(o.y+.6)-.01-min(max(abs(a.x)-.45,0.),.02)+max(abs(mod(length(o.xz),.5))-.48,0.)*.1,\n                bmin(abs(a.x)-.5,abs(length(o.xz)-3.)-1.,.05)\n            ),\n            max(max(abs(p.x),max(.9-abs(p.z),-abs(a.x)+.6))-.08,-abs(abs(p.y-.5)-.3)+.01)\n        ),\n        .05\n    );\n    d=min(d,max(abs(length(o.xz)-.5)-.02,abs(abs(o.y-3.)-.2+max(p.y-3.,0.))-.05));\n    d=bmin(d,max(max(abs(w.x),abs(w.z-.5))-.02,-o.y+2.7+floor(o.x*4.)*.1),.03);\n    d=bmin(d,CABLES=length(w.xy+vec2(0,-4.7+(1.92-dot(o.xz,o.xz)*.08)))-.01,.02);\n    p.xz=w.xz;\n    d=bmin(d,max(abs(abs(length(o.xz)-3.)-1.),abs(o.y-1.))-.08+step(3.,length(o.xz))*.02,.05);\n    d=bmin(d,max(bmin(length(o.xz)-.25,abs(o.y+.2)+.05,.1),o.y),.01);\n    p.z=max(max(-max(-p.z+.2-max(min(p.y-1.,.2),0.)*.5,-abs(p.y+1.)),p.x+.01)-.1,0.);\n    d=bmin(bmin(d,length(max(abs(p.xz)-.02,0.))-.02,.03),TUBE=length(o.xz)-.2,.01);\n    d=min(d,o.y+2.+texture(iChannel1,o.xz*.1+texture(iChannel2,o.xz*.05).r+time*.1).b*.1);\n    p=w;\n    w.x=abs(w.x-1.8)-.2,w.z-=6.;\n    d=bmin(d,length(w.xz)-.1,.05);\n\treturn d;\n}\nconst vec2 N=vec2(.002,0);\nvec3 march(vec3 ro,vec3 rd) {\n    vec3 mp=ro;float md;int ri;\n    for(int i=0;i<100;i++)if(ri=i,mp+=rd*(md=map(mp)),md<.001)break;\n    if(md==TUBE)return mp*=2.,vec3(gn(mp.xy+vec2(0,time)+gn(mp.xy*2.)))*1.5;\n    if(md==CABLES)return vec3(0);\n    vec3 n=normalize(map(mp)-vec3(map(mp-N.xyy),map(mp-N.yxy),map(mp-N.yyx)));\n    vec3 lp=vec3(0,0,0),l=normalize(lp-mp);\n    float d=max(dot(n.xz,l.xz),0.),s=pow(max(dot(n.xz,normalize(l-rd).xz),0.),100.),f=abs(1.-dot(n,-rd)),ao=map(mp+n*.1)*10.,fi;\n    f*=f*f;\n    return mix(min(texture(iChannel3,reflect(rd,n)).rgb,.6)*.4*gn(mp.xz)+1.*(2.5/length(mp.xz-lp.xz))*texture(iChannel1,(abs(n.y)>.3?mp.xz:mp.xy)*.4).rgb*clamp(.2*(mp.y+3.5),0.,1.)*smoothstep(5.,2.,mp.y)*min(vec3(pow((d*.5+2.*(s+f)*gn(mp.xz*5.)*.5)*ao*(.2+.8*gn(vec2(atan(mp.x,mp.z),mp.y)*2.+time*.3)),1./2.2)),1.),vec3(.7,.9,1.1+rd.y*.1)*1.1,smoothstep(0.,40.,length(ro-mp)-gn(rd.xy*5.)*5.));\n}\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n    vec2 uv = (fragCoord/iResolution.xy),p=uv*2.-1.;\n    p.x*=iResolution.x/iResolution.y;\n    float md,ipd=.05,focal=-.01;\n    vec3 rd,pos=vec3(-1,3.7,5.5)+.4,a;\n    mat2 rX=r2d(.5+cos(time*.17)*.2),rY=r2d(.3+sin(time*.1)*.3),r=r2d(time*.03);\n    fragColor=vec4(0);\n    rd=normalize(vec3(p*r2d(.15),-2.));\n \trd.yz*=rX;rd.xz*=rY;\n    rd.xz*=r;pos.xz*=r;\n    #ifdef ANAGLYPH\n    a=rd;a.xz*=r2d(focal);\n    fragColor.rgb+=vec3(1,0,0)*march(vec3(-ipd,0,0)+pos,a);\n    a=rd;a.xz*=r2d(-focal);\n    fragColor.rgb+=vec3(0,.7,1)*march(vec3(ipd,0,0)+pos,a);\n    #else\n    fragColor.rgb+=march(pos,rd);\n    #endif\n    fragColor=mix(1.3*fragColor,vec4(.7),.5*gn(p*5.+gn(p*5.)*.2+vec2(time,-time))*.7*pow(gn(p+vec2(time+5.5,0)*.3),4.))*1.5;\n    fragColor=vec4(min(fragColor.rgb,1.), 1.0)*max(1.-length(p)*.3,0.)+step(abs(p.x),.01)*0.;\n}","name":"Image","description":"","type":"image"}]}