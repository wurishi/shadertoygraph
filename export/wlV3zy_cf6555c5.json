{"ver":"0.1","info":{"id":"wlV3zy","date":"1579307582","viewed":564,"name":"[phreax] electric sheep","username":"phreax","description":"Kaleidoscopic polar shapes","likes":27,"published":1,"flags":0,"usePreview":0,"tags":["2d","rainbow","kifs"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"/* Creative Commons Licence Attribution-NonCommercial-ShareAlike \n   phreax 2020\n*/\n\n#define PI 3.141592\n#define TAU 2.*PI\n#define hue(v) ( .6 + .6 * cos( 6.3*(v) + vec3(0,23,21) ) )\n#define rot(a) mat2(cos(a), sin(a), -sin(a), cos(a))\n#define COUNT 30.\n#define N 5.\n#define DISTORT .7\n#define SQR(x) ((x)*(x))\n\n\nfloat tt;\n\nvec2 kalei(vec2 uv) { \n    float n = N;\n    float r = TAU/n;\n    \n    for(float i=0.; i<n; i++) {     \n    \tuv = abs(uv);\n        uv.x -= .2*i+.2;\n    \tuv *= rot(r*i-.09*tt);\n    }\n    \n    uv = abs(uv) - (sin(.15*tt)+1.2);\n\n    return uv;\n}\n\n\nfloat flower(vec2 uv) {\n    float n = 3.;\n    float a = atan(uv.y,uv.x);\n\n    float d = length( uv) - cos(a*n);\n    return smoothstep(fwidth(d), 0., abs(d));    \n}\n\n\nvec3 spiral(vec2 uv, float i) {  \n    uv *= rot(i*PI+tt*.3);\n    uv += DISTORT*sin(5.*uv.yx);\n\treturn flower(uv)*SQR(hue(i+tt*.2));\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 uv = (fragCoord-.5*iResolution.xy)/iResolution.y;\n    vec3 col = vec3(0);\n    tt = iTime;\n    \n    uv = kalei(uv*5.);\n\n    float s = 1./COUNT;\n\t\n    for(float i=0.; i<1.; i+=s) {   \n        float z = fract(i-.1*tt);\n        float fade = smoothstep(0., .1, 1.-abs(2.*z-1.));\n        col += spiral(uv*z, i)*fade;\n    }\n\n    col = sqrt(col);\n    fragColor = vec4(col,1.);\n}","name":"Image","description":"","type":"image"}]}