{"ver":"0.1","info":{"id":"DtlyRN","date":"1690465454","viewed":27,"name":"Fog_ayaha401","username":"ayaha401","description":"Example Fog","likes":0,"published":1,"flags":0,"usePreview":0,"tags":["3d","raymarching"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define rot(a) mat2(cos(a),sin(a),-sin(a),cos(a))\n\nconst float PI=3.1415926536;\nconst float TAU=PI*2.;\nconst float eps=0.0001;\nconst float DEG2RAD = PI/180.;\n\nfloat exp2Fog(float d, float density)\n{\n    float dd = d * density;\n    return exp(-dd * dd);\n}\n\nfloat sdSphere(vec3 p,float r)\n{\n    return length(p)-r;\n}\n\nfloat map(vec3 p)\n{\n    vec3 pp = mod(p, 2.) - 1.;\n    return sdSphere(pp,.5);\n}\n\nvec3 makeN(vec3 p)\n{\n    vec2 eps = vec2(.0001, 0.);\n    return normalize(vec3(map(p+eps.xyy)-map(p-eps.xyy),\n                          map(p+eps.yxy)-map(p-eps.yxy),\n                          map(p+eps.yyx)-map(p-eps.yyx)));\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv=(2.*fragCoord.xy-iResolution.xy)/iResolution.y;\n\n    float dist, hit, i = 0.;\n    vec3 cPos = vec3(0., 0., 5. - iTime*2.);\n    vec3 cDir = normalize(vec3(0., 0., -1.));\n    vec3 cUp = vec3(0., 1., 0.);\n    vec3 cSide = cross(cDir, cUp);\n    vec3 ray = normalize(cSide*uv.x+cUp*uv.y+cDir); \n    vec3 L = normalize(vec3(1));\n    vec3 col=vec3(0);\n    \n    for(;i<64.;i++)\n    {\n        vec3 rp=cPos+ray*hit;\n        dist=map(rp);\n        hit+=dist;\n        if(dist<eps)\n        {\n            vec3 N=makeN(rp);\n            float diff=dot(N,L);\n            col=vec3(1)*diff;\n        }\n    }\n    \n    // fog==========================================\n    vec3 fogCol = vec3(1., 1., 1.);\n    // fogPower=====================================\n    \n    // Example 1\n    float fp = .15; \n    \n    // Example 2\n    //float fp = .15 * abs(sin(iTime));\n    \n    float fog = exp2Fog(hit, fp);\n    col = mix(fogCol, col, fog);\n    // =============================================\n    \n    fragColor = vec4(col,1.);\n}","name":"Image","description":"","type":"image"}]}