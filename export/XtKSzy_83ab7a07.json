{"ver":"0.1","info":{"id":"XtKSzy","date":"1485175847","viewed":833,"name":"Quad plane grass","username":"mlkn","description":"One possible way to make a textured grass quad.","likes":4,"published":3,"flags":0,"usePreview":0,"tags":["fake","grass","quad"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dX3Rn","filepath":"/media/a/bd6464771e47eed832c5eb2cd85cdc0bfc697786b903bfd30f890f9d4fc36657.jpg","previewfilepath":"/media/ap/bd6464771e47eed832c5eb2cd85cdc0bfc697786b903bfd30f890f9d4fc36657.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"/*  \n\tBatch quads and add some vertex displacement based on uv.y and quad normal.\n\tGrass texture should have alpha=0 border on all sides except for bottom.\n\tAlso result is better with set background color on texture with alpha=0.\n\n\tFor usage with texture atlas:\n\t\tvTexOffset = vec2(floor(texNum / atlasSize), floor(mod(texNum, atlasSize)) ) / atlasSize;\n\t\tvUv = uv / atlasSize + vTexOffset;\n\t\t------------\n\t\tvec2 cUv = (vUv - vTexOffset) * atlasSize; // [0, 1]\n\t\tfloat transformedX = clamp(vSway + cUv.x, 0., 1.) / atlasSize + vTexOffset.x;\n*/\n\nconst float swayAmplitude = 0.22;\nconst float swayFrequency = 1.;\n\nvec4 drawGrassQuad(vec2 uv) {\n\t// swayUnsync and sway could be computed in vertex shader.\n    float swayUnsync = 0.;\n    float sway = uv.y * uv.y * sin(swayFrequency * iTime + swayUnsync) * swayAmplitude;\n        \n    float transformedX = clamp(uv.x + sway, 0., 1.); // clamp is for using with texture atlas\n\n    vec4 col = texture(iChannel0, vec2(transformedX, uv.y));\n\n    if (col.a < 0.1) discard; // could be attenuated with vViewPosition.z \n \t\n    return vec4(col.rgb, 1.);\n}\n\nvoid mainImage( out vec4 fragColor, vec2 fragCoord )\n{\n    float ratio = iResolution.x / iResolution.y;\n    vec2 uv = fragCoord / iResolution.xy;\n    uv.x = uv.x * ratio - (ratio - 1.) / 2.;\n\n    vec4 color = vec4(.1);\n    \n    if (abs(uv.x - 0.5) < 0.5) color = drawGrassQuad(uv);\n    fragColor = color;\n}","name":"Image","description":"","type":"image"}]}