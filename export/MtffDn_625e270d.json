{"ver":"0.1","info":{"id":"MtffDn","date":"1511600045","viewed":235,"name":"Doyle spiral","username":"ws","description":"An example Doyle spiral, references in source.","likes":14,"published":1,"flags":0,"usePreview":0,"tags":["spiral"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// An example Doyle spiral\n// For nicer images see:\n// http://www.josleys.com/show_gallery.php?galid=265\n// For the math to get constants:\n// https://bl.ocks.org/robinhouston/6096562\n// This is basically just a port of the second link.\n\nmat2 Rotate(float th) { return mat2(cos(th),-sin(th),sin(th),cos(th)); }\n\n// Complex multiply\n#define pi 3.1415926\n#define cmul(a,b) mat2(a,-a.y,a.x) * b\n#define cpow(a,n)  pow(length(a),n) * sin( n*atan(a.y,a.x)+vec2(pi/2.,0) )\n\n// a^p = b^q, circles at (1,0) w/ radius r, a w/ |a|*r, b w/ |b|*r, etc.\n// see diagram in pdf at first link\n#define p 9\n#define q 24\n#define r 0.1490421\nconst vec2 a = vec2(1.3449103, 0.05751978);\nconst vec2 b = vec2(1.0750469, 0.30660765);\nconst float mod_a = length(a);\nconst vec2 a_recip5 = cpow(a, -5.);\n\nconst mat3 cols = mat3(244.,208.,12.,\n                       242.,99.,95.,\n                       0.,147.,209.)/255.;\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n    //float t = float(iFrame);\n    float t = 0.;\n    vec2 uv = Rotate(-t * 2.*pi / 1000.)*(fragCoord.xy - iResolution.xy/2.);\n    vec2 start = a_recip5;\n    float max_d = .7*iResolution.x;\n    fragColor = vec4(0.,0.,0.,1.);\n    for (int i=0; i<q; i++) {          \n        vec2 qvec = start;\n        float mod_q = length(qvec);\n        for (float j = 0.; j < 30.; j+=1.) {\n            if (mod_q >= max_d) { break; }\n            if (length(qvec - uv) < mod_q*r) {\n                //fragColor.xyz = cols[j%3]; // The below is for gles2 compat.\n                fragColor.xyz += float(mod(j,3.)==0.)*cols[0];\n                fragColor.xyz += float(mod(j+1.,3.)==0.)*cols[1];\n                fragColor.xyz += float(mod(j+2.,3.)==0.)*cols[2];\n            }\n            qvec = cmul(qvec, a);\n            mod_q *= mod_a;\n        }\n        start = cmul(start, b);\n    }\n}","name":"Image","description":"","type":"image"}]}