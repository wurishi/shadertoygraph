{"ver":"0.1","info":{"id":"Dtcfz7","date":"1719927992","viewed":49,"name":"charblocks","username":"totan","description":" ","likes":6,"published":1,"flags":0,"usePreview":0,"tags":["raymarching"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGzr","filepath":"/media/a/08b42b43ae9d3c0605da11d0eac86618ea888e62cdd9518ee8b9097488b31560.png","previewfilepath":"/media/ap/08b42b43ae9d3c0605da11d0eac86618ea888e62cdd9518ee8b9097488b31560.png","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\n\nfloat MAP(vec3 p){\n    float R=0.0;\n    vec3 p1=p;\n    p1.z+=sin(p.y-mod(p.y,4.0))*iTime;\n    p1.x+=cos(p1.z-mod(p1.z,4.0))*iTime;\n    \n    //for(float i;i++<5.0;){\n    vec3 p2=abs(mod(p1,2.0)-1.0)-0.1;\n    float t=min(min(max(p2.x,p2.y),max(p2.x,p2.z)),max(p2.z,p2.y));\n    R=t;\n    \n    p2=mod(p1,4.0)-2.0;\n    p2=abs(p2)-1.1;\n    t=max(max(p2.x,p2.z),p2.y);\n    \n    R=max(R,t);\n    return R;\n    \n}\n\nvec2 MAPP2(vec3 p)\n{\n    vec2 R=vec2(0.0);\n    vec3 p1=p;\n    p1.z+=sin(p.y-mod(p.y,4.0))*iTime;\n    p1.x+=cos(p1.z-mod(p1.z,4.0))*iTime;\n    \n    //for(float i;i++<5.0;){\n    vec3 p2=abs(mod(p1,2.0)-1.0)-0.1;\n    vec2 t=vec2(min(min(p2.x,p2.y),p2.z), max(max(p2.x,p2.y),p2.z));\n    R=t;\n    \n    p2=mod(p1,4.0)-2.0;\n    p2=abs(p2)-1.1;\n    t=vec2(min(min(p2.x,p2.y),p2.z), max(max(p2.x,p2.y),p2.z));\n    \n    R=max(R,t);\n    \n    return R;\n    \n}\n\n\nvec2 rotate(vec2 k,float t)\n{\n\treturn vec2(cos(t)*k.x-sin(t)*k.y,sin(t)*k.x+cos(t)*k.y);\n}\nvoid MOVE(inout vec3 pos,inout vec3 dir){\n    float speed = iTime*0.35;\n    dir.yz = rotate(dir.yz, 0.7853*sin(speed*0.3927)); // vec2 rotation x\n\tdir.zx = rotate(dir.zx, 3.1415*cos(-speed*0.157)); // vec2 rotation y\n\tdir.xy = rotate(dir.xy, 0.3927*cos(speed*0.3927)); // vec2 rotation z\n    pos = vec3(1.2*cos(speed*0.3927),     //光またはカメラの向き位置\n                    4.5-3.0*sin(speed*0.377),\n                    -1.0-speed);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    \n\t\n    vec2 p = (fragCoord.xy*2.0-iResolution.xy)/iResolution.y;  //正規化\n\tvec3 dir=normalize(vec3(p,0.75));\n    vec3 ray;\n    MOVE(ray,dir);\n\t\n     \n    \n    float d,total_d = 0.0;  //レイマーチング\n    float i = 0.0;\n    const float max_i = 40.0;\n    for( i = 0.0; i++ < max_i; total_d += d) {\n        d = MAP(ray + dir*total_d);  //float MAP ray+dir*total_d\n        if(d<0.001) break;\n    }\n    \n    vec3 np=ray + dir*total_d;\n    //np+=sin(np.x);\n    vec2 np3=MAPP2(np);\n    bool text = texture(iChannel0,np3/3.).x > 0.7;\n    vec3 col = vec3(text);             //col=vec3(1.0,0.5,0.0);\n    \n    float fog = min(1.0, i / max_i);  //色決め\n    vec3  fog2 = .15 * col *(10.0- total_d);\n    vec3 f = vec3(0.5)*fog + fog2+0.1;\n    fragColor = vec4(1.-exp(-f*f*f), 1.0);\n}","name":"Image","description":"","type":"image"}]}