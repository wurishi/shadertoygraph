{"ver":"0.1","info":{"id":"McVSDt","date":"1715938326","viewed":101,"name":"BoxRepetition","username":"xlonlat","description":"BoxRepetition","likes":5,"published":1,"flags":0,"usePreview":0,"tags":["frameboxrepetition"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\nvec3 palette(float t) \n{\n    return .5+.5*cos(6.28318*(t+vec3(.3,.416,.557)));\n}\n\n\nfloat sdBoxFrame( vec3 p, vec3 b, float e, float scale  )\n{\n       p *= scale;\n       p = abs(p  )-b;\n  vec3 q = abs(p+e)-e; \n  return min(min(\n      length(max(vec3(p.x,q.y,q.z),0.0))+min(max(p.x,max(q.y,q.z)),0.0),\n      length(max(vec3(q.x,p.y,q.z),0.0))+min(max(q.x,max(p.y,q.z)),0.0)),\n      length(max(vec3(q.x,q.y,p.z),0.0))+min(max(q.x,max(q.y,p.z)),0.0));\n}\n\nfloat repeat = 1.0;\n\nfloat map(vec3 p) {\n    p.z += abs((iTime)) * .4; \n    \n    p = mod(p, repeat) - repeat * 0.5;\n   \n    return sdBoxFrame(p, vec3(0.3,0.2,0.3), 0.025, 1.05);\n}\n\n\n\nvec3 GetNormal(vec3 p) {\n    vec2 e = vec2(.001, 0);\n    vec3 n = map(p) - \n        vec3(map(p-e.xyy), map(p-e.yxy),map(p-e.yyx));\n    \n    return normalize(n);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n    vec2 uv = (fragCoord * 2. - iResolution.xy) / iResolution.y;\n    vec2  m = (iMouse.xy * 2. - iResolution.xy) / iResolution.y;\n    \n    if (iMouse.z <= 0.) m = vec2(cos(iTime*.2), sin(iTime*.2));\n\n    vec3 ro = vec3(0, 0, -3);         \n    vec3 rd = normalize(vec3(uv, 1)); \n    vec3 col = vec3(0);               \n\n    float t = 0.; \n\n    vec3 p;\n    float i; \n    for (i = 0.; i < 80.; i++) {\n        p = ro + rd * t; \n        \n        p.xy += m.xy * 4.;\n        //p.y += sin(t*iTime*.0005)*.5; \n\n        float d = map(p);     \n\n        t += d;              \n\n        if (d < .001 || t > 100.) break; \n    }\n    \n     vec3 n = GetNormal(p);\n     vec3 r = reflect(rd, n);\n\n    float dif = dot(n, normalize(vec3(1,2,3)))*.5+.5;\n\n    col = palette(t*.04 + float(i)*.005);\n    col *= dif * (i) / 40.;\n    col = pow(col, vec3(.4545));\t// gamma correction\n\n    fragColor = vec4(col, 1);\n}","name":"Image","description":"","type":"image"}]}