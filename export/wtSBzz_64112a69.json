{"ver":"0.1","info":{"id":"wtSBzz","date":"1598203828","viewed":406,"name":"Torus Inside","username":"Kali","description":"Inside of a torus based on an image I found on facebook","likes":24,"published":1,"flags":0,"usePreview":0,"tags":["torus"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"mat2 rot(float a) {\n\tfloat s=sin(a),c=cos(a);\n    return mat2(c,s,-s,c);\n}\n\nfloat sdTorus( vec3 p, vec2 t )\n{\n  vec2 q = vec2(length(p.xz)-t.x,p.y);\n  return length(q)-t.y;\n}\n\nfloat de(vec3 p) {\n    float t=-sdTorus(p,vec2(2.3,2.));\n    p.y+=1.;\n    float d=100.,s=2.;\n    p*=.5;\n    for (int i=0; i<6; i++) {\n        p.xz*=rot(iTime);\n        p.xz=abs(p.xz);\n        float inv=1./clamp(dot(p,p),0.,1.);\n        p=p*inv-1.;\n        s*=inv;\n        d=min(d,length(p.xz)+fract(p.y*.05+iTime*.2)-.1);\n    }\n    return min(d/s,t);\n}\n\nfloat march(vec3 from, vec3 dir) {\n    float td=0., g=0.;\n    vec3 p;\n    for (int i=0; i<100; i++) {\n    \tp=from+dir*td;\n        float d=de(p);\n        if (d<.002) break;\n        g++;\n        td+=d;\n    }\n    return smoothstep(.3,0.,abs(.5-fract(p.y*15.)))*exp(-.07*td*td)*sin(p.y*10.+iTime*10.)+g*g*.00008;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv=fragCoord/iResolution.xy-.5;\n    uv.x*=iResolution.x/iResolution.y;\n    float t=iTime*.5;\n\tvec3 from=vec3(cos(t),0.,-3.3);\n    vec3 dir=normalize(vec3(uv,.7));\n\tdir.xy*=rot(.5*sin(t));    \n    float col=march(from,dir);\n    fragColor=vec4(col);\n}","name":"Image","description":"","type":"image"}]}