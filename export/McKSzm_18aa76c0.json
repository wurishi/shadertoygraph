{"ver":"0.1","info":{"id":"McKSzm","date":"1715264297","viewed":61,"name":"Fork Halftone Effect","username":"chenxiang","description":"A halftone effect, use iMouse.x to control halftone size.","likes":4,"published":1,"flags":0,"usePreview":0,"tags":["postprocessing","halftone","pixelation"],"hasliked":0,"parentid":"ssBXRK","parentname":"[zznewclear13] Halftone Effect"},"renderpass":[{"inputs":[{"id":"4dfGRn","filepath":"/media/a/8de3a3924cb95bd0e95a443fff0326c869f9d4979cd1d5b6e94e2a01f5be53e9.jpg","previewfilepath":"/media/ap/8de3a3924cb95bd0e95a443fff0326c869f9d4979cd1d5b6e94e2a01f5be53e9.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#ifdef UNIFORM_PARAM\n\nuniform sampler2D iChannel0; //[texture26]\n\nuniform int tiles; //[20,50,100]\n\nuniform bool fixedSize; // [false]\n\n#else\n\nconst int tiles = 50;\n\nconst bool fixedSize = false;\n\n#endif\n\nfloat sdCircle(vec2 p, float r)\n{\n    return length(p) - r;\n}\n\nvec3 cellColor(vec2 u, float size)\n{\n    vec2 R = iResolution.xy;\n\n    // cell center position\n    vec2 pos = mod((u - 0.5) * R, size) - size / 2.0;\n    vec2 uv = u - pos / R;\n\n    return texture(iChannel0, uv).rgb;\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord)\n{\n    vec2 R = iResolution.xy;\n    vec2 u = fragCoord / R;\n    vec2 p = (fragCoord - 0.5 * R) / min(R.x, R.y);\n    vec2 m = (iMouse.xy - 0.5 * R) / min(R.x, R.y);\n\n    // cell count and cell size\n    float num = float(tiles) * (1.0 + ((iMouse.z > 0.0) ? m.x : 0.25 * sin(0.5 * iTime)));\n    float size = min(R.x, R.y) / num;    \n    \n    // cell color\n    vec3 tc = cellColor(u, size);\n\n    // cell greyscale -> circle size\n    float l = fixedSize ? 1.0 : (tc.r + tc.g + tc.b) / 3.0;\n\n    // draw circle in cell\n    vec2 fp = fract(p * num);\n    float d = sdCircle(fp - 0.5, 0.5 * l);\n    float a = 1.5 * num / min(R.x, R.y);\n    float c = smoothstep(0.0, -a, d);\n\n    vec3 col = fixedSize ? mix(vec3(0.0), tc, c) : vec3(c);\n\n    fragColor = vec4(col, 1.0);\n}\n","name":"Image","description":"","type":"image"}]}