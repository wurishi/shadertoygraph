{"ver":"0.1","info":{"id":"mtBGzc","date":"1673617235","viewed":76,"name":"Kanshan in Lake","username":"yunhai","description":"jff","likes":4,"published":1,"flags":0,"usePreview":0,"tags":["2d"],"hasliked":0,"parentid":"Ddj3RV","parentname":"Liu Kanshan"},"renderpass":[{"inputs":[{"id":"XdX3Rn","filepath":"/media/a/52d2a8f514c4fd2d9866587f4d7b2a5bfa1a11a0e772077d7682deb8b3b517e5.jpg","previewfilepath":"/media/ap/52d2a8f514c4fd2d9866587f4d7b2a5bfa1a11a0e772077d7682deb8b3b517e5.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\n#define P (1./iR.y)\n#define S(x,t) smoothstep(x,x-4.*P,t)\n//------------------dog----------------//\nvec2 rot(vec2 uv,float t)\n{\n    float c=cos(t),s=sin(t);\n    return mat2x2(c,-s,s,c)*uv;\n}\nfloat body(vec2 uv,float d)\n{\n    vec2 huv=rot(uv,.17),euv=rot(uv,.22),buv=uv;\n    euv.y+=0.04+d*.01;//off\n    euv.x*=sign(euv.x);\n    euv-=vec2(.16+d*.01,.1);//mid dis\n    euv=abs(rot(euv,-.1)*vec2(2,1));//mirr rot\n    huv-=vec2(.14,-d*.002);\n    huv*=vec2(1.,20.*huv.y/(.9-huv.x));\n    buv.x+=buv.y*buv.y*.1+d*.003;\n    float h=S(.4,length(huv)),\n         b=S(.26,length(buv.x))*step(uv.y,0.),\n         e=S(.19-d*.01,length(dot(euv,vec2(1))));\n    \n    return max(max(h,e),b);\n}\nfloat dbar(vec2 p,vec2 a,vec2 b)\n{\n    b=b-a;p=p-a;\n    return length(p-b*clamp(dot(p,b)/dot(b,b),0.,1.));\n}\nvoid image(out vec4 O,vec2 uv,vec2 I)\n{\n    vec2 suv=uv,e=vec2(0.,1.);\n    vec4 z=e.xxxx,o=1.-z;\n    //anim \n    uv+=vec2(.004*sin(max(.1,sin(iTime*2.))*10.),\n    +.11);\n\n    float otl=body(uv,0.);\n    O= mix(texture(iChannel0,I/iR),z,otl);//bg\n    O= mix(O,o,body(uv*1.1,1.));  \n    //face\n    O=mix(O,z,min(otl,\n    S(.2,length(uv-vec2(.5,.1)))));\n    O=mix(O,z, S(.04,length(uv-vec2(0,.06))));\n    //arm\n    uv+=.12;\n    uv=rot(uv,-1.+sin(iTime*10.)*.3);\n    vec2 se=e.yx*.2,hp=se*.8;\n    O=mix(O,z,S(.018,\n    min( dbar(uv,e.xx,se),\n         dbar(uv,hp,hp+vec2(.01,.03)))));\n    //star\n    suv=abs(suv-.3);\n    O=mix(O,vec4(1.,.9,.2,1.)*2.,max(0.,sin(iTime*2.)+.5)*\n    S(.1-dot(vec2(1.2),suv)/length(suv)*.04,\n    length(dot(suv,vec2(1)))));\n    \n    O=mix(O,vec4(.4,.6,1,1),.3);\n}\n//------------------noise------------------//\nfloat pnoise(vec2 uv)\n{\n    vec2 id=floor(uv);uv=fract(uv);\n    vec2 of=vec2(1,0);\n    float t=iTime*.8;\n    float a=dot(uv-of.yy,randDir(id+of.yy,t)),\n          b=dot(uv-of.xy,randDir(id+of.xy,t)),\n          c=dot(uv-of.yx,randDir(id+of.yx,t)),\n          d=dot(uv-of.xx,randDir(id+of.xx,t));\n    uv=uv*uv*(vec2(3)-2.*uv);//f'(0)=f'(1)=0\n    a=mix(a,b,uv.x),b=mix(c,d,uv.x);      \n    return mix(a,b,uv.y)/1.4+.5;\n}\nfloat fbm(vec2 uv)\n{\n    float res=0.;\n\n        res+=pnoise(uv);\n        res+=pnoise(uv*2.)*.5;\n        res+=pnoise(uv*4.)*.25;\n        res+=pnoise(uv*8.)*.125;\n        res*=.5;\n    return res;\n}\n//ref to iq \n//https://iquilezles.org/articles/warp/\nfloat warp(vec2 p)\n{\n    float d=1000.*P;\n    return fbm(p+fbm(p+fbm(p)*d)*d);\n}\nvoid mainImage( out vec4 O, in vec2 I )\n{\n    vec2 uv = (I-.5*iR)*P;\n    float of=warp(uv)*iR.y/400.;\n    image(O,uv+of*40.*P,I+of*30.);\n}","name":"Image","description":"","type":"image"},{"inputs":[],"outputs":[],"code":"#define iR iResolution.xy\n#define SS(a,b,t) smoothstep(a,b,t)\nconst float PI=3.14159265;\nconst float ATR=PI/180.;\nvec2 randDir(vec2 id,float time)\n{\n    id+=vec2(3,181);\n    float t=time+PI*2.*fract(sin(83.*id.x)*(id.y)*(414.-id.y*5.));\n    return vec2(cos(t),sin(t));\n}\nmat2 getRot(float a){return mat2(cos(a),sin(a),-sin(a),cos(a));}\n\n\n","name":"Common","description":"","type":"common"}]}