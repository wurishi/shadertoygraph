{"ver":"0.1","info":{"id":"wd3SzS","date":"1572251628","viewed":5499,"name":"MetaBalls Tutorial","username":"positivepig","description":"my first shader in shadertoy -- metaballs, hope you like it！","likes":26,"published":1,"flags":0,"usePreview":0,"tags":["2d","sdf","metaballs","tutorials"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define AA 2.\n\nstruct MetaBall{\n\tfloat r;\n    vec2 pos;\n    vec3 col;\n};\n\nvec4 BallSDF(MetaBall ball, vec2 uv){\n    float dst = ball.r / length(uv - ball.pos);\n    return vec4(ball.col * dst, dst);\n}\n\nvec3 renderMetaBall(vec2 uv){\n\tMetaBall  mbr, mbg, mbb;\n    mbr.pos = 0.7 * sin(iTime*.5 + vec2(4.0, 0.5) + 6.0); mbr.r = 0.6; mbr.col = vec3(1., 0., 0.);\n    mbg.pos = 0.7 * sin(iTime*.8 + vec2(1.0, 25) + 2.0); mbg.r = 0.9; mbg.col = vec3(0., 1., 0.);\n    mbb.pos = 0.7 * sin(iTime*1.2 + vec2(3.0, 2.5) + 4.0); mbb.r = 0.75; mbb.col = vec3(0., 0., 1.);\n\t\n    vec4 ballr = BallSDF(mbr, uv);\n    vec4 ballg = BallSDF(mbg, uv);\n    vec4 ballb = BallSDF(mbb, uv);\n    \n    float total = ballr.a + ballg.a + ballb.a;\n    float threshold = total > 4.5 ? 1. : 0.;\n    vec3 color = (ballr.rgb + ballg.rgb + ballb.rgb) / total;\n    color *= threshold;\n    return color;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\n    vec2 uv = (2.0 * fragCoord.xy - iResolution.xy) / iResolution.y;\n    \n    vec3 col = vec3(0.);\n    \n#ifdef AA \n    // Antialiasing via supersampling\n    float uvs = 1. / max(iResolution.x, iResolution.y);\n   \n    for(float i = -AA; i < AA; ++i){\n        for(float j = -AA; j < AA; ++j){\n        \tcol += renderMetaBall(uv + vec2(i, j) * (uvs / AA)) / (4.* AA * AA);\n        }\n    }\n#else       \n    col = renderMetaBall(uv);\n#endif /* AA */\n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}