{"ver":"0.1","info":{"id":"lf2yRd","date":"1722874172","viewed":21,"name":"SDF_SPHERE","username":"Yankowang","description":"study sdf","likes":0,"published":1,"flags":0,"usePreview":0,"tags":["raymarching","sdf"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define cam_pos vec3(0.0,0.0,-1.0)\n#define sphere_radius 1.5\n#define sphere_center  vec3(0.0,0.0,4.0)\nfloat noise(vec3 p)\n{\n    p.x = sin(p.x*1230.4)*543.321;\n    p.y = sin(p.y*1130.4)*5423.321;\n    p.z = sin(p.z*1210.4)*5143.321;\n    return (p.x+p.y+p.z)/3.0;\n\n}\n\nfloat sdSphere( vec3 p)\n{\n    return length(p-sphere_center)-sphere_radius+max(abs(sin(p.x*10.0)*0.1),abs(sin(p.y*10.0)*0.1));\n}\nvec3 pnormal (vec3 p )\n{\n    vec3 minstep= vec3(0.001,0.0,0.0);\n    float xx = sdSphere(p+minstep.xyy)-sdSphere(p-minstep.xyy);\n    float yy = sdSphere(p+minstep.yxy)-sdSphere(p-minstep.yxy);\n    float zz = sdSphere(p+minstep.yyx)-sdSphere(p-minstep.yyx);\n\n    return normalize(vec3(xx,yy,zz));\n}\nvec3 raymarching(vec3 p)\n{\n    int maxstep = 50;\n    float mask1 = 0.0;\n    int i =0;\n    float dp =0.0;\n    float mindis = 0.001;\n    for (i=0;i<maxstep;++i)\n    {\n         dp = sdSphere(p);\n         p = p+dp*normalize(p-cam_pos);\n         if (dp<=mindis)\n         {\n            mask1 = 1.0;\n            return pnormal(p)*0.5+0.5;\n            //break;\n         }\n\n    }\n\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // Normalized pixel coordinates (from 0 to 1)\n    vec2 uv = fragCoord/iResolution.xy;\n    uv=vec2((uv.x-0.5)*iResolution.x/iResolution.y,uv.y-0.5);\n\n    // Time varying pixel color\n    vec3 col = vec3((uv.xy-vec2(0.5,0.5))*2.,0.);\n   float m = clamp(0.0,dot(raymarching(vec3(uv,0)),normalize(vec3(cos(iTime)*2.2,sin(iTime)*2.2,1.0))),1.0);\n   //float m = sdSphere(vec3(uv,0));\n    vec3 nr = pnormal(vec3(uv,0.0));\n    \n    vec4 color = vec4(1.0,0.0,1.0,1.0);\n    // Output to screen\n    fragColor = vec4(vec3(pow(m,4.0)),1.0)*color;\n}","name":"Image","description":"","type":"image"}]}