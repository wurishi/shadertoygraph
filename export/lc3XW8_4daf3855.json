{"ver":"0.1","info":{"id":"lc3XW8","date":"1713841784","viewed":97,"name":"bokeh test by yang","username":"changjieyang","description":"test","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["bokeh"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XsX3Rn","filepath":"/media/a/92d7758c402f0927011ca8d0a7e40251439fba3a1dac26f5b8b62026323501aa.jpg","previewfilepath":"/media/ap/92d7758c402f0927011ca8d0a7e40251439fba3a1dac26f5b8b62026323501aa.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define GOLDEN_ANGLE 2.3999632\n#define ITERATIONS 150\n\nconst mat2 rot = mat2(cos(GOLDEN_ANGLE), sin(GOLDEN_ANGLE), -sin(GOLDEN_ANGLE), cos(GOLDEN_ANGLE));\n\nvec3 Bokeh(sampler2D tex, vec2 uv, float radius){\n\tvec3 acc = vec3(0), div = acc;\n    float r = 1.0;\n    vec2 vangle = vec2(0.0000, radius*0.01 / sqrt(float(ITERATIONS)));\n    float d = 6.28 * r / float(ITERATIONS);\n\tfor (int j = 0; j < ITERATIONS; j++){  \n        r += 1.0 / r - d;\n\t    vangle = rot * vangle;\n        vec3 col = texture(tex, uv + (r-1.0) * vangle).xyz; /// ... Sample the image\t\t\n        vec3 bokeh = pow(col, vec3(1.80));\n\t\tacc += col * bokeh;\n\t\tdiv += bokeh;\n\t}\n\treturn acc / div;\n}\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ){\n    vec2 uv = fragCoord.xy / iResolution.xy; \n    //uv.x *= iResolution.x / iResolution.y;//修改这里会影响整个纹理采样\n    vec4 color = texture(iChannel0,uv);\n    vec3 tex = Bokeh(iChannel0, uv, 3.0);\n    fragColor = vec4(tex, 1.0);\n}","name":"Image","description":"","type":"image"}]}