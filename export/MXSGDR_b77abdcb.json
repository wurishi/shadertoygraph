{"ver":"0.1","info":{"id":"MXSGDR","date":"1708351732","viewed":103,"name":"Individually Fading Pen Strokes","username":"PGRacer","description":"Draw or write multiple paths with your mouse.  The current path fades while old paths persist.","likes":4,"published":1,"flags":32,"usePreview":0,"tags":["draw","pencil","drawing","buffer","writing","fading","pen","write"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // Normalized pixel coordinates (from 0 to 1)\n    vec2 uv = fragCoord/iResolution.xy;\n\n    fragColor = texture(iChannel0, uv);\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"#define PEN_SIZE 0.005\n#define PEN_SOFTNESS 0.005\n#define FADE_MULTIPLIER 0.99\n\n//https://iquilezles.org/articles/distfunctions2d/\nfloat sdSegment( in vec2 p, in vec2 a, in vec2 b )\n{\n    vec2 pa = p-a, ba = b-a;\n    float h = clamp( dot(pa,ba)/dot(ba,ba), 0.0, 1.0 );\n    return length( pa - ba*h );\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord/iResolution.xy;\n    vec2 uvMouse = iMouse.xy/iResolution.xy;\n    vec4 uvMousePrev = texture(iChannel0, vec2(0.5)/iResolution.xy);\n\n    float d = 0.0;\n    if (iMouse.z > 0.0)\n    {\n        if (uvMousePrev.z > 0.0)\n        {\n            d = sdSegment(uv, uvMouse, uvMousePrev.xy);\n        }\n        else\n        {\n            d = distance(uvMouse, uv);\n        }\n        d = smoothstep(PEN_SIZE + PEN_SOFTNESS, PEN_SIZE, d);\n    }\n    \n    vec4 col = texture(iChannel0, uv);\n    \n    if(iMouse.z > 0.0 && col.a > 0.0)\n    {\n        col *= FADE_MULTIPLIER;\n    }\n    \n    col = max(col, d);\n    \n    if(fragCoord.x < 1.0 && fragCoord.y < 1.0)\n    {\n        col.xy = iMouse.xy/iResolution.xy;\n        col.zw = iMouse.zw;\n    }\n    \n    col.a = iMouse.z * col.a;\n    \n    fragColor = col;\n}","name":"Buffer A","description":"","type":"buffer"}]}