{"ver":"0.1","info":{"id":"MddcDs","date":"1520698613","viewed":209,"name":"Saturday afternoon analyzer","username":"frutbunn","description":"Saturday afternoon analyzer","likes":2,"published":1,"flags":64,"usePreview":0,"tags":["2d"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"Ms2SWW","filepath":"https://soundcloud.com/demoscenetimemachine/artillery","previewfilepath":"https://soundcloud.com/demoscenetimemachine/artillery","type":"musicstream","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":0}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define PI 3.14159265358979323846\n\nvec4 calcAnalyser(vec2 uv) {\n    const float BARS = 60.;\n\n    float b = fract( mod( (uv.x)*BARS, BARS ) );\n    float barArea = min(1., pow(sin(b*PI), .25) );\n\n    uv.x = floor(uv.x*BARS)/BARS;\n    float audio = texture(iChannel0, vec2(uv.x, 0.) ).x;\n\n    float r = smoothstep(.45, .5, audio);\n    float y = 1.-step(.6, audio) * step(.4, audio);\n    float g = 1.-smoothstep(.3, .4, audio);\n\n    float p = 0., a = 0.;\n    if (audio>=abs(uv.y)*2.) {\n        p = min(1., max(.0, audio*barArea*1.3));\n        a = 1.;\n    }\n\n    vec3 r_component = vec3(p*r)*vec3(.8, .4, .2);\n    vec3 g_component = vec3(p*g)*vec3(.4, 1., .4);\n    vec3 y_component = vec3(p*y)*vec3(1., 1., .4);\n\n    vec3 col = r_component;\n    col = mix(y_component, col, 1.-y);\n    col = mix(g_component, col, 1.-g);\n \n    return min(vec4(1.), max(vec4(0.), vec4(col, a) ) );\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord/iResolution.xy;\n    fragColor = calcAnalyser(uv);\n}","name":"Image","description":"","type":"image"}]}