{"ver":"0.1","info":{"id":"ss2fRK","date":"1646747214","viewed":82,"name":"Another fractal","username":"lwswl","description":"Sphere Fractal\n","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["fractal","sphere"],"hasliked":0,"parentid":"fdjBRV","parentname":"Sphere fractal"},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"const float E=0.0004;\n#define rot(x) mat2(cos(x),-sin(x),sin(x),cos(x));\n#define PI 3.1415926\nvec3 albedo=vec3(0.4,0.2,0.2);\nfloat dist(vec3 p){\n    float time=iTime+1.0;\n    vec3 o=vec3(1)*0.0;\n    float r=0.5;\n    p=mod(p-3.,6.)-3.;\n    float d=1000.;\n    //d=length(p)-1.0;\n    float I=0.0;\n    while(I<6.){\n        //float d=10000.;\n        albedo=vec3(fract(I*0.1),fract(I*0.1+0.6),fract(I*0.1+0.6));\n        albedo=albedo*0.6+0.4;\n        albedo*=vec3(1,0.8,0.7);\n        vec3 on;\n        float rn;\n        float f;\n        vec3 k=vec3(r*3.,0,0);\n        f=length(p+o+k.yzx)-r;if(f<d+E){d=f;on=o+k.yzx;rn=0.5;}\n        f=length(p+o-k.yzx)-r;if(f<d+E){d=f;on=o-k.yzx;rn=0.5;}\n        f=length(p+o+k.zxy)-r;if(f<d+E){d=f;on=o+k.yxz;rn=0.5;}\n        f=length(p+o-k.yxz)-r;if(f<d+E){d=f;on=o-k.zxy;rn=0.5;}\n        f=length(p+o+k.xyz)-r;if(f<d+E){d=f;on=o+k.xyz;rn=0.5;}\n        f=length(p+o-k.xzy)-r;if(f<d+E){d=f;on=o-k.xzy;rn=0.5;}\n        \n        \n        I++;\n        if(o==on)break;\n        o=on;\n        r*=rn;\n        \n    }\n    return d;\n}\nvec3 norm(vec3 p){\n    return normalize(vec3(dist(vec3(p.x+0.001,p.yz)),dist(vec3(p.x,p.y+0.001,p.z)),dist(vec3(p.xy,p.z+0.001))));\n}\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    \n    vec3 o=vec3(20,20,20);\n    o.z-=iTime;\n    vec2 uv=(fragCoord)/iResolution.xy-0.5;\n    uv*=normalize(iResolution.xy);\n    vec3 d=normalize(vec3(uv,-1));\n    \n    fragColor.rgb=vec3(0.4,0.9,0.9);\n    float t=0.01;\n    {\n        float x=30.0;\n        while(x>E&&t<30.0){\n            x=dist(o+d*t);\n            t+=x*0.5;\n        }\n    }\n    if(t<30.0){\n        vec3 N=norm(o+d*t);\n        float l=dot(N,vec3(0,1,1));\n        fragColor.rgb*=albedo*l;\n        fragColor.rgb+=l*albedo*0.1;\n        //fragColor.rgb+=pow(l,10.)*0.01;\n        float fog=clamp(t*0.08,0.,1.0);\n        fragColor.rgb*=1.0-fog;\n        o=o+d*t;\n        d=N;\n       \n        \n    }else{\n        fragColor.rgb=vec3(0);\n    }\n    float b1=sin(uv.x*16.+sin(75.*sin(uv.x+sin(iTime*0.02))+16.*uv.y+iTime+sin(iTime))*sin((sin(uv.y)*0.5+0.5)))*0.1+0.4;\n    fragColor.rgb+=vec3(b1*b1*0.5,b1*b1*0.5+0.1*sin(uv.y*4.)+0.2,b1);\n    //fragColor.rgb=sqrt(fragColor.rgb);\n}","name":"Image","description":"","type":"image"}]}