{"ver":"0.1","info":{"id":"MsV3DD","date":"1454626450","viewed":687,"name":"Rainy window test1","username":"Emil","description":"Just some experimentation.., didn't quite turn out like I wanted it too.","likes":5,"published":1,"flags":32,"usePreview":0,"tags":["rain","window"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dfGRn","filepath":"/media/a/8de3a3924cb95bd0e95a443fff0326c869f9d4979cd1d5b6e94e2a01f5be53e9.jpg","previewfilepath":"/media/ap/8de3a3924cb95bd0e95a443fff0326c869f9d4979cd1d5b6e94e2a01f5be53e9.jpg","type":"texture","channel":1,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    float val = texture(iChannel0, fragCoord/iResolution.xy).b;\n    vec4 wall = texture(iChannel1, (fragCoord/iResolution.xy));\n    //if(val>0.0){\n        for(float x = -1.5;x<1.5;x+=0.5){\n            for(float y = -1.5;y<1.5;y+=0.5){\n        \t\twall += texture(iChannel1, (fragCoord/iResolution.xy+0.01*vec2(x-1.0,y+0.5)*val));\n                wall *= 0.5;\n            }\n        }\n    //}\n\t//fragColor = vec4(clamp(val,0.0,2.8)*0.6)*0.5+(1.0-clamp(val,0.0,1.0))*wall;\n    fragColor = vec4(wall)*0.6*(1.5-clamp(0.0,1.0,val))+vec4(val*.2,val*.8,val*1.2,1.0)*0.3;\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"float random()\n{\n\treturn fract(sin(dot(gl_FragCoord.xy, vec2(12.9898,78.233))) * 43758.5453);  \n}\n\nvec2 randompos(float i)\n{\n\treturn vec2(fract(sin(dot(vec2(iTime+i,1.0), vec2(12.9898,78.233))) * 43758.5453),\n               fract(sin(dot(vec2(iTime+i,16.0), vec2(32.1561,13.684))) * 35616.6981));  \n}\n\nvec4 get_pixel(float x_offset, float y_offset)\n{\n\treturn texture(iChannel0, (gl_FragCoord.xy / iResolution.xy) + (vec2(x_offset, y_offset) / iResolution.xy));\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // r and g for xvelocity and yvelocity\n    float xvel = (get_pixel(0.0, 0.0).r + get_pixel(-1.0, 0.0).r + get_pixel(1.0, 0.0).r)/3.0;\n    float yvel = (get_pixel(0.0, 0.0).g + get_pixel(-1.0, 0.0).g + get_pixel(1.0, 0.0).g)/3.0;;\n    \n    \n    float press = 0.0;\n    for(float x = -1.5;x<1.5;x+=0.5){\n            for(float y = -1.5;y<1.5;y+=0.5){\n                press += get_pixel(xvel+x-1.0, yvel+y-1.0).b;\n                press *= .5;\n            }\n    }\n    \n    \n    yvel += press>1.3?(press-0.3)*pow(press,30.0)*0.00000005:0.0001;\n    //yvel += -iResolution.y*0.00001;\n    \n    float mul = press>1.9?0.01:-0.01;//+(0.004*sin(iTime));\n    xvel += (get_pixel(+1.0, 0.5).b-press)*mul;\n    xvel -= (get_pixel(-1.0, 0.5).b-press)*mul;\n    yvel += (get_pixel(0.5, +1.0).b-press)*mul;\n    yvel -= (get_pixel(0.5, -1.0).b-press)*mul;\n    /*\n    xvel += (get_pixel(+2.0, 0.0).b-press)*mul*0.5;\n    xvel -= (get_pixel(-2.0, 0.0).b-press)*mul*0.5;\n    yvel += (get_pixel(0.0, +2.0).b-press)*mul*0.5;\n    yvel -= (get_pixel(0.0, -2.0).b-press)*mul*0.5;*/\n    \n    xvel = clamp(xvel,-2.0,2.0);\n    yvel = clamp(yvel,-2.0,2.0);\n    press = gl_FragCoord.y>=iResolution.y-30.0?0.0:press;\n    \n    //if (iMouse.z > 0.0){\n    float mip = 0.0;\n    for(int i = 0; i<5; i++){\n        mip += 0.06*smoothstep(length(iResolution.xy)/100.0, 0.5, length(randompos(float(i))*iResolution.xy - fragCoord.xy))*3.0*((random()*0.1)+(0.1+press));\n        \n    }\n    \n    //yvel += mip*60.0;\n    press += mip*20.0;\n    \n        \n    fragColor.r = xvel*0.999;\n    fragColor.g = yvel*0.999;\n    fragColor.b = press*1.00;\n}","name":"Buf A","description":"","type":"buffer"}]}