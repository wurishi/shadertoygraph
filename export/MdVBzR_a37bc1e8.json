{"ver":"0.1","renderpass":[{"outputs":[{"channel":0,"id":"4dfGRr"}],"inputs":[{"channel":0,"type":"buffer","id":"4dXGR8","filepath":"/media/previz/buffer00.png","sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"}}],"code":"// This shader is a variation on\n// this tutorial:\n// https://gamedevelopment.tutsplus.com/tutorials/how-to-write-a-smoke-shader--cms-25587\n// I added color to the smoke and mirrored the image.\n\n// To change the colors, edit buffer B.\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // Normalized pixel coordinates (from 0 to 1)\n    vec2 uv = fragCoord/iResolution.xy;\n    vec2 reflection_uv = vec2(1.0 - uv.x, uv.y);\n    \n    vec4 color = texture(iChannel0, uv);\n    vec4 reflection = texture(iChannel0, reflection_uv);\n\n    // Output to screen\n    fragColor = color + reflection;\n}","name":"Image","description":"","type":"image"},{"outputs":[{"channel":0,"id":"4dXGR8"}],"inputs":[{"channel":0,"type":"buffer","id":"4dXGR8","filepath":"/media/previz/buffer00.png","sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"}},{"channel":1,"type":"buffer","id":"XsXGR8","filepath":"/media/previz/buffer01.png","sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"}}],"code":"#define RADIUS 12.0\n#define BLUR 20.0\n#define DENSITY 1.0\n#define PIXEL (vec2(1.0) / iResolution.xy)\n#define NEIGHBOR(offset) texture(iChannel0, uv + offset).rgb\n#define TIME_STEP (0.016)\n#define DIFFUSION_RATE 8.0\n#define MIN_FACTOR vec3(0.0003)\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // Normalized pixel coordinates (from 0 to 1)\n    vec2 uv = fragCoord/iResolution.xy;\n    vec2 mouse_uv = iMouse.xy / iResolution.xy;\n    \n    // Get the color from the previous frame\n    fragColor = texture(iChannel0, uv);\n    \n    // Generate smoke with the mouse\n    // Only do this if the mouse is clicked.\n    if (iMouse.z > 0.0) {\n    \tfloat dist = distance(fragCoord, iMouse.xy);\n    \tfloat mask = max(RADIUS - dist, 0.0);\n    \tvec3 density = texture(iChannel1, uv).rgb;\n    \tfragColor.rgb += mask * density;\n    }\n    \n    // Bottom row of pixels is only black and does not diffuse.\n    if (uv.y <= PIXEL.y) {\n        fragColor.rgb = vec3(0.0);\n        return;\n    }\n   \n    // Diffusion\n    vec3 right = NEIGHBOR(vec2(PIXEL.x, 0.0));\n    vec3 left = NEIGHBOR(vec2(-PIXEL.x, 0.0));\n    vec3 up = NEIGHBOR(vec2(0.0, -PIXEL.y));\n    vec3 down = NEIGHBOR(vec2(0.0, PIXEL.y));\n    vec3 neighbors = left + right + 3.0 * up + down;\n    vec3 me = fragColor.rgb;\n    vec3 diffusion_factor = DIFFUSION_RATE * TIME_STEP * (neighbors - 6.0 * me);\n    \n    // Handle precision issues component-by-component.\n    bvec3 too_small = lessThan(abs(diffusion_factor), MIN_FACTOR);\n    bvec3 negative = lessThan(diffusion_factor, vec3(0.0));\n    vec3 reset = vec3(too_small) * vec3(negative);\n    diffusion_factor = mix(diffusion_factor, -MIN_FACTOR, reset);\n    fragColor.rgb += diffusion_factor;\n}","name":"Buffer A","description":"","type":"buffer"},{"outputs":[{"channel":0,"id":"XsXGR8"}],"inputs":[{"channel":0,"type":"texture","id":"XdXGzn","filepath":"/media/a/3083c722c0c738cad0f468383167a0d246f91af2bfa373e9c5c094fb8c8413e0.png","sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"}}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord / iResolution.xy;\n    \n    // White smoke\n    //fragColor = vec4(1.0);\n    \n    // blue, green and cyan smoke\n    //fragColor = vec4(0.0, uv, 1.0);\n    \n    // red, green and yellow smoke\n    fragColor = vec4(uv, 0.0, 1.0);\n    \n    // Textured smoke\n    // Try switching out the texture!\n    //fragColor = texture(iChannel0, uv);\n}","name":"Buffer B","description":"","type":"buffer"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":true,"mFlagMusicStream":false},"info":{"id":"MdVBzR","date":"1527540680","viewed":204,"name":"Smoke 'n' Mirrors","username":"ptrgags","description":"Trying out this shader (https://gamedevelopment.tutsplus.com/tutorials/how-to-write-a-smoke-shader--cms-25587) except with more colors and some reflections.\n\nClick and drag on the canvas to add smoke to the room!","likes":3,"published":1,"flags":32,"usePreview":0,"tags":["smoke"],"hasliked":0,"parentid":"","parentname":""}}