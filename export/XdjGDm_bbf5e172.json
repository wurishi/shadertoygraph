{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[],"code":"\n#define STEPS 16\n//#define LIGHT_SPEED 1.5\n#define LIGHT_SPEED 0.5\n#define HARDNESS 2.0\n\nstruct ray {\n\tvec2 t;\n\tvec2 p;\n\tvec2 d;\n};\n\nfloat scene (in vec2 p) {\n\tp -= vec2 (400,250);\n\t\n\tfloat sn = sin (iTime / 2.0);\n\tfloat cs = cos (iTime / 2.0);\n\t\n\tfloat f1 = dot (vec2 (sn,-cs), p);\n\tfloat f2 = dot (vec2 (cs, sn), p);\n\tfloat f = max (f1*f1, f2*f2);\n\t\n\t//p += vec2 (sn + 0.5, cs) * 200.0;\n\tp -= iMouse.xy / iResolution.yy * vec2 (500, 500) - vec2 (400,250);\n\tf = min (f, dot (p, p) * 2.0);\n\t\n\treturn 1000.0 / (f + 1000.0);\n}\n\nray newRay (in vec2 origin, in vec2 target) {\n\tray r;\n\t\n\tr.t = target;\n\tr.p = origin;\n\tr.d = (target - origin) / float (STEPS);\n\t\n\treturn r;\n}\n\nvoid rayMarch (inout ray r) {\n\tr.p += r.d * clamp (HARDNESS - scene (r.p) * HARDNESS * 2.0, 0.0, LIGHT_SPEED);\n}\n\nvec3 light (in ray r, in vec3 color) {\n\treturn color / (dot (r.p, r.p) + color);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n\tvec2 uv = fragCoord.xy / iResolution.yy * vec2 (500, 500);\n\t\n\tray r0 = newRay (uv, vec2 (600, 250));\n\tray r1 = newRay (uv, vec2 (200, 250));\n\t\n\tfor (int i = 0; i < STEPS; i++) {\n\t\trayMarch (r0);\n\t\trayMarch (r1);\n\t}\n\t\n\tr0.p -= r0.t;\n\tr1.p -= r1.t;\n\t\n\tvec3 light1 = light (r0, vec3 (0.3, 0.2, 0.1) * 20000.0);\n\tvec3 light2 = light (r1, vec3 (0.1, 0.2, 0.3) * 10000.0);\n\t\n\tfloat f = clamp (scene (uv) * 200.0 - 100.0, 0.0, 3.0);\n\t\n\tfragColor = vec4 ((light1 + light2) * (1.0 + f), 1.0);\n\t//fragColor = vec4 (scene (uv));\n}\n\n\n\n\n\n\n\n\n\n","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"XdjGDm","date":"1389521708","viewed":3207,"name":"Light 2D","username":"DiLemming","description":"Click","likes":92,"published":1,"flags":0,"usePreview":0,"tags":["2d","shadow","light"],"hasliked":0,"parentid":"","parentname":""}}