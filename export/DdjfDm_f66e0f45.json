{"ver":"0.1","info":{"id":"DdjfDm","date":"1689785271","viewed":60,"name":"Diffusion Shamrock","username":"thedarkbunny","description":"Piecewise curves, because I couldn't find a better way.","likes":0,"published":1,"flags":32,"usePreview":0,"tags":["diffusion","practice"],"hasliked":0,"parentid":"cdSfDW","parentname":"Diffusion Figure Eight"},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"//it just grabs from the buffer\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord/iResolution.xy;   \n    fragColor = texture(iChannel0,uv);\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"#define DROP vec4(0.98,0.99,0.97,1.)\n#define DIFF_RATE vec4(0.6,0.9,0.3,1.)\n\n#define PI 3.1415927\n\nvec4 laplacian(in sampler2D buf, in vec2 target, in vec2 shift){\n    vec2 xr = shift*vec2(1.,0.);\n    vec2 yr = shift*vec2(0.,1.);\n    \n    vec4 lap = -texture(buf,target);\n    lap += (\n                    texture(buf,target+xr) +\n                    texture(buf,target-xr) +\n                    texture(buf,target+yr) +\n                    texture(buf,target-yr)\n                )*.2;\n    lap += (\n                    texture(buf,target+xr+yr) +\n                    texture(buf,target+xr-yr) +\n                    texture(buf,target-xr+yr) +\n                    texture(buf,target-xr-yr)\n                )*.05;\n    return lap;\n}\n\n\n\n\nfloat pattern_dist(vec2 ref, float time)\n{\n    vec2 p = vec2(abs(sin(time)),sin(time*2.)/2.) * 0.4;\n    float vel = length(vec2(cos(time)*2.,cos(time*2.)*2.));\n    \n    int cycle = int(time/PI)%4;\n    \n    if(cycle == 1){\n        p = vec2(-p.y,p.x);\n    }else if(cycle == 2){\n        p = -p;\n    }else if(cycle == 3){\n        p = vec2(p.y,-p.x);\n    }\n\n    float md = distance(p,ref);\n    \n    float inv_d = 1./(md+1.);\n    \n    \n    return smoothstep(1.-0.09/vel,1.,inv_d);\n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uva = (fragCoord - iResolution.xy*0.5)/min(iResolution.x,iResolution.y);\n    vec2 uvb = fragCoord/iResolution.xy;\n    \n    vec4 old_px = texture(iChannel0,uvb);\n    vec4 diffuse_px = laplacian(iChannel0,uvb,1./iResolution.xy);\n    \n    vec4 new_px = vec4(vec3(pattern_dist(uva,iTime*2.)),1.);\n    \n    fragColor = max(new_px+old_px*DROP+diffuse_px*DIFF_RATE,0.);\n}","name":"Buffer A","description":"","type":"buffer"}]}