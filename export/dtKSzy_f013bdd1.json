{"ver":"0.1","info":{"id":"dtKSzy","date":"1693264898","viewed":42,"name":"crying in one weekend","username":"artefox","description":"crying in one weekend","likes":0,"published":1,"flags":0,"usePreview":0,"tags":["cryinginoneweekend"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define MAXDIST 10000.0\n\nstruct ray {\n    vec3 o;\n    vec3 d;\n};\n\nstruct hit {\n    vec3 p;\n    vec3 n;\n    float t;\n};\n\nbool sphere_hit(ray r, vec4 s, float t_min, float t_max, hit h) {\n    vec3 oc = r.o - s.xyz;\n    float a = dot(r.d, r.d);\n    float half_b = dot(oc, r.d);\n    float c = dot(oc, oc) - s.w * s.w;\n\n    float d = half_b * half_b - a * c;\n    if(d < 0.0) return false;\n    float sqrtd = sqrt(d);\n\n    float root = (-half_b - sqrtd) / a;\n    if(root < t_min || t_max < root) {\n        root = (-half_b + sqrtd) / a;\n        if (root < t_min || t_max < root) return false;\n    }\n\n    h.t = root;\n    h.p = r.o + r.d * h.t;\n    h.n = (h.p - s.xyz) / s.w;\n\n    return true;\n}\n\n//bool hittable(ray r, float t_min, float t_max, hit h)\n\nvec3 ray_color(ray r) {\n    hit h;\n    sphere_hit(r, vec4(0.0, 0.0, -1.0, 0.5), 0.01, MAXDIST, h);\n    if(h.t > 0.0) {\n        vec3 n = normalize(r.o + r.d * h.t - vec3(0.0, 0.0, -1.0));\n        return 0.5 * vec3(n + 1.0);\n    }\n    h.t = 0.5 * (normalize(r.d).y + 1.0);\n    return mix(vec3(1.0), vec3(0.5, 0.7, 1.0), h.t);\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord) {\n    vec3 view = vec3(iResolution.x / iResolution.y * 2.0, 2.0, 1.0);\n    \n    vec3 orig = vec3(0.0);\n    vec3 hori = vec3(view.x, 0.0, 0.0);\n    vec3 vert = vec3(0.0, view.y, 0.0);\n    \n    vec3 lowr = orig - hori / 2.0 - vert / 2.0 - vec3(0.0, 0.0, view.z);\n    \n    vec2 uv = fragCoord / iResolution.xy;\n    ray r = ray(orig, lowr + uv.x * hori + uv.y * vert - orig);\n    \n    vec3 col = ray_color(r);\n    \n    fragColor = vec4(col, 1.0);\n}","name":"Image","description":"","type":"image"}]}