{"ver":"0.1","info":{"id":"csc3W8","date":"1677165297","viewed":135,"name":"sprite outline","username":"yunhai","description":"try better outline for sprite","likes":2,"published":1,"flags":32,"usePreview":0,"tags":["2d"],"hasliked":0,"parentid":"Ddj3RV","parentname":"Liu Kanshan"},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"//main part\nvec2 complexRot(vec2 a,vec2 b)\n{\n    return vec2(a.x*b.x-a.y*b.y,a.x*b.y+a.y*b.x);\n}\nvoid mainImage( out vec4 O, in vec2 I )\n{\n    O=texture(iChannel0,I/iResolution.xy);\n    /*\n    O.xyz=mix(vec3(.5),O.xyz,O.w);\n    return;\n    /**/\n    \n    float thick=7.+sin(iTime)*5.;\n    float otl=0.;\n    vec2 dir=vec2(1,0),roter=vec2(0.866,0.5);\n    for(int i=0;i<12;i++)//360/12 degree/times rotation\n    {\n        //dir=rot(dir,30.*DTA);\n        dir=complexRot(dir,roter);\n        otl+=texture(iChannel0,(I+dir*thick)/iResolution.xy).w;\n    }\n    otl=min(1.,otl);\n    vec3 otlCol=palette(iTime);\n    O.xyz=mix(otlCol*otl,O.xyz,O.w);\n    O.a=otl;//update a chennel\n    O.xyz=mix(vec3(.4,.7,1.)*.4,O.xyz,O.a);\n}","name":"Image","description":"","type":"image"},{"inputs":[],"outputs":[{"id":"4dXGR8","channel":0}],"code":"//RGBA Sprite\nfloat body(vec2 uv)\n{\n    vec2 huv=rot(uv,.17),euv=rot(uv,.22),buv=uv;\n    euv.y+=0.04;//off\n    euv.x*=sign(euv.x);\n    euv-=vec2(.16,.1);//mid dis\n    euv=abs(rot(euv,-.1)*vec2(2,1));//mirr rot\n    huv-=vec2(.14,0.);\n    huv*=vec2(1.,20.*huv.y/(.9-huv.x));\n    buv.x+=buv.y*buv.y*.1;\n    float h=S(.4,length(huv)),\n         b=S(.26,length(buv.x))*step(uv.y,0.),\n         e=S(.19,length(dot(euv,vec2(1))));\n    \n    return max(max(h,e),b);\n}\nfloat dbar(vec2 p,vec2 a,vec2 b)\n{\n    b=b-a;p=p-a;\n    return length(p-b*clamp(dot(p,b)/dot(b,b),0.,1.));\n}\nvoid mainImage( out vec4 O, in vec2 I )\n{\n    if(sin(sin(iTime*2.))<0.)\n        I.x=iResolution.x-I.x;//flip\n        \n    vec2 uv = (I-.5*iR)*P,suv=uv,e=vec2(0.,1.);\n    vec4 z=e.xxxx,o=1.-z;\n    //anim \n    uv+=vec2(.004*sin(max(.1,sin(iTime*2.))*10.),\n    .02*sin(iTime*2.+2.)+.18)+.1*vec2(sin(iTime),0.6*cos(iTime));\n\n    float body=body(uv);\n    O= mix(vec4(.4,.6,1,1),o,body);\n    //face\n    O=mix(O,z,min(body,\n    S(.2,length(uv-vec2(.5,.1)))));\n    float eye=S(.04,length(uv-vec2(0,.06)));\n    O=mix(O,z, eye);\n    //arm\n    uv+=.12;\n    uv=rot(uv,-1.+sin(iTime*10.)*.3);\n    vec2 se=e.yx*.2,hp=se*.8;\n    O=mix(O,z,S(.018,\n    min( dbar(uv,e.xx,se),\n         dbar(uv,hp,hp+vec2(.01,.03)))));\n\n    \n    O.w=max(0.,body-eye) ;\n    \n}","name":"Buffer A","description":"","type":"buffer"},{"inputs":[],"outputs":[],"code":"#define iR (iResolution.xy)\n#define P (1./iR.y)\n#define S(x,t) smoothstep(x,x-4.*P,t)\nconst float DTA=3.1415926/180.;\nconst float PI=3.1415;\nvec2 rot(vec2 uv,float t)\n{\n    float c=cos(t),s=sin(t);\n    return mat2x2(c,-s,s,c)*uv;\n}\nvec3 palette(float t)\n{\n    t*=1.732;\n    return vec3(.7)+vec3(.3)*cos(2.*PI*(vec3(.71,.31,.21)*t+vec3(.2,.4,.6)));\n}","name":"Common","description":"","type":"common"}]}