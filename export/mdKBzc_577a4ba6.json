{"ver":"0.1","info":{"id":"mdKBzc","date":"1698501170","viewed":130,"name":"28. Sparkle","username":"Ladus","description":"Inktober 2023 Day 28. Sparkles","likes":8,"published":1,"flags":0,"usePreview":0,"tags":["sparkle","inktober"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define aa 2./iResolution.y/2.\n\nfloat hash(float i) {\n    return (fract(fract(i*2345.234*i*23.23)*312.2134345+fract(((i+i)*2253.234)*2344.122))*2.) -1.;\n}\n\n// https://iquilezles.org/articles/distfunctions2d/\nfloat sdSegment( in vec2 p, in vec2 a, in vec2 b )\n{\n    vec2 pa = p-a, ba = b-a;\n    float h = clamp( dot(pa,ba)/dot(ba,ba), 0.0, 1.0 );\n    return length( pa - ba*h );\n}\nfloat visualizeVector(vec2 p, vec2 start, vec2 end) {\n    return smoothstep(0.+aa,0.-aa,sdSegment(p, start, end));\n}\n\nfloat visualizeCircle(vec2 p, vec2 point, float radius) {\n    return smoothstep(radius+aa, radius-aa, length(point-p));\n}\n\n\nfloat sparkle(vec2 p, vec2 start, vec2 end, float progression) {\n    float xLength = abs(end.x - start.x);\n    float relativeX = p.x - start.x;\n    p.y += (relativeX/xLength)*relativeX; // arch downwards\n    \n    float vLength = distance(start,end);\n    vec2 sparkP = (normalize(end-start) * vLength * progression)+start;\n    \n    float line = visualizeVector(p, start, end);\n    float spark = visualizeCircle(p, sparkP, 0.003);\n    \n    float distanceFromStart = pow(abs(1.-distance(p,sparkP)),5.);\n\n    return (line+spark)*distanceFromStart;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 p = (fragCoord - iResolution.xy*.5)/iResolution.y; // normalize space\n\n    vec3 col = vec3(0.);\n    float lightBoost = 1.;\n    for(float i = 0.; i < 1.; i += 0.01){\n        float time = fract(iTime/2.+hash(i));\n        time = clamp(sqrt(time),0.,1.);\n        float v = sparkle(p, vec2(0.,-0.3), vec2(1.*hash(i+2.32),0.5*hash(i)+0.5), time);\n        col += v * vec3(hash(i+3.2)+lightBoost,hash(i+3.114)+lightBoost,hash(i+2.12415)+lightBoost);\n    }\n\n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}