{"ver":"0.1","renderpass":[{"outputs":[{"channel":0,"id":"4dfGRr"}],"inputs":[{"channel":0,"type":"cubemap","id":"4sfGzn","filepath":"/media/a/793a105653fbdadabdc1325ca08675e1ce48ae5f12e37973829c87bea4be3232.png","sampler":{"filter":"mipmap","wrap":"clamp","vflip":"false","srgb":"false","internal":"byte"}}],"code":"mat2 rotate(float angle) {\nreturn mat2(cos(angle), -sin(angle), sin(angle), cos(angle));\n}\n\n\nfloat getTXY(vec3 p, float r, float minR) {\nfloat x = length(p.xy)-r;\nfloat y = p.z;\n\nreturn length(vec2(x, y))-minR;\n\n}\nfloat getTZY(vec3 p, float r, float minR) {\nfloat x = length(p.yz)-r;\nfloat y = p.x;\n\nreturn length(vec2(x, y))-minR;\n\n}\n\nfloat getLineTXY(vec3 p, vec3 a, vec3 b) {\nvec3 point = p-a;\nvec3 ab = b-a;\nfloat t = clamp(dot(point, ab)/dot(ab, ab), 0.0, 1.0);\nvec3 c = a+ab*t;\nreturn getTXY(p-c, 0.2, 0.02);\n}\n\nfloat getLineTZY(vec3 p, vec3 a, vec3 b) {\nvec3 point = p-a;\nvec3 ab = b-a;\nfloat t = clamp(dot(point, ab)/dot(ab, ab), 0.0, 1.0);\nvec3 c = a+ab*t;\nreturn getTZY(p-c, 0.2, 0.02);\n}\n\n\n\n\n\nfloat smoothMax(float a, float b, float k) { \nreturn log(exp(k*a)+exp(k*b))/k;\n}\n\nfloat smoothMin(float a, float b, float k) { \nreturn -smoothMax(-a, -b, k);\n}\n\n\n\n\n\n\nfloat getNewF(vec3 p, vec3 s) {\nvec3 q = abs(p)-s;\np=abs(p);\nif(abs(p.y-p.x) < 0.03)\n\tq.x=0.05;\nreturn length(max(q, 0.0));\n\n}\n\nfloat getLinesDist(vec3 p) {\nfloat lineTXY = getLineTXY(p, vec3(0.0, -0.8, 0.0), vec3(0.0, -0.8+0.3, 0.0));\nfloat lineTZY = getLineTZY(p, vec3(0.0, -0.8+0.65, 0.0), vec3(0.0, -0.15+0.3, 0.0));\nfloat lineTXY2 = getLineTXY(p, vec3(0.0, -0.8+0.65*2.0, 0.0), vec3(0.0, -0.8+0.65*2.0+0.3, 0.0));\nfloat lineTXY3 = getLineTXY(p, vec3(0.0, -0.8+0.65*4.0, 0.0), vec3(0.0, -0.8+0.65*4.0+0.3, 0.0));\nfloat lineTXY4 = getLineTXY(p, vec3(0.0, -0.8+0.65*6.0, 0.0), vec3(0.0, -0.8+0.65*6.0+0.3, 0.0));\nfloat lineTZY2 = getLineTZY(p, vec3(0.0, -0.8+0.65*3.0, 0.0), vec3(0.0, -0.8+0.65*3.0+0.3, 0.0));\nfloat lineTZY3 = getLineTZY(p, vec3(0.0, -0.8+0.65*5.0, 0.0), vec3(0.0, -0.8+0.65*5.0+0.3, 0.0));\nfloat lineTZY4 = getLineTZY(p, vec3(0.0, -0.8+0.65*7.0, 0.0), vec3(0.0, -0.8+0.65*7.0+0.3, 0.0));\nreturn min(min(lineTXY, min(lineTXY2, min(lineTXY3, lineTXY4))), min(lineTZY, min(lineTZY2, min(lineTZY3, lineTZY4))));\n}\nvec2 getDist(vec3 p) {\nvec3 linesPosition = p-vec3(0.0, -1.6, 2.0);\nlinesPosition.xz *= rotate(iTime);\nfloat material = 2.0;\nfloat lines = getLinesDist(linesPosition);\nreturn vec2(lines, material);\n}\n \nvec2 rayMarching(vec3 c, vec3 d) {\nfloat t=0.0;\nfloat material = 0.0;\nfor(int i=0; i<80; i++) {\nvec3 p = c+d*t;\nvec2 dist = getDist(p);\nt+=dist.x;\nif(t>100.0) break;\n\n}\nmaterial = getDist(c+d*t).y;\nreturn vec2(t, material);\n}\nvec3 getNormal(vec3 p) {\nvec2 e = vec2(0.01, 0.0);\nfloat d = getDist(p).x;\nvec3 n = d - vec3(\ngetDist(p-e.xyy).x,\ngetDist(p-e.yxy).x,\ngetDist(p-e.yyx).x\n);\n\nreturn normalize(n);\n}\n\nfloat getLight(vec3 p) {\nvec3 light = vec3(sin(iTime), 5.0, -4.0);\nvec3 ray = normalize(light-p);\nvec3 normal = getNormal(p);\nfloat diff = clamp(dot(ray, normal), 0.0, 1.0);\nfloat d = rayMarching(p+normal*0.01, ray).x;\nif(d < length(light-p)) \n\tdiff*=0.1;\nreturn diff;\n}\n\n\n\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 uv= 2.0 * fragCoord / iResolution.xy - vec2(1.0,1.0);\n\tuv.x *= iResolution.x / iResolution.y;\n\tvec3 col = vec3(0.0);\n\tvec3 c = vec3(0.0, 0.0, -3.0);\n\tvec3 d = normalize(vec3(uv.x, uv.y, 2.0));\n\tvec2 t = rayMarching(c, d);\n\tvec3 p = c+d*t.x;\n    vec3 ref = reflect(d, getNormal(p));\n    vec3 text = texture(iChannel0, ref).rgb;\n    if(t.y==2.0)\n\t\tcol = vec3(getLight(p)*text);\n    \n\tfragColor = vec4(col, 1.0);\n}\n\n","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"4Xccz4","date":"1734774080","viewed":61,"name":"Test chain","username":"byname777","description":"Test chain","likes":3,"published":1,"flags":0,"usePreview":0,"tags":["test"],"hasliked":0,"parentid":"","parentname":""}}