{"ver":"0.1","info":{"id":"7dB3zt","date":"1617812078","viewed":153,"name":"Underwater Julia fractal marcher","username":"seven_dc","description":"Testing raymarcher to render julia fractal","likes":1,"published":1,"flags":0,"usePreview":0,"tags":["juliaraymarcher"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define MAX_STEPS 10\n#define MAX_DIST 10.\n#define SURF_DIST .1\n\nfloat julia( vec2 p, float time )\n{\n\tfloat ltime = 0.5-0.5*cos(time*0.26);\n    float zoom = pow( 0.9, 50.0*ltime );\n\tvec2 cen = vec2( 0.2655,0.301) + zoom*1.8;//*cos(4.0+2.0*ltime); \n\tvec2 c = vec2( -0.745, 0.186 ) - 0.045*zoom*(1.0-ltime*0.5);\n\tvec2 z = cen + (p-cen)*zoom;\n   \n\tvec2 dz = vec2( 1.0, 0.0 );\n\tfor( int i=0; i<60; i++ )\n\t{\n\t\tdz = 2.0*vec2(z.x*dz.x-z.y*dz.y, z.x*dz.y + z.y*dz.x );\n        z = vec2( z.x*z.x - z.y*z.y, 2.0*z.x*z.y ) + c;\n\t\tif( dot(z,z)>200.0 ) break;\n\t}\n\tfloat d = sqrt( dot(z,z)/dot(dz,dz) )*log(dot(z,z));\n    \n\treturn sqrt( clamp( (1.0/zoom)*d, 0.0, 1.0 ) );\n}\n\nfloat GetDistance(vec3 point) {\n    return julia(vec2(point.x,point.y), point.z+iTime);\n}\n\nfloat RayMarch(vec3 rayOrgin, vec3 rayDirection) {\n\tfloat distance=0.;\n    \n    int steps = MAX_STEPS; \n    \n    for(int i=0; i<steps; i++) {\n    \tvec3 point = rayOrgin + rayDirection * distance;\n        float surfaceDistance = GetDistance(point);\n        distance += surfaceDistance;\n        // Stop marching if we go too far or we are close enough of surface\n        if(distance>MAX_DIST || surfaceDistance<SURF_DIST) break;\n    }\n    \n    return distance;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // put 0,0 in the center\n    vec2 uv = (fragCoord-.5*iResolution.xy)/iResolution.y;\n       \n    // camera   \n    vec3 rayOrgin = vec3(0, 1, 0);\n    vec3 rayDirection = normalize(vec3(uv.x, uv.y, 1));\n\n    float d = RayMarch(rayOrgin, rayDirection);\n    \n    vec3 col = vec3(d/100.,d/15.+uv.y,d/5.);\n    \n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}