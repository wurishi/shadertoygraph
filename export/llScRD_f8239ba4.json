{"ver":"0.1","info":{"id":"llScRD","date":"1507817326","viewed":1378,"name":"Pretty Hip (Visualiser)","username":"Hadyn","description":"Definitely some squares. Now with music! Also includes some fixes/improvements suggested by Fabrice Neyret.","likes":7,"published":1,"flags":96,"usePreview":0,"tags":["2d","musicvisualiser"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define SIZE 6.0\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{ \n    vec2 uv = ( fragCoord -.5*  iResolution.xy ) / iResolution.x;\n    uv *= mat2(1,1,-1,1)/sqrt(0.3+0.1*texture(iChannel0, vec2(0.0), 1.0).x); \n    uv += .5;\n    \n    vec2 pos = SIZE*uv;\n    vec2 rep = fract(pos);\n    rep = min(rep,1.-rep);\n    float dist = 2.*min(rep.x,rep.y);\n    float squareDist = length((floor(pos)+vec2(0.5)) - vec2(0.5*SIZE) );\n    \n    float edge = 10.0*texture(iChannel0, vec2(1.0-squareDist*0.1)).x;\n    edge = 2.0*fract(edge*0.5);\n    float value = fract (dist*2.0);\n    value = edge < 1. ? value : 1.-value;\n    edge = pow(abs(1.0-edge), 2.0);\n    \n    value = smoothstep( edge-0.05, edge, 0.95*value);    \n    \n    value += squareDist*.05;\n    value = clamp(value, 0.0, 1.0);\n    float colMix = texture(iChannel0, vec2(1.0-squareDist*0.1), 1.0).x;\n    fragColor = mix(vec4(1,0,1,1), vec4(0,1,1,1), colMix) + value;\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XslSDl","filepath":"https://soundcloud.com/hadyn/pretty-hip","previewfilepath":"https://soundcloud.com/hadyn/pretty-hip","type":"musicstream","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":0}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"// Borrowed this snippet from s23b's beautiful Blueprint of the Architekt visualiser: https://www.shadertoy.com/view/4tySDW\n// the purpose of this buffer is too smooth out the sudden changes in the fft\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord.xy / iResolution.xy;\n    float old = texture(iChannel1, uv).x;\n    float new = texture(iChannel0, uv).x;\n    fragColor = vec4(mix(old, new, new > old ? .5 : .02));\n}","name":"Buf A","description":"","type":"buffer"}]}