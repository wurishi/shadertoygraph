{"ver":"0.1","info":{"id":"llcBz7","date":"1539029696","viewed":388,"name":"Gradient Rain","username":"khlorghaal","description":"  ","likes":4,"published":1,"flags":0,"usePreview":0,"tags":["distortion","postprocess"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dfGRn","filepath":"/media/a/8de3a3924cb95bd0e95a443fff0326c869f9d4979cd1d5b6e94e2a01f5be53e9.jpg","previewfilepath":"/media/ap/8de3a3924cb95bd0e95a443fff0326c869f9d4979cd1d5b6e94e2a01f5be53e9.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4sfGRr","filepath":"/media/a/27012b4eadd0c3ce12498b867058e4f717ce79e10a99568cca461682d84a4b04.bin","previewfilepath":"/media/ap/27012b4eadd0c3ce12498b867058e4f717ce79e10a99568cca461682d84a4b04.bin","type":"volume","channel":1,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"float lum(vec3 rgb){\n\treturn dot(rgb,vec3(0.299, 0.587, 0.114));\n}\nfloat depthf(vec2 uv){\n    uv.x*= 5.;//thin\n    \n    float bglum= lum(texture(iChannel0, uv).rgb);\n    float gravity= mod(iTime*.2,1.);\n    uv.y+= gravity;\n    \n    vec3 uvB= vec3(uv, iTime*.1 );\n    uvB.xy*= 1.2;\n        \n    float water= 0.;\n    water+= lum(texture(iChannel1,uvB          ).rgb)*1.;//octaves\n    water+= lum(texture(iChannel1,uvB*vec3( 8.)).rgb)*.3;//also mul z for parallax\n    water+= lum(texture(iChannel1,uvB*vec3(10.)).rgb)*.25;\n    water/= 1.35;\n    \n    water= sqrt(1.-water*water);\n\treturn water;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ){\n    vec2 uv= fragCoord/iResolution.xy;\n    \n    float d= 0.01;\n    float d0= depthf(uv);\n    float thresh= .98;\n    if(d0>thresh){\n\t    fragColor= texture(iChannel0, uv);\n    \t//fragColor= vec4(1.);\n        return;\n\t}\n    \n    vec2 grad= (vec2(\n    \tdepthf(uv+vec2(d,0)),\n        depthf(uv+vec2(0,d))\n    )-d0)/d;\n    vec3 norm= normalize(1.-vec3(grad.xy,0.));\n    \n    float shine= max(0., reflect(normalize(vec3(1.)), norm).z )*.1;\n    \n    uv+= refract(vec3(0.,0.,1.), norm, .5).xy*.01;\n    \n    vec3 col= texture(iChannel0, uv).rgb;\n    col= pow(col,vec3(1./2.2));//gamma\n    \n    col+= shine;\n    \n    col= pow(col,vec3(2.2));\n    fragColor= vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}