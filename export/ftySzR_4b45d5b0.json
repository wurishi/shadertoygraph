{"ver":"0.1","info":{"id":"ftySzR","date":"1640066157","viewed":2571,"name":"270char fluid","username":"davidar","description":"[url=https://twitter.com/david_ar/status/1473611601626341376]Fluid simulation implemented in one tweet[/url]\n\nTakes a few seconds to start. Remove the indicated line in Buffer A to reduce the character count.","likes":40,"published":3,"flags":32,"usePreview":0,"tags":["simulation","fluid","convolution","2tweets","golf"],"hasliked":0,"parentid":"7t3SDf","parentname":"Simplest detailed fluid"},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"nearest","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"M-1.+A.z;}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"nearest","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"M;\n  for(int k=0; k++<196; v = A.xy+i, r += vec4(v-i + v-v*A.z,1,1) * A.z / exp(dot(v,v)) / 3.142)\n    i = vec2(k%14,k/14)-7.;\n  //r.z > 0. ? r.xy /= r.z : u; // slightly more accurate, but slightly longer and slightly more buggy on some devices\n  r.xy /= r.z + 1e-6; // add epsilon to avoid division by zero\n\n  iFrame%500<2 ? r += vec4(u/1e3-.5\n      * iResolution.xy/1e3 // this line can safely be removed when the resolution is >500px\n      ,.3,0) : r;\n}","name":"Buffer A","description":"","type":"buffer"},{"inputs":[],"outputs":[],"code":"#define M void mainImage(out vec4 r, vec2 u) { vec2 v, i = u-u; r -= r//\n#define A texelFetch(iChannel0,ivec2(i+u),0)","name":"Common","description":"","type":"common"}]}