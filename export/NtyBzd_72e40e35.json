{"ver":"0.1","info":{"id":"NtyBzd","date":"1665008970","viewed":137,"name":"hyperbolic band model","username":"panic","description":"the hyperbolic plane in the band model.  the plane is tiled by 336 colored triangles.","likes":16,"published":1,"flags":0,"usePreview":0,"tags":["hyperbolicgeometry"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"const int P[8] = int[]( 0, 6, 5, 3, 7, 2, 1, 4 );\nconst int R[8] = int[]( 1, 3, 0, 4, 7, 2, 5, 6 );\nconst int R4[8] = int[]( 7, 6, 4, 5, 2, 3, 1, 0 );\nconst int L[8] = int[]( 2, 0, 5, 1, 3, 6, 7, 4 );\nvec2 cmul(vec2 a, vec2 b)\n{\n    return vec2(a.x * b.x - a.y * b.y, a.x * b.y + a.y * b.x);\n}\nvec2 cdiv(vec2 a, vec2 b)\n{\n    float b2 = dot(b, b);\n    return vec2(dot(a, b), a.y * b.x - a.x * b.y) / b2;\n}\nvec2 ctanh(vec2 z)\n{\n    float d = cosh(2.*z.x) + cos(2.*z.y);\n    return vec2(sinh(2.*z.x), sin(2.*z.y)) / d;\n}\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = (fragCoord - iResolution.xy * 0.5) / (iResolution.y * 0.5);\n    vec2 mouse = (iMouse.xy - iResolution.xy * 0.5) / (iResolution.y * 0.5);\n    if (iMouse.xy == vec2(0))\n        mouse = vec2(0);\n    ivec3 code = ivec3(0, 1, 2);\n    uv = ctanh(uv*0.785);\n    mouse = ctanh(mouse*0.784);\n    uv = cdiv(uv - mouse, cmul(mouse * vec2(-1, 1), uv) + vec2(1, 0));\n    float w = 0.3646;\n    float b = (-2. * w) / (w * w + 1.);\n    for (int i=0; i<32; ++i) {\n        if (uv.x < 0.) {\n            uv = -uv;\n            code.x = R4[code.x];\n            code.y = R4[code.y];\n            code.z = R4[code.z];\n        }\n        float slope = uv.y / uv.x;\n        if (slope > 0.4143) {\n            uv = vec2(\n                uv.x * 0.7071 + uv.y * 0.7071,\n                uv.x * -0.7071 + uv.y * 0.7071\n            );\n            code.x = R[code.x];\n            code.y = R[code.y];\n            code.z = R[code.z];\n        }\n        if (slope < -0.4143) {\n            uv = vec2(\n                uv.x * 0.7071 + uv.y * -0.7071,\n                uv.x * 0.7071 + uv.y * 0.7071\n            );\n            code.x = L[code.x];\n            code.y = L[code.y];\n            code.z = L[code.z];\n        }\n        if (dot(uv - vec2(w, 0), vec2(1, 0) - w * uv) > 0.) {\n            uv = -cdiv(uv + vec2(b, 0), b * uv + vec2(1, 0));\n            code.x = P[code.x];\n            code.y = P[code.y];\n            code.z = P[code.z];\n        }\n    }\n    fragColor = vec4(vec3(code)/7., 1);\n}","name":"Image","description":"","type":"image"}]}