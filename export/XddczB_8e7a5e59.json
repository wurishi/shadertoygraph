{"ver":"0.1","info":{"id":"XddczB","date":"1519404606","viewed":373,"name":"what does kifs stand for?","username":"wyatt","description":"learned how to ray march today","likes":17,"published":1,"flags":0,"usePreview":0,"tags":["raymarching","kifs"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"mat3 rot (vec3 s) {\n    float \tsa = sin(s.x),\n        ca = cos(s.x),\n        sb = sin(s.y),\n        cb = cos(s.y),\n        sc = sin(s.z),\n        cc = cos(s.z);\n    return mat3 (\n        vec3(cb*cc, -cb*sc, sb),\n        vec3(sa*sb*cc+ca*sc, -sa*sb*sc+ca*cc, -sa*cb),\n        vec3(-ca*sb*cc+sa*sc, ca*sb*sc+sa*cc, ca*cb)\n    );\n}\nmat3 mm;\nfloat map (vec3 p) {\n    float a = 5.5;\n    for (int i = 0; i < 6; i++) {\n        p = mm*(abs(p)-a);\n        a *= 0.5;\n    }\n    return length(max(abs(p)-.1,0.))-0.05;\n}\nvec3 norm (vec3 p) {\n    vec2 e = vec2 (.001,0.);\n    return normalize(vec3(\n        map(p+e.xyy) - map(p-e.xyy),\n        map(p+e.yxy) - map(p-e.yxy),\n        map(p+e.yyx) - map(p-e.yyx)\n    ));\n}\nvec3 dive (vec3 p, vec3 d) {\n    for (int i = 0; i < 30; i++) {\n        p += d*map(p);\n    }\n    return p;\n}\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ){\n    vec2 vv = fragCoord.xy/iResolution.xy*2.-1.;\n    vv.x *= iResolution.x/iResolution.y;\n    float ui = float(iFrame);\n    vec3 r = vec3(0.,0.,-30.);\n    vec3 d = normalize(vec3(vv,2));\n    mat3 m = rot(0.003*ui*vec3(1,1,1));\n    mm = rot(0.005*ui*(vec3(0,1,2)));\n    r = m*r;\n    d = m*d;\n    vec3 p = dive(r,d);\n    vec3 light = vec3(10);\n    d = normalize(p - light);\n    p += 0.01*d;\n    bool sh = length(dive(p,d))<100.;\n    float b = (sh?0.4:1.)*(dot(normalize(reflect(r-p,norm(p))),m*vec3(-1,0,0)));\n\n    fragColor = vec4(\n        length(p-r)>50.?vec3(vv,1):vec3((2.*b*b)/(1.+0.01*length(p-light))*\n                                              (norm(p)*0.5+0.5)\n                                             )\n        ,1);\n}\n","name":"Image","description":"","type":"image"}]}