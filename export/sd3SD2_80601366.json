{"ver":"0.1","info":{"id":"sd3SD2","date":"1633964762","viewed":268,"name":"Steinmetz Tricylinder","username":"Xor","description":"The 3D shape generated from projecting 3 circles across each XYZ axis is not as round as you might think. ","likes":25,"published":1,"flags":0,"usePreview":0,"tags":["3d","sdf","steinmetz","tricylinder"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"//Anti-Aliasing level\n#define AA 2\n\n//SDF epsilon\n#define EPS 1e-4\n//z-far clipping plane\n#define MAX 3.\n\nfloat dist(vec3 p)\n{\n    float t = iTime*.5;\n    float a = min(fract(t)/.9,1.);\n    //Quintic interpolion\n    a *= a*a*(a*(a*6.-15.)+10.) * 1.57;\n    \n    //Rotation\n    mat2 r = mat2(cos(a),sin(a),-sin(a),cos(a));\n    vec3 m = p;\n    //Swap axis of rotation\n    mod(t,2.)>1.? m.xz*=r : m.zy*=r;\n    return max(length(m.xy),max(length(m.yz),length(m.zx)))-.5;\n}\n//Classic tetrahedronal normals\nvec3 normal(vec3 p)\n{\n    vec2 n = vec2(2,-2)*EPS;\n    return normalize(dist(p+n.xxy)*n.xxy+\n    dist(p+n.xyx)*n.xyx+dist(p+n.yxx)*n.yxx+dist(p+n.y)*n.y);\n}\n//Basic raymarcher\nvec4 march(vec3 p,vec3 r)\n{\n    vec4 m = vec4(p+r,1);\n    for(int i = 0;i<99;i++)\n    {\n        float s = dist(m.xyz);\n        m += vec4(r,1)*s;\n        \n        if (s<EPS || m.w>MAX) return m;\n    }\n    return m;\n}\nvoid mainImage(out vec4 color, in vec2 coord)\n{\n    vec3 col = vec3(0);\n    \n    for(int X = 0;X<=AA;X++)\n    for(int Y = 0;Y<=AA;Y++)\n    {\n        //Centered/scaled coordinates\n        vec2 c = coord+vec2(X,Y)/float(AA)-.5-.5*iResolution.xy;\n        c /= iResolution.y*.9;\n        //Ray direction\n        vec3 r = vec3(0,0,1);\n        //March along orthographic lines\n        vec4 m = march(vec3(c,-2),r);\n        //Get normal\n        vec3 n = normal(m.xyz);\n        \n        //Dot for rim lighting\n        float d = dot(n,r);\n        //Light colors\n        vec3 l = n.gbr*.5+.5;\n        //Add AA sample\n        col += m.w>MAX?vec3(.5)-.2*length(c):mix(l,vec3(1),.5*exp(-6.*d*d));\n    }\n    col /= float((AA+1)*(AA+1));\n    color = vec4(col*col,1);\n}","name":"Image","description":"","type":"image"}]}