{"ver":"0.1","info":{"id":"mltcWS","date":"1699611491","viewed":34,"name":"envmap","username":"szabolcsdombi","description":"envmap","likes":3,"published":1,"flags":0,"usePreview":0,"tags":["envmap"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"float checker(vec2 v, float unit) {\n    float check = (int(floor(v.x / unit)) + int(floor(v.y / unit))) % 2 == 0 ? 1.0 : 0.0;\n    return check;\n}\n\nfloat wave(float x, float s, float t, float m) {\n   return sin(x * s + t) * m + m;\n}\n\nvec3 aces(vec3 x) {\n    const float a = 2.51;\n    const float b = 0.03;\n    const float c = 2.43;\n    const float d = 0.59;\n    const float e = 0.14;\n    return clamp((x * (a * x + b)) / (x * (c * x + d) + e), 0.0, 1.0);\n}\n\nconst float pi = 3.14159265;\n\nvec3 sample_envmap(vec2 uv) {\n    if (uv.x < -1.0 || uv.y < -1.0 || uv.x > 1.0 || uv.y > 1.0) {\n        return vec3(0.0);\n    }\n    vec2 a = uv * vec2(pi, pi * 0.5);\n    vec2 plane = vec2(cos(a.x) * cos(a.y), sin(a.x) * cos(a.y)) / sin(a.y);\n    float c = sin(plane.x * 3.1 + 4.0) * sin(plane.y * 2.8 + 0.7) * sin(plane.y * 1.7 - 1.2) * sin(plane.x * 1.4 - 4.0);\n\n    vec3 color = vec3(0.0);\n    if (uv.y > 0.0) {\n        color = mix(vec3(0.8, 0.8, 1.0), vec3(0.1, 0.2, 0.8), uv.y);\n        float w = wave(a.x, 3.0, 0.7, 0.05) + wave(a.x, 5.0, 1.0, 0.03) + wave(a.x, 12.0, 0.0, 0.01);\n        if (uv.y < w) {\n            color = mix(vec3(0.5, 0.5, 0.5), vec3(0.6, 0.6, 0.6), smoothstep(w * w, w * w + 0.05, uv.y * 0.5));\n        } else {\n            color = mix(color, vec3(1.0, 1.0, 1.0), smoothstep(-0.3, 0.7, c));\n        }\n    } else {\n        color = mix(vec3(0.4, 1.0, 0.2), vec3(0.4, 1.0, 0.2) * 0.8, checker(plane, 0.5));\n        color = mix(color, vec3(0.5, 0.5, 0.5), min(length(plane) * 0.1, 1.0));\n    }\n    return aces(color);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord/iResolution.xy * 2.0 - 1.0;\n    uv.x = mod(uv.x + iTime * 0.1, 2.0) - 1.0;\n    vec3 color = sample_envmap(uv);\n\n    fragColor = vec4(pow(color, vec3(1.0 / 2.2)), 1.0);\n}","name":"Image","description":"","type":"image"}]}