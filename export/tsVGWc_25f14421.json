{"ver":"0.1","info":{"id":"tsVGWc","date":"1571192680","viewed":152,"name":"vector field renderer","username":"zzggbb","description":"render a vector field\nmouse the mouse around!","likes":4,"published":1,"flags":0,"usePreview":0,"tags":["field","vector"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"//#define FIELD fox_rabbit_field\n#define FIELD boring_field\n\nvec2 boring_field(vec2 p) {\n\treturn vec2(1.0, 1.0);\n}\nvec2 fox_rabbit_field(vec2 p) {\n    float r = 1.0;\n    float a = 1.0;\n    float b = 1.0;\n    float m = 5.0;\n    \n\treturn vec2(\n        r*p.x - a*p.y*p.x,\n    \tb*p.y*p.x - m*p.y\n    );\n}\nvec2 neighbor(vec2 p, float dist) {\n\tvec2 u = p / length(p);\n    return p - u * dist;\n}\nvec2 uniform_region(vec2 p, float density) {\n\treturn floor(p*density)/density + vec2(.5)/density;\n}\nvec2 strange_region(vec2 p, float density) {\n\tvec2 f = FIELD(p);\n    vec2 d = f - p;\n    vec2 u = d / length(d);\n    return p + u / density;\n}\nfloat sd_line(vec2 p, vec2 a, vec2 b) {\n    vec2 pa = p-a, ba = b-a;\n    float h = clamp(dot(pa,ba)/dot(ba,ba), 0.0, 1.0);\n    return length(pa - ba*h);\n}\nvec2 screen(vec2 pixel) {\n    vec2 uv = pixel/iResolution.xy;\n    uv -= vec2(.3, .5);\n    uv.x *= (iResolution.x/iResolution.y);\n    uv *= 4.0;\n    return uv;\n}\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord){\n\tvec2 uv = screen(fragCoord);\n    vec2 muv = screen(iMouse.xy);\n    \n    vec2 c = uniform_region(uv, length(uv - muv));\n    c = strange_region(c, 20.0);\n    float dist = sd_line(uv, c, c + FIELD(c));\n    \n    float col;\n    if (dist < 0.005)\n        col = 1.0;\n    else\n        col = 0.0;\n\n    // Output to screen\n    fragColor = vec4(vec3(col),1.0);\n}","name":"Image","description":"","type":"image"}]}