{"ver":"0.1","info":{"id":"3lBBWz","date":"1598611121","viewed":280,"name":"bokeh blur","username":"Stephen_epa","description":"bokeh blur and golden angle sample","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["postprocessing"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XdfGRn","filepath":"/media/a/e6e5631ce1237ae4c05b3563eda686400a401df4548d0f9fad40ecac1659c46c.jpg","previewfilepath":"/media/ap/e6e5631ce1237ae4c05b3563eda686400a401df4548d0f9fad40ecac1659c46c.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define IterSize 64\n#define GoldenAngle 2.399996 // rad\n\nmat2 rot(float a)\n{\n    float c = cos(a);\n    float s = sin(a);\n    return mat2(c, s, -s, c);\n}\n\nvec3 bokeh(in sampler2D tex, in vec2 uv, in vec2 pixelsize, in float radius)\n{\n    vec3 total = vec3(0.);\n    vec3 divsor = vec3(0.);\n    float r = 1.;\n    mat2 G = rot(GoldenAngle);\n    vec2 offset = vec2(radius, 0.);\n    for (int i = 0; i < IterSize; ++i) {\n        r += 1./r;\n        offset = G * offset;\n        vec3 col = texture(tex, uv + offset * (r - 1.) * pixelsize).rgb;\n        vec3 bokeh = pow(col, vec3(4.));\n        total += col * bokeh;\n        divsor += bokeh;\n    }\n    return total / divsor;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord/iResolution.xy;\n    float scale = 3.;\n\tfloat ctrl_r = iMouse.x / iResolution.x * scale;\n \tctrl_r += fract(iTime * .1) * scale;\n    ctrl_r = mod(ctrl_r, scale);\n    vec3 col = bokeh(iChannel0, uv, 1./iResolution.xy, ctrl_r);\n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}