{"ver":"0.1","info":{"id":"wl2GD3","date":"1561405984","viewed":127,"name":"Noise through Voronoi Iterations","username":"badjano","description":"Visualization of noise through voronoi iterations using hashes","likes":1,"published":1,"flags":0,"usePreview":0,"tags":["voronoi","noise"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define sqrt2 pow(2.0,0.5)\n#define pi 3.141592\n\nvec3 hash23( vec2 p )\n{\n    vec3 q = vec3( dot(p,vec2(127.1,311.7)), \n\t\t\t\t   dot(p,vec2(371.9,183.3)), \n\t\t\t\t   dot(p,vec2(419.2,269.5)) );\n\treturn fract(sin(q)*43758.5453);\n}\n\nfloat voronoise( in vec2 p)\n{\n    vec2 i = floor(p);\n    vec2 f = fract(p);\n    \n\tvec2 a = vec2(0.0,0.0);\n    \n    float cycle = round(sin(iTime)*20.+22.);\n    cycle = 100.;\n    float inv_cycle = 1.0/cycle;\n\n    for( int y=-2; y<=2; y++ )\n    for( int x=-2; x<=2; x++ )\n    {\n        vec2  g = vec2( x, y );\n        vec2 ig = i + g;\n        ig = fract(ig*inv_cycle)*cycle;\n\t\tvec3  rand = hash23( ig );\n        rand = 0.5+0.5*sin(iTime+5.038*rand);\n\t\tvec2  d = g - f + rand.xy;\n\t\tfloat w = 1.0-smoothstep(0.0,sqrt2,length(d));\n\t\ta += vec2(rand.z*w,w);\n    }\n\t\n    return a.x/a.y;\n}\n\nfloat voronoi(vec2 p) {\n    vec2 n = floor(p);\n    vec2 f = fract(p);\n    float md = 5.0;\n    vec2 m = vec2(0.0);\n    const int _size = 1;\n    for (int i = -_size;i<=_size;i++) {\n        for (int j = -_size;j<=_size;j++) {\n            vec2 g = vec2(i, j);\n            vec2 o = hash23(n+g).xy;\n            o = 0.5+0.5*sin(iTime+5.038*o);\n            vec2 r = g + o - f;\n            float d = pow(dot(r, r),0.5);\n            md = min(d,md);\n            m = min(m,n+g+o);\n        }\n    }\n    return 1.0-md;\n}\n\nfloat fbm(in vec2 p){\n    float a = 30.0;\n    float b = 0.5;\n    float r = 0.0;\n    int iter = 10;\n    for (int i=0;i<iter;i++){\n        if (mod(iTime,4.)<2.){\n            r += voronoi(a*p)*b;\n        } else {\n            r += voronoise(a*p)*b;\n        }\n        b *= 0.5;\n        a *= 2.0;\n    }\n    return r;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 uv = fragCoord / iResolution.xy;\n    uv += iMouse.xy / iResolution.xy;\n    \n    \n    float f = fbm(uv);\n    \n    \n\tfragColor = vec4( f, f, f, 1.0 );\n}","name":"Image","description":"","type":"image"}]}