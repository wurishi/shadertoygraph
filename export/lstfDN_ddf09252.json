{"ver":"0.1","info":{"id":"lstfDN","date":"1588528684","viewed":77,"name":"experiment - negative light","username":"Azorlogh","description":"click to place the negative and positive light sources","likes":1,"published":1,"flags":0,"usePreview":0,"tags":["test"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"struct Ray {\n\tvec2 pos;\n\tvec2 dir;\n};\n\nstruct Sphere {\n\tvec2 pos;\n\tfloat rad;\n};\n\nbool hitSphere(Ray R, Sphere S, float m) {\n\tvec2 toSphere = S.pos-R.pos;\n\tfloat d = dot(toSphere, R.dir);\n\tif (d < 0. || length(toSphere) < S.rad) {\n\t\treturn false;\n\t}\n\tfloat dist = sqrt(length(toSphere)*length(toSphere) - d*d);\n\tif (dist < S.rad && d+sqrt(S.rad*S.rad-dist*dist)<m) {\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nvec2 uvToWorld(vec2 pos) {\n\tpos = ( pos - iResolution.xy/2. ) / (iResolution.y/2.);\n    return pos*0.8;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 pos = uvToWorld(fragCoord);\n    \n    vec3 col;\n    \n    Sphere s = Sphere(vec2(.0), .2);\n\tSphere s2 = Sphere(vec2(.0,.5), .2);\n    \n    float time = iTime+1.0;\n\n    vec2 l;\n    vec2 d;\n    if (iMouse.xy == vec2(0)) {\n        l = vec2(1,0);\n    } else {\n        l = uvToWorld(iMouse.xy);\n    }\n    if (iMouse.z <= 0.0 || iMouse.w > 0.0) {\n        d = vec2(cos(time)+cos(time*1.618033),sin(time)+sin(time*1.618033));\n    } else {\n    \td = uvToWorld(abs(iMouse.zw));\n    }\n\n    Ray ray;\n    \n\tvec2 toLight = l-pos;\n\tray = Ray(pos, normalize(toLight));\n    if (!hitSphere(ray, s, length(toLight)) && !hitSphere(ray, s2, length(toLight))) {\n\t\tcol += vec3(0.2/pow(length(pos-l),0.4));\n    }\n    \n    vec2 toDark = d-pos;\n\tray = Ray(pos, normalize(toDark));\n    if (!hitSphere(ray, s, length(toDark)) && !hitSphere(ray, s2, length(toDark))) {\n\t\tcol -= vec3(0.2/pow(length(pos-d),0.4));\n    }\n\n    if (length(pos-s.pos) < s.rad) {\n\t\tcol *= vec3(1,0,0);\n\t}\n\tif (length(pos-s2.pos) < s2.rad) {\n\t\tcol *= vec3(1,0,0);\n\t}\n\t\n    \n    col = tanh(col)*.5+.5;\n\n\tfragColor = vec4(col, 1);\n}\n","name":"Image","description":"","type":"image"}]}