{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[],"code":"#define C0 32.703*0.5\n#define CS0 34.648*0.5\n#define D0 36.708*0.5\n#define DS0 38.891*0.5\n#define E0 41.203*0.5\n#define F0 43.654*0.5\n#define FS0 46.249*0.5\n#define G0 48.999*0.5\n#define GS0 51.913*0.5\n#define A0 55.0*0.5\n#define AS0 58.270*0.5\n#define B0  61.735*0.5\n#define C1 32.703\n#define CS1 34.648\n#define D1 36.708\n#define DS1 38.891\n#define E1 41.203\n#define F1 43.654\n#define FS1 46.249\n#define G1 48.999\n#define GS1 51.913\n#define A1 55.0\n#define AS1 58.270\n#define B1  61.735\n#define C2 32.703*2.0\n#define CS2 34.648*2.0\n#define D2  36.708*2.0\n#define DS2 38.891*2.0\n#define E2  41.203*2.0\n#define F2  43.654*2.0\n#define FS2 46.249*2.0\n#define G2  48.999*2.0\n#define GS2 51.913*2.0\n#define A2  55.0*2.0\n#define AS2 58.270*2.0\n#define B2  61.735*2.0\n#define _   0.0\n#define XX  100.0\n#define X   1.0\n    \n\n\nfloat tempo = 0.0;\nfloat tune  = 0.0;\n\n// instruments\n\nvec2 tb303(vec3 k){     \n    float s = abs(sin(tune*0.7)+1.0)*0.3;\n \tfloat a = pow(1.0-k.y,0.2);   \n \tfloat f = pow(1.0-k.y,2.0);   \n    float osc = sin(k.x*4.40*tune*2.0);\n    osc = pow(osc,pow(2000.0,s+(f*0.8)));\n  \tosc = clamp(osc*1.1,-1.0,1.0)*a;    \n    return vec2(osc,osc)*0.3; \n}\n\n\nvec2 pad(vec3 k){\n    float osc = 0.0;\n    osc += smoothstep(0.0,0.4,sin(k.x*4.4*tune*8.0));\n    osc += smoothstep(0.0,0.4,sin(k.x*4.4*tune*16.1));\n    osc += smoothstep(0.0,0.4,sin(k.x*4.4*tune*15.9));\n    osc = clamp(pow(osc,0.1),-1.0,1.0);\n    osc = osc*smoothstep(1.0,0.0,k.y);  \n    return vec2(pow(osc,abs(sin(tune))),pow(osc,abs(cos(tune))))*0.4; \n}\n\n\nvec2 piano(vec3 k){\n    float osc = 0.0;\n    osc += sin(k.x*4.4*tune*4.0);\n    osc = clamp(pow(osc,20.0),-1.0,1.0);\n    osc = osc*smoothstep(1.8,0.0,k.y);  \n    return vec2(osc*sin(k.z),osc*cos(k.z*2.0))*0.5; \n}\n\n\nvec2 kick(vec3 k){\n    float a = pow(1.0-k.y,1.0);\n    float osc = sin(pow(a,5.0)*k.x);\n    return vec2(smoothstep(-0.9,0.9,osc*pow(a,2.0))); \n}\n\n\nvec2 hat(vec3 k){\n    float n = fract(sin(k.x * tune * 110.082) * 19871.8972);\n    float a = pow(1.0-k.y,1.0);\n  \tfloat osc = clamp(n,-1.0,1.0)*pow(a,8.0+k.x*0.1);    \n    return vec2(osc*osc,osc)*0.4; \n}\n\n\nvec2 clap(vec3 k){\n    float n = fract(sin(tune * 110.082 * k.x) * 19871.8972);\n    float a = pow(1.0-k.y,1.0);\n  \tfloat osc = sin(n*a)*a;\n    \t  osc += (sin(a*8.4*k.x)*pow(a,8.0-k.x*0.02));\n    return vec2(osc,osc); \n}\n\n\n// sequencer\n\nvec3 pat(float time,float p1,float p2,float p3,float p4,float p5,float p6,float p7,float p8, float p9, float p10, float p11, float p12, float p13, float p14, float p15, float p16){\n    float t = mod(time,16.0);\n\tif(t>15.0) return vec3(p16,t-15.0,time);    \n\tif(t>14.0) return vec3(p15,t-14.0,time);    \n\tif(t>13.0) return vec3(p14,t-13.0,time);    \n\tif(t>12.0) return vec3(p13,t-12.0,time);    \n\tif(t>11.0) return vec3(p12,t-11.0,time);    \n\tif(t>10.0) return vec3(p11,t-10.0,time);    \n\tif(t>9.0)  return vec3(p10,t-9.0,time);    \n\tif(t>8.0)  return vec3(p9,t-8.0,time);    \n    if(t>7.0)  return vec3(p8,t-7.0,time);    \n\tif(t>6.0)  return vec3(p7,t-6.0,time);    \n\tif(t>5.0)  return vec3(p6,t-5.0,time);    \n\tif(t>4.0)  return vec3(p5,t-4.0,time);    \n\tif(t>3.0)  return vec3(p4,t-3.0,time);    \n\tif(t>2.0)  return vec3(p3,t-2.0,time);    \n\tif(t>1.0)  return vec3(p2,t-1.0,time);    \n\tif(t>0.0)  return vec3(p1,t,time);    \n\treturn vec3(0.0);\n}\n\n\nvec2 Song(float time)\n{  \n\n    tempo = time * 5.8;\n    tune  = time * 1.0;\n\n\n    // patterns\n\tvec2 pads  = vec2(0.0);\n \tpads += pad(pat(tempo,         C1,C0,C1,C2,_ ,_ ,D1,D2,_ ,E1,E2,_ ,_ ,G2,C0,C0 )) * vec2( 0.1, 0.1);    \n    \n    vec2 bass  = vec2(0.0);\n    bass += tb303(pat(tempo-0.0,   C1,_ ,C0,C2,_ ,D1,D2,_ ,E1,E2,_ ,E1,G1,C1,G2,G1)) * vec2( 0.5,  0.6);    \n    bass += tb303(pat(tempo-1.0,   C1,_ ,C0,C2,_ ,D1,D2,_ ,E1,E2,_ ,E1,G1,C1,G2,G1)) * vec2(-0.05, 0.05);    \n    bass += tb303(pat(tempo-2.0,   C1,_ ,C0,C2,_ ,D1,D2,_ ,E1,E2,_ ,E1,G1,C1,G2,G1)) * vec2( 0.01,-0.01);    \n   \n    vec2 chord = vec2(0.0);\n    chord += piano(pat(tempo,  \t   C1,_ ,C0,C1,_ ,C0,C1,_ ,C1,_ ,F0,C1,_ ,G0,C1,_ )) * vec2( 0.1, 0.2);;    \n\tchord += piano(pat(tempo+0.1,  E1,_ ,_ ,E1,_ ,_ ,E1,_ ,F1,_ ,_ ,F1,_ ,_ ,F1,_ )) * vec2( 0.2,-0.1);;    \n \tchord += piano(pat(tempo-0.1,  G1,C2,_ ,A1,C2,_ ,G1,C2,G1,C2,_ ,A1,C2,_ ,G1,C2)) * vec2(-0.1, 0.3);;    \n \n    vec2 drum  = vec2(0.0);\n    drum += kick(pat(tempo,        C1,_ ,_ ,_ ,_ ,C1,_ ,C1,_ ,_ ,_ ,C1,_ ,_ ,_ ,_ )) * vec2( 0.2, 0.3);    \n    drum += clap(pat(tempo,        _ ,_ ,_ ,_ ,C1,_ ,_ ,_ ,_ ,_ ,_ ,_ ,C1,_ ,_ ,C1)) * vec2( 0.2, 0.4);    \n    drum += hat (pat(tempo,        C1,C1,C2,_ ,C1,C2,C1,C2,C2,C1,C2,C1,C1,_ ,C1,C1)) * vec2(-0.1, 0.1);    \n\n   \n    // arrange\n    vec3 arrange1 = pat(tempo/16.0 ,_,_,_,_,_,_,X,X,X,X,X,X,X,X,X,X);\n    vec3 arrange2 = pat(tempo/16.0 ,_,_,_,_,_,_,_,_,_,_,_,_,X,X,X,X);\n    vec3 arrange3 = pat(tempo/16.0 ,_,_,X,X,X,X,_,_,X,X,X,X,X,X,X,X);\n     \n    \n    // mix\n    vec2 mixed = vec2(pads*arrange1.x + chord*arrange2.x + bass*arrange3.x + drum);\n    return mixed * smoothstep(0.0,5.0,time) * smoothstep(60.0,50.0,time);\n    \n}\n\n\n\n\n\n// visualize\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2  uv = fragCoord.xy / iResolution.xy;\n    float screentime =uv.x*60.0;\n    vec2  s = Song(screentime);   \n\tfloat v = abs(s.y+s.x)-abs(uv.y-0.5);\n    v += smoothstep(0.0,0.2,iTime-screentime)*smoothstep(20.0,0.0,iTime-screentime);\n    fragColor = vec4(vec3(v),1.0);\n    \n}","name":"Image","description":"","type":"image"},{"outputs":[],"inputs":[],"code":"#define C0 32.703*0.5\n#define CS0 34.648*0.5\n#define D0 36.708*0.5\n#define DS0 38.891*0.5\n#define E0 41.203*0.5\n#define F0 43.654*0.5\n#define FS0 46.249*0.5\n#define G0 48.999*0.5\n#define GS0 51.913*0.5\n#define A0 55.0*0.5\n#define AS0 58.270*0.5\n#define B0  61.735*0.5\n#define C1 32.703\n#define CS1 34.648\n#define D1 36.708\n#define DS1 38.891\n#define E1 41.203\n#define F1 43.654\n#define FS1 46.249\n#define G1 48.999\n#define GS1 51.913\n#define A1 55.0\n#define AS1 58.270\n#define B1  61.735\n#define C2 32.703*2.0\n#define CS2 34.648*2.0\n#define D2  36.708*2.0\n#define DS2 38.891*2.0\n#define E2  41.203*2.0\n#define F2  43.654*2.0\n#define FS2 46.249*2.0\n#define G2  48.999*2.0\n#define GS2 51.913*2.0\n#define A2  55.0*2.0\n#define AS2 58.270*2.0\n#define B2  61.735*2.0\n#define _   0.0\n#define XX  100.0\n#define X   1.0\n    \n\n\nfloat tempo = 0.0;\nfloat tune  = 0.0;\n\n// instruments\n\nvec2 tb303(vec3 k){     \n    float s = abs(sin(tune*0.7)+1.0)*0.3;\n \tfloat a = pow(1.0-k.y,0.2);   \n \tfloat f = pow(1.0-k.y,2.0);   \n    float osc = sin(k.x*4.40*tune*2.0);\n    osc = pow(abs(osc),pow(2000.0,s+(f*0.8)));\n  \tosc = clamp(osc*1.1,-1.0,1.0)*a;    \n    return vec2(osc,osc)*0.3; \n}\n\n\nvec2 pad(vec3 k){\n    float osc = 0.0;\n    osc += smoothstep(0.0,0.4,sin(k.x*4.4*tune*8.0));\n    osc += smoothstep(0.0,0.4,sin(k.x*4.4*tune*16.1));\n    osc += smoothstep(0.0,0.4,sin(k.x*4.4*tune*15.9));\n    osc = clamp(pow(osc,0.1),-1.0,1.0);\n    osc = osc*smoothstep(1.0,0.0,k.y);  \n    return vec2(pow(osc,abs(sin(tune))),pow(osc,abs(cos(tune))))*0.4; \n}\n\n\nvec2 piano(vec3 k){\n    float osc = 0.0;\n    osc += sin(k.x*4.4*tune*4.0);\n    osc = clamp(pow(abs(osc),20.0),-1.0,1.0);\n    osc = osc*smoothstep(1.8,0.0,k.y);  \n    return vec2(osc*sin(k.z),osc*cos(k.z*2.0))*0.5; \n}\n\n\nvec2 kick(vec3 k){\n    float a = pow(1.0-k.y,1.0);\n    float osc = sin(pow(a,5.0)*k.x);\n    return vec2(smoothstep(-0.9,0.9,osc*pow(a,2.0))); \n}\n\n\nvec2 hat(vec3 k){\n    float n = fract(sin(k.x * tune * 110.082) * 19871.8972);\n    float a = pow(1.0-k.y,1.0);\n  \tfloat osc = clamp(n,-1.0,1.0)*pow(a,8.0+k.x*0.1);    \n    return vec2(osc*osc,osc)*0.4; \n}\n\n\nvec2 clap(vec3 k){\n    float n = fract(sin(tune * 110.082 * k.x) * 19871.8972);\n    float a = pow(1.0-k.y,1.0);\n  \tfloat osc = sin(n*a)*a;\n    \t  osc += (sin(a*8.4*k.x)*pow(a,8.0-k.x*0.02));\n    return vec2(osc,osc); \n}\n\n\n// sequencer\n\nvec3 pat(float time,float p1,float p2,float p3,float p4,float p5,float p6,float p7,float p8, float p9, float p10, float p11, float p12, float p13, float p14, float p15, float p16){\n    float t = mod(time,16.0);\n\tif(t>15.0) return vec3(p16,t-15.0,time);    \n\tif(t>14.0) return vec3(p15,t-14.0,time);    \n\tif(t>13.0) return vec3(p14,t-13.0,time);    \n\tif(t>12.0) return vec3(p13,t-12.0,time);    \n\tif(t>11.0) return vec3(p12,t-11.0,time);    \n\tif(t>10.0) return vec3(p11,t-10.0,time);    \n\tif(t>9.0)  return vec3(p10,t-9.0,time);    \n\tif(t>8.0)  return vec3(p9,t-8.0,time);    \n    if(t>7.0)  return vec3(p8,t-7.0,time);    \n\tif(t>6.0)  return vec3(p7,t-6.0,time);    \n\tif(t>5.0)  return vec3(p6,t-5.0,time);    \n\tif(t>4.0)  return vec3(p5,t-4.0,time);    \n\tif(t>3.0)  return vec3(p4,t-3.0,time);    \n\tif(t>2.0)  return vec3(p3,t-2.0,time);    \n\tif(t>1.0)  return vec3(p2,t-1.0,time);    \n\tif(t>0.0)  return vec3(p1,t,time);    \n\treturn vec3(0.0);\n}\n\n\nvec2 Song(float time)\n{  \n\n    tempo = time * 5.8;\n    tune  = time * 1.0;\n\n\n    // patterns\n\tvec2 pads  = vec2(0.0);\n \tpads += pad(pat(tempo,         C1,C0,C1,C2,_ ,_ ,D1,D2,_ ,E1,E2,_ ,_ ,G2,C0,C0 )) * vec2( 0.1, 0.1);    \n    \n    vec2 bass  = vec2(0.0);\n    bass += tb303(pat(tempo-0.0,   C1,_ ,C0,C2,_ ,D1,D2,_ ,E1,E2,_ ,E1,G1,C1,G2,G1)) * vec2( 0.5,  0.6);    \n    bass += tb303(pat(tempo-1.0,   C1,_ ,C0,C2,_ ,D1,D2,_ ,E1,E2,_ ,E1,G1,C1,G2,G1)) * vec2(-0.05, 0.05);    \n    bass += tb303(pat(tempo-2.0,   C1,_ ,C0,C2,_ ,D1,D2,_ ,E1,E2,_ ,E1,G1,C1,G2,G1)) * vec2( 0.01,-0.01);    \n   \n    vec2 chord = vec2(0.0);\n    chord += piano(pat(tempo,  \t   C1,_ ,C0,C1,_ ,C0,C1,_ ,C1,_ ,F0,C1,_ ,G0,C1,_ )) * vec2( 0.1, 0.2);;    \n\tchord += piano(pat(tempo+0.1,  E1,_ ,_ ,E1,_ ,_ ,E1,_ ,F1,_ ,_ ,F1,_ ,_ ,F1,_ )) * vec2( 0.2,-0.1);;    \n \tchord += piano(pat(tempo-0.1,  G1,C2,_ ,A1,C2,_ ,G1,C2,G1,C2,_ ,A1,C2,_ ,G1,C2)) * vec2(-0.1, 0.3);;    \n \n    vec2 drum  = vec2(0.0);\n    drum += kick(pat(tempo,        C1,_ ,_ ,_ ,_ ,C1,_ ,C1,_ ,_ ,_ ,C1,_ ,_ ,_ ,_ )) * vec2( 0.2, 0.3);    \n    drum += clap(pat(tempo,        _ ,_ ,_ ,_ ,C1,_ ,_ ,_ ,_ ,_ ,_ ,_ ,C1,_ ,_ ,C1)) * vec2( 0.2, 0.4);    \n    drum += hat (pat(tempo,        C1,C1,C2,_ ,C1,C2,C1,C2,C2,C1,C2,C1,C1,_ ,C1,C1)) * vec2(-0.1, 0.1);    \n\n   \n    // arrange\n    vec3 arrange1 = pat(tempo/16.0 ,_,_,_,_,_,_,X,X,X,X,X,X,X,X,X,X);\n    vec3 arrange2 = pat(tempo/16.0 ,_,_,_,_,_,_,_,_,_,_,_,_,X,X,X,X);\n    vec3 arrange3 = pat(tempo/16.0 ,_,_,X,X,X,X,_,_,X,X,X,X,X,X,X,X);\n     \n    \n    // mix\n    vec2 mixed = vec2(pads*arrange1.x + chord*arrange2.x + bass*arrange3.x + drum);\n    return mixed * smoothstep(0.0,5.0,time) * smoothstep(60.0,50.0,time);\n    \n}\n\n\n\n\nvec2 mainSound( in int samp,float time)\n{  \n\tvec2 s = vec2(0.0);\n    s += Song(time);\n    s += Song(time-0.07).yx*0.04;\n    s -= Song(time-0.25).yx*0.01;\n    s += Song(time-1.00).yx*0.005;\n    \n    return s;\n}\n","name":"Sound","description":"","type":"sound"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":true,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"MdlXWj","date":"1407064822","viewed":1346,"name":"Musicbox 2","username":"ztri","description":"Another music player. ","likes":18,"published":1,"flags":0,"usePreview":1,"tags":["music"],"hasliked":0,"parentid":"","parentname":""}}