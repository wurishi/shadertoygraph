{"ver":"0.1","info":{"id":"Dl3BW2","date":"1701578172","viewed":55,"name":"体素光线步进-test","username":"KunJinKao","description":"一个小练习","likes":8,"published":1,"flags":32,"usePreview":0,"tags":["3d"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\nvoid mainImage( out vec4 O, in vec2 C )\n{\n    vec4 o1=texture(iChannel0,C/iResolution.xy);\n    O=o1;return;\n    \n    vec4 o2=texture(iChannel0,(C+vec2(8))/iResolution.xy);\n    O=o1;\n    O.yz=mix(O.yz,o2.yz,step(.4,sin(sin(iTime*2.)*8.)));\n    \n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"XdX3Rr","filepath":"/media/a/aea6b99da1d53055107966b59ac5444fc8bc7b3ce2d0bbb6a4a3cbae1d97f3aa.bin","previewfilepath":"/media/ap/aea6b99da1d53055107966b59ac5444fc8bc7b3ce2d0bbb6a4a3cbae1d97f3aa.bin","type":"volume","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"const float EPS=1e-4;\nfloat map(vec3 p)\n{\n    return texture(iChannel0,p/80.).x* //random\n            (dot(p.xy,p.xy)*.01+ //radius weight\n            sin(iTime*.1)*.1);//animation\n}\nvec3 fog(vec3 p,vec3 o)\n{\n   p.z+=10.*iTime;\n   return texture(iChannel0,p*.02).x*\n           palette(o.z*.1);\n}\nvec3 minComponent(vec3 v)\n{return min(v.xxx,min(v.y,v.z));}\n\nvoid mainImage( out vec4 O, in vec2 C )\n{\n\n    vec3 dir=vec3((C-.5*iResolution.xy)/iResolution.x*3.,1),\n    o=vec3(0.,0.,iTime),\n    \n    p=o+EPS*dir+vec3(EPS,2.*EPS,0),//fix:45° alias\n    cn=step(vec3(0),dir),dif,m;\n    \n    float d,i;\n    for(i=0.,O-=O;i<100.&&(d=map(floor(p)))<.42f;i++)\n    {\n        dif=cn-fract(p);\n        dif/=dir;\n        m=minComponent(dif);\n        p+=dir*(m.x+EPS);\n        O.xyz+=fog(p,o)*0.01;\n    }if(i>99.) return;\n    \n    vec3 nml=-dir*step(dif,m)/(abs(dir)+EPS),po=o-p;\n    O.xyz+=5910./(dot(po,po)+300.)*dot(nml,normalize(po))*\n    vec3(palette(d*2.+floor(p*0.01+floor(iTime*4.)*0.04).z))*pow(1.-d,4.);\n}","name":"Buffer A","description":"","type":"buffer"},{"inputs":[],"outputs":[],"code":"//Color Palette from iq\nconst float PI=3.1415;\nvec3 palette(float t)\n{\n    t*=1.732;\n    return vec3(.7)+vec3(.3)*cos(2.*PI*(vec3(.71,.31,.21)*t+vec3(.2,.4,.6)));\n}","name":"Common","description":"","type":"common"}]}