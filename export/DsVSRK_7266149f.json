{"ver":"0.1","info":{"id":"DsVSRK","date":"1681316508","viewed":259,"name":"ShaderShowdown_Revision2023 Cosa","username":"louis_C","description":"Shader made during the shodwon of 2023 revision we little modification to integrate fft accumulation texture.\n(sound in)","likes":10,"published":1,"flags":40,"usePreview":0,"tags":["livecoding","shadershowdown","demoparty"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\n\nvoid mainImage( out vec4 r, in vec2 f ){r = texture(iChannel0, f/iResolution.xy);}\n","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"\nmat2 rot(float t){ float c = cos(t); float s = sin(t); return mat2(c,-s,s,c);}\nfloat rd(float t){ return fract(sin(dot(floor(t),45.236))*7845.236);}\nfloat no(float t){ return mix(rd(t), rd(t+1.),smoothstep(0.,1.,fract(t)));}\nfloat cap(vec3 p, vec3 a, vec3 b){ vec3 pa  = p-a; vec3 ba = b-a;\n  float h = clamp(dot(pa,ba)/dot(ba,ba),0.,1.);\n  return length(pa-ba*h);}\n  float smin(float a, float b){\n    float h = clamp(0.5+0.5*(a-b)/0.5,0.,1.);\n    return mix(a,b,h)-0.5*h*(1.-h);}\nfloat map(vec3 p){\nfloat si = 24./iResolution.x;\n float f = 0.175;\n  vec3 r = vec3(12.,0.,12.);\n  p = mix(p,mod(p+0.5*r,r)-0.5*r,step(0.5,no(texture(iChannel1,vec2(0.34*si,0.)).x*f*0.25)));\n  float t1 = no(texture(iChannel1,vec2(0.5*si,0.)).x*f);\n  p.xz += vec2(cos(p.y*0.5+t1),sin(p.y*0.5+t1));\n \n  vec2  b=  vec2(-2.,-3.);\n  p.x = mix(p.x,-p.x,smoothstep(-1.,1.,p.x));\n  float d1 = 100.;\n  for( int  i = 0 ;i < 3 ; i++){\n    b += 1.;\n    float t1 = texture(iChannel1,vec2(float(i)*0.1*si,0.)).x;\n       float t2 = texture(iChannel1,vec2((float(i)*0.1-0.1)*si,0.)).x;\n    vec2 v1 = (vec2(no(t1*f),no(t1*f+6.25))-0.5)*2.;\n     vec2 v2 = (vec2(no(t2*f),no(t2*f+6.25))-0.5)*2.;\n    d1 = smin(d1,cap(p+vec3(2.,0.,0.),vec3(v1.x,b.x,v1.y),vec3(v2.x,b.y,v2.y))-pow(length(p.y+3.)*0.8,0.5));\n    d1 = smin(d1,cap(p+vec3(0.,-3.8,0.),vec3(v1.x*0.5,b.x*0.5,v1.y),vec3(v2.x*0.5,b.y*0.5,v2.y))-2.);\n     d1 = smin(d1,cap(p+vec3(3.,-5.8,0.),vec3(b.x,v1.x,v1.y),vec3(b.y,v2.x,v2.y))-(1.-pow(length(p.x),2.)*0.05));\n     d1 = smin(d1,cap(p+vec3(0.,-7.,0.),vec3(v1.x*0.1,b.x*0.25,v1.y),vec3(v2.x*0.1,b.y*0.25,v2.y))-0.3);\n  }\n  float d2 = p.y+3.+no(p.x*10.)*0.05;\n  return min(d1,d2);}\n  vec3 n(vec3 p){ vec2 e = vec2(0.01,0.); return normalize(map(p)-vec3(map(p-e.xyy),map(p-e.yxy),map(p-e.yyx)));}\n  float ev(vec3 r){ r  = normalize(r*vec3(1.,3.,1.)); return no(r.x*3.);}\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\nfloat si = 24./iResolution.x;\n vec2 uv = fragCoord/iResolution.xy;\n vec2 uc = uv;\n\tuv -= 0.5;\n  uv *=2.;\n   float f = 0.175;\n\tuv /= vec2(iResolution.y /iResolution.x, 1);\nvec3 p = vec3(0.,0.,-6.-no(texture(iChannel1,vec2(0.55*si,0.)).x*2.*f)*4.);\n  vec3 r = normalize(vec3(uv+vec2(0.,no(texture(iChannel1,vec2(0.45*si,0.)).x*f/4.)),1.));\n  p.xz *= rot(iTime);\nr.xz *=rot(iTime);\n  float t1 = sin(iTime)*mix(0.,1., step(0.5,no(texture(iChannel1,vec2(0.23*si,0.)).x*f/4.)));;\n   p.xy *= rot(t1);\nr.xy *= rot(t1);\n  float dd;\n  for(int  i = 0 ; i < 64 ; i++){\n    float d = map(p);\n    if(d<0.01){break;}\n    p +=r*d;\n    dd +=d;\n  }\n  float d1 = smoothstep(20.,10.,dd);\n  float d2 = mix(ev(r), clamp(ev(reflect(r,n(p))),0.,1.),d1);\n  float b = sqrt(32.);\n  float d = pow(length(uv.y),2.)*0.01+pow(no(texture(iChannel1,vec2(0.6*si,0.)).x*f/7.),20.)*0.05;\n  float d3;\n  for(float i = -0.5*b ; i<0.5*b; i+=1.)\n    for(float j = -0.5*b ; j<0.5*b; j+=1.){\n      d3 += texture(iChannel0,uc+vec2(i,j)*d).a;\n    }d3 /= 32.;\n    vec3 d4 = mix(vec3(1.),3.*abs(1.-2.*fract(d3*0.8+0.4+vec3(0.,-1./3.,1./3.)))-1.,0.4)*d3*1.2;\n    vec3 d5 = mix(vec3(2.,0.,0.),vec3(0.,0.,2.),d3)*d3*1.5;\n    vec3 d6 = mix(d4,d5,step(0.5,no(texture(iChannel1,vec2(0.45*si,0.)).x*f/6.)));\n\tfragColor = vec4(vec3 (d6),d2);\n  \n}","name":"Buffer A","description":"","type":"buffer"},{"inputs":[],"outputs":[],"code":"\nvec2 mainSound( int samp, float time )\n{\n\n    return vec2(s1(time));\n}","name":"Sound","description":"","type":"sound"},{"inputs":[],"outputs":[],"code":"float hs(float t){return fract(sin(dot(t,45.))*7845.236);}\nfloat rds(float t){ return fract(sin(dot(floor(t),45.))*7845.236);}\nfloat nos(float t){ return mix(rds(t), rds(t+1.),smoothstep(0.,1.,fract(t)));}\nfloat it(float t, int n){float r = 0.;float a = 0.5;for(int i=0 ; i <n ;i++){\nr += nos(t/a)*a; a*=0.5;} return (r-0.5)*2.;}\n\nvec2 e2(float t){float tt2 = 0.25*floor(fract(t*0.25)*3.+1.);                           \n  float t2 = t*mix(mix(6.,8.,step(0.5,fract(t*mix(4.,6.,step(tt2,fract(t)))))),4.,\n  step(0.5,fract(t)*step(0.5,fract(t*0.125+0.5))))+0.5;     \n  float t3 = t2;\n  vec2 s2 = vec2(sin(hs(t)*t3*10.),sin(hs(t+45.)*t3*10.))*0.1\n   *pow(clamp(vec2(fract(t3),fract(t3))*2.-1.,0.,1.),\n  vec2( mix(0.01,10.,step(0.5,fract(t*8.))))); \n                 return s2;}\nvec2 e3(float t){float h = it(t*40.,4);\n  vec2 r = vec2(0.); for(int i = 0 ; i < 6 ; i++){\n    r += e2 (t+float(i)*1.5)/(1.+float(i));\n  }return r;}\nvec2 e4(float t){float tt2 = 0.25*floor(fract(t*0.25)*3.+1.);                           \n  float t2 = t*mix(mix(6.,8.,step(0.5,fract(t*mix(4.,6.,step(tt2,fract(t)))))),4.,\n  step(0.5,fract(t)*step(0.5,fract(t*0.125+0.5))))+0.5; \n                  float t3 = t2;\n  vec2 s2 = vec2(rds(t*5000.-t3*1000.),rds(t*5000.-t3*1000.+45.))*0.1\n   *pow(clamp(vec2(fract(t3),fract(t3))*2.-1.,0.,1.),\n  vec2( mix(0.01,10.,step(0.5,fract(t*8.))))); \n                 return s2;}\nvec2 e5(float t){\n  vec2 r = vec2(0.); for(int i = 0 ; i < 3 ; i++){\n    r += pow(e4 (t+float(i)*(0.015)),vec2(1.+float(i)*0.05));\n  }return (clamp(r,0.,1.)-0.5)*2.;}\n \nfloat voc(float t, float f, float ft,float ta){float x = fract(t * f) / f;\nfloat e=(fract(x*3.*ft)+fract(x*22.*ft)+fract(x*28.*ft)); \nfloat a=(sin(x*6.5*ft)+sin(x*13.*ft)+sin(x*24.*ft));\nreturn mix(e,a,ta)* min(x * 1000., 1.) * exp(x * -200.);}\nfloat hash(float x){return fract(sin(x) * 897612.531);}\nvec2 vo(float t, float var,float ta){vec2 v = vec2(0., 0.);\n    for(int i = 0; i < 16; ++i){\n        float h = float(i);\n       \tfloat m = voc(t+h,40.+pow(2.01,(h-8.)*.2),var,ta);\n        float pan = hash(h);\n        v.x += m * pan;v.y += m * (1.-pan);\n    }return v *.1;}\nvec2 e6(float t){vec2 r = vec2(0.); \n      float e = step(0.5,fract(t*0.03125));                    \n      float tv = mix(0.5,mix(1.,2.,step(0.5,fract(t*0.5))),e)*\n        mix(mix(1.,4.,step(0.75,fract(t*0.03125))),0.25,step(0.875,fract(t*0.03125+0.5)));\n      float tv2 =tv;\n      float tt = mix(0.5,mix(1.,2.,step(0.5,fract(t*0.25)))*tv,e);   \n      float tt2 =mix(0.5,mix((1.+floor(fract(t/6.)*3.))/3.,1.,step(0.5,fract(t*0.125+0.5))),e);\n      float tt3 =tt;    \n      float tt4 =tt2;  \n      vec2 f1 = vec2(nos(pow(fract(t*tt3),0.7*tt4/tv2)*140000./tt3),\n      nos(pow(fract(t*tt3),0.7*tt4/tv2)*140000./tt3)) -0.5; \n      float tta = mix(2.,mix(4.,1.,step(0.5,fract(t*0.25))),step(0.5,fract(t*0.125+0.5)));                         \n      float tp = 0.25+fract(t*0.25)*0.5;\n      float tp2 = 0.25+fract(t*0.25+0.5)*0.5;\n      float ta = mix(mix(pow(fract(t*0.25+0.5),tp),pow(fract(t+0.5),tp),\n       step(0.5,fract(t*0.5))),max(smoothstep(0.225,0.25,1.-fract(t*0.0625)),\n       step(0.5,fract(t*0.5)))*pow(fract(t*tta+0.5),tp),e);\n      float ta2 = mix(mix(pow(fract(t*0.25+0.5),tp2),pow(fract(t+0.5),tp2),\n       step(0.5,fract(t*0.5))),max(smoothstep(0.225,0.25,1.-fract(t*0.0625)),\n       step(0.5,fract(t*0.5)))*pow(fract(t*tta+0.5),tp2),e);\n       return  r += f1*mix(vec2(ta,ta2),vec2(1.),e);}\nfloat e1(float t){\n   float tt1 = mix(1.,2.,step(0.75,fract(t*0.25)));\n  float t1 = t*mix(mix(4.,3.,step(0.5,fract(t*2.)))*tt1,2.,step(0.875,fract(t*0.125+0.5)));\n  t1 *= 1.+step(0.8125,fract(t*0.125+0.75)); \n  float t2 =t1;\n  float s1 = sin(pow(fract(t2),0.5)*100.)*mix(0.5,0.25,step(0.5,fract(t*6.\n  +floor(fract(t*0.0625)*4.)/4.)));\n  s1 += it(pow(fract(t2),(1.-fract(tt1+0.5))*0.5)*70.,5);  \n  return s1;}\nfloat sfract (float t){ return 1.-fract(t);}\nvec2 e7(float t){\n  float bt = sfract(t*mix(0.25,1.,step(0.5,fract(t*0.25)))*mix(1.,2.,step(0.5,fract(t*0.5))));\n  float tt = pow(mix(1.-bt,bt,step(0.5,sfract(t*4.))),\n                 mix(0.25,0.5,step(0.5,sfract(t*0.25+0.5))));\n  float tti = t*2.;\n  float ti = (floor(fract(tti/8.)*8.+1.)+sfract(tti))*100.+400.;\n  float tta = step(0.25,fract(t*0.125+step(0.5,fract(t*0.25+0.5))*0.5));\n  float ta = fract(t*mix(1.,2.,step(0.5,fract(t*0.0625)))\n                   *mix(mix(1.,4.,step(0.5,fract(t*0.125+0.5))),\n                        2.,step(0.75,fract(t*0.125+0.5))))*tta;\n  return vo(t,tt*ti, ta)*mix(fract(t*4.),1.,tta);}\n\nvec2 s1(float t)\n{\nt *= 1.25;\nfloat time  = t;\n    vec2 d  = vec2(0.);\n    float s1 = e1(t)*0.5;\n  vec2 s2 = e3(t*max(step(0.5,fract(t*0.125)),step(0.5,fract(t*0.5))))*0.5;  \n  vec2 s3 = e5(t)*0.5;\n  vec2 s4 = e6(t) *0.4;\n  vec2 s5 = e7(t);\n  float ttp = smoothstep(0.125,2.5,time);\n  d += s1*smoothstep(0.25,0.5,time);\n  d += s2*ttp;\n  d += s3*ttp;\n  d += s4*smoothstep(8.,12.,time);\n  d += s5*smoothstep(16.,24.,time);\n  return (d+0.5)*smoothstep(180.,175.,time);\n}\n\n   \n   ","name":"Common","description":"","type":"common"},{"inputs":[{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"XsXGR8","channel":0}],"code":"\n#define PI 3.1415927\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2  uv = fragCoord.xy / iResolution.xy;\n    float gt = iTime;\n    float n = 0.;\n    if(uv.y <1./iResolution.y  && uv.x < 24./iResolution.x){\n    n = 24.;\n    }\n    float fi = floor(uv.x*n*PI*iResolution.x/24.);\n    float angle =  fi / n;\n    vec2  di = vec2(cos(angle), sin(angle));\n    vec2  df = vec2(1.0, 0.0);\n    vec2  f  = vec2(0.0, 0.0);\n    for (int i = 0; i < int(n); i++)\n    {\n        float x = float(i) / n;\n        float t = x *0.05 + gt;\n        vec2  w = s1(t);\n        float v = (w.x + w.y) * 0.5;\n        v *= 0.5 * (1.0 - cos(2.0 * PI * x));\n        f += df * v;\n        df = df.xy * di.x + vec2(-1.0, 1.0) * df.yx * di.y;\n    }\n    float y = length(f);\n    fragColor = vec4(y+texture(iChannel0,uv).x);\n}","name":"Buffer B","description":"","type":"buffer"}]}