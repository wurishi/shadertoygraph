{"ver":"0.1","info":{"id":"7dSXW1","date":"1620117515","viewed":47,"name":"Oiseau","username":"azouagh","description":"Oiseau","likes":1,"published":1,"flags":0,"usePreview":0,"tags":["azouagh"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define AAstep(thre, val) smoothstep(-.7,.7,(val-thre)/min(.05,fwidth(val-thre)))\n#define circle(d, s) AAstep(s, length(d))\n#define anim Animation(abs(-1.+2.*dt))\n#define TAU 6.2831853071\n#define dt fract(iTime*0.5)\n\nfloat cos01(float v){ return 0.5 + 0.5 * cos(v); }\nfloat Animation(float x)\n{\n    float c1 = 8.70158;\n    float c2 = c1 * 1.525; // rotation des ailes\n\n    return x < 0.5\n      ? (pow(2. * x, 2.) * ((c2 + 1.) * 2. * x - c2)) / 2.\n      : (pow(2. * x - 2., 2.) * ((c2 + 1.) * (x * 2. - 2.) + c2) + 2.) / 2.;\n}\n\nmat2 rot (float a) \n{return mat2(cos(a),sin(a),-sin(a),cos(a));}\n\n\n\nvoid moda (inout vec2 p, float rep)\n{\n    float per = TAU/rep;\n    float a = mod(atan(p.y,p.x),per)-per*0.5; // forme du cercle rouge  \n    p = vec2(cos(a),sin(a))*length(p); // diamètre du  cercle rouge\n}\n\nfloat tri (vec2 uv, float size, vec2 ratio)\n{return AAstep(size, max(-uv.x,dot(vec2(uv.x,abs(uv.y)),normalize(ratio))));}\n\nvec4 head (vec2 uv)\n{\n    uv.y -= anim*0.1;\n    float size = 0.3; //la taile du tête\n    float center = clamp(1.-circle(uv,size),0.,1.);\n    float outer = clamp(1.-(circle(uv, size*1.35)+(center)),0.,1.);\n    vec2 uu = uv;\n    moda(uu,40.); // forme du cercle rouge \n    uu.x -= size;\n    uu.y += sin(uu.x*1.)*0.0001;\n    float pales = clamp(1.-(tri(uu,0.2, vec2(9.25,1.))+outer+center),0.,1.);\n    vec3 col = vec3(1.,8.,0.)*outer + vec3(0.7,0.4,0.3)*pales + vec3(0.95,0.75,0.2)*center;\n\treturn vec4(col, clamp(pales+center+outer,0.,1.));\n}\n//création des ailes\nvec4 ailes (vec2 uv)\n{\n    uv.y -= 0.3;\n    uv.x = abs(uv.x)-0.7;\n    uv *= rot(-anim*0.5);\n    vec2 uu = uv;\n    uu *= rot(TAU/8.);\n    uu.y += sin(uu.x*1.5)*1.3;\n    float w1 = tri(uu, 0.14,vec2(0.12,1.));\n    uu.y += sin(uu.x*5.)*0.2;\n    uu.y += 0.1;\n    float w2 = tri(uu, 0.12,vec2(0.15,1.));\n    uu *= rot(-TAU/15.);\n    uu.y += 0.1;\n    float w3 = tri(uu, 0.1,vec2(0.2,1.));\n    float win = clamp(1.-w1*w2*w3*circle(uv+vec2(0.2,0.1), 0.2),0.,1.);\n    return vec4(vec3(1.)*win, win);\n}\n\n//l'arrière plan \nvec3 background (vec2 uv)\n{\n    uv.y += sin(uv.x*5.+iTime)*4.1;\n    vec3 col;\n    float mask = floor((abs(uv.x + uv.y)*0.7-0.2)*3.)/3.;\n    if (mask<0.2) col = vec3(0.4,1.7,1.7);\n    else if (mask>=0.2 && mask<0.5) col = vec3(0.6,0.9,0.5);\n    else if (mask>=0.5 && mask<0.7) col = vec3(0.5,0.6,0.7);\n    else if (mask>=2.7) col = vec3(0.9,0.3,0.9);\n    return col;\n \n}\n\nvec3 image (vec2 uv) \n{\n    vec3 back = background(uv);\n    uv *= 2.3; // 4.3\n    vec4 su = head(uv);\n    vec4 wi = ailes(uv);\n    float wmask = clamp(wi.w-su.w,0.,1.);\n    float allmask = clamp(1.-(wi.w+su.w),0.,1.);\n    return (ailes(uv).xyz*wmask) + su.xyz + back*allmask;\n}\n\n//création du soleil\nvec4 Soleil(vec2 uv, vec2 center, float radius, vec4 color) {\n    float dist = step(length(center - uv), (radius));\n    //return vec4(dist, dist, dist, 1.0) * cos01(1.2 * iTime );\n    return vec4(dist, 2, 4, 7.0)*color * cos01(1.2 * iTime );\n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = (2.*fragCoord-iResolution.xy)/iResolution.y;\n    vec3 col = image(uv);\n    vec2 center = iResolution.xy * 0.5; // position du soleil (je l'ai mis au centre )\n    float radius = 0.11 * iResolution.x; // Rayon du soleil \n    float reactBase =texture(iChannel0, vec2(0.4, 1.0) ).x;\n\n   \n    fragColor = vec4( col, 1.0) +  Soleil(fragCoord.xy, center, radius, vec4(1.0, 0.0, 0.0, 1.0));\n\n\n}","name":"Image","description":"","type":"image"}]}