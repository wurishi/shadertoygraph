{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[],"code":"// License Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License.\n\n\n//parameters\n\nconst int iterations=100;\nconst float bailout=1e5;\nconst float brightness=.85;\nconst float saturation=.6;\nconst float zoom=1.;\n\n\n//------------------ ------------------------------------------\n// complex number operations\nvec2 cadd( vec2 a, float s ) { return vec2( a.x+s, a.y ); }\nvec2 cmul( vec2 a, vec2 b )  { return vec2( a.x*b.x - a.y*b.y, a.x*b.y + a.y*b.x ); }\nvec2 cdiv( vec2 a, vec2 b )  { float d = dot(b,b); return vec2( dot(a,b), a.y*b.x - a.x*b.y ) / d; }\nvec2 cinv( vec2 z)  { float d = dot(z,z); return vec2( z.x, -z.y ) / d; }\nvec2 csqr( vec2 a ) { return vec2(a.x*a.x-a.y*a.y, 2.0*a.x*a.y ); }\nvec2 csqrt( vec2 z ) { float m = length(z); return sqrt( 0.5*vec2(m+z.x, m-z.x) ) * vec2( 1.0, sign(z.y) ); }\nvec2 conj( vec2 z ) { return vec2(z.x,-z.y); }\nvec2 cpow( vec2 z, float n ) { float r = length( z ); float a = atan( z.y, z.x ); return pow( r, n )*vec2( cos(a*n), sin(a*n) ); }\nvec2 cexp( vec2 z) {  return exp( z.x )*vec2( cos(z.y), sin(z.y) ); }\nvec2 clog( vec2 z) {  float d = dot(z,z);return vec2( 0.5*log(d), atan(z.y,z.x)); }\nvec2 csin( vec2 z) { float r = exp(z.y); return 0.5*vec2((r+1.0/r)*sin(z.x),(r-1.0/r)*cos(z.x));}\nvec2 ccos( vec2 z) { float r = exp(z.y); return 0.5*vec2((r+1.0/r)*cos(z.x),-(r-1.0/r)*sin(z.x));}\n//------------------------------------------------------------\n\nvec2 z0;\nvec2 zavg;\n//vec2 zn;\n\n//formulas\n\n\nvec2 f( vec2 x ){return cdiv( z0-x ,csin(z0+0.5*x));}//Santa Claus\n//vec2 f( vec2 x ){return cinv(x+z0)+ x-z0  ;}//Infinity\n//vec2 f( vec2 x ){return (cpow(x+vec2(1.5,0.)+csin(z0+x+vec2(3.,0.)),-2.0))-x +z0 -vec2(1.5,0.)  ;}//dragon\n//vec2 f( vec2 x ){return csqr(x) + z0  ;}//Mandelbrot\n//vec2 f( vec2 x ){return (csqr(x+z0)- x+ z0)*0.5  ;}\n//vec2 f( vec2 x ){return (x+cinv(x)+ z0+cinv(z0))*-.5  ;}\n//vec2 f( vec2 x ){return (csqr(x-z0)+ x+z0)  ;}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec3 color=vec3(0.);\n    vec2 p=(fragCoord.yx-iMouse.yx)/ iResolution.yx - 0.5;\n    p.y*=iResolution.x/iResolution.y;\n    p/=zoom*0.25;\n\n\n    //float avg=0.;\n    float k = 0.0;\n    float dz;\n    zavg=p;\n    //zn=normalize(p);\t\t\t\n    vec2 z=p;\n    z0=p;\n    vec2 trap = vec2(bailout);\n    for (int i=0; i<iterations; i++) {\n        vec2 prevz=z;\n\tz=f(z);\n\t\t\t\t\n\tdz=length(z-prevz);\n        if(dz==0.)break;\n\n        trap = min(trap, vec2(\n            abs(dot(z+zavg,z-zavg)),\n            dot(z-1.,z-1.)*dot(z-vec2(1.,-1),z-vec2(1.,-1))\n        ));\n\n        if(dz<1.0)dz=1.0/dz;\n        if(dz>bailout){\n            k = bailout/dz;\n            z=(k*prevz+(1.-k)*z);\n            //float k1 =sqrt(sqrt(k))/float(i+1);\n            //if(dot(z,z)>0.)zn=k1*normalize(z)+(1.-k1)*zn;\n            //avg = k1*dz+(1.-k1)*avg;\n            //zavg=k1*z+(1.-k1)*zavg;\n            //k = float(i)+k; \n            break;\n        }\n\t\t\t\t                          \n        k = 1./float(i+1);\n        zavg=k*z+(1.-k)*zavg;\n        //avg = k*dz+(1.-k)*avg;       \n        //if(dot(z,z)>0.)zn=k*normalize(z)+(1.-k)*zn;\n        \t\t\t\n    }\n    \n\n    trap=trap/(1.0+trap);\n\n    //color=0.2+abs(vec3(zn.x*zn.x,zn.x*zn.x,zn.y));\n    color = 0.4+ 0.6*sin(vec3(-0.5,-0.2,0.8)+2.3+log(trap.y*abs(z.x*z.y)));\n\n    color =0.5*color+0.5* mix( color, abs(sin(vec3(-0.5,-0.2,0.8)+1.7+0.5*log(trap.y*trap.x))),min(0.4,pow(trap.y,0.3)) );\n    color=mix(vec3(length(color)),color,saturation)*brightness;\t\n    fragColor = vec4(color,1.0);\n}","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"4djGDz","date":"1386255799","viewed":373,"name":"Fractal Santa Claus","username":"guil","description":"Santa Claus formula : (c-z)/sin(c+z/2)","likes":4,"published":1,"flags":0,"usePreview":0,"tags":["2d","fractal","santaclaus"],"hasliked":0,"parentid":"","parentname":""}}