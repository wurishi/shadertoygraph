{"ver":"0.1","info":{"id":"wds3WN","date":"1578804828","viewed":280,"name":"spectral color scale","username":"16807","description":"Tech demo after reading Zucconi's article on color scales: https://www.alanzucconi.com/2017/07/15/improving-the-rainbow/","likes":13,"published":1,"flags":0,"usePreview":0,"tags":["spectrum","rainbow","colorscale"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\n// This function returns a rgb vector that quickly approximates a spectral \"bump\"\n// Based on GPU Gems\n// Optimised by Alan Zucconi\n// from https://www.alanzucconi.com/2017/07/15/improving-the-rainbow/\nvec3 bump (vec3 x, vec3 yoffset)\n{\n\tvec3 y = 1. - x * x;\n\treturn clamp(y-yoffset,0.,1.);\n}\n\nfloat bump (float x, float edge0, float edge1, float height)\n{\n    float center = (edge1 + edge0) / 2.;\n    float width  = (edge1 - edge0) / 2.;\n    float offset = (x - center) / width;\n\treturn height * max(1. - offset * offset, 0.);\n}\n// This function returns a rgb vector that best represents color at a given wavelength\n// It is from Alan Zucconi: https://www.alanzucconi.com/2017/07/15/improving-the-rainbow/\n// I've adapted the function so that coefficients are expressed in meters\nvec3 spectral_zucconi (float w)\n{\n\treturn vec3(\n        bump(w, 530e-9, 690e-9, 1.00),\n        bump(w, 465e-9, 635e-9, 0.75),\n        bump(w, 400e-9, 570e-9, 0.45)\n      );\n}\nvec3 spectral_zucconi6 (float w)\n{\n\treturn vec3(\n        bump(w, 530e-9, 690e-9, 1.00)+\n        bump(w, 410e-9, 460e-9, 0.15),\n        bump(w, 465e-9, 635e-9, 0.75)+\n        bump(w, 420e-9, 700e-9, 0.15),\n        bump(w, 400e-9, 570e-9, 0.45)+\n        bump(w, 570e-9, 625e-9, 0.30)\n      );\n}\n// --- Main Image -----------------------------------------\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 uv = fragCoord.xy / iResolution.xy;\n    \n    // uv.x: [0,   1]\n    // w   : [400e-9, 700e-9]\n    float w = uv.x * 300e-9 + 400e-9;\n    \n    fragColor = uv.y>0.5? \n        vec4(spectral_zucconi(w), 1.) : \n        vec4(spectral_zucconi6(w), 1.);\n}","name":"Image","description":"","type":"image"}]}