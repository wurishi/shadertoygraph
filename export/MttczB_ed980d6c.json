{"ver":"0.1","info":{"id":"MttczB","date":"1533092103","viewed":107,"name":"clock with basic shape","username":"guowei","description":"basic shape, circle, line","likes":0,"published":1,"flags":0,"usePreview":0,"tags":["clock","basicshape"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"//original from https://zhuanlan.zhihu.com/p/39798563?utm_source=ZHShareTargetIDMore&utm_medium=social&utm_oi=70060592857088\n\nfloat circle(vec2 pixel, vec2 center, float radius, float blurSize);\nfloat line(vec2 pixel, vec2 pa, vec2 pb, float width, float blurSize);\nmat2 rotateMatrix(float angle);\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 uv = (fragCoord - 0.5 * iResolution.xy)/iResolution.y;\n    \n    //shake the clock\n    float tt=mod(iTime,1.5)/1.5;\n  \tfloat ss=1.0+0.5*sin(tt*3.1415*6.0+uv.x*0.5)*exp(-tt*4.0);\n  \tuv*=(vec2(0.7,1.5)+ss*vec2(0.3,-0.5));\n\t\n    //paint the clock\n    float circleBodySign = circle(uv, vec2(0.0, 0.0), 0.3, 0.005);\n    vec4 clockBodyColor = mix(vec4(0.404, 0.824, 0.784, 1.0), vec4(0, 0.0, 0.0, 0.0), circleBodySign);\n    \n    float circleBodyWhiteSign = circle(uv, vec2(0.0, 0.0), 0.28, 0.005);\n    vec4 clockBodyWhiteColor = mix(vec4(1.0, 1.0, 1.0, 1.0), vec4(0.0, 0.0, 0.0, 0.0), circleBodyWhiteSign);\n    \n    fragColor = vec4(clockBodyColor);\n    fragColor += clockBodyWhiteColor;\n    \n    mat2 rotationSecond = rotateMatrix(iTime + 45.0/3.14);   \n    float secondLineSign = line(uv, vec2(0.0, 0.2) * rotationSecond, vec2(0.0, -0.03) * rotationSecond, 0.005, 0.005);\n    fragColor = mix(vec4(1.0, 0.0, 0.0, 1.0), fragColor, secondLineSign);\n    //float hourLineSign = line(uv, vec2(0.0, 0.0), vec2(-0.2, 0.15), 0.005, 0.005);\n    //fragColor = mix(vec4(1.0, 0.0, 0.0, 1.0), fragColor, hourLineSign);\n    \n    mat2 rotationMinute = rotateMatrix(iTime/5.0 + 15.0/6.283);\n    float minuteLineSign = line(uv, vec2(0.0, 0.15) * rotationMinute, vec2(0.0, -0.03) * rotationMinute, 0.007, 0.005);\n    fragColor = mix(vec4(0.0, 0.0, 0.0, 1.0), fragColor, minuteLineSign);\n    \n    mat2 rotationHour = rotateMatrix(iTime/10.0 + 45.0/6.283);\n    float hourLineSign = line(uv, vec2(0.0, 0.1) * rotationHour, vec2(0.0, -0.03) * rotationHour, 0.009, 0.005);\n    fragColor = mix(vec4(0.0, 0.0, 0.0, 1.0), fragColor, hourLineSign);\n}\n\nfloat circle(vec2 pixel, vec2 center, float radius, float blurSize) {\n\tvec2 vectorPixelToCenter = pixel - center;\n    float distanceToCenter = length(vectorPixelToCenter);\n    \n    return smoothstep(radius - blurSize, radius, distanceToCenter);\n}\n\n//float line(vec2 pixel, vec2 pa, vec2 pb, float width, float blurSize) {\n\t//vec2 vpa = pixel - pa;\n   // vec2 vba = pb - pa;\n    //vec2 dirBa = normalize(vba);\n    \n    //float shadowVpaOnVba = clamp(dot(vpa, dirBa), 0.0, length(vba));\n    //float dist = length(vpa - dirBa * shadowVpaOnVba);\n    \n    //return smoothstep(width - blurSize, width, dist);\n//}\n\nfloat line(vec2 p, vec2 a, vec2 b, float width, float blur) {\n  vec2 pa = p - a;\n  vec2 ba = b - a;\n  vec2 dir = normalize(ba);\n  float t = clamp(dot(pa, dir), 0., length(ba));\n  float dist = length(pa - dir * t);\n  return smoothstep(width - blur, width, dist);\n}\n\nmat2 rotateMatrix(float angle) {\n\treturn mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n}","name":"Image","description":"","type":"image"}]}