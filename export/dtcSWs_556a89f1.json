{"ver":"0.1","info":{"id":"dtcSWs","date":"1686143065","viewed":103,"name":"Hyperbola segment - Dist L-inf","username":"Poisson","description":"Exact Hyperbola segment sdf in L-inf space.","likes":11,"published":1,"flags":0,"usePreview":0,"tags":["2d","raymarching","math","sdf","square","distance","conic","section","signed","maths","metric","hyperbola","maxnorm","conics"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// Hyperbola distance in L-inf space\n\n/*\nThe distance equation:\n\n(x-t) + (y-sqrt(t^2 + k^2)) = 0\nx + y - t = sqrt(t^2 + k^2)\nx^2 + y^2 + t^2 - 2yt + 2xy - 2xt = t^2 + k^2\n2(x - y)t + x^2 + y^2  + 2xy - k^2 = 0\n\nSolve linear equation:\n\na = 2(x - y)\nb = x^2 + y^2  + 2xy - k^2;\nt = -b/a\n\nFinal distance:\nd = max(x-t, y-sqrt(t^2 + k^2))\n*/\n\nfloat sdHyperbola(vec2 p, float k, float wi) {\n    p = abs(p);\n    float k2 = k*k;\n    \n    float a = p.x + p.y;\n    float b = a*a - k2;\n    if (b<0.) return k-p.y;\n    float x = min(.5*b/a, wi);\n    \n    vec2 q = p - vec2(x, sqrt(x*x + k2));\n    float s = sign(q.x-q.y);\n    return s*max(q.x,q.y);\n}\n\n/*\n// infinite hyperbola (not a segment)\nfloat sdHyperbola(vec2 p, float k, float wi) {\n    p = abs(p);    \n    float a = p.x + p.y;\n    float b = a*a - k*k;\n    \n    if (b<0.) return k-p.y;\n    return p.x - .5*b/a;\n}\n*/\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 p = (2.*fragCoord - iResolution.xy) / iResolution.y;\n\n    float k = .35+.25*sin(iTime);\n    float wi = .55+.35*cos(1.5*iTime);\n\tfloat d = sdHyperbola(p, k, wi);\n    \n\t// coloring\n    vec3 col = (d>0.) ? vec3(.4,1,1) : vec3(1,.4,.55);\n    col *= 1.-exp(-8.*abs(d));\n\tcol *= .8 + .2*cos(180.*d);\n\tcol = mix(col, vec3(1), smoothstep(.01,0.,abs(d)));\n\n    vec2 m = iMouse.z>0. ? (2.*iMouse.xy - iResolution.xy) / iResolution.y\n                         : .7*vec2(sin(.4*iTime),cos(.7*iTime));\n\n    d = sdHyperbola(m, k, wi);\n    vec2 q = abs(p-m);\n    col = mix(col, vec3(1,1,0), smoothstep(.01,0., abs(max(q.x,q.y)-abs(d))-.0025));\n    col = mix(col, vec3(1,1,0), smoothstep(.01,0., length(p-m)-.015));\n        \n    p = abs(p);\n    col = mix(col, vec3(1,1,0), smoothstep(.01,0., length(p - vec2(wi,sqrt(wi*wi+k*k)))-.02));\n    col = mix(col, vec3(1,1,0), smoothstep(.01,0., length(p - vec2(0,k))-.02));   \n\n\tfragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}