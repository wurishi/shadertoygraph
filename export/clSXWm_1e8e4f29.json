{"ver":"0.1","info":{"id":"clSXWm","date":"1677818107","viewed":115,"name":"Diverdiva","username":"yukithm","description":"連なるペアカラーの立方体","likes":9,"published":1,"flags":0,"usePreview":0,"tags":["raytracingfbm"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"precision highp float;\n\n\nconst float REPEAT = 5.0;\n\n#define rot(a) mat2(cos(a+vec4(0,-1.57,1.57,0))) \n\n//立方体の距離関数\nfloat sdBox( vec3 q, float b )\n{\n\tq = abs(q) - b;\n\treturn length(max(q,0.)) + min(max(q.x,max(q.y,q.z)),0.);\n}\n\nfloat map(vec3 pos, float iTime) {\n\tpos.xy *= rot(0.8);\n\treturn -sdBox(pos*(2.-abs(sin(iTime*0.4))*1.5),.4)/1.5;\n}\n\n#define random2(U) (2.*fract(sin((U)*mat2(127.1,311.7,269.5,183.3))*43758.5453123)-1.)\n\n//パーリンノイズ関数\nfloat perlinNoise(vec2 st) \n{\n    vec2 p = floor(st),\n         f = fract(st),\n         u = f*f*(3.-2.*f),\n\n         v00 = random2(p+vec2(0,0)),\n         v10 = random2(p+vec2(1,0)),\n         v01 = random2(p+vec2(0,1)),\n         v11 = random2(p+vec2(1,1));\n\n    return mix( mix( dot( v00, f - vec2(0,0) ), dot( v10, f - vec2(1,0) ), u.x ),\n                 mix( dot( v01, f - vec2(0,1) ), dot( v11, f - vec2(1,1) ), u.x ), \n                 u.y)+.5f;\n}\n\n//fBmノイズ関数\nfloat fBm (vec2 q) \n{\n    float f = 0.,\n          s = .5;\n\n    for( int i=0; i< 4; i++, q*=2.02, s/=2. )\n        f += s * perlinNoise(q);\n\n    return f;\n}\n\n\nvoid mainImage( out vec4 O, vec2 u ) {\n\n    float t = .1, ac = 0., i, T = iTime, C = sin(T)*.3,d;\n    vec2 R = iResolution.xy,\n         p = (u.xy * 2. - R) / min(R.x,R.y),\n\n         ro_fBm = vec2(T/2.);\n         ro_fBm.x = fBm(ro_fBm);\n         ro_fBm.y = fBm(ro_fBm);\n         \n\tvec3 ro = vec3(ro_fBm ,T * 4.),\n         ray = normalize(vec3(p, 1.5));\n\tray.xy *= rot(sin(T * .03) * 5.);\n\n    //レイマーチング\n\tfor (i = 0.; i < 1.; i+=.01){\n\t\tvec3 pos = ro + ray * t;\n\t\tpos = mod(pos-2., 4.) -2.;\n\t\t\n\t\tfloat d = map(pos, T-i);\n\n\t\td = max(abs(d), .01);\n\t\tac += exp(-d*23.);\n\n\t\tt += d*.55;\n\t}\n\n    O = ac*.02 + vec4(max(-C,0.),0,C,0);\n}","name":"Image","description":"","type":"image"}]}