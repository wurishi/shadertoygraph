{"ver":"0.1","info":{"id":"ssGGDd","date":"1632402424","viewed":234,"name":"Image distortion using mouse","username":"TimurAB","description":"Image area inside a half of an ellipse is stretching towards mouse cursor (dumb idea, but was not easy)","likes":0,"published":1,"flags":2,"usePreview":0,"tags":["postprocessing","distortion","webcam"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4sf3zn","filepath":"/presets/webcam.png","previewfilepath":"/presets/webcam.png","type":"webcam","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord.xy / iResolution.xy;\n    vec4 m = iMouse;\n    vec2 res = iResolution.xy;\n    vec2\n        b = vec2(m.x / res.x, m.y / res.y),             // click start\n        a = vec2(abs(m.z) / res.x, abs(m.w) / res.y);   // click end\n    float angle = atan(b.y-a.y, b.x-a.x);               // mouse drag direction\n    vec2 v = uv;  // find ellipse area\n    v -= a;\n    v = vec2(\n        v.x * cos(angle) + v.y * sin(angle),\n        v.y * cos(angle) - v.x * sin(angle)\n    );\n    float scale = 6.0; // ellipse proportions\n    v.x /= scale * length(b - a);\n    v += a;\n    float f = dot(normalize(uv - a), normalize(b - a));  // find half of the shape\n    f = smoothstep(-.25, 1.0, f);\n    if (length(v - a) < 1.0 / scale) {\n        uv -= .95 * f * length(uv-a) * vec2(cos(angle), sin(angle)); // new coordinates\n    }\n\n    vec3 col = texture(iChannel0, uv).rgb; // get image\n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}