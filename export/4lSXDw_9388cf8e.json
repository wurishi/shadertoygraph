{"ver":"0.1","info":{"id":"4lSXDw","date":"1443983388","viewed":786,"name":"Docking","username":"dila","description":"Trying to come up with something original, and failing. Sorry about the speed.","likes":20,"published":1,"flags":0,"usePreview":0,"tags":["raymarching"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[],"code":"vec2 map(vec3 p)\n{\n    float g = 4.0;\n\tvec3 q = (fract(p/g) * 2.0 - 1.0) * g;\n    float m = 0.0;\n    float md = 1000.0;\n    const int ni = 3;\n    for (int i = 0; i < ni; ++i) {\n       \tfloat f = float(i+1) / float(ni);\n        vec3 s = 0.5 - abs(normalize(q));\n        q = sign(q) * s;\n        float d = length(q) - 0.25;\n        if (d < md) {\n            md = d;\n            m = f;\n        }\n    }\n    float tr = mix(1.0, 4.0, 0.5+0.5*sin(p.z*4.0));\n    float cv = pow(length(p.xy), 0.5) - tr;\n    md = max(md, -cv);\n    return vec2(md, m);\n}\n\nvec3 normal(vec3 p)\n{\n\tvec3 o = vec3(0.01, 0.0, 0.0);\n    return normalize(vec3(map(p+o.xyy).x - map(p-o.xyy).x,\n                          map(p+o.yxy).x - map(p-o.yxy).x,\n                          map(p+o.yyx).x - map(p-o.yyx).x));\n}\n\nfloat trace(vec3 o, vec3 r)\n{\n    float t = 0.0;\n    for (int i = 0; i < 128; ++i) {\n        vec3 p = o + r * t;\n        float d = map(p).x;\n        t += d * 0.1;\n    }\n    return t;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 uv = fragCoord.xy / iResolution.xy;\n    uv = uv * 2.0 - 1.0;\n    uv.x *= iResolution.x / iResolution.y;\n    \n    vec3 r = normalize(vec3(uv, 1.0));\n    vec3 o = vec3(0.0, 0.0, iTime);\n    \n    float t = trace(o, r);\n    vec3 w = o + r * t;\n    vec2 fd = map(w);\n   \tvec3 sn = normal(w);\n    \n    float prod = max(dot(r, -sn), 0.0);\n    float fog = prod * 1.0 / (1.0 + t * t * 0.01 + fd.x * 100.0);\n    \n    vec3 sc = vec3(0.25, 0.5, 1.0);\n    vec3 ec = vec3(1.0, 1.0, 1.0);\n    vec3 fc = mix(sc, ec, fd.y);\n    \n    fc *= fog;\n    \n\tfragColor = vec4(sqrt(fc),1.0);\n}","name":"","description":"","type":"image"}]}