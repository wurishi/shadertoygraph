{"ver":"0.1","info":{"id":"wlVXRc","date":"1583299187","viewed":175,"name":"Ray Triangle Intersection","username":"bhuwan0000","description":"learning ray triangle intersection","likes":4,"published":1,"flags":0,"usePreview":0,"tags":["ray","triangle","intersection","point"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"float mag(vec3 i)\n{\n    return sqrt(i.x*i.x + i.y*i.y + i.z);\n}\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // Normalized pixel coordinates (from 0 to 1)\n    vec2 uv = fragCoord/iResolution.xy;\n\tuv -= 0.5;\n    uv.x *= iResolution.x/iResolution.y;\n    \n    vec3 lookat = vec3(0.0, 0.0, 0.0);\n    float zoom = 2.;\n    \n    vec3 ro = vec3(0.0, 0.0, 2.0);\n   // vec3 ro = vec3(0.0, 0.0, 2.0);\n    //vec3 rd = normalize(vec3(uv.x, uv.y, 1.0));\n    \n    vec3 f = normalize(lookat-ro);\n    vec3 r = cross(vec3(0., 1., 0.), f);\n    vec3 u = cross(f, r);\n    \n    vec3 c = ro + f*zoom;\n    vec3 i = c + uv.x*r + uv.y*u;\n    vec3 rd = i-ro;\n    \n    //triangle\n    vec3 A = vec3(-0.5, -0.2, 0.0);\n    vec3 B = vec3( 0.5, -0.2, 0.0);\n    vec3 C = vec3(-0.0,  0.4, 0.0);\n   // vec3 D = vec3( 0.5,  0.5, 0.0);\n    \n    vec3 n = cross((B-A), (C-A))/mag(cross((B-A), (C-A))); // normal\n    \n    float t = (dot(n, ro) + dot(n, A)) / dot(n, rd);\n    vec3 Q = ro + rd*t; // hit point\n    \n    float ar_ABC = dot(cross((B-A), (C-A)), n);\n    //float ar_BCD = dot(cross((C-B), (D-B)), n);\n    \n    //barycentric coordinates    \n    float ar_QBC = dot(cross((B-A), (Q-A)), n)/ar_ABC;\n\tfloat ar_AQC = dot(cross((C-B), (Q-B)), n)/ar_ABC;\n\tfloat ar_ABQ = dot(cross((A-C), (Q-C)), n)/ar_ABC;\n\n\n    fragColor = vec4(0.);\n    if (dot(cross((B-A), (Q-A)), n) >= 0.)\n    {\n        if (dot(cross((C-B), (Q-B)), n) >= 0.)\n        {\n            if (dot(cross((A-C), (Q-C)), n) >= 0.)\n            {\n                fragColor = vec4(ar_QBC, ar_AQC, ar_ABQ, 1.0);\n                \n            }\n        }\n    }\n            \n        \n}","name":"Image","description":"","type":"image"}]}