{"ver":"0.1","info":{"id":"mtcGW8","date":"1682321266","viewed":49,"name":"Image roll","username":"PuddingWang","description":"one simple effect, one image roll from center","likes":1,"published":1,"flags":0,"usePreview":0,"tags":["simpleeffect"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dfGRn","filepath":"/media/a/8de3a3924cb95bd0e95a443fff0326c869f9d4979cd1d5b6e94e2a01f5be53e9.jpg","previewfilepath":"/media/ap/8de3a3924cb95bd0e95a443fff0326c869f9d4979cd1d5b6e94e2a01f5be53e9.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"const float PI = 3.1415926;\nconst float duration = 2.0;\n\nvec4 getMaskColor(float time, vec2 textureCoords, float padding)\n{\n    vec2 translation = vec2(sin(time * (PI*2.0 / duration)), cos(time * (PI*2.0 / duration)));\n    vec2 translatedTextureCoords = textureCoords + padding* translation;\n    vec4 maskColor = texture(iChannel0, translatedTextureCoords);\n    return maskColor;\n}\n\nfloat getAlphaProgress(float currentTime, float hideTime, float startTime)\n{\n    float time = mod(duration + currentTime - startTime, duration);\n    return min(time, hideTime);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    float time = mod(iTime, duration);\n    float scale = 1.2;\n    float padding = 0.5 * (1.0 - 1.0/scale);\n    \n    // Normalized pixel coordinates (from 0 to 1)\n    vec2 uv = fragCoord/iResolution.xy;\n    vec2 editedUv = vec2(0.5, 0.5) + (uv - vec2(0.5,0.5)/scale); \n\n    float hideTime = 0.9;\n    float timeGap = 0.2;\n    \n    float maxAlphaR = 0.5;\n    float maxAlphaG = 0.05;\n    float maxAlphaB = 0.05;\n    \n    // we got image color of current time by padded and functions operated\n    vec4 originTranslatedColor = getMaskColor(time, uv, padding);\n    \n    float alphaR = 1.0;\n    float alphaG = 1.0;\n    float alphaB = 1.0;\n\n    vec4 resultMaskColor;\n    \n    for(float nowTime= 0.0; nowTime<duration; nowTime+= timeGap)\n    {\n        // we got image color of pre time by padded and functions operated\n        vec4 preMaskColor = getMaskColor(nowTime, uv, padding);\n        float preAlphaR = maxAlphaR - maxAlphaR*getAlphaProgress(time, hideTime, nowTime);\n        float preAlphaG = maxAlphaG - maxAlphaG*getAlphaProgress(time, hideTime, nowTime);\n        float preAlphaB = maxAlphaB - maxAlphaB*getAlphaProgress(time, hideTime, nowTime);\n        \n        resultMaskColor += vec4(\n            preMaskColor.r * preAlphaR, preMaskColor.g * preAlphaG, preMaskColor.b * preAlphaB, 1.0);\n        \n        alphaR -= preAlphaR;\n        alphaG -= preAlphaG;\n        alphaB -= preAlphaB;\n    }\n    \n    // we mix current and pre colors\n    resultMaskColor += vec4(\n        originTranslatedColor.r * alphaR, \n        originTranslatedColor.g * alphaG, \n        originTranslatedColor.b * alphaB, 1.0);\n\n\n    // Output to screen\n    fragColor = resultMaskColor;\n}","name":"Image","description":"","type":"image"}]}