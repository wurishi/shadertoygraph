{"ver":"0.1","info":{"id":"stXSDj","date":"1626533837","viewed":70,"name":"MortonCode","username":"taqu","description":"Calculate morton codes by one LUT","likes":1,"published":1,"flags":0,"usePreview":0,"tags":["mortoncode"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"uvec4[8] MortonCodeLUT = uvec4[8](\n uvec4(0x0U, 0x1U, 0x8U, 0x9U),\n uvec4(0x40U, 0x41U, 0x48U, 0x49U),\n uvec4(0x200U, 0x201U, 0x208U, 0x209U),\n uvec4(0x240U, 0x241U, 0x248U, 0x249U),\n uvec4(0x1000U, 0x1001U, 0x1008U, 0x1009U),\n uvec4(0x1040U, 0x1041U, 0x1048U, 0x1049U),\n uvec4(0x1200U, 0x1201U, 0x1208U, 0x1209U),\n uvec4(0x1240U, 0x1241U, 0x1248U, 0x1249U)\n);\n\nuint mortonCode(uint x)\n{\n  uint index = x>>2;\n  uint e = x&03U;\n  return MortonCodeLUT[index][e];\n}\n\nuint mortonCode3(uvec3 xyz)\n{\n    xyz &= uvec3(1023U, 1023U, 1023U);\n    uint x = mortonCode(xyz.x & 0x1FU) | (mortonCode((xyz.x>>5)&0x1FU)<<15);\n    uint y = mortonCode(xyz.y & 0x1FU) | (mortonCode((xyz.y>>5)&0x1FU)<<15);\n    uint z = mortonCode(xyz.z & 0x1FU) | (mortonCode((xyz.z>>5)&0x1FU)<<15);\n    return x | (y<<1) | (z<<2);\n}\n\nvec4 toColor(uint code)\n{\n   float a = float((code>>24)&0xFFU)*(1.0/255.0);\n   float b = float((code>>16)&0xFFU)*(1.0/255.0);\n   float g = float((code>> 8)&0xFFU)*(1.0/255.0);\n   float r = float((code>> 0)&0xFFU)*(1.0/255.0);\n   return vec4(r, g, b, a);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // Normalized pixel coordinates (from 0 to 1023)\n    uvec3 uv = uvec3(fragCoord.x/iResolution.x*1024.0, fragCoord.y/iResolution.y*1024.0, 0);\n    uint code = mortonCode3(uv);\n    vec4 col = toColor(code);\n\n    // Output to screen\n    fragColor = col;\n}","name":"Image","description":"","type":"image"}]}