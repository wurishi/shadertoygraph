{"ver":"0.1","info":{"id":"wts3RX","date":"1557167218","viewed":1600,"name":"Cube root function","username":"scholarius","description":"Cube root function without using pow()\nDoes not choke on negative numbers either.","likes":8,"published":1,"flags":0,"usePreview":0,"tags":["cube","approximation","function","error","power","polynomial","root"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\n#define NEWTON_ITER 1\n#define HALLEY_ITER 1\n\nfloat cbrt( float x )\n{\n\tfloat y = sign(x) * uintBitsToFloat( floatBitsToUint( abs(x) ) / 3u + 0x2a514067u );\n\n\tfor( int i = 0; i < NEWTON_ITER; ++i )\n    \ty = ( 2. * y + x / ( y * y ) ) * .333333333;\n\n    for( int i = 0; i < HALLEY_ITER; ++i )\n    {\n    \tfloat y3 = y * y * y;\n        y *= ( y3 + 2. * x ) / ( 2. * y3 + x );\n    }\n    \n    return y;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = 2. * ( fragCoord - iResolution.xy / 2. ) / iResolution.y;\n\tfloat x = uv.x;    \n    float y = cbrt(x);\n    float invddx = 3. * cbrt(x) * cbrt(x);\n\n    // compute relative error wrt. to pow\n    float rel_error = round( 16777216. * abs( abs(y) / pow( abs(x), .333333333 ) - 1. ) ) / 40.;\n    \n    vec2 d = vec2(1.);\n    d.x = min( d.x, .875 + .0625 * iResolution.y * abs( uv.y - round( uv.y * 10. ) / 10. ) );\n    d.x = min( d.x, .875 + .0625 * iResolution.y * abs( uv.x - round( uv.x * 10. ) / 10. ) );\n    d.x = min( d.x, .5 + .25 * iResolution.y * abs( uv.y - round( uv.y ) ) );\n    d.x = min( d.x, .5 + .25 * iResolution.y * abs( uv.x - round( uv.x ) ) );\n    \n    d.x = min( d.x, .0 + .5 * iResolution.y * abs( rel_error - uv.y ) / max( 1., fwidth( rel_error ) ) );    \n    d.y = min( d.y, -.5 + .5 * iResolution.y * abs( y - uv.y ) * min( 1., invddx ) );\n    \n    fragColor.xyz = vec3( clamp( d.x, 0., 1. ) );\n    fragColor.xyz = mix( vec3(.1,.3,1.), fragColor.xyz, clamp( d.y, 0., 1. ) );\n    fragColor.xyz = pow( fragColor.xyz, vec3(0.4545) );\n}","name":"Image","description":"","type":"image"}]}