{"ver":"0.1","info":{"id":"4scXRr","date":"1457284006","viewed":283,"name":"trailing","username":"jpweiyi","description":"only test trailing.","likes":1,"published":1,"flags":0,"usePreview":0,"tags":["2dtrailingwithoutbuffer"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"vec2 rotation(vec2 p, float angle)\n{\n    float rad = radians(angle);\n    return vec2(p.x*cos(rad)+p.y*sin(rad) -cos(rad*0.3)*0.4, \n                -p.x*sin(rad)+p.y*cos(rad) + sin(1.-rad)*.2);\n}\n\n\nfloat line(vec2 p, vec2 a, vec2 b, float w)\n{\n     vec2 a2b = b - a;\n     vec2 a2p = p - a;     \n     \n     // å› ä¸ºæŠ•å½± proj(a2p,a2b) ç­‰äºŽ dot(a2p,a2b) / length(a2b)\n     // åœ¨æŠŠæŠ•å½±çš„å€¼å’Œa2bå‘é‡åšæ¯”ä¾‹å…³ç³»ã€‚\n     // æ‰€ä»¥proj(a2p,a2b)/length(a2b) ç­‰äºŽ dot(a2p,a2b)/dot(a2b,a2b)\n     \n     float h = clamp( dot(a2p,a2b)/dot(a2b,a2b), 0.0, 1.0 );\n     vec2 p1 = mix( a, b, h );\n     if( length( p1 - p ) <= w )\n         return 1.0;\n     \n     return 0.0;\n}\n\nconst vec4 black_color = vec4(0.3, 0.3, 0.3, 1.0);\nconst vec4 axis_color = vec4(0.0, 0.0, 1.0, 1.0);\n\n\nvoid animation(inout vec4 color,vec2 uv)\n{\n    vec4 newColor = color;\n    const float loop = 40.0;\n    float time = iTime - 1.0;\n    for(float i = 0.0; i < loop; ++i)\n    {// ç”»åœ†\n\t\tif(line(rotation(uv, (time+i*0.1)* 70.0), \n                \t\t  vec2(0.5,0.0), \n                          vec2(0.5, 0.0), \n                          smoothstep(0.0, 0.2, i/loop*0.2)*0.2\n                          /*0.2*/) > 0.0)\n    \t{\n        \tnewColor = mix(color, vec4(1.0, 0.0, 0.0, 1.0), smoothstep(0.0,loop,i));\n    \t}\n    }\n    \n    color = newColor; \n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 uv = (fragCoord.xy / iResolution.xy) * 2.0 - 1.0;\n    uv.x *= iResolution.x / iResolution.y;\n    \n    // ç”»èƒŒæ™¯\n    vec4 color = black_color;\n    \n    // ç”»è½´\n    if(line(uv, vec2(-2.0, 0.0), vec2(2.0, 0.0), 0.01) > 0.0 ||\n      \tline(uv, vec2(0.0, -2.0), vec2(0.0, 2.0), 0.01) > 0.0){\n        color = axis_color;\n    }\n    \n\tanimation(color, uv);\n    \n   \tfragColor = color;\n}","name":"Image","description":"","type":"image"}]}