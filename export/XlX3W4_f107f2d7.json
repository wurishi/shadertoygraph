{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[],"code":"// chocolux by Auld\n// http://www.pouet.net/prod.php?which=49796\n// Conversion to ShaderToy by Michael Pohoreski\n// Source Code: http://sizecoding.blogspot.com/2008/02/chocolux-1k-intro.html\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // Original Win32 code was using milliseconds and converting to seconds.\n    vec3 s[4];\n    s[0] = vec3(0);\n    s[3] = vec3(sin(abs( iTime*.1)),cos(abs(iTime*.1)),0);\n    s[1] = s[3].zxy;\n    s[2] = s[3].zzx;\n\n    float t,b,c,h=0.;\n    vec3 m, n, p=vec3(.2), d = normalize(.001*vec3(fragCoord,0.)-p);\n    for( int i = 0; i < 4; i++ )\n    {\n        t = 2.;\n        for( int i = 0; i < 4; i++ ) // intentional re-use of same var i ??\n        {\n            b = dot(d, n = s[i] - p );\n            c = b*b + .2 - dot(n,n);\n            if (b - c < t)\n                if (c > 0.)\n                {\n                    m = s[i];\n                    t = b - c;\n                }\n        }\n        p += t*d;\n        d = reflect(d,n=normalize(p-m));\n        h += pow(n.x*n.x,44.) + n.x*n.x * .2;\n    }\n    fragColor = vec4(h,h*h,h*h*h*h,1.0); // original: alpha=h but that is a bug!\n} \n\n/* Original Win32 source code in case you're curious!\n\n#include <windows.h>\n#include <GL/gl.h>\n#include <GL/glext.h>\nchar *vsh=\"\\\nvarying vec3 s[4];\\\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ){\\\ngl_Position=gl_Vertex;\\\ns[0]=vec3(0);\\\ns[3]=vec3(sin(abs(gl_Vertex.x*.0001)),\\\ncos(abs(gl_Vertex.x*.0001)),0);\\\ns[1]=s[3].zxy;\\\ns[2]=s[3].zzx;}\";\nchar *fsh=\"\\\nvarying vec3 s[4];\\\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ){\\\nfloat t,b,c,h=0;\\\nvec3 m,n,p=vec3(.2),d=normalize(.001*fragCoord.rgb-p);\\\nfor(int i=0;i<4;i++){\\\nt=2;\\\nfor(int i=0;i<4;i++){\\\nb=dot(d,n=s[i]-p);\\\nc=b*b+.2-dot(n,n);\\\nif(b-c<t)if(c>0){m=s[i];t=b-c;}\\\n}\\\np+=t*d;\\\nd=reflect(d,n=normalize(p-m));\\\nh+=pow(n.x*n.x,44.)+n.x*n.x*.2;\\\n}\\\nfragColor=vec4(h,h*h,h*h*h*h,h);}\";\n\nPIXELFORMATDESCRIPTOR pfd={0,1,PFD_SUPPORT_OPENGL|PFD_DOUBLEBUFFER, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 32, 0, 0, 0, 0, 0, 0, 0};\nDEVMODE dmScreenSettings={ 0,0,0,sizeof(DEVMODE),0,DM_PELSWIDTH|DM_PELSHEIGHT, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1024,768,0,0,0,0,0,0,0,0,0,0};\nvoid WinMainCRTStartup()\n{\n  ChangeDisplaySettings(&dmScreenSettings,CDS_FULLSCREEN);\n  HDC hDC = GetDC(CreateWindow(\"edit\",0,WS_POPUP | WS_VISIBLE | WS_MAXIMIZE, 0, 0, 0, 0, 0, 0, 0, 0));\n  SetPixelFormat(hDC, ChoosePixelFormat(hDC, &pfd) , &pfd);\n  wglMakeCurrent(hDC, wglCreateContext(hDC));\n  ShowCursor(0);\n  GLuint p = ((PFNGLCREATEPROGRAMPROC)wglGetProcAddress(\"glCreateProgram\"))();\n  GLuint s = ((PFNGLCREATESHADERPROC)(\n    wglGetProcAddress(\"glCreateShader\")))(GL_VERTEX_SHADER);\n    ((PFNGLSHADERSOURCEPROC)wglGetProcAddress(\"glShaderSource\"))(s,1, &vsh,0);\n    ((PFNGLCOMPILESHADERPROC)wglGetProcAddress(\"glCompileShader\"))(s);\n    ((PFNGLATTACHSHADERPROC)wglGetProcAddress(\"glAttachShader\"))(p,s);\n  s = ((PFNGLCREATESHADERPROC)\n    wglGetProcAddress(\"glCreateShader\"))(GL_FRAGMENT_SHADER);\n    ((PFNGLSHADERSOURCEPROC)wglGetProcAddress(\"glShaderSource\"))(s,1, &fsh,0);\n    ((PFNGLCOMPILESHADERPROC)wglGetProcAddress(\"glCompileShader\"))(s);\n    ((PFNGLATTACHSHADERPROC)wglGetProcAddress(\"glAttachShader\"))(p,s);\n    ((PFNGLLINKPROGRAMPROC)wglGetProcAddress(\"glLinkProgram\"))(p);\n    ((PFNGLUSEPROGRAMPROC)wglGetProcAddress(\"glUseProgram\"))(p);\nloop:\n  int t=GetTickCount();\n  glRecti(t,t,-t,-t);\n  SwapBuffers(hDC);\n  if (GetAsyncKeyState(VK_ESCAPE)) ExitProcess(0);\n  goto loop;\n}\n\n*/\n","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"XlX3W4","date":"1421901447","viewed":843,"name":"Chocolux Reloaded","username":"MichaelPohoreski","description":"chocolux by Auld (1k Win32 Demo!)\nConverted to ShaderToy by Michael Pohoreski\nhttp://www.pouet.net/prod.php?which=49796","likes":7,"published":1,"flags":0,"usePreview":0,"tags":["procedural","2d","chocolate"],"hasliked":0,"parentid":"","parentname":""}}