{"ver":"0.1","info":{"id":"cdsSWj","date":"1669576290","viewed":84,"name":"StereographicCubeMap","username":"blublublublucas","description":"Stereographic Projection of a Cube Map, Mouse drag changes the rotation and radius of the projection","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["projection","stereographic","360image"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XsfGzn","filepath":"/media/a/585f9546c092f53ded45332b343144396c0b2d70d9965f585ebc172080d8aa58.jpg","previewfilepath":"/media/ap/585f9546c092f53ded45332b343144396c0b2d70d9965f585ebc172080d8aa58.jpg","type":"cubemap","channel":0,"sampler":{"filter":"mipmap","wrap":"clamp","vflip":"false","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define PI  (3.14159265359) // pi\n#define PIH (1.57079632679) // half pi\n#define TAU (6.283185307)\n\n#define COMPACT (1)\n\n#if (COMPACT)\n#define DIR dir_compact\t\n#else\n#define DIR dir\t\n#endif\n\n\n/* Cube Map - LatLong take from\nhttps://www.shadertoy.com/view/4tByRm\n** http://paulbourke.net/miscellaneous/cubemaps/\n*/\nvec3 dir(vec2 p)\n{\n    /* First calculate spherical coords (theta, phi, R) on\n\t** 2D plane.\n\t** The mapping is simple:\n\t**\n\t** pixel coords    normalized     spherical coords\n\t** [0:w, 0:h]  ->  [-1:1,-1:1] -> [-pi:pi, -pi/2:pi/2]\n\t*/    \n    vec2 uv = p * 2. - 1.;\n    uv.x *= PI;  // phi\n    uv.y *= PIH; // theta\n        \n    /* Calculate a direction from spherical coords:\n\t** R = 1\n    ** x = R sin(phi) cos(theta)\n\t** y = R sin(phi) sin(theta)\n\t** z = R cos(phi)\n\t*/\n    return vec3(cos(uv.x)*cos(uv.y)\n              , sin(uv.y)\n              , sin(uv.x)*cos(uv.y));\n}\n\nvec3 dir_compact(vec2 p)\n{\n    vec2 s = (p*2.-1.) * vec2(PI,PIH); // Spherical coords\n    vec4 t = vec4(sin(s), cos(s));       // Precalculated sin/cos values\n    return t.zyx * vec3(t.w, 1, t.w);    // Conversion to direction\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 mouse = iMouse.xy/iResolution.xy - vec2(0.5);\n    vec2 uv_centered = fragCoord.xy/iResolution.xy - vec2(0.5);\n    float r = length(uv_centered);\n    \n    float theta_long = atan(uv_centered.y, uv_centered.x);\n    float sample_x = mod(-0.2 * atan(mouse.y, mouse.x) + (theta_long + PI) / TAU, 1.0);\n\n    float theta_lat = acos((4.0 - pow(r,2.0))/(4.0 + pow(r,2.0)));\n    float sample_y = 1.41 * (0.5 + length(mouse)) * theta_lat;\n    vec2 samplePT = vec2(sample_x, sample_y);\n\n\n    fragColor = vec4(texture(iChannel0, DIR(samplePT)).xyz, 1);\n}","name":"Image","description":"","type":"image"}]}