{"ver":"0.1","info":{"id":"WtsSRs","date":"1563937638","viewed":196,"name":"make edge","username":"liutp","description":"edge detection","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["sobel","edge"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XdfGRr","filepath":"/media/a/35c87bcb8d7af24c54d41122dadb619dd920646a0bd0e477e7bdc6d12876df17.webm","previewfilepath":"/media/ap/35c87bcb8d7af24c54d41122dadb619dd920646a0bd0e477e7bdc6d12876df17.webm","type":"video","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\nvec3 GX[3];\nvec3 GY[3];\n\n//Sobel\n//为毛不能直接 const float G[3]={1.0, 2.0, 3.0};\nvoid initSobel(){\n  GX[0] = vec3(-1, -2, -1);\n  GX[1] = vec3(0, 0, 0);\n  GX[2] = vec3(1, 2, 1);\n\n  GY[0] = vec3(1, 0, -1);\n  GY[1] = vec3(2, 0, -2);\n  GY[2] = vec3(1, 0, -1);\n}\n\nfloat alpha(vec4 color){\n  if (length(color-vec4(0.0, 1.0, 0.0, 1.0))>0.5){ return 1.0;}\n  return 0.0;\n  //return color.r * 0.212 + color.g * 0.715 + color.b * 0.072;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n  initSobel();\n\n  vec2 uv = gl_FragCoord.xy/iResolution.xy;\n  vec4 col = texture(iChannel0, uv);\n  \n  float gx = 0.0;\n  float gy = 0.0;\n  for (int i=0; i<=2; i++){\n    {\n      float c = alpha(texture(iChannel0, vec2(fragCoord.x+float(i),fragCoord.y)/iResolution.xy));\n      gx += (c*GX[i].x);\n      gy += (c*GY[i].x);\n    }\n    {\n      float c = alpha(texture(iChannel0, vec2(fragCoord.x+float(i+1),fragCoord.y+1.0)/iResolution.xy));\n      gx += (c*GX[i].y);\n      gy += (c*GY[i].y);\n    }\n    {\n      float c = alpha(texture(iChannel0, vec2(fragCoord.x+float(i+2),fragCoord.y+2.0)/iResolution.xy));\n      gx += (c*GX[i].z);\n      gy += (c*GY[i].z);\n    }\n  }\n  float g = (abs(gx)+abs(gy))/9.0;\n  if(g>0.1){\n    fragColor = vec4(1,0,0,1);\n  }else{\n    fragColor = col;\n  }\n}","name":"Image","description":"","type":"image"}]}