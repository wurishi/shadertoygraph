{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[{"channel":0,"type":"texture","id":"4dfGRn","filepath":"/media/a/8de3a3924cb95bd0e95a443fff0326c869f9d4979cd1d5b6e94e2a01f5be53e9.jpg","sampler":{"filter":"mipmap","wrap":"repeat","vflip":"false","srgb":"false","internal":"byte"}}],"code":"#define F1 float\n#define F2 vec2\n#define F3 vec3\n#define F4 vec4\n\nF1 Linear1(F1 c){return(c<=0.04045)?c/12.92:pow((c+0.055)/1.055,2.4);}\nF3 Linear3(F3 c){return vec3(Linear1(c.r),Linear1(c.g),Linear1(c.b));}\nF1 Srgb1(F1 c){return(c<0.0031308?c*12.92:1.055*pow(c,0.41666)-0.055);}\nF3 Srgb3(F3 c){return vec3(Srgb1(c.r),Srgb1(c.g),Srgb1(c.b));}\n\nF3 photoLuma=F3(0.2126,0.7152,0.0722);\nF1 PhotoLuma(F3 c){return dot(c,photoLuma);}\n\n//\n// LARGE FILM GRAIN TEST\n//\n\nF1 Noise(F2 n,F1 x){n+=x;return fract(sin(dot(n.xy,F2(12.9898, 78.233)))*43758.5453)*2.0-1.0;}\nF1 NoiseB(F2 n,F1 x){n+=x;return fract(sin(dot(n.xy,F2(12.9898, 78.233)))*43758.5453);}\n\n// Step 1 in generation of the grain source texture.\nF1 Step1(F2 uv,F1 n){\n F1 a=1.0,b=2.0,c=-12.0,t=1.0;   \n return (1.0/(a*4.0+b*4.0+abs(c)))*(\n  Noise(uv+F2(-1.0,-1.0)*t,n)*a+\n  Noise(uv+F2( 0.0,-1.0)*t,n)*b+\n  Noise(uv+F2( 1.0,-1.0)*t,n)*a+\n  Noise(uv+F2(-1.0, 0.0)*t,n)*b+\n  Noise(uv+F2( 0.0, 0.0)*t,n)*c+\n  Noise(uv+F2( 1.0, 0.0)*t,n)*b+\n  Noise(uv+F2(-1.0, 1.0)*t,n)*a+\n  Noise(uv+F2( 0.0, 1.0)*t,n)*b+\n  Noise(uv+F2( 1.0, 1.0)*t,n)*a+\n 0.0);}\n    \n// Step 2 in generation of the grain source texture.\nF1 Step2(F2 uv,F1 n){\n F1 a=1.0,b=2.0,c=4.0,t=1.0;   \n return (1.0/(a*4.0+b*4.0+abs(c)))*(\n  Step1(uv+F2(-1.0,-1.0)*t,n)*a+\n  Step1(uv+F2( 0.0,-1.0)*t,n)*b+\n  Step1(uv+F2( 1.0,-1.0)*t,n)*a+\n  Step1(uv+F2(-1.0, 0.0)*t,n)*b+\n  Step1(uv+F2( 0.0, 0.0)*t,n)*c+\n  Step1(uv+F2( 1.0, 0.0)*t,n)*b+\n  Step1(uv+F2(-1.0, 1.0)*t,n)*a+\n  Step1(uv+F2( 0.0, 1.0)*t,n)*b+\n  Step1(uv+F2( 1.0, 1.0)*t,n)*a+\n 0.0);}\n    \n// Used for stills.\nF3 Step3(F2 uv){\n F1 a=Step2(uv,0.07);    \n F1 b=Step2(uv,0.11);    \n F1 c=Step2(uv,0.13);\n return F3(a,b,c);}\n\n// Used for temporal dither.\nF3 Step3T(F2 uv){\n F1 a=Step2(uv,0.07*fract(iTime));    \n F1 b=Step2(uv,0.11*fract(iTime));    \n F1 c=Step2(uv,0.13*fract(iTime));\n return F3(a,b,c);}\n\n#define STEPS 16.0\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ){    \n F2 uv=fragCoord.xy;\n F2 uv2=fragCoord.xy/iResolution.xy;F2 uv3=F2(uv2.x,1.0-uv2.y); \n uv2.y=1.0-uv2.y;    \n F1 rep=2.0;\n F3 color=texture(iChannel0,uv2*rep).rgb;\n color=Linear3(color);\n F3 grain=Step3T(uv);\n // Prune effect at lighter luma.\n F1 prune=PhotoLuma(color);\n prune=sqrt(prune);\n prune=1.0-prune;\n prune*=sqrt(uv2.x);\n F2 off=grain.yz*2.5*prune;\n off/=iResolution.xy;\n // Adjust sampling position.\n color=texture(iChannel0,(uv2+off)*rep).rgb;\n color=Linear3(color);\n // TOP: Show grain.\n if(uv2.y<0.9){\n  color+=color*grain.xxx*(prune*10.0/1.0);\n  color=Srgb3(color);}\n // BOTTOM: Show noise texture.\n else{color=Step3(uv)*1.0*uv2.x+0.5;}    \n fragColor=F4(color,1.0);}\n\n\n","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"4sSXDW","date":"1412740240","viewed":3253,"name":"LargeGrain","username":"TimothyLottes","description":"Experimental film grain.","likes":13,"published":1,"flags":0,"usePreview":1,"tags":["largefilmgrain"],"hasliked":0,"parentid":"","parentname":""}}