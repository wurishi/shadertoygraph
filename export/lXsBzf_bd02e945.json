{"ver":"0.1","info":{"id":"lXsBzf","date":"1728736695","viewed":203,"name":"Worm truchet","username":"Trixelized","description":"worm!?","likes":23,"published":3,"flags":0,"usePreview":0,"tags":["truchet"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\n#define PI  3.14159265359\n#define TAU 6.28318530718\n\nfloat h21(vec2 val) {\n    val = fract(fract(val) * vec2(123.45, 678.91));\n    val += dot(val, val + 12.34);\n    return fract(val.x * val.y);\n}\n\nvec2 getTruchet(vec2 uv) {\n    vec2 id = floor(uv);\n    vec2 tuv = fract(uv) - 0.5;\n\n    float checkered = sign(mod(id.x + id.y, 2.0) - 0.5);\n\n    float rand = h21(id / 200.0);\n    if (rand > 0.5) tuv.x *= -1.0;\n\n    vec2 cuv = tuv * sign(tuv.x + tuv.y) - 0.5;\n    float dist = abs(length(cuv) - 0.5);\n    float angle = atan(cuv.x, cuv.y) / TAU;\n\n    float fangle = fract(angle * checkered * 2.0);\n\n    return vec2(dist, fangle);\n}\n\nfloat squish(float v, float aa, float p) {\n    return smoothstep(v + aa / 2.0, v - aa / 2.0, p);\n}\n\nvec3 truchetLayer(vec3 baseColor, vec2 uv) {\n    float aa = fwidth(length(uv));\n\n    vec2 tMain = getTruchet(uv);\n    vec2 tShd = getTruchet(uv + vec2(0.02, 0.08));\n    vec2 tHi = getTruchet(uv  - vec2(0.02, 0.08));\n    \n    float wormBump = pow(abs(sin(tMain.y * 4.0 * TAU + iTime)), 0.45);\n\n    vec3 fgCol = mix(\n        vec3(0.05),\n        vec3(0.35),\n        smoothstep(0.0, 0.4, tShd.x) + wormBump * 0.2\n    );\n\n    vec3 color = mix(\n        baseColor,\n        fgCol,\n        squish(0.08 + 0.04 * wormBump, aa, tMain.x)\n    );\n\n    color += smoothstep(0.8, 0.0, tHi.x) * 0.05;\n\n    return color;\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord) {\n    vec2 uv = (fragCoord - (0.5 * iResolution.xy)) / iResolution.y;\n\n    vec2 parallax = vec2(0.2, 0.1) * iTime;\n\n    vec3 color = vec3(0.0);\n\n    color = truchetLayer(color, uv * 8.0 + 25.0 + parallax) * 0.25;\n    color = truchetLayer(color, uv * 4.0 + 50.0 + parallax) * 0.50;\n    color = truchetLayer(color, uv * 2.0 + 75.0 + parallax) * 1.00;\n\n    color *= smoothstep(1.5, 0.0, length(uv));\n    color = pow(color * 2.8, vec3(0.95, 2.4, 1.6));\n\n    fragColor = vec4(color, 1.0);\n}","name":"Image","description":"","type":"image"}]}