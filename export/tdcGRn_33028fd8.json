{"ver":"0.1","info":{"id":"tdcGRn","date":"1567607168","viewed":182,"name":"finty","username":"foran","description":"finty","likes":13,"published":1,"flags":0,"usePreview":0,"tags":["finty"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XsBSR3","filepath":"/media/a/cb49c003b454385aa9975733aff4571c62182ccdda480aaba9a8d250014f00ec.png","previewfilepath":"/media/ap/cb49c003b454385aa9975733aff4571c62182ccdda480aaba9a8d250014f00ec.png","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsBSR3","filepath":"/media/a/cb49c003b454385aa9975733aff4571c62182ccdda480aaba9a8d250014f00ec.png","previewfilepath":"/media/ap/cb49c003b454385aa9975733aff4571c62182ccdda480aaba9a8d250014f00ec.png","type":"texture","channel":1,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\nfloat o(vec3 p)\n{\n  return cos(p.x) + cos(p.y*.5) + cos(p.z) + cos(p.y*20. + iTime)*.1 + texture(iChannel0, p.xy*.91).r*2.5 ;//  бочки в небе\n}\n\nfloat water( vec3 p)\n{\n  float d = p.y + texture(iChannel1, p.xz*.1+vec2(iTime*.01)).r*.1;//+ texture(iChannel1, p.xz*.1-vec2(iTime*.05)).r*.1;//вода\n  d = min(d, mix(length(p-vec3(0.,1.,iTime+2.5)) - 1., length(p.xy-vec2(sin(p.z),1.+cos(p.z))) - .5, cos(iTime)*.45+.5));//финтифлюшка\n  return d;\n}\n\nfloat map( vec3 p)\n{\n  float d = min(o(p), water(p));\n  return d;\n}\n\nvec3 rm( vec3 ro ,vec3 rd)\n{\n  vec3 p = ro;\n  for(int i=0; i<64; i++)\n  {\n    float d = map(p);\n  p += rd *d;\n  }\nreturn p;\n}\n\nvec3 normal( vec3 p)\n{\n  vec2 eps = vec2(0.01, 0.);\n  vec3 n;\n  n.x = map(p) - map(p+eps.xyy);\n  n.y = map(p) - map(p+eps.yxy);\n  n.z = map(p) - map(p+eps.yyx);\n  return normalize(n);\n}\n\nvec3 shade( vec3 ro, vec3 rd, vec3 n, vec3 p)\n{\n  vec3 col = vec3(0.);\n  col += vec3(1.) * max(0., dot(n, normalize(vec3(1.,1.,1.))))*.5;\n  vec3 fog = mix(vec3(cos(iTime)*.5+.5, .7, .5), vec3(0.,.7,1.5), rd.x) * (length(p-ro)*.05 );;\n\n  col += fog;\n  return col;\n}\n\nmat2 rot( float v)\n{\n  float a = 1.;\n  float b = sin(v)*0.1;\n  return mat2( a,-b,b,a);\n}\nvoid mainImage(out vec4 fragColor,in vec2 fragCoord)\n{\n  vec2 uv=vec2(fragCoord.x/iResolution.x,fragCoord.y/iResolution.y);\nuv-=.5;\nuv/=vec2(iResolution.y/iResolution.x,1);\n\n  vec3 ro = vec3( 0., 1., iTime);\n  vec3 rd = normalize( vec3(uv, 1.) );\n  rd.xy = rot(iTime*.91) * rd.xy;\n  vec3 p = rm(ro ,rd);\nvec3 n = normal(p);\n\n  vec3 col = shade(ro,rd,n,p);\n  for(int i=0; i<3; i++)\n  if(water(p)<.1)\n  {\n    rd = reflect(  rd, n);\n    p += rd*.1;\n  ro = p;\n    p = rm(ro,rd);\n    n = normal(p);\n    col = vec3(0.5,.47,1.) * shade(ro,rd,n,p);\n  }\n  vec4 out_color=vec4(1.);\n  out_color=vec4(col,1.);\n  fragColor=vec4(out_color);\n}","name":"Image","description":"","type":"image"}]}