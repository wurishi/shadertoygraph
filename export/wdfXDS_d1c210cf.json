{"ver":"0.1","info":{"id":"wdfXDS","date":"1552256378","viewed":125,"name":"fx2","username":"fabiovergani","description":"tmp","likes":4,"published":1,"flags":0,"usePreview":0,"tags":["tmp"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"vec3 R(in vec3 p, in float x){\n\tfloat y=p.y,\n\tc=cos(x),\n\ts=sin(x);\n\tx=p.x;\n\treturn vec3(\n\t\tc*x+s*y,\n\t\tc*y-s*x,\n\t\tp.z\n\t);\n}\n//=====================================================\n\n\nfloat box(in vec3 p, in vec3 b, in float r) {\n\treturn length(max(abs(p) - b + r, 0.0)) - r;\n}\n\n\n\n\n\n\n\n\nfloat getDistance(vec3 p,out vec4 q){\n\n\tfloat d=p.z;\n\t\n\tq.xyz=(p+=vec3(\n        2.*sin(d*.2+iTime*2.),\n        sin(d*.1+iTime),\n        .0\n    ));\n\n\tq.w=-2.;\n\n\td=-length(q.xy)+4.+.5*sin(atan(q.y,q.x)*6.)*sin(q.z);\n\n\td=min(d,max((d-.01)*clamp(.8,.0,1.)+.01,d-.4));\n\n\n\t// Flow of boxes and spheres\n\tvec3 r=p;\n\n\tr.z+=iTime*20.;\n\n\tfor(int i=0;i<3;++i){\n        \n \t   \tfloat a=floor(r.z/1.5+.5),\n\t\tb=a*3.+float(i);\n\n\t\tvec3 s=r-vec3(.4*sin(b),.4*sin(b*13.),1.5*a);\n        \n\t\ta=.08;\n        b=mod(b,2.);\n\t\tif(b<.5){\n            b=length(s)-a;\n\t\t}else{\n            b=box(R(s,b),vec3(a),.01);\n        };\n\n\t\tif(b<d){\n\t\t\tq.xyz=s;\n\t\t\tq.w=1.;\n\t\t\td=b;\n\t\t}\n        \n\t\tr.z+=.5;\n\t};\n\treturn d;\n}\n\n\n\nvec3 hsv2rgb(in vec3 hsv) {\n\n\treturn hsv.z *(1.0 + hsv.y * clamp(abs(fract(hsv.x + vec3(0.0, 2.0 / 3.0, 1.0 / 3.0)) * 6.0 - 3.0) - 2.0, -1.0, 0.0));\n\n}\n\n\n\n\n//frag:color,coord\nvoid mainImage(out vec4 a,in vec2 b){\n    \n    //S,l,j\n\tfloat S=sin(iTime),l,j;\n\n    //c,d,n,g,z,p\n\tvec3 c,d,n,\n\t\n\tg=normalize(\n        vec3(\n            .2*cos(iTime),\n            .2*S,\n            cos(iTime*.3)\n        )\n    ),\n\t\n\tz=normalize(\n        cross(\n            R(\n                vec3(.0,1.,.0),\n                3.14*S*sin(iTime*.2)\n            ),\n            g\n        )\n    ),\n\t\n\tp=vec3(.0,.0,iTime*6.);\n\n    //#\n\tg=mat3(z,cross(g,z),g)*normalize(vec3((2.*b.xy-iResolution.xy)/iResolution.y,2.));\n\n\n\tvec4 q;\n\n\n\tl=.0;\n\tfor(int i=0;i<50;++i){\n        j=getDistance(p,q);\n\t\tif(j<.01||(l+=j)>50.){break;};\n\t\tp+=j*g;\n\t};\n\n\n\tif(l>50.){\n\t\tc=vec3(.0);\n\t}else{\n\n\n        b=vec2(.01,.0);\n\n        n=normalize(vec3(\n            getDistance(p+(d=b.xyy),q)-getDistance(p-d,q),\n            getDistance(p+(d=b.yxy),q)-getDistance(p-d,q),\t\t\n            getDistance(p+(d=b.yyx),q)-getDistance(p-d,q)\n        ));\n\n\n\n\t\td=normalize(vec3(.5,.0,-2.));\n\n\t\tc=pow(\n\t\t\t(\n\t\t\t\tmax(.2,dot(n,d))*\n\t\t\t\thsv2rgb(\n\t\t\t\t\tvec3(\n\t\t\t\t\t\tp.z*.1,\n\t\t\t\t\t\t.8+.2*sin(q.y*10.)*sin(q.z*10.),\n\t\t\t\t\t\t.6\n\t\t\t\t\t)\n\t\t\t\t)+\n\t\t\t\tpow(max(.0,dot(reflect(g,n),d)),4.)*.2\n\t\t\t)*\n\t\t\tpow(1.-l/50.,3.)*\n\t\t\tmax(1.,sin(p.z*.1)),\n\t\t\tvec3(.5)\n\t\t);\n\t};\n\n\ta=vec4(c,1.);\n}","name":"Image","description":"","type":"image"}]}