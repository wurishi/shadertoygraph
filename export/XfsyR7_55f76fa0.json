{"ver":"0.1","info":{"id":"XfsyR7","date":"1720955774","viewed":27,"name":"Voronoi filter","username":"ODtian","description":"null","likes":0,"published":1,"flags":32,"usePreview":0,"tags":["voronoi"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// #iChannel0 \"file://20220726112871017101.jpg\"\n#define PI 3.14159265359\n#define rot3p(x) mat3(cos(x), -sin(x), 0, sin(x), cos(x), 0,  0, 0, 1)\n#define rot3y(x) mat3(1, 0, 0, 0, cos(x), -sin(x), 0, sin(x), cos(x))\n#define rot3r(x) mat3(cos(x), 0, sin(x), 0, 1, 0,  -sin(x), 0, cos(x))\n\n#define HAS_BORDER 0\n\n\nvec2 hash(vec2 p) {\n    p = vec2(dot(p, vec2(127.1, 311.7)), dot(p, vec2(269.5, 183.3)));\n    return fract(sin(p) * 18.5453);\n}\n\n// modified from iq's\nvec3 voronoi(in vec2 x) {\n    vec2 n = floor(x);\n    vec2 f = fract(x);\n\n    float min_d = 8.0;\n    vec2 min_grid, min_point, min_r;\n\n    for (int j = -1; j <= 1; j++) {\n        for (int i = -1; i <= 1; i++) {\n            vec2 g = vec2(float(i), float(j));\n            vec2 o = hash(n + g);\n            vec2 r = g - f + (0.5 + 0.5 * sin(iTime + 6.2831 * o));\n            float d = dot(r, r);\n            if (d < min_d) {\n                min_d = d;\n                min_grid = g;\n                min_point = vec2(n + g + o);\n                min_r = r;\n            }\n        }\n    }\n    \n    #if HAS_BORDER\n    min_d = 8.0;\n    for (int j = -2; j <= 2; j++) {\n        for (int i = -2; i <= 2; i++) {\n            vec2 g = vec2(float(i), float(j));\n            vec2 o = hash(n + g);\n            vec2 r = g - f + (0.5 + 0.5 * sin(iTime + 6.2831 * o));\n            if (dot(min_r - r, min_r - r) > 0.00001) {\n                min_d = min(min_d, dot(0.5 * (min_r + r), normalize(r - min_r)));\n            }\n        }\n    }\n    #endif\n    return vec3(min_d, min_point);\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord) {\n    vec2 uv = fragCoord / iResolution.xy;\n    vec2 pos = uv;\n\n    const float x = 60.0;\n    vec3 c = voronoi(pos * x);\n    c.yz /= x;\n    vec3 col = texture(iChannel0, c.yz).rgb;\n    #if HAS_BORDER\n    col = mix(vec3(0.1), col, smoothstep(0.04, 0.07, c.x));\n    #endif\n    fragColor = vec4(col, 1.0);\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"Xdf3Rn","filepath":"/media/a/e81e818ac76a8983d746784b423178ee9f6cdcdf7f8e8d719341a6fe2d2ab303.webm","previewfilepath":"/media/ap/e81e818ac76a8983d746784b423178ee9f6cdcdf7f8e8d719341a6fe2d2ab303.webm","type":"video","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"Xsf3Rn","filepath":"/media/a/cbcbb5a6cfb55c36f8f021fbb0e3f69ac96339a39fa85cd96f2017a2192821b5.png","previewfilepath":"/media/ap/cbcbb5a6cfb55c36f8f021fbb0e3f69ac96339a39fa85cd96f2017a2192821b5.png","type":"texture","channel":1,"sampler":{"filter":"nearest","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"vec4 texcat(vec2 uv) {\n    uv.x = -0.01 + mod(uv.x, 0.99) / 6.0 + 0.94 * mod(floor(iTime * 8.0), 6.0) / 6.0 ;\n    return texture(iChannel1, uv);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord / iResolution.xy;\n    float asp = iResolution.x / iResolution.y;\n    fragColor = texture(iChannel0, uv);\n    //fragColor = texcat(uv);\n}","name":"Buffer A","description":"","type":"buffer"}]}