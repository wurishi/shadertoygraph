{"ver":"0.1","info":{"id":"Wltyz4","date":"1608580682","viewed":167,"name":"Persistent State - Buffer","username":"kubamaruszczyk1604","description":"Persistent state buffer. Press arrow keys to update persistent position of the green circle.","likes":2,"published":1,"flags":48,"usePreview":0,"tags":["keyboard","buffer","persistentstate"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\n\n    vec2 uv = fragCoord/iResolution.xy;\n    uv = 2.0*uv -1.0;\n    uv.x *= iResolution.x/iResolution.y;\n   \n    vec3 persistentKey = texture(iChannel0, vec2(0.5,0.5)).rgb;\n    uv.x += persistentKey.x;\n    uv.y += persistentKey.y;\n    \n    \n    vec3 col = vec3(0.0,0.6-pow(length(uv),0.61),0.10);\n    \n    //texture(iChannel0,uv).rgb;\n\n   \n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGRr","filepath":"/presets/tex00.jpg","previewfilepath":"/presets/tex00.jpg","type":"keyboard","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"// BUFFER A - KEYBOARD HANDLING\n\nconst int KEY_LEFT  = 37;\nconst int KEY_UP    = 38;\nconst int KEY_RIGHT = 39;\nconst int KEY_DOWN  = 40;\n\nbool IsPressed(int key)\n{\n   return bool(texelFetch( iChannel0, ivec2(key,0),0 ).x);\n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    \n    vec2 uv = fragCoord/iResolution.xy;\n    vec3 col = texture(iChannel1, uv).rgb;\n    \n   if(IsPressed(KEY_LEFT))\n    { \n       col += vec3(0.01,0.0,0.0);\n    }\n    if(IsPressed(KEY_RIGHT))\n    { \n       col += vec3(-0.01,0.0,0.00);\n    }\n    if(IsPressed(KEY_UP))\n    { \n       col += vec3(0.0,-0.01,0.00);\n    }\n    if(IsPressed(KEY_DOWN))\n    { \n       col += vec3(0.0,+0.01,0.00);\n    }\n\n    // Output to screen\n    fragColor = vec4(col,1.0);\n}","name":"Buffer A","description":"","type":"buffer"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"XsXGR8","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    \n    vec2 uv = fragCoord/iResolution.xy;\n\n\n    vec3 col = texture(iChannel0, uv).rgb;\n    fragColor = vec4(col,1.0);\n}","name":"Buffer B","description":"","type":"buffer"}]}