{"ver":"0.1","info":{"id":"lfBBWd","date":"1725978728","viewed":71,"name":"Fork Lame minimal","username":"Tempally","description":"Another version of Antonalog's \"Lame\" motion blurred ray-tracer https://www.shadertoy.com/view/lsfGRB\nand TekF's https://www.shadertoy.com/view/4slGzl\nwith short compilation time and small source code","likes":7,"published":1,"flags":0,"usePreview":0,"tags":["raytracing","motionblur"],"hasliked":0,"parentid":"4slGzl","parentname":"Antonalog's Motion Blur"},"renderpass":[{"inputs":[],"outputs":[],"code":"float sphere=12., pass=6.;//N of spheres and N of blur passes\n\nfloat Q(float a, float b, float c) //quadratic equation solver\n{ return (c=b*b-4.*a*c)<.0?-1.:min(-b-(c=sqrt(c)),c-b)*.5/a; }\n\nvec4 trace(vec3 V, float ts) //raytracer\n{\n#define IFT if((T=Q(dot(V,V),2.*(dot(P,V)-dot(A,V)),dot(A,A)+dot(P,P)-R*R-2.*dot(A,P)))>.0&&T<p)\n#define EACH(i) for(float i=.0; i<1.; i+=1./sphere) { \\\n        float t=i*6.283+ts, R=.3-i*.3+.2, T; \\\n        vec3 C=vec3(h(R),h(i),i)*.7, A=vec3(sin(t),sin(t*3.)*.4,cos(t)),\n#define LIT max(dot(N,L),.0)*.5 + pow(max(dot(N,H),.0),999.)*8.\n#define h(n) fract(sin(n)*4375.545312)\n\tvec3 L=vec3(.8,-.4,.4), H=normalize(L-V), c=vec3(.2); //background\n\tfloat b, p=1e9; //proximity\n\tts+=sin(ts+=iTime)*.7;\t\n\tEACH(i) \n        P=vec3(0,0,5);\n        IFT {\n            P+=T*V;\n            vec3 N=normalize(P-A), Ref=reflect(V,N), RC=vec3(0);\n            b=LIT;\n            EACH(j) \n                V=L;\n                if (i!=j) {\n                    IFT b=.0; //shadow\n                    V=normalize(Ref);\n                    IFT N=normalize(P+T*V-A), p=T, RC=(C+LIT)*.5/(1.+T*T);\n                }\n            }\n            p=T, c=vec3(b)+C+RC;\n        }\n\t}\n\treturn c.rgbb;\n}\n\n\nvoid mainImage( out vec4 O, in vec2 u )\n{\n\tfloat s=u.x-iMouse.x, d=.05/pass, t=h(u.x*u.y)*d;\n\tu*=2./iResolution.y, O-=O;\t\n\tif (s<.0) t=d=.0; // disable motion blur\n\tfor (float f=pass; f-->.0; t+=d) //blur passes\n\t\tO+=trace(normalize(vec3(u.x-1.78,1.-u.y,-5)),t);\n\tO=abs(s)>1.?O/pass:vec4(1); //white separator\n}","name":"Image","description":"","type":"image"}]}