{"ver":"0.1","info":{"id":"3lVBRt","date":"1614881140","viewed":106,"name":"practice 20210305","username":"nerumae3","description":" ","likes":3,"published":1,"flags":96,"usePreview":0,"tags":["3d"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv=fragCoord.xy/iResolution.xy;\n    fragColor=vec4(texture(iChannel0,uv).xyz,1.0);\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"MlXXWH","filepath":"https://soundcloud.com/niko_14/eins","previewfilepath":"https://soundcloud.com/niko_14/eins","type":"musicstream","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":0}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"float time;\n\nfloat sphere(vec3 p,float r){\n  return length(p)-r;\n}\n\nfloat box(vec3 p,vec3 s){\n  p = abs(p)-s;\n  return min(0.0,max(p.x,max(p.y,p.z))) + length(max(vec3(0),p));\n}\n\nmat2 rot(float r){\n  float s=sin(r),c=cos(r);\n  return mat2(c,s,-s,c);\n}\n\nfloat ac=0.;\n\nfloat map(vec3 p){\n  vec3 q =p;\n  float t=floor(time)+pow(fract(time),.2);\n  for(int i=0;i<5;i++){\n    q=abs(q)-.5;\n    q.xy*=rot(.7+t);\n    q.xz*=rot(.5);\n  }\n  float d1=(q.y-1.);\n  float d2=box(q,vec3(.5,1.,.5));\n  float d=min(d1,d2);\n  ac += .2/(0.15+abs(d2));\n  return d2;\n}\n\nvec3 norm(vec3 p){\n  vec2 k=vec2(.001,-.001);\n  return normalize(\n  k.xyy*(map(p+k.xyy))+\n  k.yxy*(map(p+k.yxy))+\n  k.yyx*(map(p+k.yyx))+\n  k.xxx*(map(p+k.xxx))\n  );\n}\n\nvoid cam(inout vec3 p){\n  float t=time*.4;\n  p.xz*=rot(t);\n  p.xy*=rot(.4);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n  time=iTime;\n  vec2 uv = vec2(gl_FragCoord.x / iResolution.x, gl_FragCoord.y / iResolution.y);\n\tvec2 p2=uv;\n  \n  float fft = texture(iChannel0,vec2(0.5,.9)).x;\n  uv -= 0.5;\n\tuv /= vec2(iResolution.y / iResolution.x, 1);\n  vec2 p = uv;\n  p =abs(p)-.5;\n  p = abs(p)-.5;\n  time = time/60.*140.;\n  float bt=pow(fract(time),2.);\n  vec3 ro=vec3(0.,0.,-10.),rd=normalize(vec3(-p,1.));\n  cam(ro);\n  cam(rd);\n  \n  vec3 col,pos;\n  float t=0.01,d;\n  int i=0;\n  for(i=0;i<69;i++){\n    pos = ro+rd*t;\n    d=map(pos);\n    if(d<0.01){\n      vec3 n=norm(pos);\n      float edge=clamp(pow(length(n-norm(pos-0.015))*((0.3+bt*.8)*1.3),44.),0.,1.);\n      vec3 ld = normalize(vec3(1.,1.,1.));\n      vec3 h = normalize(ld+rd);\n      float spec = pow(clamp(dot(reflect(ld,n),rd),0.,1.),40.);\n      \n      \n      col=edge*vec3(.99,.01,.01);\n      col+=spec*vec3(2.,.01,.01);\n\n      //break;\n    } \n    t+=fft*2.+.01;\n  }\n  //vec3 b = texture(texPreviousFrame,p2).xyz;\n  vec3 b = texture(iChannel1,p2).xyz;\n\tfloat fog=min(0.,(1./99.)*float(i))*1.;\n\n  col=pow(col,vec3(.4545));\n  col+=mix(col,b,pow(fft,.8)*1.5);\n  \n  fragColor=vec4(col,1.0);\n}\n","name":"Buffer A","description":"","type":"buffer"}]}