{"ver":"0.1","info":{"id":"7ll3WM","date":"1622227749","viewed":104,"name":"[KiFS] GldChains","username":"ad_lucem","description":"Snapshot of a new fft reacting shader wip","likes":4,"published":1,"flags":0,"usePreview":0,"tags":["raymarch","kifs","neon"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"vec2 ep=vec2(0.003,-0.003);\nfloat ti,b,f;\nfloat em;\nfloat bo(vec3 p, vec3 b){p=abs(p)-b;return max(p.x,max(p.y,p.z));}\nmat2 rt(float a){return mat2(cos(a),sin(a),-sin(a),cos(a));}\nvec2 sdf(vec3 p)\n{\n    vec3 yp,xp,zp;\n    vec2 h,r=vec2(bo(abs(p),vec3(1)),1);\n    yp=xp=zp=p;\n  f=1.0;\n    float a=.1, of=.25, w=6.*f;\n    vec2 we= vec2(w,.1);\n    xp.yz*=rt(abs(xp.x));\n    h=vec2(bo(abs(xp)-vec3(of+a*abs(p.x)),we.xyy),3);    \n    yp.xz*=rt(abs(yp.y));     \n    h.x=min(bo(abs(yp)-vec3(of+a*abs(p.y)),we.yxy),h.x);\n    zp.xy*=rt(abs(zp.z));  \n    h.x=min(bo(abs(zp)-vec3(of+a*abs(p.z)),we.yyx),h.x);\n    r=r.x<h.x?r:h;\n  b=1.0;\n    float bi = 1.+b;\n    h=vec2(bo(abs(p)-vec3(0,bi,bi),vec3(.5,.0,.0)),2);\n    p.xy*=rt(1.59);\n    h.x=min(bo(abs(p)-vec3(0,bi,bi),vec3(.5,.0,.0)),h.x);\n    p.xz*=rt(1.59);\n    h.x=min(bo(abs(p)-vec3(0,bi,bi),vec3(.5,.0,.0)),h.x);  \n    em+=0.002/(0.1+h.x*h.x);\n    r=r.x<h.x?r:h;\n    r.x*=.5;\n    return r;\n}\n\nvec2 mp(vec3 p)\n{\n  p.xz*=rt(.5*ti);\n  p.xy*=rt(.89*ti);\n  vec3 np=p;\n  //f = texture(texFFTSmoothed,1).r*400;\n  //b = clamp(texture(texFFTSmoothed,0).r*800,0,3);\n  for(int i=0; i<3; i++){\n    np=abs(np)-vec3(pow(1.8,2.));\n    //float t = clamp(100000/fGlobalTime,0,1);\n    //np.zx*=r2(-ti*.1*t);\n    //np.yz*=r2(sin(-ti*.1*t));\n    //np.xy*=r2(sin(-ti)*.1*t);\n  }\n  return sdf(np);\n}\n\nvec2 rm(vec3 ro, vec3 rd)\n{\n  float tn=.001,tx=75.;\n  vec2 h,d=vec2(tn,0);\n  for(;d.x<tx;d.x+=h.x)\n  {\n      h=mp(ro+rd*d.x);\n      if(h.x<.0001)break;\n      d.y=h.y;\n  }\n  if(d.x>tx)d.x=0.;\n  return d;\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord)\n{\n    vec2 uv = (2.*fragCoord-iResolution.xy)/iResolution.y;\n    ti=mod(iTime,100.);\n    vec3 co=vec3(0,0,-15),\n    cd=normalize(vec3(uv,1.5)),fo,cl=fo=vec3(.2,.5,1)+cd.y*vec3(0,.5,0);\n    vec2 r=rm(co, cd);\n    float d=r.x;\n    if(d>0.)\n    {\n        vec3 p=co+cd*d, no=normalize(ep.xyy*mp(p+ep.xyy).x+\n        ep.xyx*mp(p+ep.xyx).x+\n        ep.xxy*mp(p+ep.xxy).x+\n        ep.xxx*mp(p+ep.xxx).x),\n        l=normalize(vec3(-1,-.5,1)),\n        al=vec3(1.);\n        if(r.y>0.)al=vec3(.1,.2,1.);\n        if(r.y>1.)\n        {\n            float at = clamp(1.-(length(p)-7.),0.,1.);\n            al=vec3(1.-at,1.-at,.4*at);\n        }\n        float dif=max(dot(no,-l),0.),r=40./d, ao = exp2(pow(max(0.,1.-mp(p+no*r).x)/r,2.));\n        float spec=pow(max(0., dot(no, normalize(-l-cd))), 100.),\n        sss=smoothstep(0., 1., mp(p+l*.4).x/.4);\n        cl=spec+al*(.3*ao)*(dif+sss);\n    }\n    cl=mix(cl+em*vec3(.5,b,(.4*b)), fo, 1.-exp(-.0001*d*d*d));\n    fragColor=vec4(pow(cl,vec3(.45)),1);\n}","name":"Image","description":"","type":"image"}]}