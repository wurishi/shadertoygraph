{"ver":"0.1","info":{"id":"wsSXWR","date":"1553453646","viewed":555,"name":"Love is War","username":"belfry","description":"Replicating effect from opening.","likes":9,"published":1,"flags":64,"usePreview":0,"tags":["heart","kaguya"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4lBXzz","filepath":"https://soundcloud.com/realpianoprinceofanime/kaguya-sama-love-is-war-op-love-dramatic-feat-rikka-ihara-by-masayuki-suzuki-piano","previewfilepath":"https://soundcloud.com/realpianoprinceofanime/kaguya-sama-love-is-war-op-love-dramatic-feat-rikka-ihara-by-masayuki-suzuki-piano","type":"musicstream","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":0}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"vec2 noise(vec2 p) {\n    return fract(1234.1234 * sin(1234.1234 * (fract(1234.1234 * p) + p.yx)));\n}\n\nfloat heart(vec2 p, float s) {\n    p /= s;\n    vec2 q = p;\n    q.x *= 0.5 + .5 * q.y;\n    q.y -= abs(p.x) * .63;\n    return (length(q) - .7) * s;\n}\n\nvec3 hearts(vec2 polar, float time, float fft) {\n    float l = clamp(polar.y, 0., 1.);\n    float tiling = 1./3.14159 * 14.;\n    polar.y -= time;\n    vec2 polarID = (floor(polar * tiling));\n    \n    polar.x = polar.x + polarID.y * .03;\n    polar.x = mod(polar.x + 3.14159 * 2., 3.14159 * 2.);\n    polarID = floor(polar * tiling);\n    \n    polar = fract(polar * tiling);\n    \n    polar = polar * 2. - 1.;\n    vec2 n = noise(polarID + .1) * .75 + .25;\n    vec2 n2 = 2. * noise(polarID) - 1.;\n    vec2 offset = (1. - n.y) * n2;\n    float heartDist = heart(polar + offset, n.y * .6);\n    float a = smoothstep(.0, .25, n.x*n.x);\n    float heartGlow = smoothstep(0., -.05, heartDist) * .5 * a + smoothstep(0.3, -.4, heartDist) * .75;\n    vec3 heartCol = vec3(smoothstep(0., -.05, heartDist), 0., 0.) * a + heartGlow * vec3(.9, .5, .7);\n    vec3 bgCol = vec3(0.15 + l / 2., .0, 0.);\n    return bgCol * (.5 + fft) + heartCol * step(0.45, noise(polarID + .4).x);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = (2. * fragCoord - iResolution.xy) / iResolution.y;\n    vec2 polar = vec2(atan(uv.y, uv.x), log(length(uv)));\n    //float x = mod(polar.x + iTime * .3, 3.14159 * 2.) - 3.14159;\n    //float m = smoothstep(0.01, 0., abs(x) - .2);\n    float speed = .666;\n    float fft = texelFetch(iChannel0, ivec2(1., 0.), 0).x;\n    vec3 h = max(max(hearts(polar, iTime * speed, fft), \n                     hearts(polar, iTime * speed * 1.2 + 12., fft)), \n                 hearts(polar, iTime * speed * .8 + 23., fft));\n    //uv = 2. * fragCoord / iResolution.xy - 1.;\n    //fragColor = vec4(mix(vec3(1. - length(uv) * .075), h, m), 1.);\n    fragColor = vec4(h, 1.);\n}","name":"Image","description":"","type":"image"}]}