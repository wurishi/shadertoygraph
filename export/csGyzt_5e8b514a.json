{"ver":"0.1","info":{"id":"csGyzt","date":"1696429603","viewed":33,"name":"DrawLineSegments","username":"shimian","description":"绘制线段","likes":0,"published":1,"flags":0,"usePreview":0,"tags":["2dlinesegments"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define UVLength 3.\n#define PI 3.1415926\nvec2 fixUV(in vec2 uv,float s){\n    return s*(2.*uv-iResolution.xy)/min(iResolution.x,iResolution.y);\n    //将uv控制在s*(-1,1)之间\n}\nvec3 Grid(in vec2 uv){\n    vec3 col = vec3(0.);\n    vec2 faction =1.-2.*abs(fract(uv)-0.5) ;\n    if(abs(uv.x)<=1.*fwidth(uv.x))\n    {\n        col.g=1.;\n    }else if(abs(uv.y)<=1.*fwidth(uv.y))\n    {\n        col.r=1.;\n    }else if(faction.x<2.*fwidth(uv.x)||faction.y<2.*fwidth(uv.y))\n    {\n        col = vec3(1.);\n    }\n    return col;\n}\n\nfloat segment(in vec2 p,in vec2 a,in vec2 b,in float w)\n{\n    float f =0.;\n    vec2 ba = b-a;\n    vec2 pa = p-a;\n    float proj =clamp(dot(pa,ba)/dot(ba,ba),0.,1.);\n    float d =length(proj*ba-pa);\n    if(d<=w){\n        f=1.;\n    }\n    return f;\n}\nfloat func(in float x){\n    float T = 3.+sin(iTime);\n    return sin(2.*PI/T*x);\n}\n\nfloat funcPlot(in vec2 uv){\n    float f = 0.;\n    for(float x =0.;x<=iResolution.x;x +=1.){\n        float fx = fixUV(vec2(x,0.),UVLength).x;\n        float nfx = fixUV(vec2(x+1.,0.),UVLength).x;\n        f+=segment(uv,vec2(fx,func(fx)),vec2(nfx,func(nfx)),fwidth(uv.x));\n    }\n    return clamp(f,0.,1.);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fixUV(fragCoord,UVLength);\n    vec3 col = Grid(uv);\n    //segment混合比\n    //col = mix(col,vec3(1.,1.,0.),segment(uv,vec2(1.,2.),vec2(-2.,-2.),fwidth(uv.x)));\n    // Output to screen\n    col = mix(col,vec3(1.,1.,0.),funcPlot(uv));\n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}