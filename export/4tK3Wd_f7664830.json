{"ver":"0.1","renderpass":[{"outputs":[{"channel":0,"id":"4dfGRr"}],"inputs":[{"channel":0,"type":"buffer","id":"4sXGR8","filepath":"/media/previz/buffer02.png","sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"}}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{   \n    vec2 uv = fragCoord/iResolution.xy;\n\tvec4 col = texture(iChannel0, uv);\n    \n    fragColor = col;\n}","name":"Image","description":"","type":"image"},{"outputs":[{"channel":0,"id":"4dXGR8"}],"inputs":[{"channel":0,"type":"texture","id":"XdX3Rn","filepath":"/media/a/52d2a8f514c4fd2d9866587f4d7b2a5bfa1a11a0e772077d7682deb8b3b517e5.jpg","sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"}}],"code":"float densityPow = 4.0;\nfloat densityMultiplier1 = 300.0;\nfloat densityMultiplier2 = 3.0;\nfloat viewDistance = 10.0;\nfloat fade = 0.5;\nfloat fadeVariation = 0.1;\nfloat twist = 1.0;\nvec3 sinusSpaceDistortion = vec3(0.5, 0.5, 1.5);\nfloat noiseZDistortion = 50.0;\nfloat noiseZDistortionScale = 0.005;\nfloat distortionTwist = 10.0;\nvec3 noiseScale = vec3(0.75,0.75,0.25);\nvec3 noiseSpeed = vec3(0.5,0.25,0.00);\nvec3 cameraOrigin = vec3(0.0,0.0,0.0);\nfloat moveSpeed = 2.0;\nvec3 skyColor1 = vec3(0.0,0.0,0.1);\nvec3 skyColor2 = vec3(1.25,1.15,1.0);\nvec3 skyColor3 = vec3(0.15,0.0,0.1);\nvec3 color1 = vec3(0.1,0.03,0.0);\nvec3 color2 = vec3(0.25,0.25,1.0);\nvec2 colorsPlacement = vec2(0.075,1.0);\n\n//https:www.shadertoy.com/view/XsBXWt\nmat2 rot(float a) \n{\n\treturn mat2(cos(a),sin(a),-sin(a),cos(a));\t\n}\n\nfloat noise(vec3 x) \n{ \n    vec3 s = noiseSpeed*iTime;\n    x *= noiseScale.xyz;\n    x.xy *= rot(x.z*distortionTwist);\n    float texZ = texture(iChannel0, vec2(x.z*noiseZDistortionScale, s.z)).x;\n    float tex = texture(iChannel0, x.xy + vec2(texZ-0.5)*noiseZDistortion + s.xy).x;   \n    return tex;\n}\n\nvec3 rayCast(vec3 rayDir, vec3 cameraOrigin)\n{\n    const int ITER = 100;\n    float iterations = float(ITER);\n\tvec3 p = cameraOrigin;\n    vec3 density = vec3(0.0);\n    for(int i = 0; i < 70; i++)\n\t{\n        p.x += sin(p.z*sinusSpaceDistortion.y)*sinusSpaceDistortion.x;\n        p.y += sin(p.z*sinusSpaceDistortion.y + sinusSpaceDistortion.z)*sinusSpaceDistortion.x;\n        p.xy *= rot(p.z*twist);\n        float ifloat = float(i);\n\t\tfloat f = ifloat / iterations;\n        vec3 c = mix(color1, color2, smoothstep(colorsPlacement.x, colorsPlacement.y, f));\n        float clouds1 = noise(p + vec3(0.0,0.0,iTime*moveSpeed));\n\t\tfloat clouds2 = pow(clouds1, densityPow);\n        float dfade = smoothstep(1.0, 0.0, length(p.xy*(fade+sin(iTime)*fadeVariation)));\n\t\tdensity += clouds1*clouds1*c*densityMultiplier2 + clouds2*dfade*densityMultiplier1*c;\n\t\tp = cameraOrigin + rayDir * f * viewDistance;\n\t}\n    return density/iterations;\n}\n\nvec3 skyBox(vec3 rayDir)\n{\n    float c = clamp(1.0 - length(rayDir.xy),0.0, 1.0);\n    \n    return mix(mix(skyColor1, skyColor3, rayDir.y), skyColor2, c);\n}\n\n//https://www.shadertoy.com/view/Xds3zN\nmat3 setCamera( in vec3 ro, in vec3 ta, float cr )\n{\n\tvec3 cw = normalize(ta-ro);\n\tvec3 cp = vec3(sin(cr), cos(cr), 0.0);\n\tvec3 cu = normalize( cross(cw,cp) );\n\tvec3 cv = normalize( cross(cu,cw) );\n    return mat3( cu, cv, cw );\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{   \n    vec3 cameraTarget = vec3(sin(iTime),cos(iTime),4.0);\n    cameraOrigin += vec3(sin(iTime*0.7)*1.5,0.0,0.0);\n        \n\tvec2 screenPos = (fragCoord.xy/iResolution.xy)*2.0-1.0;\n\tscreenPos.x *= iResolution.x/iResolution.y;\n    \n\tmat3 cam = setCamera(cameraOrigin, cameraTarget, iTime*0.5);\n    \n    vec3 rayDir = cam* normalize( vec3(screenPos.xy,0.25) );\n    vec3 effect = rayCast(rayDir, cameraOrigin);\n    \n    vec3 sky = skyBox(rayDir);\n    vec3 res = sky + effect;\n\n\tfragColor = vec4(res, 1.0);\n}","name":"Buffer A","description":"","type":"buffer"},{"outputs":[{"channel":0,"id":"XsXGR8"}],"inputs":[{"channel":0,"type":"buffer","id":"4dXGR8","filepath":"/media/previz/buffer00.png","sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"}}],"code":"float sampleDistance = 0.05;\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord/iResolution.xy - vec2(0.5);\n\t\n    vec4 col = vec4(0.0);\n    for(int i = 0; i < 4; i++)\n    {\n        \n        col += texture(iChannel0, uv/(1.0 + float(i)*sampleDistance) + vec2(0.5));\n    }\n    \n    col /= 4.0;\n    \n    fragColor = col;\n}","name":"Buffer B","description":"","type":"buffer"},{"outputs":[{"channel":0,"id":"4sXGR8"}],"inputs":[{"channel":0,"type":"buffer","id":"XsXGR8","filepath":"/media/previz/buffer01.png","sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"}},{"channel":1,"type":"buffer","id":"4sXGR8","filepath":"/media/previz/buffer02.png","sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"}}],"code":"float sampleDistance = 0.05;\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord/iResolution.xy - vec2(0.5);\n\t\n    vec4 col = vec4(0.0);\n    for(int i = 0; i < 4; i++)\n    {\n        \n        col += texture(iChannel0, uv/(1.0 + float(i)*sampleDistance) + vec2(0.5));\n    }\n    \n    col /= 4.0;\n    \n    vec4 oldFrame = texture(iChannel1, fragCoord/iResolution.xy);\n    \n    fragColor = mix(col, oldFrame, 0.75);\n}","name":"Buffer C","description":"","type":"buffer"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":true,"mFlagMusicStream":false},"info":{"id":"4tK3Wd","date":"1477563601","viewed":1564,"name":"Photon's journey","username":"zguerrero","description":"first time trying volumetric effect, followed this amazing tutorial : http://www.blog.sirenix.net/blog/realtime-volumetric-clouds-in-unity, then started digressing to get this king of magical light effect.","likes":84,"published":1,"flags":32,"usePreview":0,"tags":["raycast","light","effect","volumetric","photon","journey"],"hasliked":0,"parentid":"","parentname":""}}