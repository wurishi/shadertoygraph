{"ver":"0.1","info":{"id":"wtBXWz","date":"1565573775","viewed":353,"name":"Multipass distance feild","username":"rory618","description":"Applying evolution over time to a signed distance field stored in a buffer. Keeping the magnitude of the gradient close to 1, and shifting the distance field near regions of large divergence and low distance. Use the mouse to push the line around.","likes":25,"published":1,"flags":32,"usePreview":0,"tags":["2d","automata"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"nearest","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void mainImage( out vec4 O, in vec2 I )\n{\n    \n    O = vec4(vec3(max(0.,1.5-abs(A(I).x))),1.0);\n    O.y += max(0.,B(I).w);\n    O.z += max(0.,-B(I).w);\n    //O = vec4(vec3(abs(A(I))/vec4(2,1,1,1)),1.0);\n    O = vec4(A(I).x);\n    \n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"nearest","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"void mainImage( out vec4 O, in vec2 I )\n{\n    int seed = int(I.x)+int(I.y)*3256+int(iFrame)*23416;\n    O = iFrame<3?vec4(length(I-R.xy/2.)-R.y/3.,0,0,0):A(I);\n    O.x += randn(rand2(IHash(seed))).x/10.;\n    \n    vec4 _L = A(I-vec2(1,0));\n    vec4 _R = A(I+vec2(1,0));\n    vec4 _U = A(I-vec2(0,1));\n    vec4 _D = A(I+vec2(0,1));\n    \n    vec2 G = vec2(_R.x-_L.x,_D.x-_U.x)/2.;\n    float f = 1e-6+length(G);\n    float d = _R.y-_L.y+_D.z-_U.z;\n    \n    \n    float nO = 0.;\n    if(abs(_L.x) < abs(_R.x)){\n        nO += _L.x + G.x/f;\n    } else {\n        nO += _R.x - G.x/f;\n    }\n    if(abs(_U.x) < abs(_D.x)){\n        nO += _U.x + G.y/f;\n    } else {\n        nO += _D.x - G.y/f;\n    }\n    if(iFrame>3){\n    \tO.x = mix(O.x,nO/2.,.5);\n        O.yz = G/f;\n        O.x -= .2*B(I).w/(1.+abs(O.x));\n    }\n    \n    if(iMouse.z>0.){\n        O.x += 105.5*exp(-.001*dot2(I-iMouse.xy))*sign(A(iMouse.xy).x);\n    }\n    O.w = d;\n    \n}","name":"Buffer A","description":"","type":"buffer"},{"inputs":[],"outputs":[],"code":"#define dot2(x) dot(x,x)\n#define R iResolution.xy\n#define A(x) texture(iChannel0,vec2(x)/iResolution.xy)\n#define B(x) texture(iChannel1,vec2(x)/iResolution.xy)\n#define C(x) texture(iChannel2,vec2(x)/iResolution.xy)\n//#define D(x) texture(iChannel3,vec2(x)/iResolution.xy)\n\nint IHash(int a){\n\ta = (a ^ 61) ^ (a >> 16);\n\ta = a + (a << 3);\n\ta = a ^ (a >> 4);\n\ta = a * 0x27d4eb2d;\n\ta = a ^ (a >> 15);\n\treturn a;\n}\n\nfloat Hash(int a){\n\ta = (a ^ 61) ^ (a >> 16);\n\ta = a + (a << 3);\n\ta = a ^ (a >> 4);\n\ta = a * 0x27d4eb2d;\n\ta = a ^ (a >> 15);\n\treturn float(a) / float(0x7FFFFFFF);\n}\nvec4 rand4(int seed){\n    return vec4(Hash(seed^0x348593),\n                Hash(seed^0x8593D5),\n                Hash(seed^0x625384),\n                Hash(seed^0x253625));\n}\nvec3 rand3(int seed){\n    return vec3(Hash(seed^0x348593),\n                Hash(seed^0x8593D5),\n                Hash(seed^0x625384));\n}\nvec2 rand2(int seed){\n    return vec2(Hash(seed^0x348593),\n                Hash(seed^0x8593D5));\n}\n\n\nvec2 randn(vec2 randuniform){\n    vec2 r = randuniform;\n    r.x = sqrt(-2.*log(1e-9+abs(r.x)));\n    r.y *= 6.28318;\n    r = r.x*vec2(cos(r.y),sin(r.y));\n    return r;\n}","name":"Common","description":"","type":"common"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"nearest","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"XsXGR8","channel":0}],"code":"\n\nvoid mainImage( out vec4 O, in vec2 I )\n{\n    float f0 = 1.;\n    float f1 = 0.;\n    float f2 = 15.;\n    float sum = f0+f1+f2;\n    vec4 a = A(I);\n    vec4 b = B(I);\n    vec4 c = (B(I+vec2(1,0)) + B(I-vec2(1,0)) + B(I+vec2(0,1)) + B(I-vec2(0,1)))/4.;\n    O = (a*f0+b*f1+c*f2)/sum;\n    \n}","name":"Buffer B","description":"","type":"buffer"}]}