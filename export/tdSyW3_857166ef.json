{"ver":"0.1","info":{"id":"tdSyW3","date":"1587406830","viewed":384,"name":"Closest Point To Box","username":"MarvelousBilly","description":"The blue circle is the mouse and the green is the point on the box that the mouse is closest to.\nInside the box does not work though...","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["distancetobox","closestpoint"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"float smoothness = 0.95;\n\nfloat sdBox(in vec2 P, in vec2 p, in vec2 b ){\n    p = P-p;\n    vec2 d = abs(p)-b;\n    return length(max(d,0.0)) + min(max(d.x,d.y),0.0);\n}\n\nvec2 closestPointOnBox(vec2 P, vec2 p, vec2 b){\n    vec2 pB = max(abs(P-p)-b,0.0);\n    vec2 d = clamp(P - p, -b, b) + p; //thanks oneshade for this improvement\n    return d;\n}\n\nvec4 drawAACircle(vec4 col, vec3 ccol, vec2 uv, vec2 pos, float rad){\n    float d = distance(uv,pos)/rad; //distance to circle\n    float v = smoothstep(1.5/iResolution.y, .0, distance(uv,pos) - rad ); \n    return mix(col, vec4(ccol.rgb,v) , v ); \n} //FabriceNeyret2, I don't know if this is what you meant but uhh, it works :)\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec4 col;\n\n    vec2 uv = (fragCoord.xy    / iResolution.y);\n    vec2 P =  (iMouse.xy       / iResolution.y);\n    \n    vec2 BC = vec2(0.49,0.31); //box center \n    vec2 BS = vec2(0.19,0.1); //box size\n    \n    float D = sdBox(uv,BC,BS); //draw rectangle\n    if (D >= 0.){ col = vec4(0.7,0.7,0.7,1.0); }\n    if (D <  0.){ col = vec4(0.0,0.0,0.0,1.0); }\n       \n    //mouse dot\n    col = drawAACircle(col, vec3(0.,0.,1.), uv, P, 0.02);\n    \n    vec2 cob = closestPointOnBox(P,BC,BS);\n    col = drawAACircle(col, vec3(0.,1.,0.), uv, cob, 0.02);\n\n    fragColor = vec4(col);\n}","name":"Image","description":"","type":"image"}]}