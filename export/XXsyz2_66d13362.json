{"ver":"0.1","info":{"id":"XXsyz2","date":"1726436515","viewed":29,"name":"Voro line","username":"twixuss","description":"It's like a regular voronoi pattern, but with lines instead of points.","likes":3,"published":1,"flags":0,"usePreview":0,"tags":["voronoi","noise","line","distance","pattern","hash","segment"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define TAU 6.2831853\nvec3 hash32(vec2 p)\n{\n\tvec3 p3 = fract(vec3(p.xyx) * vec3(.1031, .1030, .0973));\n    p3 += dot(p3, p3.yxz+33.33);\n    return fract((p3.xxy+p3.yzz)*p3.zyx);\n}\nvec4 hash42(vec2 p)\n{\n\tvec4 p4 = fract(vec4(p.xyxy) * vec4(.1031, .1030, .0973, .1099));\n    p4 += dot(p4, p4.wzxy+33.33);\n    return fract((p4.xxyz+p4.yzzw)*p4.zywx);\n}\nfloat distance_to_segment(vec2 point, vec2 line_a, vec2 line_b) {\n\tfloat l2 = dot(line_a-line_b,line_a-line_b);\n\tif (l2 == 0.) return distance(point, line_a);\n\n\tfloat t = clamp(dot(point - line_a, line_b - line_a) / l2, 0.0, 1.0);\n\tvec2 projection = mix(line_a, line_b, t);\n\treturn distance(point, projection);\n}\n\n\nstruct Voroline {\n    float dist;\n    vec2 tile;\n    vec2 local;\n};\nVoroline voroline(vec2 uv) {\n    vec2 tile = floor(uv);\n    vec2 local = uv - tile;\n    \n    Voroline result;\n    result.dist = 999.;\n    \n    for (float dy = -1.0; dy <= 1.0; ++dy) {\n    for (float dx = -1.0; dx <= 1.0; ++dx) {\n        vec2 d = vec2(dx, dy);\n        \n        vec2 dtile = tile + d;\n        vec2 dlocal = local - d;\n        \n        vec4 r = hash42(dtile);\n        vec2 p1 = r.xy;\n        vec2 p2 = r.zw;\n\n        float dist = distance_to_segment(dlocal, p1, p2);\n        if (result.dist > dist) {\n            result.dist = dist;\n            result.tile = dtile;\n            result.local = dlocal;\n        }\n    }\n    }\n    \n    return result;\n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord/iResolution.x;\n\n    float scale = 16.0;\n\n    Voroline v = voroline(uv * scale + iTime);\n    \n    if (uv.x < 1.0/3.0) {\n        fragColor = vec4(vec3(v.dist), 1);\n    } else if (uv.x < 2.0/3.0) {\n        fragColor = vec4(hash32(v.tile), 1);\n    } else {\n        fragColor = vec4(v.local, 0, 1);\n    }\n}","name":"Image","description":"","type":"image"}]}