{"ver":"0.1","info":{"id":"MsySRm","date":"1463467298","viewed":403,"name":"3D Tunnel","username":"JasonD","description":"3D textured tunnel, with fade, and rotation.  Just a throw back to the old-school Demo Scene in the mode 13h (320x200 x 256 color) days.","likes":3,"published":1,"flags":0,"usePreview":0,"tags":["3d","tunnel","demoscene"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"Xsf3Rr","filepath":"/media/a/79520a3d3a0f4d3caa440802ef4362e99d54e12b1392973e4ea321840970a88a.jpg","previewfilepath":"/media/ap/79520a3d3a0f4d3caa440802ef4362e99d54e12b1392973e4ea321840970a88a.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// Jason Allen Doucette\n// http://xona.com/jason/\n//\n// 3D Tunnel\n// May 16, 2016\n\n// ---- SETTINGS ----------------------------------------------------------------\n\n#define Z_SCALE 0.2\n\n#define SPEED_IN 0.5\n#define SPEED_ROTATE 0.25\n#define ROTATE_MAGNITUDE 1.5\n\n// http://xona.com/colorlist/\n#define FADE_COLOR vec3(0.1, 0.2, 0.4)\n#define FADE_POWER 1.0\n\n#define TOLERANCE_ATAN 0.01\n\n\n// ---- CONSTANTS ----------------------------------------------------------------\n\n#define PI 3.1415926535897932384626\n\n\n// ---- CODE ----------------------------------------------------------------\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // isotropic scaling, ensuring entire texture fits into the view.\n    // After this, you should consider fragCoord = 0..1, usually,\n    // aside from overflow for wide-screen.\n    float minRes = min(iResolution.x, iResolution.y);\n    fragCoord /= minRes;\n    \n    // center point on screen\n    vec2 center = (iResolution.xy / minRes) / 2.0;\n    \n    // angle from center\n    vec2 dCenter = center - fragCoord.xy;\n    // small tolerance delta to avoid atan() with zeros = undefined.\n    float angle = atan(dCenter.y + TOLERANCE_ATAN, dCenter.x + TOLERANCE_ATAN) / PI;\n    \n    // distance from center\n    float distancePixFromCen = sqrt(dCenter.x * dCenter.x + dCenter.y * dCenter.y);\n    \n    // 3D perspective: 1/Z = constant\n    float zCamera = Z_SCALE / distancePixFromCen;\n    \n    // static texture coordinates\n    fragCoord.xy = vec2(angle, zCamera);\n    \n    // move in Z -- into the tunnel\n    fragCoord.y += iTime * SPEED_IN;\n    \n    // move in X -- rotate\n    fragCoord.x += cos(iTime * SPEED_ROTATE) * ROTATE_MAGNITUDE;\n    \n    // textured\n    fragColor = texture(iChannel0, fragCoord);\n    \n    // fade into distance\n    // need formula that changes z distnace = 0..infinity, into a fade = 0..1\n    // y=1/x, from x=1..infinity, y=1..0, thus:\n    // y=1-(1/x), from x=1..infinity, gets y=0..1\n   \n    // 0=no fade, 1=full fade\n    float fade = 1.0 - (1.0 / (1.0 + zCamera * FADE_POWER));\n        \n    fragColor.rgb = fragColor.rgb * (1. - fade) + FADE_COLOR.rgb * (fade);\n}\n","name":"Image","description":"","type":"image"}]}