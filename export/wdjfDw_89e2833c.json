{"ver":"0.1","info":{"id":"wdjfDw","date":"1625841440","viewed":189,"name":"Screen Sweat","username":"badjano","description":"sweat using voronoi","likes":4,"published":1,"flags":32,"usePreview":0,"tags":["voronoi","sweat"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4sX3Rn","filepath":"/media/a/c3a071ecf273428bc72fc72b2dd972671de8da420a2d4f917b75d20e1c24b34c.ogv","previewfilepath":"/media/ap/c3a071ecf273428bc72fc72b2dd972671de8da420a2d4f917b75d20e1c24b34c.ogv","type":"video","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord/iResolution.xy;\n    vec3 displace = pow(sat(texture(iChannel0,uv)).xyz,vec3(0.6666));\n    float spec = texture(iChannel0,uv+vec2(0.5,0.)*0.01).x;\n    float shadow = texture(iChannel0,uv+vec2(-0.5,0.)*0.01).x;\n    float t1 = 0.;\n    float t2 = 0.;\n    fragColor = texture(iChannel1,uv-displace.xy*0.1);\n    fragColor = mix(fragColor,fragColor*0.8,sat(smoothstep(t2,t2+0.75,shadow)*1.5));\n    fragColor += sat(smoothstep(t1,t1+0.1,pow(spec,4.))*0.666);\n    fragColor = mix(vec4(displace, 1.),fragColor,step(uv.x,mix(iMouse.x/iResolution.x,0.5,step(iMouse.z,0.5))));\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"float smin( float a, float b, float k )\n{\n    a = pow( a, k ); b = pow( b, k );\n    return pow( (a*b)/(a+b), 1.0/k );\n}\n\nvec2  hash22( vec2  p ) {\n    p = vec2(\n        dot(p,vec2(127.1,311.7)),\n        dot(p,vec2(269.5,183.3))\n    );\n    return fract(sin(p)*43758.5453);\n}\n\nvec3 hash23( vec2  p ) {\n    vec3 p3 = vec3(\n        dot(p,vec2(127.1,311.7)),\n        dot(p,vec2(311.1,269.7)),\n        dot(p,vec2(269.5,183.3))\n    );\n    return fract(sin(p3)*43758.5453);\n}\n\nvec3 voronoi(vec2 uv){\n    float seed = 1.;\n    vec2 p0 = uv*5.; // zoom\n    p0 += vec2(0.,iTime*2.);\n    vec2 f = fract(p0);\n    vec2 id = floor(p0);\n    const int steps = 2;\n    float dropSize = 2.1; // the higher the smaller\n    \n    vec3 m = vec3(1.0);\n    float a = 0.0;\n    for(int x=-steps;x<=steps;x++){\n        for(int y=-steps;y<=steps;y++){\n            vec2 dif = vec2(float(x),float(y));\n            vec2 rid = hash22(id + dif)*2.-1.;\n            vec2 move = sin(3.1416*iTime*rid)*0.25;\n            \n            vec2 p1 = st11(uv);\n            float us = p1.y;\n            a = max(us,a);\n            float ds = pow(st11(sin(iTime*2.+rid.x*100.)),1.)*0.5+1.;\n            float power = 3.;\n            float s = pow(a,power);\n            vec2 p = dif-f+rid+move;\n            vec3 d = vec3(length(p)+0.333)*dropSize*ds;\n            d = pow(d,vec3(6.66));\n            vec3 m2 = pow(min(m,d),vec3(.2));\n            vec3 h = pow(st11(m2-d),vec3(3.));\n            vec3 dcol = d*st11(hash23(rid))*2.25;\n            m = mix(m,dcol,h);\n        }\n    }\n    return sat(1.-m);\n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord*2./iResolution.xy-1.;\n    uv.x *= iResolution.x/iResolution.y;\n    vec3 col = vec3(voronoi(uv*0.5));\n    fragColor = vec4(col,1.0);\n    uv = fragCoord/iResolution.xy;\n    vec4 buffer = texture(iChannel0,uv);\n    col = mix(fragColor.xyz,buffer.xyz,0.825); // temporal blur mix\n    fragColor = vec4(col*1.1666, 1.);\n}","name":"Buffer A","description":"","type":"buffer"},{"inputs":[],"outputs":[],"code":"#define sat(x) clamp(x,0.,1.)\n#define st11(x) smoothstep(-1.,1.,x)\n\n","name":"Common","description":"","type":"common"}]}