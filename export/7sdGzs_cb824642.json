{"ver":"0.1","info":{"id":"7sdGzs","date":"1630526950","viewed":108,"name":"pl√∂tty2","username":"nexor","description":".","likes":10,"published":1,"flags":32,"usePreview":0,"tags":["sdf","multipass"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    fragColor = texture(iChannel0,fragCoord/iResolution.xy);\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"#define max2(v) max((v.x),(v.y))\n\nconst float pi = acos(-1.);\nconst float pi2 = pi*2.;\n\nmat2 rot(float a)\n{\n    float c=cos(a),s=sin(a);\n    return mat2(c,-s,s,c);\n}\n\nfloat circle(vec2 p, float r)\n{return length(p)-r;}\n\nfloat box(vec2 p, vec2 b)\n{\np=abs(p)-b;\nreturn max(p.x,p.y)+length(max(p,0.));\n}\n\nfloat smin( float a, float b, float k )\n{\n    float res = exp2( -k*a ) + exp2( -k*b );\n    return -log2( res )/k;\n}\n\nfloat sdf(float d)\n{\n    return smoothstep(0.,fwidth(d)*1.5,d);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = (2.*fragCoord-iResolution.xy)/max2(iResolution.xy);\n    \n    float w = fwidth(uv.y);\n\n    vec3 col = vec3(0);\n    \n    float ft = float(iFrame)/60.;\n    ft = fract(ft/pi);\n    float tmask = \n    ft*=pi2;\n    \n    \n    float d[] = float[](1e3,1e3);\n    \n    {\n        vec2 p = uv;\n        float k = cos(ft*2.);\n        k=k*.5+.5;\n        k = abs(k-.2)*(1.+.2);\n        k = 2.*abs(k)-1.;\n        vec2 q = p;\n        p.y -= k*.45;\n        d[0] = min(d[0],circle(p,.1));\n        p = rot(-cos(ft)*pi2)*p;\n        d[1] = min(d[1],box(p,vec2(.1-w*7.5))-w*15.);\n    }\n    \n    {\n        vec2 p = uv;\n        float k = 24.;\n        d[0] = smin(d[0],-p.y,k);\n        d[1] = smin(d[1], p.y,k);               \n    }\n    \n    float mask = sdf(uv.y);\n    \n    float d0 = sdf(d[0]);\n    float d1 = sdf(d[1]);\n    float fd = mix(1.-d0,d1,mask);\n    \n    col += fd;\n    col = pow(col,vec3(1./2.2));\n    \n    vec3 buf=texelFetch(iChannel0,ivec2(fragCoord),0).rgb;\n    col=mix(col,mix(col,buf,-.9),mask);\n    \n\n    \n    fragColor = vec4(col,1.0);\n}","name":"Buffer A","description":"","type":"buffer"}]}