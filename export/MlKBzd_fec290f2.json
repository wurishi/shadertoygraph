{"ver":"0.1","info":{"id":"MlKBzd","date":"1543715779","viewed":131,"name":"Weird shape and video artifacts","username":"Vermifuge","description":"A deformed sphere and video artifacts","likes":3,"published":1,"flags":0,"usePreview":0,"tags":["artifacts"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"vec2 one = vec2(1., 0.);\n\nfloat hash(vec2 x) {\n\treturn fract(cos(\n\t\tdot(x, vec2(672.529,198.3862))\n\t\t)*9857.733);\n}\n\nfloat noise(vec2 x) {\n\tvec2 ix =floor(x);\n\tvec2 fx = fract(x);\n\tfx=fx*fx*(3.-2.*fx);\n\n\tfloat bl = hash(ix);\n\tfloat br = hash(ix+one.xy);\n\tfloat tl = hash(ix+one.yx);\n\tfloat tr = hash(ix+one.xx);\n\n\treturn mix(\n\t\tmix(bl, br, fx.x),\n\t\tmix(tl, tr, fx.x),\n\t\tfx.y);\n}\n\nfloat fbm(vec2 p) {\n\treturn (\n\t\t.5* noise(p)\n\t\t+ .25* noise(p*2.1)\n\t\t+ .175* noise(p*3.9)\n\t\t+ .0875* noise(p*7.03)\n\t);\n}\n\nfloat sphere(vec3 p, float r) {\n\tp += .2*sin(6.*p.zxy+one.yxy*iTime);\n\tp += .1*sin(12.*p.yzx+one.yxy*iTime);\n\treturn length(p) - r;\n}\n\nfloat map(vec3 p) {\n\treturn sphere(p, 1.5);\n}\n\nvec4 raymarch(vec2 uv) {\n\tvec3 camera = vec3(0., 0., -5.);\n\tvec3 dir = normalize(vec3(uv, 1.));\n\tvec4 res = vec4(camera, 0.);\n\tfloat t = 0.;\n\tfor (int i = 0; i < 60; ++i) {\n\t\tvec3 p = camera + t*dir;\n\t\tfloat d = map(p);\n\t\tif (d < .001) {\n\t\t\tres = vec4(p, 1.);\n\t\t}\n\t\tt += d;\n\t}\n\treturn res;\n}\n\nvec3 normal(vec3 p) {\n\tvec2 e = vec2(.001, 0.);\n\treturn normalize(vec3(\n\t\tmap(p - e.xyy) - map(p + e.xyy),\n\t\tmap(p - e.yxy) - map(p + e.yxy),\n\t\tmap(p - e.yyx) - map(p + e.yyx)));\n}\n\nvec2 artifacts(vec2 uv, float cells) {\n    // random displacement vector\n\tvec2 glitch = 2.*vec2(\n\t\tfbm(floor(cells*uv)+1.5*iTime),\n\t\tfbm(floor(cells*uv)+1.5*iTime+7383.42))-1.;\n    \n    // randomly enable / disable displacement\n\tglitch *= step(.95, noise(floor(cells*uv)+10.*noise(iTime*one)));\n\treturn uv + .1*glitch;\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord) {\n    // center the origin and make it span -0.5 to 0.5\n\tvec2 uv = fragCoord.xy/iResolution.xy;\n\tuv -= .5;\n\tuv.x *= iResolution.x/iResolution.y;\n    \n    uv = artifacts(uv, 10.);\n\t\n    //background\n\tvec3 color = (uv.y+.5)*vec3(.1,.4,.5);\n    \n    //sphere\n\tvec4 obj = raymarch(uv);\n    float orthogonal = abs(dot(normal(obj.xyz), vec3(0., 1., -.6)));\n\tcolor = mix(color, vec3(1.), obj.w * orthogonal - .2);\n\tcolor = mix(color, vec3(.7,.2,.2),\n\t\t.5*smoothstep(.1, 1., obj.w*noise(obj.z+obj.xy*5.)));\n\tfragColor = vec4(color, 1.);\n}\n","name":"Image","description":"","type":"image"}]}