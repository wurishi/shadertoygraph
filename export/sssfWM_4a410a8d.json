{"ver":"0.1","info":{"id":"sssfWM","date":"1728274272","viewed":69,"name":"Repelling Points on Sphere","username":"oneshade","description":"Another interesting old shader sitting around in private.","likes":12,"published":3,"flags":32,"usePreview":0,"tags":["sphere","moving","points","repelling"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define drawPoint3(p) drawSDF(length(uv - p.xy / (3.0 - p.z)) - 0.01 / (2.0 - p.z), vec3(1.0))\n#define drawSDF(dist, col) color = mix(color, col, smoothstep(unit, 0.0, dist))\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord) {\n    vec2 uv = (fragCoord - 0.5 * iResolution.xy) / iResolution.y;\n    float unit = 2.0 / iResolution.y;\n    vec3 color = vec3(0.0);\n\n    float rot = 0.0;//-iTime;\n    float co = cos(rot), si = sin(rot);\n    mat2 rotMat = mat2(co, si, -si, co);\n\n    for (int i=0; i < NUM_POINTS; i++) {\n        vec3 p = texelFetch(iChannel0, ivec2(i, 0), 0).xyz;\n\n        p.xz *= rotMat;\n        p.yz *= rotMat;\n\n        drawPoint3(p);\n    }\n\n    fragColor = vec4(color, 1.0);\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"// https://www.shadertoy.com/view/4djSRW\nvec2 Hash12(in float p) {\n    vec3 p3 = fract(p * vec3(0.1031, 0.103, 0.0973));\n    p3 += dot(p3, p3.yzx + 33.33);\n    return fract((p3.xx + p3.yz) * p3.zy);\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord) {\n    fragColor = vec4(0.0);\n    ivec2 iFragCoord = ivec2(fragCoord);\n    if (iFrame == 0) {\n        if (iFragCoord.x < NUM_POINTS) {\n            vec2 rot = (Hash12(fragCoord.x) - 0.5) * vec2(6.28, 3.14);\n            float cy = cos(rot.x), sy = sin(rot.x);\n            float cp = cos(rot.y), sp = sin(rot.y);\n            fragColor.xyz = vec3(cy * cp, sp, sy * cp);\n        }\n    }\n\n    if (iFrame > 0) {\n        fragColor = texelFetch(iChannel0, iFragCoord, 0);\n\n        for (int i=0; i < NUM_POINTS; i++) {\n            if (i == iFragCoord.x) continue;\n            vec3 p = texelFetch(iChannel0, ivec2(i, 0), 0).xyz;\n            vec3 push = fragColor.xyz - p;\n            fragColor.xyz += normalize(push) / (dot(push, push) + 1.0) * SPEED * iTimeDelta;\n        }\n\n        fragColor.xyz /= length(fragColor.xyz);\n        //fragColor.xyz /= max(abs(fragColor.x), max(abs(fragColor.y), abs(fragColor.z)));\n        //fragColor.xyz /= abs(fragColor.x) + abs(fragColor.y) + abs(fragColor.z);\n    }\n}","name":"Buffer A","description":"","type":"buffer"},{"inputs":[],"outputs":[],"code":"#define NUM_POINTS 20 //100\n#define SPEED 20.0","name":"Common","description":"","type":"common"}]}