{"ver":"0.1","info":{"id":"XdKfRD","date":"1527806728","viewed":576,"name":"Wavy vortex","username":"knutae","description":"Answer to StackOverflow question https://stackoverflow.com/questions/5451376/how-to-implement-this-tunnel-like-animation-in-webgl/5493122","likes":11,"published":1,"flags":0,"usePreview":0,"tags":["tunnel"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"const float PI = 3.14159265358979323846264;\nconst float TWOPI = PI*2.0;\nconst vec4 WHITE = vec4(1.0, 1.0, 1.0, 1.0);\nconst vec4 BLACK = vec4(0.0, 0.0, 0.0, 1.0);\nconst int MAX_RINGS = 30;\nconst float RING_DISTANCE = 0.05;\nconst float WAVE_COUNT = 60.0;\nconst float WAVE_DEPTH = 0.04;\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    float rot = mod(iTime*0.6, TWOPI);\n    vec2 pos = vec2(fragCoord.x / iResolution.x, fragCoord.y / iResolution.y);\n    pos = vec2(3.0*(pos.x - 0.5), 2.0*(pos.y - 0.5));\n    float x = pos.x;\n    float y = pos.y;\n\n    bool black = false;\n    float prevRingDist = RING_DISTANCE;\n    for (int i = 0; i < MAX_RINGS; i++) {\n        vec2 center = vec2(0.0, 0.7 - RING_DISTANCE * float(i)*1.2);\n        float radius = 0.5 + RING_DISTANCE / (pow(float(i+5), 1.1)*0.006);\n        float dist = distance(center, pos);\n        dist = pow(dist, 0.3);\n        float ringDist = abs(dist-radius);\n        if (ringDist < RING_DISTANCE*prevRingDist*7.0) {\n            float angle = atan(y - center.y, x - center.x);\n            float thickness = 1.1 * abs(dist - radius) / prevRingDist;\n            float depthFactor = WAVE_DEPTH * sin((angle+rot*radius) * WAVE_COUNT);\n            if (dist > radius) {\n                black = (thickness < RING_DISTANCE * 5.0 - depthFactor * 2.0);\n            }\n            else {\n                black = (thickness < RING_DISTANCE * 5.0 + depthFactor);\n            }\n            break;\n        }\n        if (dist > radius) break;\n        prevRingDist = ringDist;\n    }\n\n    fragColor = black ? BLACK : WHITE;\n}","name":"Image","description":"","type":"image"}]}