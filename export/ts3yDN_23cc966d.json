{"ver":"0.1","info":{"id":"ts3yDN","date":"1600954651","viewed":123,"name":"Normal Map Stuff by Flyguy-v2","username":"jorge2017a1","description":"Normal Map Stuff by Flyguy-v2","likes":5,"published":1,"flags":0,"usePreview":0,"tags":["normalmapstuffbyflyguyv2"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"/* Normal Map Stuff */\n/* By: Flyguy */\n/* With help from http://stackoverflow.com/q/5281261 */\n// fancified a bit by psonice\n// slimified a bit by kabuto\n \n\n#define PI 3.141592\n\n\nfloat heightmap(vec2 position)\n{\n\tfloat height = 0.0;\n\tfloat f = .002;\n\tvec2 timevec = iTime*vec2(.1,.13);\n\tfloat g = sqrt(1.25)+.5;\n\tposition *= f;\n\tfloat c = cos(2.*PI*g);\n\tfloat s = sin(2.*PI*g);\n\tmat2 matcs = mat2(c,s,-s,c)*g;\n\tfor (int i = 0; i < 13; i++) {\n\t\tvec2 v = fract(position + timevec)-.5;\n\t\tfloat dots = max(0.,.13-dot(v,v));\n\t\tdots = dots*dots*dots/f*8.;\n\t\theight += dots*dots*2.;//max(height,dots);\n\t\tf *= g;\n\t\tposition *= matcs;\n\t}\n\t\n\treturn sqrt(height);\n}\n\t\nfloat n1,n2,n3,n4;\nvec2 size = vec2(-0.4,0.0);\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 mouse;\n\tvec2 pos = fragCoord.xy;\n\tmouse.x=0.5+0.5*cos(iTime);\n    mouse.y=0.5+0.5*sin(iTime);\n    \n\tn1 = heightmap(vec2(pos.x,pos.y-1.0));\n\tn2 = heightmap(vec2(pos.x-1.0,pos.y));\n\tn3 = heightmap(vec2(pos.x+1.0,pos.y));\n\tn4 = heightmap(vec2(pos.x,pos.y+1.0));\n\t\n\tvec3 p2m = vec3(-((pos/iResolution.xy)-mouse.xy)*iResolution.xy,iResolution.x*1.1);\t\n\t\n\tvec3 normal = normalize(vec3(n2-n3, n1-n4, 0.4));\n\t\n\tfloat color = dot(normal, normalize(p2m))*.5+.5;\n\tvec3 colorvec = vec3(pow(color,10.),pow(color,5.),pow(color,2.5));\n\t\n\tfloat brightness = 1./sqrt(1.+pow(distance(mouse.xy*iResolution.xy,pos)/iResolution.x*8.,2.));\n\t\n\tfragColor = vec4( colorvec*brightness, 1.0 );\n\n}\n","name":"Image","description":"","type":"image"}]}