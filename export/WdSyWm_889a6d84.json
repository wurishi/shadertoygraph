{"ver":"0.1","info":{"id":"WdSyWm","date":"1586733797","viewed":126,"name":"pulsating virus","username":"nexor","description":"Click and hold down the mouse to paint on the screen.\nSpace key resets the scene.","likes":3,"published":1,"flags":48,"usePreview":0,"tags":["diffusion","multipass"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGzn","filepath":"/media/a/0c7bf5fe9462d5bffbd11126e82908e39be3ce56220d900f633d58fb432e56f5.png","previewfilepath":"/media/ap/0c7bf5fe9462d5bffbd11126e82908e39be3ce56220d900f633d58fb432e56f5.png","type":"texture","channel":1,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4dXGRr","filepath":"/presets/tex00.jpg","previewfilepath":"/presets/tex00.jpg","type":"keyboard","channel":2,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void mainImage(out vec4 fragColor, vec2 fragCoord)\n{\n    vec3 col = vec3(.0);\n    vec2 p = (fragCoord.xy-.5*resolution)/resolution.y;\n    \n    {\n        col.gr += texture(iChannel0,fragCoord/iResolution.xy).rg;\n    }\n \tfragColor = vec4(col,1.);   \n}","name":"Image","description":"","type":"image"},{"inputs":[],"outputs":[],"code":"#define time iTime\n#define resolution iResolution.xy\n\n#define replim(x,n,a,b) ((p)-(n)*clamp(round(p/n),(a),(b)))\n#define fetch(pass,uv) texelFetch(pass,ivec2(mod(vec2(uv),(res))),0)\n\n\n\nfloat rect(vec2 p, vec2 s)\n{\n    p=abs(p)-s;\n    return max(p.x,p.y);\n}\n\nfloat circle(vec2 p,float r)\n{\n    return length(p)-r;\n}\n\nvec2 laplace(out vec2 prev, sampler2D pass, vec2 res)\n{\n    vec2 lap=vec2(0.);\n    ivec2 fc = ivec2(gl_FragCoord.xy);\n    ivec3 off = ivec3(-1.,0.,1.);\n    vec2 w = vec2(.2,.05);\n    \n    lap += fetch(pass,fc+off.xx).xy*w.y;\n    lap += fetch(pass,fc+off.xy).xy*w.x;\n    lap += fetch(pass,fc+off.xz).xy*w.y;\n    lap += fetch(pass,fc+off.yx).xy*w.x;\n    prev = fetch(pass,fc+off.yy).xy;\n    lap += fetch(pass,fc+off.yz).xy*w.x;\n    lap += fetch(pass,fc+off.zx).xy*w.y;\n    lap += fetch(pass,fc+off.zy).xy*w.x;\n    lap += fetch(pass,fc+off.zz).xy*w.y;\n    lap += -prev;\n    \n    return lap;\n}\n\n","name":"Common","description":"","type":"common"},{"inputs":[{"id":"4dXGzn","filepath":"/media/a/0c7bf5fe9462d5bffbd11126e82908e39be3ce56220d900f633d58fb432e56f5.png","previewfilepath":"/media/ap/0c7bf5fe9462d5bffbd11126e82908e39be3ce56220d900f633d58fb432e56f5.png","type":"texture","channel":1,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4dXGRr","filepath":"/presets/tex00.jpg","previewfilepath":"/presets/tex00.jpg","type":"keyboard","channel":2,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"vec4 get_params(vec2 p)\n{\n    \n\tfloat A = .6+(length(p))*1.3;\n\tfloat B = .3+sin(time*2.+texture(iChannel1,p*5.-time).x*6.)*.15;\n    \n\tfloat F = .035-B*.015;\n\tfloat K = .06-A*.005;\n    return vec4(A,B,F,K);   \n}\n\nfloat get_dt(vec2 p)\n{\n \treturn 1.;   \n}\n\nfloat seed(vec2 p)\n{\n    return texture(iChannel1,p).x;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord.xy/resolution;\n    vec2 p = (fragCoord.xy-.5*resolution)/resolution.y;\n    \n    vec3 col = vec3(0.);\n    float space = texelFetch(iChannel2,ivec2(32,1),0).x;\n    \n    if(time < 1. || space > .0)\n    {\n        col.rg = vec2(seed(p/25.)*1.5,seed(p/20.));\n    }\n    else\n    {\n        vec2 mouse = (iMouse.xy-.5*resolution)/resolution.y;\n        vec2 click = (iMouse.zw-.5*resolution)/resolution.y;\n        \n        if(iMouse.z >.0)\n        {\n            col += smoothstep(.01,.0,circle(p-(mouse-click),smoothstep(.0,1.,length(p-mouse))*.1));\n        }\n        \n        vec2 curr = vec2(0.);\n        vec2 prev = vec2(0.);\n        vec2 lap = laplace(prev,iChannel0,resolution);\n        vec4 pms = get_params(p);\n        float da=pms.x,db=pms.y;\n        float f=pms.z, k=pms.w;\n        \n        \n        float dt = get_dt(p);\n        \n        float pr = prev.x*prev.y*prev.y;\n        \n        curr.x = da * lap.x - pr + f * (1.-prev.x);\n        curr.y = db * lap.y + pr - (k + f) * prev.y;\n   \n        curr = prev + curr*dt;\n        \n        col += vec3(curr.xy,0.);\n        col = clamp(col,.0,1.);\n        col *= smoothstep(.7,.5,length(p));\n    }\n    \n    \n    fragColor = vec4(col,1.);\n}","name":"Buffer A","description":"","type":"buffer"}]}