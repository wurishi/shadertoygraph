{"ver":"0.1","info":{"id":"wsj3Wc","date":"1550187691","viewed":167,"name":"Glsl Valentine","username":"cbrpnk","description":"Everyday.","likes":6,"published":1,"flags":0,"usePreview":0,"tags":["raymarchingmarcher"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"mat2 rot(float a)\n{\n    float c = cos(a);\n    float s = sin(a);\n    return mat2(c, s, -s, c);\n}\n\nfloat heart(vec2 p)\n{\n    p.x = abs(p.x);\n    p.y *= 1.5;\n    p.x *= 1.2;\n    p.y -= p.x;\n    float c =(length(p) - .3);\n    return c / 2.;\n}\n\nfloat map(vec3 p)\n{\n    p.z -= iTime;\n    vec3 cell = floor(p*.5);\n    p.y += sin(cell.z);\n    p.xy *= rot(cell.z+iTime*.01);\n    p.xy *= rot(iTime*.08);\n    p = mod(p, 2.)-vec3(.8);\n    \n    float ay = abs(p.z) - .01;\n    float h = max(sqrt(pow(heart(p.xy)+.2, 2.) + pow(p.z, 2.)) - .2, ay);\n    \n    return h;\n}\n\nfloat march(vec3 ro, vec3 rd)\n{\n    float t = 0.;\n    for(int i=0; i<128; ++i)\n    {\n        float d = map(ro+rd*t);\n        if(d < .001+t*.03) break;\n        if(t > 30.) return -1.;\n        t += d*.6;\n    }\n    return t;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord/iResolution.xy - vec2(.5);\n    uv.x *= iResolution.x/iResolution.y;\n\n    vec3 cam = vec3(0, 0, 3.);\n    vec3 dir = normalize(vec3(uv.x, uv.y, -1.));\n    float d = march(cam, dir);\n    float h = heart(uv);\n    vec3 col;\n    \n    if(d < 0.) {\n        col = vec3(1., .6, .85);\n    } else {\n    \tcol = vec3(clamp(d*.05, .6, 1.));\n\t\tcol *= vec3(1., .3, .35) * clamp(d, 5., 100.) *.2;\n   \t\tcol.gb = pow(col.gb, vec2(1.4, 1.));\n    }\n    \n    fragColor = vec4(sqrt(col),1.0);\n}","name":"Image","description":"","type":"image"}]}