{"ver":"0.1","info":{"id":"cddBz8","date":"1696862084","viewed":106,"name":"Sprite collisions","username":"kastorp","description":".","likes":16,"published":1,"flags":32,"usePreview":0,"tags":["collision","sprite"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"//Sprite Collisions by kastorp\n\n\nvoid mainImage( out vec4 O, in vec2 I )\n{\n   O=vec4(0.3);\n   \n   for(float i =0.;i<N; i++){\n       vec3 t =texelFetch(iChannel0,ivec2(0.,i),0).xyz;\n       vec4 c= rpos(I,t,R);\n       if(c.x<0.) continue;\n       if(O==vec4(.3)) O=vec4(.28);\n       vec4 pix=texelFetch(iChannel0,ivec2(1.+ c.x*NP+c.y,i),0);\n       if(pix.x>0.) {\n           O=vec4(.5) + .5* cos( vec4(0,11,33,0)+i*6.28/N);\n           if(any(greaterThan(abs(c.zw-vec2(.5)),vec2(.45)))) O*=.2;\n           //vec2 ap=apos(c,t,R);\n           //if(length(ap-I)<R.y*rsz/NP*.1) O=vec4(0);\n       }\n       else if( pix.y>0.) O=vec4(1);\n   }\n   O=pow(O,vec4(.4));\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"\nvoid mainImage( out vec4 O, in vec2 I )\n{\n    if(I.x>NP*NP+1. || I.y>N) discard;\n    if(I.x<1.){\n        float i=I.y;\n        float time=float(iFrame)/60.;\n        vec2 sp=R*.5 + R*.35* vec2(cos(time*.3 + i/N*6.28),sin(time*.31+2.*i/N*6.28 ));\n        float a=time*2. *(i/N-.5) ;    \n        O=vec4(sp,a,0.);\n    }\n    else{\n         int i=int(I.x)-1;\n        if((iFrame%1000)==0) {\n            \n            O= //vec4(1);\n            vec4(((i/NPI + i%NPI)%2)==0);\n        }\n        else {\n            O=texelFetch(iChannel0,ivec2(I),0);\n            O.y=max(O.y-1.,0.);\n            ivec2 c = ivec2(i/NPI , i%NPI);\n            vec3 t =texelFetch(iChannel0,ivec2(0.,I.y),0).xyz;\n            vec2 ap=apos(c,  t ,  R);\n               for(float j =0.;j<N; j++){\n                   if(int(j)==int(I.y)) continue;\n                   vec3 t2 =texelFetch(iChannel0,ivec2(0.,j),0).xyz;\n                   vec4 c2= rpos(ap,t2,R);\n                   if(c2.x<0.) continue;\n                   if(texelFetch(iChannel0,ivec2(1.+ c2.x*NP+c2.y,j),0).x>0.) O=vec4(0,O.x==0.?0.:5.,0,0);\n               }\n        }\n    }\n}","name":"Buffer A","description":"","type":"buffer"},{"inputs":[],"outputs":[],"code":"#define N 20.\n#define rsz .15\n#define NPI 10\n\n\n#define NP float(NPI)\n#define R iResolution.xy\n\nvec4 rpos(vec2 I, vec3 t , vec2 r)\n{\n       vec2 sz =vec2(r.y*rsz);\n       vec2 sp=t.xy;\n       float a=t.z;\n       vec2 rp=(I-sp)/sz *mat2(cos(a),sin(a),-sin(a),cos(a));\n       if(any(greaterThan(abs(rp),vec2(.5)))) return vec4(-1) ;\n       return vec4(floor((rp + .5)*NP),fract((rp + .5)*NP));\n}\n\nvec2 apos(ivec2 c, vec3 t , vec2 r)\n{\n       vec2 sz =vec2(r.y*rsz);\n       vec2 sp=t.xy;\n       float a=t.z;\n       \n       return sp + (vec2(c)/NP-.5 +.5/NP)*sz *mat2(cos(a),-sin(a),sin(a),cos(a));       \n}","name":"Common","description":"","type":"common"}]}