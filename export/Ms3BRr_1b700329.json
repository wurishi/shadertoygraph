{"ver":"0.1","info":{"id":"Ms3BRr","date":"1523967997","viewed":1078,"name":"I feel retro!","username":"crundle","description":"2d parallax scrolling city - in 4:3!","likes":9,"published":1,"flags":0,"usePreview":0,"tags":["retro","pixel","parallax","city"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4sf3Rn","filepath":"/media/a/0a40562379b63dfb89227e6d172f39fdce9022cba76623f1054a2c83d6c0ba5d.png","previewfilepath":"/media/ap/0a40562379b63dfb89227e6d172f39fdce9022cba76623f1054a2c83d6c0ba5d.png","type":"texture","channel":0,"sampler":{"filter":"nearest","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"vec2 res = vec2(320.,240.);\n\nfloat pixelateIn(vec2 p, float st, float ft) {\n    float blend = smoothstep(st,ft,iTime);\n    return clamp(0.,1.,step(texture(iChannel0, p*res/64.).r+.1*(1.-blend),blend));\n}\n\nfloat layer(in vec2 p, out vec3 col, in float time) {\n    p+=+vec2(time*.2,0.);\n    vec2 cell = trunc(p*vec2(64.,40.));\n    vec2 local = fract(p*vec2(64.,40.));\n    float noise =texture(iChannel0, p*vec2(1,4)).r;\n    float block = (texture(iChannel0,vec2(cell.x/64.*.2,0.)).x*.3+.1);\n    float house = 1.-step(block*40.,cell.y);\n    float window = min(min(step(.2,local.x),1.-step(.8,local.x)), min(step(.2,local.y),1.-step(.8,local.y)) );\n    float light = step(.8,texture(iChannel0,(cell+trunc(time*1.)*20.)/vec2(64,40)).x)*(noise*.2+.8);\n    col=mix(mix(vec3(.15),vec3(.2),step(.3,block))*(noise*.2+.8),mix(vec3(.1),vec3(0.7,0.7,0.3),light),window);\n    col=mix(vec3(.7),col,house);\n    float fog = smoothstep(.2,1.,noise*(cos(p.y*4.-3.-sin(iTime*.4+p.x*10.)*.2) ))*.1;\n    return max(house,fog);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // Normalized pixel coordinates (from 0 to 1)\n    vec2 uv = fragCoord/iResolution.xy;\n    if(min(uv.x,1.-uv.x)<0.13333) { //approx. 4:3\n        fragColor = vec4(0);\n        return;\n    }\n    \n    vec2 pixl = trunc(uv*res)/res;\n\n    // background\n    vec3 bg = mix(vec3(0.3,.1,0.4),vec3(0.8,.4,.7),1.-pixl.y-texture(iChannel0,uv*vec2(.0,1.)).r*.05);\n    vec3 col = bg;\n    //parallax\n    for(int i =4; i>0; i--) {\n    \tvec3 lc = bg;\n        float lf = 1.-float(i-1)/4.;\n    \tfloat l = layer(pixl-vec2(0,float(i)*.05),lc, iTime*lf*.75+float(i*i)+5.5);\n    \tcol = mix(col,mix(bg,lc,lf),l);\n    }\n    col*=pixelateIn(pixl,0.,2.);\n    \n    \n    // Output to screen\n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}