{"ver":"0.1","info":{"id":"Wsj3R1","date":"1548162006","viewed":412,"name":"The Twitter “Like” Animation.","username":"tatsunoru","description":"The Twitter “Like” Animation.","likes":6,"published":1,"flags":0,"usePreview":0,"tags":["heart","twitter"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\n#define M_PI 3.1415926535897932384626433832795\n#define M_PI05 (M_PI * 0.5)\n\nvec2 rotate(vec2 v, float c, float s){\n\treturn vec2(v.x*c - v.y*s, v.x*s + v.y*c);\n}\n\nvec2 rotate(vec2 v, float r){\n\treturn rotate(v, cos(r), sin(r));\n}\n\nvec3 hsv2rgb(vec3 hsvValue) {\n\tconst vec4 t = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\tvec3 p = abs(fract(hsvValue.x + t.xyz) * 6.0 - t.w);\n\treturn hsvValue.z * mix(t.xxx, clamp(p - t.x, 0.0, 1.0), hsvValue.y);\n}\n\nfloat heartLength(vec2 pos){\n    pos.y -= 0.35;\n    pos *= 2.2;\n    float r = abs(atan(pos.x, pos.y) / M_PI);\n    float r2 = r * r;\n    float s = (39.0 * r - 66.0 * r2 + 30.0 * r2 * r) / (6.0 - 5.0 * r);   \n    return length(pos) / s;\n}\n\nfloat ease_in_quad(float t){ return t * t; }\nfloat ease_out_quad(float t){ return -t * (t - 2.0); }\nfloat ease_in_cubic(float t){ return ease_in_quad(t) * t; }\nfloat ease_out_cubic(float t){ return ease_in_cubic(t - 1.0) + 1.0; }\nfloat ease_in_quart(float t){ return ease_in_cubic(t) * t; }\nfloat ease_out_quart(float t){ return -ease_in_quart(t - 1.0) + 1.0; }\nfloat ease_out_back(float t){ float g = 1.70158; return (ease_in_quad(t - 1.0) * ((g + 1.0) * (t - 1.0) + g) + 1.0); }\n\nvec4 mixin(vec4 src1, vec4 src2){\n    return vec4(mix(src1.rgb, src2.rgb, src2.a), max(src1.a, src2.a));\n}\n\nvec4 circleEffect(vec2 pos, float t){\n    float t2 = ease_out_quad(t);\n    float len = length(pos);\n    float r = (1.0 - smoothstep(0.8 + t2 * 0.1, 0.81 + t2 * 0.1, len)) * smoothstep(t2, t2 + 0.01, len);\n    return vec4(hsv2rgb(vec3(0.0 - ease_in_cubic(t), 0.5, 0.9)), r);\n}\n\nvec4 circleEffect2(vec2 pos, float t){\n    float t1 = ease_out_quart(t);\n    float t2 = ease_in_quart(t);\n   \n    float r = length(pos);\n    float s = atan(pos.y, pos.x) / M_PI;\n\n    float s2 = floor(s * 3.505) / 3.505;\n    float hash = sin(s2 * 4863.89644169) * 0.05;\n    vec2 uv2 = pos + rotate(vec2(mix(0.5, 1.0 + hash, t1), 0.0), s2 * M_PI + 3.4);\n    vec2 uv3 = pos + rotate(vec2(mix(0.8, 0.9 + hash, t1), 0.0), s2 * M_PI + 3.65);\n    \n    float aa = length(uv2);\n    float aa2 = length(uv3) * 1.8;\n    aa = min(aa, aa2);\n    aa = 1.0 - smoothstep(0.1, 0.11, aa +  t2 * 0.11);\n    \n    return vec4(hsv2rgb(vec3(s2 * 0.5 - 0.1, 0.5, 0.95)), aa);\n}\n\nvec4 heartEffect(vec2 pos, float t){\n    float t3 = max(1.0 - t * 3.0, ease_out_back(t));\n    float heartLen = heartLength(pos * mix(6.0, 2.0, (t3)));\n    float th = clamp(t * 5.0, 0.0, 1.0);\n    float heart = (1.0 - smoothstep(1.0, 1.02, heartLen));// * mix(smoothstep(0.9, 0.91, heartLen), 1.0, th);                            \n    return vec4(hsv2rgb(mix(vec3(0.0, 0.0, 0.8), vec3(0.0, 0.5, 0.95), th)), heart);   \n}\n\nvec4 effect(vec2 pos, float t){\n    vec4 col = vec4(1.0, 1.0, 1.0, 0.0);    \n    col = mixin(col, heartEffect(pos, t));\n    col = mixin(col, step(0.001, t) * circleEffect(pos, clamp(t * 3.0, 0.0, 1.0)));\n    col = mixin(col, step(0.001, t) * circleEffect2(pos, clamp(t * 1.2, 0.0, 1.0)));  \n    return col;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = (fragCoord.xy - iResolution.xy * 0.5) / iResolution.yy * 2.2;  \n    fragColor = effect(uv, clamp((fract(iTime * 0.5) - 0.5) * 3.0, 0.0, 1.0));\n}\n","name":"Image","description":"","type":"image"}]}