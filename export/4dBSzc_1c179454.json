{"ver":"0.1","renderpass":[{"outputs":[{"channel":0,"id":"4dfGRr"}],"inputs":[],"code":"vec3 eye = vec3(0,0,-10);\nvec3 sphere1Pos = vec3(-.5,.2,.5);\nvec3 sphere2Pos = vec3(-.5,.3,-.1);\nvec3 torusPos = vec3(0,0,0.);\nconst float maxIterations = 64.;\n\nstruct ray{\n \tvec3 position;\n    vec3 direction;\n};\n    \nfloat smin( float a, float b, float k){\n    float h = clamp( 0.5+0.5*(b-a)/k, 0.0, 1.0 );\n    return mix( b, a, h ) - k*h*(1.0-h);\n}\n\nfloat distSphere( vec3 p, float s )\n{\n  return length(p)-s;\n}\n\nfloat distTorus( vec3 p, vec2 t )\n{\n  vec2 q = vec2(length(p.xz)-t.x,p.y);\n  return length(q)-t.y;\n}\n\nfloat distFunc(vec3 p){\n    float d1 = distSphere(p - sphere1Pos, .5);\n\tfloat d2 = distSphere(p - sphere2Pos,0.3);\n    float d3 = distTorus(p - torusPos, vec2(.75,.2));\n    //return min(min(d1,d2),d3);\n    return smin(smin(d1,d2, .2),d3, .2);\n}\n    \nray lookAt(in vec2 uv, in vec3 targetPoint){\n\tvec3 forward = normalize(targetPoint - eye);\n    vec3 up = vec3(0.,1.0,0.0);\n    vec3 right = cross(forward, up);\n    up = cross(forward, right);\n    //return ray(eye, normalize(up + right + forward));\n    vec3 ro = eye + forward * .1 + right * uv.x + up * uv.y;\n    vec3 rd = forward;\n    return ray(ro,rd);\n}\n\nvec3 rayMarch(ray marcher){\n    float epsilon = 0.00001;\n    float t = 0.;\n    for (float i = 0.; i < maxIterations; i++){\n        vec3 point = marcher.position + marcher.direction * t;\n        float d = distFunc(point);\n        if (d < epsilon){\n            return vec3(1.-i/maxIterations); \n        }\n        t+=d;\n    }\n    return vec3(0,0,0);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ){\n    eye = vec3(cos(iTime) * 5. ,sin(iTime) * 3., sin(iTime) * 5.);\n    vec2 uv = fragCoord.xy / iResolution.xy * 2. - 1.;\n\tuv.x *= iResolution.x / iResolution.y;\n    ray eyeRay = lookAt(uv, vec3(0)); \n\tfragColor = vec4(rayMarch(eyeRay),1.0);\n}","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"4dBSzc","date":"1414195486","viewed":299,"name":"Distance fields How do they work","username":"twitchingace","description":"Messing around with a first look into distance field based ray marching. Nothing worth looking at.","likes":8,"published":1,"flags":0,"usePreview":0,"tags":["3d","distancefield","raymarch"],"hasliked":0,"parentid":"","parentname":""}}