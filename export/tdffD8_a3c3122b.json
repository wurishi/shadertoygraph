{"ver":"0.1","info":{"id":"tdffD8","date":"1588125598","viewed":151,"name":"Chroma split","username":"hclarke","description":"split chroma\nsame luminosity","likes":5,"published":1,"flags":0,"usePreview":0,"tags":["chroma"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"Xdf3Rn","filepath":"/media/a/e81e818ac76a8983d746784b423178ee9f6cdcdf7f8e8d719341a6fe2d2ab303.webm","previewfilepath":"/media/ap/e81e818ac76a8983d746784b423178ee9f6cdcdf7f8e8d719341a6fe2d2ab303.webm","type":"video","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"const mat3 YUV_to_RGB = mat3(\n         1.0,1.0,1.0,\n        0.0,-0.39465,2.03211,\n        1.13983,-0.58060,0.0);\n\nconst mat3 XYZ_to_RGB = mat3(\n    3.2406, -0.9689, 0.0557,\n    -1.5372, 1.8758, -0.2040,\n    -0.4986, 0.0415, 1.0570);\n\nconst vec3 D65_XYZ = vec3(.95047, 1.0, 1.08883);\nconst vec3 D65_xyY = vec3(0.31271, 0.32902, 1.0);\nconst vec3 D65_Yuv = vec3(1.0, 0.19784, 0.46834);\nconst vec3 ONE = vec3(1.0,1.0,1.0);\n\nvec3 XYZ_to_xyY(vec3 XYZ) {\n \tfloat inv_sum = 1.0/dot(XYZ,ONE);\n    return XYZ.xyy * vec3(inv_sum,inv_sum,1.0);\n}\n\nvec3 xyY_to_XYZ(vec3 xyY) {\n \tfloat s = xyY.z/xyY.y;\n    float z = 1.0-dot(vec2(1.0,1.0), xyY.xy);\n    return vec3(xyY.x, xyY.z, z) * vec3(s,1.0,s);\n}\n\nvec3 LUV_to_XYZ(vec3 LUV) {\n    vec2 uv = LUV.yz / (13.0*LUV.x) + D65_Yuv.yz;\n    float Y = LUV.x > 8.0 ? \n        D65_Yuv.x * pow((LUV.x+16.0)/116.0, 3.0) : \n    \tLUV.x * D65_Yuv.x * 0.00110705645;\n    float X = Y * 9.0 * uv.x / (4.0*uv.y);\n    float Z = Y * (12.0-3.0*uv.x-20.0*uv.y)/(4.0*uv.y);\n    return vec3(X,Y,Z);\n}\n\nvec3 XYZ_to_LUV(vec3 XYZ) {\n \tvec3 xyY = XYZ_to_xyY(XYZ);\n    float e = 0.008856;\n    float k = 903.3;\n    vec2 mul = vec2(4.0, 9.0);\n    float div = dot(XYZ, vec3(1.0, 15.0, 3.0));\n    \n    vec2 uv_ = XYZ.xy * mul / div;\n    float y_ = XYZ.y / D65_Yuv.x;\n    float L = y_ > e ? \n        116.0 * pow(y_, 1./3.) - 16. :\n\t\tk*y_;\n    return vec3(L, 13. * L * (uv_ - D65_Yuv.yz));\n\n}\n\nvec3 RGB_to_LUV(vec3 RGB) {\n \treturn XYZ_to_LUV(inverse(XYZ_to_RGB) * RGB);   \n}\n\nvec3 LUV_to_RGB(vec3 LUV) {\n \treturn XYZ_to_RGB * LUV_to_XYZ(LUV);   \n}\n\nvec3 LUV_to_HCL(vec3 LUV) {\n \tfloat H = atan(LUV.z, LUV.y);\n    float C = length(LUV.yz);\n    return vec3(H, C, LUV.x);   \n}\n\nvec3 HCL_to_LUV(vec3 HCL) {\n    float u = cos(HCL.x);\n    float v = sin(HCL.x);\n    vec2 uv = vec2(u,v);\n    return vec3(HCL.z, uv * HCL.y);\n}\n\nvec3 RGB_to_HCL(vec3 RGB) {\n \tvec3 LUV = RGB_to_LUV(RGB);\n    return LUV_to_HCL(LUV);\n}\n\nvec3 HCL_to_RGB(vec3 HCL) {\n \tvec3 LUV = HCL_to_LUV(HCL);\n    return LUV_to_RGB(LUV);\n}\n\n\n\nvec3 tex(vec2 uv) {\n    vec3 c = texture(iChannel0, uv).xyz;\n    \n \t// make greenscreen grey\n    c.g = min(c.g, (c.r + c.b) * 0.5);\n    \n    return c;\n}\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // Normalized pixel coordinates (from 0 to 1)\n    vec2 uv = fragCoord/iResolution.xy;\n   \n    float t = iTime * 2. * 0.;\n    t = 1.;\n    float d = sin(iTime * 2.1);\n\tvec2 o = vec2(sin(t), cos(t)) * 0.05;\n    \n    vec3 colA = RGB_to_HCL(tex(uv+o));\n    vec3 colB = RGB_to_HCL(tex(uv - o));\n    vec3 col = RGB_to_LUV(tex(uv));\n    float r = 3.14195*2.*iTime;\n    colA.x += r;\n    colB.x += r;\n    \n    colA = HCL_to_LUV(colA);\n    colB = HCL_to_LUV(colB);\n    colA.y *= 0.;\n    colB.z *= 0.;\n    \n    \n    colA = LUV_to_HCL(colA);\n    colB = LUV_to_HCL(colB);\n    colA.x -= r;\n    colB.x -= r;\n    \n    \n    colA = HCL_to_LUV(colA);\n    colB = HCL_to_LUV(colB);\n    \n    col.yz = colA.yz + colB.yz;\n    col = LUV_to_RGB(col);\n    // Output to screen\n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}