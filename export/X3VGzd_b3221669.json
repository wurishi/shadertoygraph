{"ver":"0.1","info":{"id":"X3VGzd","date":"1718102681","viewed":38,"name":"retro greenbackground film test","username":"chenxianming","description":"grab your mouse to try and refresh page to sync video source.","likes":3,"published":1,"flags":32,"usePreview":0,"tags":["retro","greenbackground"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XdfGRr","filepath":"/media/a/35c87bcb8d7af24c54d41122dadb619dd920646a0bd0e477e7bdc6d12876df17.webm","previewfilepath":"/media/ap/35c87bcb8d7af24c54d41122dadb619dd920646a0bd0e477e7bdc6d12876df17.webm","type":"video","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\n\nfloat D( vec2 u ){\n\n    u.y -= .3;\n    \n    float py = u.y, d;\n\n    py = abs( py ) - 1.2;\n    py = abs( py );\n    \n    d = max( abs( u.x ) - .5 * py,  ( u.y ) - .7 * py );\n    \n    if( u.y < -1.2 )\n        d = 1.;\n    \n    return d;\n}\n\nfloat df( vec3 p ){\n    \n    return max( D( p.xy ), abs( p.z ) - .02 );\n}\n\nvec3 cl( vec2 V ){\n    vec3 c = texture( iChannel1, V ).rgb;\n    \n    if( abs( c.x - .05 ) < .3 && abs( c.y - .63921 ) < .3 && abs( c.z - .145 ) < .3 ){\n        c = vec3(0);\n    }\n    \n    return c;\n}\n\nvec3 gr( vec2 u, vec2 cen, float n ){\n    vec3 c;\n    \n    \n    for( float i = -2.; i < 2.; i+=.5 ){\n        if( i > n ){\n            break ;\n        }\n        c += texture( iChannel0, u + ( i / n * .9 ) * ( cen - u ) ).rgb * (1.- i / n ) * .1;\n    }\n    \n    return c;\n}\n\n\nvoid mainImage( out vec4 U, in vec2 V )\n{\n    vec2 u = (V+V-I.xy) / A,\n         m = ( iMouse.xy * 2. - I.xy ) / A;\n\n    \n    m = max( m, vec2( -.1 ) );\n    m = min( m, vec2( .1 ) );\n    \n    float t, d, i;\n\n    vec3 c, o = vec3( 0, 0, -1 ), p, r = vec3( u, 1 );\n    \n    while( i++ < 64. ){\n        p = o + r * t;\n        p.xz *= rot( m.x );\n        p.yz *= rot( m.y );\n        d = df( p );\n        t += d * .5556;\n    }\n    \n    c = mix(\n        vec3( .76, .4, 0.07 ),\n        vec3( .9, .439, .06 ),\n        V.y / I.y\n    ) * ( 1. - sin( atan( u.x, u.y ) * 20. ) );\n\n    \n    if( d < 1e-3 ){\n        c *= smoothstep( 5. / A, -5. / A, abs( fract( D( p.xy ) * 6. ) ) - .5 );\n        c *= 5.;\n        c = vv( c );\n        c += .5;\n        \n        c = mix(\n            c,\n            cl( (p.xy / 2. + .5) ) * .3,\n            t\n        );\n\n        vec2 cen = vec2( .5, .5 );\n        vec3 ga = gr( p.xy / 2. + .5, cen, 40. );\n        c *= 1. - ga;\n        c += ga * 1.5;\n\n        /*\n        c = mix(\n            c,\n            cl( (p.xy / 2. + .5) ),\n            t\n        );\n        \n        vec2 cen = vec2( .5, .5 );\n        vec3 ga = gr( p.xy / 2. + .5, cen, 40. );\n        c *= 1. - ga;\n        c += ga * 1.5;\n    \n        */\n\n    }\n    \n\n    c = mix(\n        c,\n        vec3( m.x * 10. ),\n        step( D(u * 5. +vec2(-5., 3)), 0. )\n    );\n    \n    c = mix(\n        c,\n        vec3( m.x * -10. ),\n        step( D(u * 5. +vec2(5., 3)), 0. )\n    );\n    \n    U = vec4(c,1.0);\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"XdfGRr","filepath":"/media/a/35c87bcb8d7af24c54d41122dadb619dd920646a0bd0e477e7bdc6d12876df17.webm","previewfilepath":"/media/ap/35c87bcb8d7af24c54d41122dadb619dd920646a0bd0e477e7bdc6d12876df17.webm","type":"video","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"\n\nvec3 ft( vec2 V, int inv ){\n    vec3 c = texture( iChannel0, V / I.xy ).rgb;\n    \n    if( abs( c.x - .05 ) > .1 || abs( c.y - .63921 ) > .1 || abs( c.z - .145 ) > .1 ){\n        c = vec3(3);\n    }\n    \n    c -= 2.;\n    \n    if( inv == 1 ){\n        c.x = step( c.x, 0. );\n    }\n    \n    return c.xxx;\n}\n\nvec3 cl( vec2 V ){\n    vec3 c = texture( iChannel0, V / I.xy ).rgb;\n    \n    if( abs( c.x - .05 ) < .3 && abs( c.y - .63921 ) < .3 && abs( c.z - .145 ) < .3 ){\n        c = vec3(0);\n    }\n    \n    return c;\n}\n\n\nvoid mainImage( out vec4 U, in vec2 V )\n{\n\n    \n    vec3 g = ft( V, 0 );\n    vec2 u = (V+V-I.xy) / I.y,\n         m = ( iMouse.xy * 2. - I.xy ) / A;\n    \n    g *= ft( V + vec2( edge * -m ), 1 );\n    \n    g *= cl( V * 0.99 );\n\n\n    \n    U = vec4(g,1.0);\n}","name":"Buffer A","description":"","type":"buffer"},{"inputs":[],"outputs":[],"code":"#define I iResolution\n#define A min( I.x, I.y )\n#define rot( a ) mat2( cos(a), sin(a), -sin(a), cos(a) )\n#define edge 4.\n#define vv(a) clamp( a, 0., 1. )\n","name":"Common","description":"","type":"common"}]}