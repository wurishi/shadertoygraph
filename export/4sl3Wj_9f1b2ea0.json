{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[],"code":"vec3 ErrorCheck(vec3 col)\n{\n\tif (col.x > 1.0)\n\t\treturn vec3(0.6, 0.0, 0.0);\n\tif (col.y > 1.0)\n\t\treturn vec3(0.0, 0.6, 0.0);\n\tif (col.z > 1.0)\n\t\treturn vec3(0.0, 0.0, 0.6);\n\n\tif (col.x < 0.0)\n\t\treturn vec3(0.3, 0.0, 0.0);\n\tif (col.y < 0.0)\n\t\treturn vec3(0.0, 0.3, 0.0);\n\tif (col.z < 0.0)\n\t\treturn vec3(0.0, 0.0, 0.3);\n\n\tif (abs(col.x + col.y + col.z - 1.0) > 0.001)\n\t\treturn vec3(1.0, 1.0, 1.0);\n\n\treturn col;\n}\n\nvec4 ErrorCheck(vec4 col)\n{\n\tif (col.x > 1.0)\n\t\treturn vec4(0.6, 0.0, 0.0, 0.0);\n\tif (col.y > 1.0)\n\t\treturn vec4(0.0, 0.6, 0.0, 0.0);\n\tif (col.z > 1.0)\n\t\treturn vec4(0.0, 0.0, 0.6, 0.0);\n\tif (col.w > 1.0)\n\t\treturn vec4(0.0, 0.0, 0.0, 0.6);\n\n\tif (col.x < 0.0)\n\t\treturn vec4(0.3, 0.0, 0.0, 0.0);\n\tif (col.y < 0.0)\n\t\treturn vec4(0.0, 0.3, 0.0, 0.0);\n\tif (col.z < 0.0)\n\t\treturn vec4(0.0, 0.0, 0.3, 0.0);\n\tif (col.w < 0.0)\n\t\treturn vec4(0.0, 0.0, 0.0, 0.3);\n\n\tif (abs(col.x + col.y + col.z + col.w - 1.0) > 0.001)\n\t\treturn vec4(0.6, 0.6, 0.6, 0.0);\n\n\treturn col;\n}\n\nvec3 Weights2(vec3 p, vec3 a, vec3 b)\n{\n\tvec3 ba = a - b;\n\tvec3 bp = p - b;\n\n\tfloat x = dot(ba, bp) / dot(ba, ba);\n\n\tvec3 col;\n\tcol.x = clamp(x, 0.0, 1.0);\n\tcol.y = 1.0 - col.x;\n\tcol.z = 0.0;\n\n\treturn ErrorCheck(col);\n}\n\nvec3 Weights3(vec3 p, vec3 a, vec3 b, vec3 c)\n{\n\tvec3 ab = b - a;\n\tvec3 ac = c - a;\n\n\tvec3 n = cross(ab, ac);\n\tfloat areaSq = dot(n, n);\n\t\n\tvec3 pa = a - p;\n\tvec3 pb = b - p;\n\tvec3 pc = c - p;\n\t\n\tvec3 crossA = cross(pb, pc);\n\tvec3 crossB = cross(pc, pa);\n\tvec3 crossC = cross(pa, pb);\n\n\tfloat areaA = dot(crossA, n);\n\tfloat areaB = dot(crossB, n);\n\tfloat areaC = dot(crossC, n);\n\n\tvec3 col;\n\tcol.x = clamp(areaA / areaSq, 0.0, 1.0);\n\tcol.y = clamp(areaB / areaSq, 0.0, 1.0);\n\tcol.z = clamp(areaC / areaSq, 0.0, 1.0);\n\n\tfloat total = col.x + col.y + col.z;\n\tcol /= total;\n\n\treturn ErrorCheck(col);\n}\n\nvec3 Weights4(vec3 p, vec3 a, vec3 b, vec3 c, vec3 d)\n{\n\tvec3 n = vec3(0.0, 0.0, -1.0);\n\n\tvec3 pa = a - p;\n\tvec3 pb = b - p;\n\tvec3 pc = c - p;\n\tvec3 pd = d - p;\n\n\tvec3 ab = b - a;\n\tvec3 bc = c - b;\n\tvec3 cd = d - c;\n\tvec3 da = a - d;\n\n\tvec3 crossPAD = cross(pd, pa);\n\tvec3 crossPBA = cross(pa, pb);\n\tvec3 crossPCB = cross(pb, pc);\n\tvec3 crossPDC = cross(pc, pd);\n\n\tfloat areaPAD = max(dot(crossPAD, n), 0.0001);\n\tfloat areaPBA = max(dot(crossPBA, n), 0.0001);\n\tfloat areaPCB = max(dot(crossPCB, n), 0.0001);\n\tfloat areaPDC = max(dot(crossPDC, n), 0.0001);\n\n\tfloat totalA = areaPAD * areaPBA;\n\tfloat totalB = areaPBA * areaPCB;\n\tfloat totalC = areaPCB * areaPDC;\n\tfloat totalD = areaPDC * areaPAD;\n\n\tvec3 crossA = cross(ab, -da);\n\tvec3 crossB = cross(bc, -ab);\n\tvec3 crossC = cross(cd, -bc);\n\tvec3 crossD = cross(da, -cd);\n\n\tfloat areaA = dot(crossA, n);\n\tfloat areaB = dot(crossB, n);\n\tfloat areaC = dot(crossC, n);\n\tfloat areaD = dot(crossD, n);\n\n\tvec4 col;\n\tcol.x = areaA / totalA;\n\tcol.y = areaB / totalB;\n\tcol.z = areaC / totalC;\n\tcol.w = areaD / totalD;\n\n\tfloat total = col.x + col.y + col.z + col.w;\n\tcol /= total;\n\n\tcol = ErrorCheck(col);\n\n\treturn (col.xyz + col.w * vec3(0.0, 1.0, 1.0));\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tfloat x =  cos(iTime) * 0.1;\n\tfloat y = -sin(iTime) * 0.1;\n\n\tvec3 a = vec3(-0.3 + x, -0.3 - y, 0.0);\n\tvec3 b = vec3(-0.3 - x,  0.3 + y, 0.0);\n\tvec3 c = vec3( 0.3 + x,  0.3 - y, 0.0);\n\tvec3 d = vec3( 0.3 - x, -0.3 + y, 0.0);\n\n\tvec3 p = vec3(fragCoord.xy / iResolution.xy - vec2(0.5, 0.5), 0.0);\n\n//\tvec3 col = Weights2(p, a, b);\n//\tvec3 col = Weights3(p, a, b, c);\n\tvec3 col = Weights4(p, a, b, c, d);\n\n\tfragColor = vec4(col, 1.0);\n}\n","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"4sl3Wj","date":"1379610547","viewed":181,"name":"Generalized Barycentric","username":"rjobling","description":"Testing generalized barycentric co-ordinates","likes":3,"published":1,"flags":0,"usePreview":0,"tags":["test"],"hasliked":0,"parentid":"","parentname":""}}