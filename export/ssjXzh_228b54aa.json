{"ver":"0.1","info":{"id":"ssjXzh","date":"1619678435","viewed":63,"name":"test_lod","username":"winsen","description":"test lod","likes":0,"published":1,"flags":0,"usePreview":0,"tags":["lod"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XdX3Rn","filepath":"/media/a/52d2a8f514c4fd2d9866587f4d7b2a5bfa1a11a0e772077d7682deb8b3b517e5.jpg","previewfilepath":"/media/ap/52d2a8f514c4fd2d9866587f4d7b2a5bfa1a11a0e772077d7682deb8b3b517e5.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"vec4 getTexLinear(sampler2D a, vec2 coord, int lod)\n{\n    ivec2 texSize = textureSize(a, lod);\n    vec2 coord1 = coord * vec2(texSize);\n    vec2 coord0 = floor(coord1);\n    \n    vec4 c0 = texelFetch(a, ivec2(coord0), lod);\n    vec4 c1 = texelFetch(a, ivec2(coord0.x + 1.0, coord0.y), lod);\n    vec4 c2 = texelFetch(a, ivec2(coord0.x, coord0.y + 1.0), lod);\n    vec4 c3 = texelFetch(a, ivec2(coord0.x + 1.0, coord0.y + 1.0), lod);\n    \n    float tx = fract(coord1.x);\n    float ty = fract(coord1.y);\n    vec4 c01 = c0 * (1.0 - tx) + c1 * tx;\n    vec4 c23 = c2 * (1.0 - tx) + c3 * tx;\n    \n    vec4 c0123 = c01 * (1.0 - ty) + c23 * ty;\n    \n    return c0123;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord.xy/iResolution.xy;\n    vec2 channelRes = iChannelResolution[0].xy;\n    float scalex = 8.0;\n    float scaley = 1.0;\n    float lod = log2(max(scalex * channelRes.x / iResolution.x, scaley * channelRes.y / iResolution.y));\n    \n    uv.x = uv.x * scalex;\n    uv.y = uv.y * scaley;\n    if(uv.x < 1.0 && uv.y < 1.0)\n    {\n        fragColor = texture(iChannel0, uv);\n    }\n    else if(uv.y < 1.0 && uv.x < 2.0)\n    {\n        fragColor = textureLod(iChannel0, uv, lod);\n    }\n    else if(uv.y < 1.0 && uv.x < 3.0)\n    {\n        vec4 a = textureLod(iChannel0, uv, floor(lod));\n        vec4 b = textureLod(iChannel0, uv, floor(lod) + 1.0);\n        float t = lod - floor(lod);\n        fragColor = a * (1.0 - t) + b * t;\n    }\n    else if(uv.y < 1.0 && uv.x < 4.0)\n    {\n        int intLod = int(lod);\n        ivec2 intUV = ivec2(mod(uv, 1.0) * vec2(textureSize(iChannel0, intLod)));\n        ivec2 intUV2 = ivec2(mod(uv, 1.0) * vec2(textureSize(iChannel0, intLod + 1)));\n        vec4 a = texelFetch(iChannel0, intUV, intLod);\n        vec4 b = texelFetch(iChannel0, intUV2, intLod + 1);\n        float t = lod - floor(lod);\n        fragColor = a * (1.0 - t) + b * t;\n    }\n    else if(uv.y < 1.0 && uv.x < 5.0)\n    {\n        int intLod = int(lod);\n        vec2 uv2 = mod(uv, 1.0);\n        vec4 a = getTexLinear(iChannel0, uv2, intLod);\n        vec4 b = getTexLinear(iChannel0, uv2, intLod + 1);\n        float t = lod - floor(lod);\n        fragColor = a * (1.0 - t) + b * t;\n    }\n    \n    else if(uv.y < 1.0 && uv.x < 6.0)\n    {\n        fragColor = textureLod(iChannel0, uv, floor(lod));\n    }\n    else if(uv.y < 1.0 && uv.x < 7.0)\n    {\n        fragColor = textureLod(iChannel0, uv, ceil(lod));\n    }\n    else if(uv.y < 1.0 && uv.x < 8.0)\n    {\n        fragColor = textureLod(iChannel0, uv, 0.0);\n    }\n}","name":"Image","description":"","type":"image"}]}