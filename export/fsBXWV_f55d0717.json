{"ver":"0.1","info":{"id":"fsBXWV","date":"1620997562","viewed":58,"name":"Fork Ball of fu kithy 500","username":"kithy","description":"Playing with displacement using textures.","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["displacement","texture","fur","uvanim"],"hasliked":0,"parentid":"WslGWH","parentname":"Ball of fuzz"},"renderpass":[{"inputs":[{"id":"XdXGzn","filepath":"/media/a/3083c722c0c738cad0f468383167a0d246f91af2bfa373e9c5c094fb8c8413e0.png","previewfilepath":"/media/ap/3083c722c0c738cad0f468383167a0d246f91af2bfa373e9c5c094fb8c8413e0.png","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define MAX_DIST 30.0\n#define MIN_DIST 0.000001\n\nfloat SphereDf(vec3 p,vec3 spherePos,float radius,out vec3 color){\n\tvec2 uv=vec2(p.x+iTime*0.2,p.y);\n\tvec3 displacement=vec3(texture(iChannel0,uv));\n\n\tcolor=texture(iChannel0,uv).xyz;\n\n\tfloat dist=length(spherePos+p)-radius;\n\tdist+=dot(displacement,displacement)*2.0;\n\treturn dist;\n}\n\nfloat sceneDf(vec3 p,out vec3 color){\n\tvec3 spherePosition=vec3(0.0);\n    \n    float t=(0.5*fract(iTime*0.5))*10.0-0.5;\n\tfloat dist=SphereDf(p,spherePosition,t,color);\n\treturn dist;\n}\n\nvec3 calcNormal(vec3 p){\n\tfloat e=0.3;\n\tvec3 normal;\n\tvec3 i;\n\tnormal.x=sceneDf(vec3(p.x+e,p.y,p.z),i)-sceneDf(vec3(p.x-e,p.y,p.z),i);\n\tnormal.y=sceneDf(vec3(p.x,p.y+e,p.z),i)-sceneDf(vec3(p.x,p.y-e,p.z),i);\n\tnormal.z=sceneDf(vec3(p.x,p.y,p.z+e),i)-sceneDf(vec3(p.x,p.y,p.z-e),i);\n\n\treturn normalize(normal);\n}\n\nvec3 processLightning(vec3 baseColor,vec3 eyePos,vec3 surfacePoint){\n\tvec3 diffuseDir=normalize(vec3(-1.0,0.0,-1.0));\n\n\tvec3 normal=calcNormal(surfacePoint);\n\tfloat diffDot=max(dot(-diffuseDir,normal),0.0);\n\treturn 0.1+vec3(diffDot)*baseColor;\n}\n\nvec3 marchRay(vec3 eyePos,vec3 dir){\n\tvec3 color=vec3(0.0);\n\tvec3 currentPoint=eyePos;\n\twhile(length(currentPoint)<MAX_DIST){\n\t\tfloat intensity;\n\t\tvec3 sceneCol;\n\t\tfloat dist=sceneDf(currentPoint,sceneCol);\n\t\tif(dist<=MIN_DIST){\n\t\t\tcolor=processLightning(sceneCol,eyePos,currentPoint);\n\t\t\tbreak;\n\t\t}\n\t\tcurrentPoint+=(dist*dir);\n\t}\n\treturn color;\n}\n\nvoid mainImage(out vec4 fragColor,in vec2 fragCoord){\n\tvec3 eye=vec3(0.0,0.0,6.0);\n\tvec3 lookat=vec3(0.0);\n\tvec3 forward=normalize(lookat-eye);\n\tvec3 right=normalize(cross(forward,vec3(0.0,1.0,0.0)));\n\tvec3 up=normalize(cross(right,forward));\n\n\tvec2 p=(-iResolution.xy+2.0*fragCoord)/iResolution.y;\n\tvec3 dir=normalize(p.x*right+p.y*up+2.5*forward);\n\tvec3 color=marchRay(eye,dir);\n\n\tfragColor=vec4(color,1.0);\n}\n","name":"Image","description":"","type":"image"}]}