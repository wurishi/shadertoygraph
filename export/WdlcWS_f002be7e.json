{"ver":"0.1","info":{"id":"WdlcWS","date":"1585481100","viewed":96,"name":"bukVShkv","username":"Kapsy","description":"Demo or Die!","likes":5,"published":1,"flags":0,"usePreview":0,"tags":["kapsy"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dfGzn","filepath":"/media/a/ec8a6ea755d34600547a5353f21f0a453f9f55ff95514383b2d80b8d71283eda.mp3","previewfilepath":"/media/ap/ec8a6ea755d34600547a5353f21f0a453f9f55ff95514383b2d80b8d71283eda.mp3","type":"music","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// Fork of \"Bukvshkv\" by Kapsy. https://shadertoy.com/view/wdXcDB\n// 2020-03-29 10:17:14\n\n#define PI 3.145926\nvec2 mainSound( in int samp, float time ){\n    float s = sin(2.0*PI*0.180*time);\n    return vec2(s);\n}\n\n#define fGlobalTime iTime\nfloat a1 = 50.;  float b1 = 350.;\n\nmat2 rot(float a){return mat2(cos(a),sin(a),-sin(a),cos(a));}\nfloat aaa;\nfloat caps(vec3 p, float h, float r,float fft){\n  p.y-=clamp(p.y,0.0,h);  \n  aaa = length(p)+(fft-r);\n  return aaa;\n  }\nfloat smin(float a, float b, float h){\n    float k = clamp((a-b)/h*0.5+0.5,0.,1.);\n    return mix(a,b,k)-k*(1.-k)*h;\n  }\n\nvec3 smin(vec3 a, vec3 b, float h){\n    vec3 k = clamp((a-b)/h*0.5+0.5,0.,1.);\n    return mix(a,b,k)-k*(1.-k)*h;\n  }\n\nvec2 moda(vec2 p, float per){\n  float a = atan(p.y,p.x);\n  float l = length(p);\n  a = mod(a-per*0.5,per)-per*0.5;\n  return vec2(cos(a),sin(a))*l;\n  }  \n\n  \nfloat xxx2;\n\n float SDF(vec3 p,float fft){\n   \n      p.yx*=rot(fGlobalTime);\n      p.xz*=rot(fGlobalTime);\n      p.zy*=rot(fGlobalTime);\n      vec3 pp =p;\n  \n       float a = caps(p+vec3(0.,1.,0.),1.150,2.3,fft);\n       p.yz=moda(p.yz,0.5);\n       float b = caps(p+vec3(0.,1.,0.),4.150,0.4,fft);\n       float c = caps(p+vec3(0.,1.,0.),1.150,2.39,fft);\n       p.yz=moda(p.yz,0.5);\n       float d = caps(p+vec3(0.,1.,0.),4.150,0.49,fft);\n   \n      float xxx = smin(a,b,1.3);\n      xxx2 = smin(c,d,1.3);\n      return xxx2;\n }\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord/iResolution.xy;\n    vec2 uvm = uv;\n  vec2 uv2 = uv;\n  vec2 back= fract(uv*2.);\n  \n    \n    uv -= 0.5;\n  uv /= vec2(iResolution.y / iResolution.x, 1);\n  uv*=7.;  \n    \n\t\n    float fft  = texelFetch( iChannel0, ivec2(float(uvm),1), 0 ).r*0.4;\n  vec3 rao = vec3(0.001,0.001,-3.7); vec3 p = rao; vec3 rad=normalize(vec3(-uv,1.));\n  vec3 col = vec3(0.1);\n  float dd = 0.;\n  bool chk = false;\n  for(int i=0; i<50;i++){\n    float d = SDF(p,fft);\n    if(d<0.001) {break;}\n    if(dd>100.) {dd=100.; break;}\n    p+=d*rad;\n    dd+=d;\n  }  \nvec2 eps = vec2(0.001,0.0);  \nvec3 no = normalize(SDF(p,fft)-vec3(SDF(p-eps.xyy,fft),SDF(p-eps.yxy,fft),SDF(p-eps.yyx,fft)));\nvec3 li = normalize(-vec3(1.,7.,5.));\nvec3 h = normalize(vec3(li-rad));  \n  float def = 1.-clamp(dd/100.,0.,1.);\n  float ofs = 10.; float ofs2 = 30.;\n    vec3 col2;\n    if(xxx2<=5.5) col2 = vec3(1.,0,0);\n    col+=dot(no,li)*def*mix(1.-col*exp(col/1.),vec3(0.1,1.4,0.),vec3(1.,0.,1.5))+(pow(max(0.,dot(no,h)),ofs)*pow(max(0.,dot(no,h)),ofs2));\n    if((fft>0.340 && uv.y > 3.3)) col=vec3(1.);\n    if((fft>0.340 && uv.y < -3.3)) col=vec3(1.);\n    else col-= mix(vec3(1.,0.,0.),vec3(uv/20.,0.),mainSound( in int samp,iTime).x);  \n    \n    fragColor = vec4(pow(max(col2,col),vec3(0.75)),1.);\n  \n  \n}","name":"Image","description":"","type":"image"}]}