{"ver":"0.1","info":{"id":"3sc3z8","date":"1567713005","viewed":176,"name":"Barrel Distort","username":"96logda","description":"My first barrel distortion shader.","likes":1,"published":1,"flags":0,"usePreview":0,"tags":["noise","fbm","distortion","distort","barrel"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGRn","filepath":"/media/a/10eb4fe0ac8a7dc348a2cc282ca5df1759ab8bf680117e4047728100969e7b43.jpg","previewfilepath":"/media/ap/10eb4fe0ac8a7dc348a2cc282ca5df1759ab8bf680117e4047728100969e7b43.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4df3Rr","filepath":"/media/a/3871e838723dd6b166e490664eead8ec60aedd6b8d95bc8e2fe3f882f0fd90f0.jpg","previewfilepath":"/media/ap/3871e838723dd6b166e490664eead8ec60aedd6b8d95bc8e2fe3f882f0fd90f0.jpg","type":"texture","channel":1,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"//Copyright (c) 2019-09-05 by Angelo Logahd\n//Portfolio: https://angelologahd.wixsite.com/portfolio\n\nconst float BARREL_POWER = 3.0;\n\n#define IMAGE_1\t\t0\n#define IMAGE_2\t\t1\n\n#define IMAGE_TYPE IMAGE_2\n\nfloat hash(vec2 p)\n{\t\n    return fract(sin(dot(p, vec2(12.9898,78.233))) * 43758.5453123);\n}\n\nfloat noise (in vec2 p) \n{\n    vec2 i = floor(p);\n    vec2 f = fract(p);\n    vec2 sf = f * f * (3.0 - 2.0 * f);\n    \n    float a = hash(i);\n    float b = hash(i + vec2(1.0, 0.0));\n    float c = hash(i + vec2(0.0, 1.0));\n    float d = hash(i + vec2(1.0, 1.0));\n    \n    return mix(mix(a, b, sf.x), mix(c, d, sf.x), sf.y);\n}\n\nfloat fbm (in vec2 p)\n{\n    float f = 0.0;\n    f += 0.5000 * noise(p); p = p * 2.02;\n    f += 0.2500 * noise(p); p = p * 2.03;\n    f += 0.1250 * noise(p); p = p * 2.01;\n    f += 0.0625 * noise(p);\n    return f / 0.9375;\n}\n\nvoid distort(inout vec2 p)\n{\n    float theta = atan(p.y, p.x);\n    float radius = pow(length(p), BARREL_POWER);\n    p = radius * vec2(cos(theta), sin(theta));\n    p = (p + 1.0) * 0.5;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = 2.0 * (fragCoord.xy / iResolution.xy) - 1.0;\n    uv.x *= iResolution.x / iResolution.y;  \n    distort(uv);\n    \n\t#if   IMAGE_TYPE == IMAGE_1\n    vec3 texCol = texture(iChannel0, uv).rgb;\n    #elif IMAGE_TYPE == IMAGE_2\n    vec3 texCol = texture(iChannel1, uv).rgb;\n    #endif\n    \n    float shadow = fbm(uv * 0.1 + vec2(0.1, 0.4)) * 0.2;\n    vec3 col = shadow / texCol;\n    col *= 0.5;\n    \n    fragColor = vec4(pow(col, vec3(0.4545)), 1.0);\n}","name":"Image","description":"","type":"image"}]}