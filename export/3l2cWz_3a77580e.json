{"ver":"0.1","info":{"id":"3l2cWz","date":"1595184783","viewed":138,"name":"automata_7","username":"balkhan","description":" spacebar clear screen, define switches in Common tab","likes":7,"published":1,"flags":48,"usePreview":0,"tags":["2d","automata"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\nvoid mainImage( out vec4 o, in vec2 f )\n{\n\tvec2 u = f.xy / R.xy;\n    o.w = texture(iChannel0, u).x;\n    o.z = .0;\n    for (int k=0; o.xy=vec2(k%3,k/3)-1., k<9; k++ )\n            o.z += texture(iChannel0, (f+o.xy)/R).z/9.;\n    o.xyz =\n        sin(o.w+vec3(.0, 1., 2.)/4.+o.z*.05)\n        +fract(f.x*.5)*fract(f.y*.5)*2.-.125;\n\to = vec4(o.xyz, 1.0);\n}\n","name":"Image","description":"","type":"image"},{"inputs":[],"outputs":[],"code":"#define R iResolution.xy\n#define ZS 256000.\n\n\n#define ONE_ROTATION\n//#define LINE_ALTERNATE\n\n//#define TRIANGULAR_DISPOSITION\n\nvec3\tN8(sampler2D chan, vec2 uv, vec2 texsize)\n{\n\tvec3\tret = vec3(0.);\n    \n    if (uv.x == 0. || uv.y == 0. || uv.x== 1. || uv.y ==1.)\n        return (ret);\n    \n    ret += texture(chan, vec2(uv.x -texsize.x, uv.y) ).xyz * (.125);\n    ret += texture(chan, vec2(uv.x +texsize.x, uv.y) ).xyz * (.125);\n    ret += texture(chan, vec2(uv.x , uv.y -texsize.y) ).xyz * (.125);\n    ret += texture(chan, vec2(uv.x , uv.y +texsize.y) ).xyz * (.125);\n\n    ret += texture(chan, vec2(uv.x -texsize.x, uv.y -texsize.y) ).xyz * (.125);\n    ret += texture(chan, vec2(uv.x +texsize.x, uv.y -texsize.y) ).xyz * (.125);\n    ret += texture(chan, vec2(uv.x +texsize.x, uv.y +texsize.y) ).xyz * (.125);\n    ret += texture(chan, vec2(uv.x -texsize.x, uv.y +texsize.y) ).xyz * (.125);\n    return (ret);\n}\n","name":"Common","description":"","type":"common"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"XsXGR8","channel":0}],"code":"void mainImage( out vec4 o, in vec2 f )\n{\n\tvec2 u = f / R;\n    o = texture(iChannel0, u);\n    if (o.y == 1.)\n        o = texture(iChannel1, u);\n}\n","name":"Buffer B","description":"","type":"buffer"},{"inputs":[{"id":"4dXGRr","filepath":"/presets/tex00.jpg","previewfilepath":"/presets/tex00.jpg","type":"keyboard","channel":2,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"\nvec3\tlv0(vec2 uv)\n{\n    return N8(iChannel0, uv, 1./R).xyz;\n}\n\nvec3 lsum;\n\nvoid forward(inout vec4 o, vec2 f, in vec4 cell)\n{\n    lsum = vec3(.0);\n    vec2 cd;\n    o.x = .0;\n    int qrb = (int(mod(floor(iTime*.5), 8.)-0.)\n                      % 2\n                      ==\n                      0)?1:0;\n    int qlb = (int(mod(floor(iTime*.5/8.), 6.)-0.)\n                      % 2\n                      >\n                      0)?1:0;\n    for (int k=0; cd.yx=vec2((k)%3,((k) )/3)-1., k<9; k++ ) // switch cd.yx to cd .xy to turn 1 quarter right\n        {            \n            #ifdef ONE_ROTATION\n            if (qrb == 1)\n                cd = cd.yx;\n            #endif\n//            cd = vec2(cd.y, -cd.x); // left turn\n            #ifdef LINE_ALTERNATE\n            if( qlb == 1) // one line alternate top+right -> down+left\n            cd = vec2(-cd.y, -cd.x);\n            #endif\n        \tcd = (f+cd) /R;\n            o.x += max(texture(iChannel0, cd).x, o.x)/(9.-3.5*abs(texture(iChannel0, cd).x));\n            lsum.xz += lv0(cd.xy).xz/9.;\n        }\n    lsum.x = cell.x*.25+1.*lsum.x;\n    lsum.x /= .25+1.;\n    if (abs(lsum.x) <= .005)\n    {\n    \to.x = o.x\n            *\n            #ifndef TRIANGULAR_DISPOSITION\n            -2.\n            #else\n            2.\n            #endif\n            ;\n        return ;\n    }\n    o.x = -o.x/(lsum.x+.05+-cell.x/16.);\n}\n\nvoid mainImage( out vec4 o, in vec2 f )\n{\n    o -= o;\n    vec2 u = f / R;\n    vec4 r = texture(iChannel0, u);\n    r.y += (iFrame == 0 ? 1. : 0.);\n    float kb;\n    kb = texture(iChannel2, vec2(32.5/256., 0.25)).x;\n    if (kb > .5 ) // spacebar pressed\n    {\n        o.xyz = vec3(.0, 1.,.0); // clear screen\n        return;\n    }\n    vec2 rru = u-.5;\n\trru += .125*vec2( (mod(floor(iTime*.5), 8.)-4.)  , (mod(floor(iTime*.5/8.), 6.)-2.75));\n    rru = abs(rru*R);\n    float s = \n        #ifndef TRIANGULAR_DISPOSITION\n\t\t(\n         step(max( (rru.x), (rru.y)), 20. )\n         *\n         step(6., max( (rru.x), (rru.y)))\n        );\n    \t#else\n\t    step(max( (rru.x), (rru.y)), 4. );\n\t    #endif\n\n    float g = .1;\n\n    forward(o, f, r);\n\n    float e = (s > 0.0 ? 1.0 : 0.0);\n    e *= step(abs(u.y-0.5), .46)*step(abs(u.x-0.5), .46);\n    float b = (max(abs(u.x-.5)-.0, abs(u.y-.5))-.45);    \n\tif ( e == 1.)\n        o.x  = g;\n    o.z = clamp(-r.z+.00000125*o.x , -ZS , +ZS);\n    o.x = clamp(o.x, -2.50, +2.50);\n    if\t(\n\t\tb < .0150 && b > .010\n\t\t)\n\t\to = vec4(r.y, 0., ZS*r.y, 1.);\n\to.y = -r.y;\n}\n","name":"Buffer A","description":"","type":"buffer"}]}