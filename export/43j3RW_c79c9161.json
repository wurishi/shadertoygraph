{"ver":"0.1","info":{"id":"43j3RW","date":"1708262067","viewed":168,"name":"truchet zoo","username":"lijiyong","description":"child style truchet ground with animal and fur sys,\nthanks for watching and hope you will like this truchet style.","likes":7,"published":1,"flags":0,"usePreview":0,"tags":["fur","animal","truchets"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"/*\n    Truchet zoo\n    by LJY studio presets.\n    Copyright ( c ) 2024 LJY ST.\n    \n    child style truchet ground with animal and fur sys,\n    thanks for watching and hope you will like this truchet style.\n*/\n\n#define I iResolution\n#define T2  iTime * .1\n#define A min( I.x, I.y )\n#define PI 3.1415926\n#define rot( r ) mat2(cos(r), sin(r), -sin(r), cos(r) )\n#define v( a ) clamp( a, 0., 1. )\n#define h(u) fract(dot( floor(u.yxx * 2.45), sin(u.xyy+vec3(1,2,3)) / 4.5 ) )\n#define k( p ) min( min( abs(p-.02), abs(p+.02) ), abs(p) )\n\n#define w( a, b ) a + cos( b * 3. ) / 3.\n#define T iTime * 3.\n\n#define BLUR 5.\n\nfloat FUR;\n\nfloat H( vec2 u ){\n    u = vec2( w( u.x, u.y ), w( u.y, u.x ) );\n    \n    float x = round( u.x / .5 );\n    \n    u -= x - T * .4;\n    \n    u -= .5 * round( u / .5 );\n    \n    u = abs( u );\n    \n    return max(\n        u.x,\n        u.y\n    );\n}\n\nfloat smin (float a, float b, float r)\n{\n    float h = clamp(.5+.5*(b-a)/r,0.,1.);\n    return mix(b, a, h) - r*h*(1.-h);\n}\n\nfloat smax(float a, float b, float k) {\n    return -smin(-a, -b, k);\n}\n\nfloat tex( vec2 u, float s ){\n\n    vec2 t = round(u / -s);\n\n    float r = round( h( ( t * 5. ) ) );\n\n    u -= s * round( u / s ); // hp mod\n\n    if( r > 0. )\n      u.x *= -1.;\n\n    // if( abs(u.x + u.y) < .15 )\n      u += s * ( ( u.x + u.y > 0. ) ? -.5 : .5 );\n    \n    return (length(u) - s * .5) * ( r != mod( t.x + t.y, 2. ) ? 1. : -1. );\n\n}\n\nfloat f( vec3 p ){\n    \n    p.xy = abs( p.xy );\n    \n    return smax(\n        p.x + p.y - .2,\n        abs( p.z ) - .05,\n        .005\n    );\n}\n\nfloat top, bottom;\n\nvec2 aa, bb;\n\nfloat up( vec3 p ){\n    \n\n    vec2 t = round( p.xy / -.4 );\n    \n    p.xy -= .4 * round( p.xy / .4 );\n    \n    aa = t;\n    \n    p.z += cos( t.x / 6.28 ) * .1;\n    p.z += cos( t.y / 6.28 ) * .15;\n    \n    return f( p );\n}\n\nfloat down( vec3 p ){\n    \n    p.xy += .2;\n    \n    vec2 t = round( p.xy / .4 );\n\n    \n    bb = t;\n    \n    p.xy -= .4 * round( p.xy / .4 );\n    p.z += cos( t.x / 6.28 ) * .1;\n    p.z += cos( t.y / 6.28 ) * .15;\n\n\n    return f( p );\n}\n\nfloat df( vec3 p ){\n    return min(\n        min(\n            top = up( p ),\n            bottom = down( p )\n        ),\n        -( p.z - .3 )\n    );\n}\n\nfloat body( vec3 p ){\n\n    p.x += .25 * pow(p.y, 2.) + .125 * -p.x - .1 * ( p.y / 2. + .5 );\n    \n    return length( p * vec3( 1., 1.99 * ( p.y / 2. + .45 ), 1.25 ) ) - .6;\n}\n\nfloat mouth( vec3 p ){\n    p += vec3(-.7, -.5, 0.);\n    return length( p ) - .1;\n}\n\nfloat ear( vec3 p ){\n\n    p.x -= .1;\n    p.y -= .6;\n    \n    p.z = abs( p.z ) - .3;\n    \n    return length( p ) - .1;\n}\n\nfloat ears( vec3 p ){\n\n    p.xz *= rot( PI * .5 + cos(iTime) * .07 );\n    p.xy *= rot( PI * -.2 );\n\n    p.x += cos( T * 2. ) * .2;\n    p.z += .3;\n    float z = round( p.z / .6 );\n    p.y -= z == 0. ? .6 : .65;\n    p.z -= .6 * clamp( round( p.z / .6 ), 0., 1. );\n    \n    return length( p * vec3( 1., .5, 1. ) ) - .2;\n}\n\nfloat head( vec3 p ){\n\n    p.x += cos( T * 2. ) * .2;\n    return smin(\n        smin(\n            length( p - vec3(.1,.3,0.) ) - .55,\n            mouth(p),\n            .3\n        ),\n        ear( p ),\n        .3\n    );\n}\n\nfloat tail( vec3 p ){\n    \n    p.x += 1.5;\n    p.y += 1.2;\n    \n    p.xy *= rot( PI * -.5 );\n    \n    p.x += -.25 * pow(p.y, 1.) + .125 * -p.x + .7 * cos(T) * ( 1. - ( p.y / 2. + .5 ) );\n    \n    p.yz *= rot( cos(T*.5) * .5 );\n    \n    return length( p * vec3( 1., .4, 1. ) ) - .3;\n}\n\n\nfloat fur( vec3 p ){\n    p.xz *= rot( PI * .5 + cos(iTime) * .07 );\n    p.xy *= rot( PI * -.2 );\n    // p.z -= .9;\n    \n     p.x -= ( .25 * pow(p.y, 2.) + .125 * -p.x + .4 * cos(T) * ( 1. - ( p.y / 2. + .5 ) ) ) * .5;\n    \n    return smin(\n        smin(\n            body( p ),\n            head( p ),\n            .1\n        ),\n        tail( p ),\n        .5\n    \n    );\n}\n\nfloat map( vec3 p ){\n    return min(\n        FUR = fur(p),\n        ears(p)\n    );\n}\n\nvec3 l2(in vec3 b) {\n  vec2 a = vec2(1, -1) * .5773;\n  return normalize(a.xyy * map(b + a.xyy * 5e-4) + a.yyx * map(b + a.yyx * 5e-4) +\n                   a.yxy * map(b + a.yxy * 5e-4) + a.xxx * map(b + a.xxx * 5e-4));\n}\n\nvec3 l(in vec3 b) {\n  vec2 a = vec2(1, -1) * .5773;\n  return normalize(a.xyy * df(b + a.xyy * 5e-4) + a.yyx * df(b + a.yyx * 5e-4) +\n                   a.yxy * df(b + a.yxy * 5e-4) + a.xxx * df(b + a.xxx * 5e-4));\n}\n\nfloat L( vec3 p, vec3 ca, vec3 r, float q ){\n    return v( pow( dot( l( p ), normalize( normalize( ca ) - r ) ), q ) );\n}\n\nvoid colors( inout vec3 c, vec2 t ){\n    \n    float r = h( (t + 5. ) );\n    \n    vec3 q;\n    \n    if( r > -.0 && r < .25 )\n        q = vec3(.003,.98,.027);\n\n    if( r > .25 && r < .5 )\n        q = vec3(0.990,0.979,0.0);\n        \n    if( r > .5 && r < .75 )\n        q = vec3(0.010,0.692,0.990);\n        \n    if( r > .75 && r < 1. )\n        q = vec3(0.910,0.414,0.804);\n\n    c = mix(\n        c,\n        q,\n        v( c.x * 3. ) * 0.35\n    );\n    \n    c = v(c);\n}\n\nfloat addTex( vec3 p, int t ){\n    vec3 n = l( p );\n    \n    return t > 1 ? \n    smoothstep( 2. / A, -2. / A, tex( (p.xy) * 10., 1. ) ) * max( -n.z, 0. ) * .2 :\n    smoothstep( 2. / A, -2. / A, abs( tex( (p.xy) * 10., 1. ) + .05 ) - .05 ) * max( -n.z, 0. ) * .5;\n}\n\n\nvec2 figure8( float t ){\n    // https://gamedev.stackexchange.com/questions/43691/how-can-i-move-an-object-in-an-infinity-or-figure-8-trajectory\n    // credit ladus's  11. Wander\n    // https://www.shadertoy.com/view/dsdfWn\n    float scale = 2. / (3. - cos(2.*t));\n    float x = scale * cos(t),\n          y = scale * sin(2.*t) / 2.;\n    return vec2(x, y);\n}\n\nvec3 trace( vec2 u ){\n    vec3 c, p, o = vec3( 0., 0., -1. ), r = vec3( u, 1. );\n    float t, d, i;\n    for( ; i < 50.; i++ ){\n        p = o + r * t,\n        p.yz *= rot( PI * .15 ),\n        p.y += T2 - ( sin( iTime * 3. ) * .05 ),\n        d = df( p ),\n        t += d * .4445;\n        \n        if( t <.225 && d < 1e-3 )\n            break ;\n    }\n\n    \n    if( d < 1e-3 ){\n\n        vec3 lg = vec3( -.1, .5, -1. );\n        lg.x += figure8( iTime * .6 ).x * 1.2;\n        lg.y += figure8( iTime * .6 ).y * 1.5;\n        float dd = v( dot( l( p ), lg ) );\n        \n        c += L( p, lg, r, 15. ) * dd * vec3(.01,0.765,0.995) * .2;\n\n        lg = vec3( .2, .2, -1. );\n        lg.x += figure8( iTime * .4 ).x * 1.2;\n        lg.y += figure8( iTime * .4 ).y * 1.5;\n        dd = v( dot( l( p ), lg ) );\n        c += L( p, lg, r, 10. ) * dd * vec3(.96,0.401,0.768) * .2;\n       \n        lg = vec3( -.2, -.5, -1. );\n        lg.x += figure8( iTime * .3 ).x * 1.2;\n        lg.y += figure8( iTime * .3 ).y * 1.5;\n        dd = v( dot( l( p ), lg ) );\n        c += L( p, lg, r, 20. ) * dd * vec3(.753,.96,0.006) * .2;\n        \n        \n        lg = vec3( 0., .5, -1. );\n        dd = v( dot( l( p ), lg ) );\n        c += L( p, lg, r, 10. ) * dd * .5;\n        \n        if( df( p ) == top ){\n            if( h( (aa + 5.) ) < .9 ){\n                c += addTex( p, 2 );\n            }else{\n                c += addTex( p, 1 );\n            }\n            \n            colors( c, aa + 5. );\n        }\n        \n        if( df( p ) == bottom ){\n            if( h( (bb-5.) ) < .1 ){\n                c += addTex( p, 2 );\n            }else{\n                c += addTex( p, 1 );\n            }\n            \n            colors( c, bb - 10. );\n        }\n        \n        \n        p = vec3( 0 );\n        i = 0.,\n        d = 0.,\n        t = 0.;\n\n        for( ; i < 8.; i++ )\n            p = o + r * t,\n            p.xy += tex(p.xy, .5) * .3,\n            p.x += .01,\n            p.y *= -1.,\n            p.y -= .35,\n            p.y -= cos( T ) * .2,\n            p.z -= cos( T ) * .3,\n            d = length( p * vec3( 1., .4, 1. ) ) - .1,\n            t += d;\n            \n        if( d < 1e-3 ){\n            c -= .1;\n        }\n       \n        \n    }\n    \n    return c;\n}\n\nvec3 animal( vec2 u ){\n    float d, t, i;\n    vec2 s;\n    vec3 c, p, o = vec3( 0, 0, -3. ), r = vec3( u, 1 );\n\n    for( ; i < 90.; i++ ){\n        p = o + r * t,\n        p.zy *= rot( cos(T) * -.2 ),\n        p.y -= .2,\n        p.y += cos( T ) * .5,\n        p.z += cos( T ) * .3,\n        d = map(p),\n        s = ( p.xy + d * vec2( cos(T*5.) * .3, cos(T*3.) * 1.2 ) ) * 13.,\n        t += map( p ) != FUR ? d : (d + H(s) * .8 ) * .334;\n        \n        if( t < .14 && d < 1e-3 )\n            break ;\n    }\n\n    if( d < 1e-3 ){\n        c += vec3(.57, .47, .23) + dot( l2(p), vec3( -.1, .5, .8 ) ) * .2 + H(s) * .1 +\n        (\n        map( p ) == FUR ? \n        (smoothstep( .5 / A, -.5 / A, tex( l2(p).xy, .5 ) ) * .05) : 0.\n        );\n    }\n\n    return v( c );\n}\n\n\nvoid mainImage( out vec4 U, in vec2 V )\n{\n    vec2 u = ( V * 2. - I.xy ) / A;\n    \n    vec3 c, an = animal( u );\n\n    for( float i = 0.; i < 1.; i+=.5 )\n        for( float j = 0.; j < 1.; j+=.5 )\n            c += trace( ( (V + vec2(i, j * \n            #ifdef BLUR\n            sin( iTime * 1.5 ) * BLUR\n            #else\n            1.\n            #endif\n            )) * 2. - I.xy ) / A ) * .25;\n    \n    \n    c = mix(\n        c,\n        an,\n        v( an.r * 9. )\n    );\n    \n    c = mix(\n        c,\n        vec3(0.),\n        smoothstep( 0., .4, length( u * vec2( .5, 1. ) + vec2(0., .6 ) ) - 1.2 )\n    );\n\n    \n    U = vec4( c, 1. );\n}","name":"Image","description":"","type":"image"}]}