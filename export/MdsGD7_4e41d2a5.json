{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[],"code":"float cube(vec3 pos)\n{\n\treturn length(max(abs(pos) - vec3(17.0) - vec3(3.), 1.));\n}\n\nfloat map(vec3 pos)\n{\n\treturn cube(mod(pos - vec3(-5.0, 0.0, -(iTime + .1) * 50.0), 50.0) - vec3(25.0));\n}\n\nvec3 traceRay(vec3 pos, vec3 dir)\n{\n   for (int i = 0; i < 40; i++)\n   {\n       float distance = map(pos);\n       pos += 0.9 * distance * dir;\n   }\n\t\n   return pos;\n}\n\nvec3 calcNormal(vec3 pos)\n{\n    float eps = 0.01;\n\t\n    return normalize(vec3(\n\t\tmap(vec3(pos.x + eps, pos.y, pos.z)) - map(vec3(pos.x - eps, pos.y, pos.z)),\n    \tmap(vec3(pos.x, pos.y + eps, pos.z)) - map(vec3(pos.x, pos.y - eps, pos.z)),\n    \tmap(vec3(pos.x, pos.y, pos.z + eps)) - map(vec3(pos.x, pos.y, pos.z - eps))\n\t));\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 uv = fragCoord.xy / iResolution.xy;\n\t\n\tvec3 pos = vec3(20., 23., 0.);\n\tvec3 dir = normalize(vec3(\n\t\t(fragCoord.x - iResolution.x * 0.5) / iResolution.y, fragCoord.y / iResolution.y - 0.5,\n\t\t//cos(iTime) * 1.5));\n\t\t.8));\n\tvec3 color = vec3(.5, .9, .9);\n    vec3 point = traceRay(pos, dir);\n    vec3 normal = calcNormal(point);\n\t\n\tfloat fogFactor = 1.0 - (1.0 / exp(point.z * 0.0005));\n    float diffuse = max(dot(normal, vec3(.9, .9, .9)), 0.0);\n\t\n    color = mix(color * diffuse, vec3(1.), fogFactor);\n\tcolor = mix(vec3(.2 + .05 * sin(iTime), .25, .0), color, color);\n\t//color = mix(vec3(.4, .4, .7), color, color);\n\t\n\tfragColor = vec4(color,1.0);\n}","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"MdsGD7","date":"1372494205","viewed":194,"name":"Bass","username":"Did","description":"A raymarching pushed a bit too far","likes":0,"published":1,"flags":0,"usePreview":0,"tags":["raymarching"],"hasliked":0,"parentid":"","parentname":""}}