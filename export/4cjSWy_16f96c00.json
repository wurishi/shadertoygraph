{"ver":"0.1","info":{"id":"4cjSWy","date":"1732844325","viewed":44,"name":"Smiley learn","username":"lazyfish","description":"beginner","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["beginner"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define s(a,b,t) smoothstep(a,b,t)\n#define sat(x) clamp(x,0.,1.)\nfloat remap01(float a,float b,float t)\n{\n    return sat((t-a)/(b-a));\n}\nfloat remap(float a,float b,float c,float d,float t)\n{\n    return sat((t-a)/(b-a))*(d-c)+c;\n}\nvec2 within(vec2 uv,vec4 rect)\n{\n    return (uv -rect.xy)/(rect.zw - rect.xy);\n}\nvec4 Eye(vec2 uv)\n{\n    uv -= .5;\n    float d = length(uv);\n    //基础色\n    vec4 irisCol = vec4(.3,.4,1.,1.);\n    //眼白\n    vec4 col = mix(vec4(1.),irisCol,s(.1,.7,d)*0.5);\n    col.rgb *= 1.-s(.45,.5,d)*.5*sat(-uv.y-uv.x);\n    //瞳孔外描边\n    col.rgb = mix(col.rgb,vec3(0.),s(.3,.28,d));\n    \n    //瞳孔外侧\n    irisCol.rgb *= 1. + s(.3,.05,d);\n    col.rgb = mix(col.rgb,irisCol.rgb,s(.28,.25,d));\n    //瞳孔内侧\n    col.rgb = mix(col.rgb,vec3(0.),s(.16,.14,d));\n\n    //高光\n    float highlight = s(.1,.09,length(uv-vec2(-.15,.15)));\n    highlight +=s(.07,.05,length(uv+vec2(-.08,.08)));\n    col.rgb = mix(col.rgb,vec3(1.),highlight);\n    col.a = s(.5,.48,d);\n    return col;\n}\nvec4 Mouth(vec2 uv)\n{\n    uv -= .5;\n    vec4 col = vec4(.5,.18,.05,1.);\n    uv.y*=1.5;\n    uv.y -= uv.x*uv.x*2.;\n    float d = length(uv);\n    col.a = s(.5,.48,d);\n    float td = length(uv - vec2(.0,.6));\n    vec3 toothCol = vec3(1.)*s(.6,.35,d);\n    col.rgb = mix(col.rgb,toothCol,s(.4,.37,td));\n    \n    td = length(uv + vec2(.0,.5));\n    col.rgb = mix(col.rgb,vec3(1.,.5,.5),s(.5,.2,td));\n    return col;\n}\nvec4 Head(vec2 uv)\n{\n    vec4 col = vec4(.9,.65,.1,1.);\n    //取得圆形区域\n    float d = length(uv);\n    //半径为0.5，平滑0.1\n    col.a = s(.5,.49,d);\n    //阴影部分为.35到.5\n    float edgeShadow = remap01(.35,.5,d);\n    //平滑阴影\n    edgeShadow *= edgeShadow;\n    col.rgb *= 1.-edgeShadow*.5;\n    col.rgb = mix(col.rgb,vec3(.6,.3,.1),s(.47,.48,d));\n    //设置高光，高光位置.41,模糊值.005\n    float highlight = s(.41,.405,d);\n    highlight *= remap(.41,-.1,.75,.0,uv.y);\n    col.rgb = mix(col.rgb,vec3(1.),highlight);\n    \n    d = length(uv-vec2(.25,-.2));\n    float cheek = s(.2,.01,d)*.4;\n    cheek *=s(.18,.16,d);\n    col.rgb = mix(col.rgb,vec3(1.,.1,.1),cheek);\n    d = length(uv-vec2(-.25,-.2));\n    float cheek2 = s(.2,.01,d)*.4;\n    cheek2 *=s(.18,.16,d);\n    col.rgb = mix(col.rgb,vec3(1.,.1,.1),cheek2);\n    return col;\n}\nvec4 Smiley(vec2 uv)\n{\n    vec4 col = vec4(0.);\n    vec4 head = Head(uv);\n    vec4 mouth = Mouth(within(uv,vec4(-.3,-.4,.3,-.1)));\n    vec4 rightEye = Eye(within(uv,vec4(.03,-.1,.37,.25)));\n    vec4 LeftEye = Eye(within(uv,vec4(-.03,-.1,-.37,.25)));\n    //uv.x = abs(uv.x);\n    col = mix(col,head,head.a);\n    col = mix(col,rightEye,rightEye.a);\n    col = mix(col,LeftEye,LeftEye.a);\n    col = mix(col,mouth,mouth.a);\n    return col;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    //计算UV\n    vec2 uv = fragCoord/iResolution.xy;\n    //将原点重新映射到屏幕中心\n    uv-=.5;\n    //修正屏幕拉伸\n    uv.x *= iResolution.x/iResolution.y;\n    fragColor = Smiley(uv);\n}","name":"Image","description":"","type":"image"}]}