{"ver":"0.1","info":{"id":"MdjBW1","date":"1500332668","viewed":206,"name":"Blooming Flower","username":"Homaniac","description":"First shader where I really focused on composition and color scheme. I love the result.","likes":3,"published":1,"flags":0,"usePreview":0,"tags":["2d","fbm","composition"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define PI 3.141592654\n\nfloat random(vec2 st) {\n  return fract(\n      sin(\n          dot(st.xy,vec2(12.9898, 78.233))\n          ) * 43758.5453123);\n}\n\nfloat noise(vec2 st) {\n  vec2 i = floor(st);\n  vec2 f = fract(st);\n\n  float ll_corner = random(i);\n  float lr_corner = random(i + vec2(1.0,0.0));\n  float ul_corner = random(i + vec2(0.0,1.0));\n  float ur_corner = random(i + vec2(1.0,1.0));\n\n  vec2 u = smoothstep(0.0, 1.0, f);\n\n  return mix(ll_corner, lr_corner, u.x) +\n      (ul_corner - ll_corner)*u.y*(1.0 - u.x) +\n      (ur_corner - lr_corner)*u.x*u.y;\n}\n\nfloat fbm(vec2 st) {\n  float val = 0.0;\n  float amp = 1.0;\n  val += noise(st); st *= 2.0;\n  val += 0.5000*noise(st); st *= 2.0;\n  val += 0.2500*noise(st); st *= 2.0;\n  val += 0.1250*noise(st); st *= 2.0;\n  val += 0.0625*noise(st); st *= 2.0;\n\n  return val / 0.9375;\n}\n\nfloat fbmWarp2(in vec2 st, out vec2 q, out vec2 r) {\n  q.x = fbm(st);\n  q.y = fbm(st + vec2(4.7, 1.5));\n\n  r.x = fbm(st + 4.0*q + vec2(1.4, 9.1));\n  r.y = fbm(st + 4.0*q + vec2(8.7, 2.9));\n  return fbm(q + st);\n}\n\nvec3 hsb2rgb( in vec3 c ){\n  vec3 rgb = clamp(abs(mod(c.x*6.0+vec3(0.0,4.0,2.0),\n                           6.0)-3.0)-1.0,\n                   0.0,\n                   1.0 );\n  rgb = rgb*rgb*(3.0-2.0*rgb);\n  return c.z * mix(vec3(1.0), rgb, c.y);\n}\n\nvec3 hsb2rgb(float h, float s, float b) {\n  return hsb2rgb(vec3(h,s,b));\n}\n\nfloat uSin(float x) {\n  return 0.5*sin(x) + 0.5;\n}\n\nfloat uCos(float x) {\n  return 0.5*cos(x) + 0.5;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n  vec2 st = fragCoord.xy / iResolution.xy;\n  st = 2.0*st - 1.0;\n  st.x *= iResolution.x / iResolution.y;\n\n  vec3 color = vec3(0.0);\n\n  float a = atan(st.y, st.x);\n  float rad = length(st);\n\n  float ss = 0.5 + 0.5*sin(3.0*iTime);\n  float anim = 1.0 + 0.4*ss*(1.0 - rad);\n  rad *= anim;\n\n  a += 0.15*sin(fbm(10.0*st)) + 0.97;\n\n  float flowerR = 0.35 + 0.28*sin(8.0*a);\n  float flowerR2 = 0.35 + 0.28*sin(8.0*a);\n  float petalR = 0.35 + 0.28*sin(8.0*a + PI);\n  float petalR2 = 0.35 + 0.28*sin(8.0*a + PI);\n  flowerR2 += 0.2*sin(fbm(10.0*st + vec2(0.4,3.7)));\n  petalR2 += 0.2*sin(fbm(10.0*st + vec2(0.13,7.7)));\n\n  flowerR *= uSin(2.0*iTime/5.)*anim;\n  petalR *= uSin(2.0*iTime/2.)*anim;\n\n  flowerR2 *= uCos(2.0*iTime/3.)*anim;\n  petalR2 *= uCos(2.0*iTime/7.)*anim;\n\n  if (rad <= flowerR) {\n    color = vec3(0.0);\n    flowerR = rad / flowerR;\n    vec2 q;\n    vec2 r;\n    float f = fbmWarp2(15.0*st, q, r);\n    color = mix(color, hsb2rgb(0.45,0.99,0.99), f);\n\n    f = fbm(vec2(4.0*a, 7.0*flowerR));\n    color = mix(color, hsb2rgb(0.55,0.99,0.99), f);\n\n    color = mix(color, hsb2rgb(0.95,0.7,0.2 + length(q)), smoothstep(0.0,1.3,flowerR));\n  }\n  if (rad <= petalR) {\n    petalR = rad / petalR;\n    vec2 q;\n    vec2 r;\n    float f = fbmWarp2(25.0*st, q, r);\n    color += hsb2rgb(0.65,f,0.95);\n\n    f = fbm(vec2(8.0*a, 3.0*petalR));\n    color = mix(color, hsb2rgb(0.6,0.99,0.99), f);\n\n    color = mix(color, vec3(0.9,0.8,0.3), smoothstep(0.0,1.0,petalR));\n    color = mix(color, vec3(0.9,0.6,0.7), smoothstep(0.0,1.5,flowerR));\n  }\n  if (rad <= flowerR2) {\n    color = vec3(0.0);\n    flowerR2 = rad / flowerR2;\n    vec2 q;\n    vec2 r;\n    float f = fbmWarp2(9.0*st, q, r);\n    color += hsb2rgb(0.15,f,0.95);\n\n    a += 0.15*sin(f);\n    f = fbm(vec2(8.0*a, 9.0*flowerR2));\n    color = mix(color, hsb2rgb(0.0,0.99,0.99), f);\n\n    color = mix(color, hsb2rgb(0.8,0.9,r.x), smoothstep(0.0,1.3,petalR));\n    color = mix(color, hsb2rgb(0.1,0.9,length(q)), smoothstep(0.0,1.3,flowerR));\n    color = mix(color, hsb2rgb(0.5,0.9,f), smoothstep(0.0,1.5,flowerR2));\n  }\n  if (rad <= petalR2) {\n    petalR2 = rad / petalR2;\n    vec2 q;\n    vec2 r;\n    float f = fbmWarp2(5.0*st, q, r);\n    color += hsb2rgb(0.15,f,0.95);\n\n    a += 0.15*sin(f);\n    f = fbm(vec2(9.0*a, 3.0*petalR2));\n    color = mix(color, hsb2rgb(0.6,0.99,0.99), f);\n\n    color = mix(color, vec3(0.2,0.9,0.8), smoothstep(0.0,1.0,petalR));\n    color = mix(color, hsb2rgb(0.12,1.0,f), smoothstep(0.0,1.3,petalR2));\n    color = mix(color, vec3(0.9,0.6,r.x), smoothstep(0.0,1.5,flowerR));\n    color = mix(color, vec3(0.9,0.6,length(q)), smoothstep(0.0,1.5,flowerR2));\n  }\n\n  fragColor = vec4(color, 1.0);\n}\n","name":"Image","description":"","type":"image"}]}