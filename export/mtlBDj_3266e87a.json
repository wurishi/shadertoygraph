{"ver":"0.1","info":{"id":"mtlBDj","date":"1693642720","viewed":32,"name":"generative Bernsley's fern","username":"pik","description":"generative algorithm\n(without stem)","likes":3,"published":1,"flags":32,"usePreview":0,"tags":["fractal","bernsleysfern"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 pix=vec2(1./iResolution.xy);\n    vec2 c=texture(iChannel0,fragCoord*pix).zw;\n    //vec3 col=vec3(0.,c.x,0.)*c.y;//monocolor\n    vec3 col=vec3(mod(c.x*1.,7.)/7.,mod(c.x*29.,5.)/5.,mod(c.x*19.,6.)/6.)*c.y;\n    col=pow(col,vec3(1./2.2));\n    fragColor=vec4(col,1.);\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"//#define Bernsley 0\n#define Bernsley2 0\n\nconst float speed=1e15;\nconst float scale=10.;\nconst float dotsize=1.;\nconst float fade=0.1;\n\nvec2 pix;\n\nfloat turn(float i){\n    return mod(i,8.);\n}\n#ifdef Bernsley\nvec2 F(vec2 Coord,float id){\n    float a,b,c,d,f;\n    mat2 A;\n    if(id<4.5){\n        a=0.85,b=0.04,c=-0.04,d=0.85,f=1.60;\n        //a=0.1,b=0.1,c=0.1,d=0.16,f=0.;\n        //return vec2(Coord.x,Coord.y/0.16);\n    }\n    else if(id<5.5){\n        a=0.85,b=0.04,c=-0.04,d=0.85,f=1.60;\n    }\n    else if(id<6.5){\n        a=0.20,b=-0.26,c=0.23,d=0.22,f=1.60;\n    }\n    else{\n        a=-0.15,b=0.28,c=0.26,d=0.24,f=0.44;\n    }\n    A=inverse(mat2(a,b,c,d));\n    return (Coord-vec2(0.,f))*A;\n}\n\nfloat rand(float y){\n    float s=fract(sin((y+iTime)*815.858)*9621.5876);\n    if(s<0.01) return 0.;\n    else if(s<0.86) return 1.;\n    else if(s<0.93) return 2.;\n    else return 3.;\n}\n#endif\n\n#ifdef Bernsley2\nvec2 F(vec2 Coord,float id){\n    float a,b,c,d,f;\n    mat2 A;\n    if(id<4.5){\n        a=0.845,b=0.035,c=-0.035,d=0.82,f=1.6;\n    }\n    else if(id<5.5){\n        a=0.845,b=0.035,c=-0.035,d=0.82,f=1.6;\n    }\n    else if(id<6.5){\n        a=0.2,b=-0.31,c=0.255,d=0.245,f=0.29;\n    }\n    else{\n        a=-0.15,b=0.24,c=0.25,d=0.2,f=0.68;\n    }\n    A=inverse(mat2(a,b,c,d));\n    return (Coord-vec2(0.,f))*A;\n}\n\nfloat rand(float y){\n    float s=fract(sin((y+iTime)*815.858)*9621.5876);\n    if(s<0.01) return 0.;\n    else if(s<0.86) return 1.;\n    else if(s<0.93) return 2.;\n    else return 3.;\n}\n#endif\n\n\nvoid trail(vec2 Coord,float id,inout vec4 T,inout int Count){\n    vec2 coloredCoord=(F(Coord*scale+vec2(-scale*0.5,0.),id)-vec2(-scale*0.5,0.))/scale;\n    vec4 _S=texture(iChannel0,coloredCoord);\n    float _Sid=turn(id+4.);\n    if(_S.x>0.){\n        if(_S.x>1.){\n            if(abs(_Sid-_S.y)<0.5){\n                T=vec4(_S.x,rand(_S.y),_S.y,1.);\n                Count++;\n            }\n        }\n    }\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    if(fragCoord.x>iResolution.x-1. || fragCoord.y>iResolution.y-1. || fragCoord.x<1. || fragCoord.y<1.)discard;\n    pix=vec2(1./iResolution.xy);\n    vec4 S=texture(iChannel0,fragCoord*pix);\n    if(S.x==0.){\n        vec4 T=S;\n        int Count=0;\n        if(dotsize<1.5){\n            trail(fragCoord*pix,4.,T,Count);\n            trail(fragCoord*pix,5.,T,Count);\n            trail(fragCoord*pix,6.,T,Count);\n            trail(fragCoord*pix,7.,T,Count);\n        }\n        \n        else if(dotsize<2.5){\n            trail((fragCoord+vec2(1.,0.))*pix,4.,T,Count);\n            trail((fragCoord+vec2(1.,0.))*pix,5.,T,Count);\n            trail((fragCoord+vec2(1.,0.))*pix,6.,T,Count);\n            trail((fragCoord+vec2(1.,0.))*pix,7.,T,Count);\n        }\n        else if(dotsize<3.5){\n            trail((fragCoord+vec2(0.,1.))*pix,4.,T,Count);\n            trail((fragCoord+vec2(0.,1.))*pix,5.,T,Count);\n            trail((fragCoord+vec2(0.,1.))*pix,6.,T,Count);\n            trail((fragCoord+vec2(0.,1.))*pix,7.,T,Count);\n        }\n        else if(dotsize<4.5){\n            trail((fragCoord+vec2(-1.,0.))*pix,4.,T,Count);\n            trail((fragCoord+vec2(-1.,0.))*pix,5.,T,Count);\n            trail((fragCoord+vec2(-1.,0.))*pix,6.,T,Count);\n            trail((fragCoord+vec2(-1.,0.))*pix,7.,T,Count);\n        }\n        else{\n            trail((fragCoord+vec2(0.,-1.))*pix,4.,T,Count);\n            trail((fragCoord+vec2(0.,-1.))*pix,5.,T,Count);\n            trail((fragCoord+vec2(0.,-1.))*pix,6.,T,Count);\n            trail((fragCoord+vec2(0.,-1.))*pix,7.,T,Count);\n        }\n        \n        if(Count==1){S=T;}\n    }\n    else{\n        S.x=0.;\n    }\n    \n    //FADE\n    if(S.w>0.){\n        S.w-=fade*iTimeDelta;\n        if(S.w<0.){\n            S=vec4(0.);\n        }\n    }\n    \n    /*\n    ////MOUSE\n    if(iMouse.z>0.){\n        vec2 point=iMouse.xy+0.5-fragCoord;\n        if(dot(point,point)<2.){\n            S=vec4(20000.,1.,20000.,1.);\n        }\n    }\n    */\n    \n    vec2 p=iResolution.xy*vec2(0.5,0.1);\n    if(length(p-fragCoord)<1.)S=vec4(speed,1.,speed,1.);\n\n    \n    fragColor=S;\n}","name":"Buffer A","description":"","type":"buffer"}]}