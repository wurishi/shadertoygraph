{"ver":"0.1","info":{"id":"3l2BW3","date":"1608729014","viewed":221,"name":"sound shader wave visualizer","username":"jedi_cy","description":"sound shader wave visualizer","likes":2,"published":1,"flags":8,"usePreview":0,"tags":["sound","wave","visualize"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define SWITCH_RANGE 1\n#define DYNAMIC_OFFSET 1\nconst float ShowTimeRange = 2.0; // visualize time range\nconst float ShowTimeOffset = 0.0;// visualize start time when DYNAMIC_OFFSET is 0\nconst float SwitchRangeDuration = 5.0;\n\n// copy from https://www.shadertoy.com/view/XdXSWs\n//-----------------------------------------------------------------------------------------------------------\n//-------------------------------------------copy the sound shader below-----------------------------------\n//modified from iq's \"Music - Pirates\"\n\nfloat instrument( float freq, float time )\n{\n    freq = 440.0*pow(freq/440.0,1.003); // spread\n    \n    float ph = 1.0;\n    ph *= sin(6.2831*freq*time);\n    ph *= 0.2+0.8*max(0.0,6.0-0.01*freq);\n    ph *= exp(-time*freq*0.25);\n    \n    float y = 0.0;\n    y += 0.70*sin(1.00*6.2831*freq*time+ph)*exp(-0.5*0.007*freq*time);\n    y += 0.20*sin(2.01*6.2831*freq*time+ph)*exp(-0.5*0.011*freq*time); // lower 2nd harmonic\n    y += 0.20*sin(3.01*6.2831*freq*time+ph)*exp(-0.5*0.015*freq*time); // boost 3rd\n    y += 0.16*sin(4.01*6.2831*freq*time+ph)*exp(-0.5*0.018*freq*time);\n    y += 0.13*sin(5.01*6.2831*freq*time+ph)*exp(-0.5*0.021*freq*time);\n    y += 0.10*sin(6.01*6.2831*freq*time+ph)*exp(-0.5*0.027*freq*time);\n  //y += 0.15*sin(7.01*6.2831*freq*time+ph)*exp(-0.5*0.024*freq*time); // no seventh!\n    y += 0.09*sin(8.01*6.2831*freq*time+ph)*exp(-0.5*0.030*freq*time);\n    y += 0.07*sin(9.01*6.2831*freq*time+ph)*exp(-0.5*0.033*freq*time);\n\n    y += 0.45*y*y*y;\n       \n    y *= 1.0 + 1.5*exp(-8.0*time);\n    y *= clamp( time/0.004, 0.0, 1.0 );\n\n    y *= 2.5-1.5*clamp( log2(freq)/10.0,0.0,1.0);\n\treturn y;\t\n}\n\n#define D(a) b=a;if(t>b)x=b;\n#define tint 0.5\n\n//----------scales\n//http://www.cnblogs.com/cute/archive/2013/02/28/2937222.html\n#define A_(num, d_info) x = t; b = 0.0; d_info; y += instrument( 27.5*pow(2.0,float(num)), tint*(t-x) );\n#define Asharp_(num, d_info) x = t; b = 0.0; d_info; y += instrument( 29.135 *pow(2.0,float(num)), tint*(t-x) );\n#define B_(num, d_info) x = t; b = 0.0; d_info; y += instrument( 30.868 *pow(2.0,float(num)), tint*(t-x) );\n#define C_(num, d_info) x = t; b = 0.0; d_info; y += instrument( 16.352 *pow(2.0,float(num)), tint*(t-x) );\n#define Csharp_(num, d_info) x = t; b = 0.0; d_info; y += instrument( 17.324 *pow(2.0,float(num)), tint*(t-x) );\n#define D_(num, d_info) x = t; b = 0.0; d_info; y += instrument( 18.354 *pow(2.0,float(num)), tint*(t-x) );\n#define Dsharp_(num, d_info) x = t; b = 0.0; d_info; y += instrument( 19.445 *pow(2.0,float(num)), tint*(t-x) );\n#define E_(num, d_info) x = t; b = 0.0; d_info; y += instrument( 20.602 *pow(2.0,float(num)), tint*(t-x) );\n#define F_(num, d_info) x = t; b = 0.0; d_info; y += instrument( 21.827 *pow(2.0,float(num)), tint*(t-x) );\n#define Fsharp_(num, d_info) x = t; b = 0.0; d_info; y += instrument( 23.125 *pow(2.0,float(num)), tint*(t-x) );\n#define G_(num, d_info) x = t; b = 0.0; d_info; y += instrument( 24.500 *pow(2.0,float(num)), tint*(t-x) );\n#define Gsharp_(num, d_info) x = t; b = 0.0; d_info; y += instrument( 25.957  *pow(2.0,float(num)), tint*(t-x) );\n// \nvec2 mainSound( in int samp,float time)\n{\n    float x = 0.0;\n    float y = 0.0;\n    float b = 0.0;\n    float t = time/tint;\n    \n    //t+= 36.0;//debug\n    \n    Asharp_(1,\n       D(0.0)\n       D(26.0)D(26.666)D(27.333));\n    \n    F_(1,\n       D(19.0));\n    \n    Asharp_(2,\n       D(0.0)\n       D(8.333)D(11.333)D(13.333)D(13.666)D(14.0)\n       D(34.0)D(35.0)D(35.333));\n    \n    F_(2,\n       D(11.0)D(13.333)D(13.666)D(14.0)\n       D(19.0)\n       D(23.0)D(24.0)D(24.666)D(25.0)D(25.333)\n       D(29.0)D(31.0)D(32.0)D(32.666)D(33.0)D(33.333));\n    \n    A_(2,\n       D(11.0));\n    \n    Asharp_(2,\n       D(19.0)\n       D(21.0)D(26.0)D(26.666)D(27.333)D(34.0)D(35.0)D(35.333));\n    \n    C_(3,\n       D(11.0)\n       );\n    \n    D_(3,\n       D(17.0)D(17.333)D(17.666)D(18.0));\n    \n    Dsharp_(3,\n       D(8.0)D(8.666)\n       D(19.0)\n       D(21.0)\n           );\n    \n    F_(3,\n       D(4.333)D(6.333)\n       D(11.0)D(11.333)D(13.333)D(13.666)D(14.0)\n       D(17.0)D(17.333)D(17.666)D(18.0)\n       D(20.0)D(21.0)\n       D(23.0)D(24.0)D(24.666)D(25.0)D(25.333)\n       D(29.0)D(31.0)D(32.0)D(32.666)D(33.0)D(33.333)\n       D(38.0));\n    \n    G_(3,\n       D(36.666));\n    \n    Gsharp_(3,\n       D(9.0)\n       D(19.0)\n       D(23.0)\n       D(24.0)D(24.666)D(25.0)D(25.333)\n       D(31.0)D(32.0)D(32.666)D(33.0)D(33.333)\n       D(36.0)D(37.333));\n    \n    A_(3,\n       D(11.0)\n       D(38.0));\n    \n    Asharp_(3,\n       D(1.5)D(1.75)D(2.0)D(3.5)D(3.75)D(4.0)D(5.666)D(6.0)D(7.666)\n       D(8.333)D(11.0)D(12.0)D(13.333)D(13.666)D(14.0)\n       D(17.0)D(17.333)D(17.666)D(18.0)D(19.0)\n       D(21.0)\n       D(23.0)D(24.0)D(24.666)D(25.0)D(25.333)\n       D(31.0)D(32.0)D(32.666)D(33.0)D(33.333));\n    \n    B_(3,\n       D(36.666));\n    \n    C_(4,\n       D(11.0)\n       D(21.333)\n       D(29.333)\n       D(36.0)D(37.333)D(38.0));\n    \n    D_(4,\n       D(20.666)\n       D(28.666)\n       D(36.666));\n    \n    Dsharp_(4,\n       D(4.666)D(5.333)D(6.666)D(7.333)\n       D(8.0)D(8.666)D(10.0)\n       D(20.0)\n       D(23.0)D(24.0)D(24.666)D(25.0)D(25.333)\n       D(28.0)D(31.0)D(32.0)D(32.666)D(33.0)D(33.333)\n       D(36.0)D(37.333));\n    \n    F_(4,\n       D(5.0)D(7.0)D(11.333)D(11.666)\n       D(16.0)\n       D(26.0)D(34.0)\n       D(38.0));\n    \n    G_(4,\n       D(11.333)\n       D(36.666));\n    \n    Gsharp_(4,\n       D(7.333)D(7.5)D(7.666)\n       D(8.0)D(9.0)\n       D(36.0)D(37.333));\n    \n    A_(4,\n       D(11.407)\n       D(38.0));\n    \n    Asharp_(4,\n       D(4.666)D(4.8325)D(5.0)D(6.0)D(6.666)D(7.0)\n       D(9.0)D(10.333)D(10.5)D(10.666)D(11.481)D(12.0)\n       D(22.0)D(26.0)\n       D(30.0)D(34.0));\n    \n    B_(4,\n       D(36.666));\n    \n    C_(5,\n       D(11.555)\n       D(21.333)\n       D(29.333)\n       D(36.0)D(37.333)D(38.0));\n    \n    D_(5,\n       D(11.629)\n       D(20.666)D(26.0)\n       D(28.666)D(34.0)\n       D(36.666));\n    \n    Dsharp_(5,\n       D(5.666)D(6.333)\n       D(9.666)D(11.703)\n       D(20.0)D(22.0)\n       D(28.0)D(30.0)\n       D(36.0)D(37.333));\n    \n    F_(5,\n       D(5.0)D(5.333)D(6.0)D(7.0)D(7.666)\n       D(8.0)D(9.333)D(10.0)D(11.777)\n       D(16.0)\n       D(22.0)D(26.0)\n       D(30.0)D(34.0));\n    \n    G_(5,\n       D(11.851));\n    \n    Gsharp_(5,\n       D(10.0));\n    \n    A_(5,\n       D(11.925));\n    \n    Asharp_(5,\n       D(0.0)D(12.0)\n       D(22.0)\n       D(30.0));\n    \n    Asharp_(6,\n       D(0.0)D(12.0));\n    \n    \n   \n    return vec2(0.1,0.1)*y;\n    //return vec2(0.5 * sin(t),0.5*cos(t))*y;\n}\n//-------------------------------------------copy the sound shader above-----------------------------------\n//-----------------------------------------------------------------------------------------------------------\n\n\n\nfloat MapSoundWave(float X1, float X2, float Y, float wave_pos1, float wave_pos2)\n{\n    float unit_dist = (1.0/iResolution.y);\n    \n    float dist1 = wave_pos1 - Y;\n    if(abs(dist1) < unit_dist)\n       return 1.0;\n    \n    float k = (wave_pos2 - wave_pos1) / (X2 - X1);\n    if(k > 0.0 && dist1 > 0.0 || k < 0.0 && dist1 < 0.0)\n    \treturn 0.0;\n    \n    k = pow(abs(k)*0.05, 0.8);// my magic number~\n       \n    float re = 1.0 - abs((dist1 - unit_dist) * unit_dist / k * 10000.0);\n    return max(re, 0.0);\n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n#if SWITCH_RANGE\n    float range_change = (SwitchRangeDuration - mod(iTime, SwitchRangeDuration * 2.0))/SwitchRangeDuration;\n    float switch_range = step(range_change, 0.0);\n    float LocalShowTimeRange = max(switch_range * ShowTimeRange, 0.05);\n#else\n    float LocalShowTimeRange = ShowTimeRange;\n#endif\n\n#if DYNAMIC_OFFSET\n    float LocalShowTimeOffset = floor(iTime / ShowTimeRange) * ShowTimeRange;\n#else\n    float LocalShowTimeOffset = ShowTimeOffset;\n#endif\n\n\n\n    // Normalized pixel coordinates (from 0 to 1)\n    vec2 uv = fragCoord/iResolution.xy;\n    \n    float Y = (uv.y-0.5) * 2.0;// y:0---1\n    \n    float X = uv.x;\n    float time = X * LocalShowTimeRange + LocalShowTimeOffset;\n    float X2 = X + 1.0/iResolution.x;\n\tfloat time2 = X2 * LocalShowTimeRange + LocalShowTimeOffset;\n    int samp = 48000;\n    \n    vec2 wave_pos = mainSound(samp,time);\n    vec2 wave_pos2 = mainSound(samp,time2);\n    \n    \n    float re1 = MapSoundWave(X, X2, Y, wave_pos.x, wave_pos2.x);\n    float re2 = MapSoundWave(X, X2, Y, wave_pos.y, wave_pos2.y);\n    \n    vec3 color = vec3(re1, re2, 0.0);\n    if(abs(Y)< (1.0/iResolution.y))\n    {\n        color = vec3(1.0,1.0,1.0);\n    }\n    if(abs(time - iTime) < LocalShowTimeRange/iResolution.x)\n    {\n        color = vec3(1.0,1.0,1.0);\n    }\n\n    // Output to screen\n    fragColor = vec4(color, 1.0);\n}","name":"Image","description":"","type":"image"},{"inputs":[],"outputs":[],"code":"//modified from iq's \"Music - Pirates\"\n\nfloat instrument( float freq, float time )\n{\n    freq = 440.0*pow(freq/440.0,1.003); // spread\n    \n    float ph = 1.0;\n    ph *= sin(6.2831*freq*time);\n    ph *= 0.2+0.8*max(0.0,6.0-0.01*freq);\n    ph *= exp(-time*freq*0.25);\n    \n    float y = 0.0;\n    y += 0.70*sin(1.00*6.2831*freq*time+ph)*exp(-0.5*0.007*freq*time);\n    y += 0.20*sin(2.01*6.2831*freq*time+ph)*exp(-0.5*0.011*freq*time); // lower 2nd harmonic\n    y += 0.20*sin(3.01*6.2831*freq*time+ph)*exp(-0.5*0.015*freq*time); // boost 3rd\n    y += 0.16*sin(4.01*6.2831*freq*time+ph)*exp(-0.5*0.018*freq*time);\n    y += 0.13*sin(5.01*6.2831*freq*time+ph)*exp(-0.5*0.021*freq*time);\n    y += 0.10*sin(6.01*6.2831*freq*time+ph)*exp(-0.5*0.027*freq*time);\n  //y += 0.15*sin(7.01*6.2831*freq*time+ph)*exp(-0.5*0.024*freq*time); // no seventh!\n    y += 0.09*sin(8.01*6.2831*freq*time+ph)*exp(-0.5*0.030*freq*time);\n    y += 0.07*sin(9.01*6.2831*freq*time+ph)*exp(-0.5*0.033*freq*time);\n\n    y += 0.45*y*y*y;\n       \n    y *= 1.0 + 1.5*exp(-8.0*time);\n    y *= clamp( time/0.004, 0.0, 1.0 );\n\n    y *= 2.5-1.5*clamp( log2(freq)/10.0,0.0,1.0);\n\treturn y;\t\n}\n\n#define D(a) b=a;if(t>b)x=b;\n#define tint 0.5\n\n//----------scales\n//http://www.cnblogs.com/cute/archive/2013/02/28/2937222.html\n#define A_(num, d_info) x = t; b = 0.0; d_info; y += instrument( 27.5*pow(2.0,float(num)), tint*(t-x) );\n#define Asharp_(num, d_info) x = t; b = 0.0; d_info; y += instrument( 29.135 *pow(2.0,float(num)), tint*(t-x) );\n#define B_(num, d_info) x = t; b = 0.0; d_info; y += instrument( 30.868 *pow(2.0,float(num)), tint*(t-x) );\n#define C_(num, d_info) x = t; b = 0.0; d_info; y += instrument( 16.352 *pow(2.0,float(num)), tint*(t-x) );\n#define Csharp_(num, d_info) x = t; b = 0.0; d_info; y += instrument( 17.324 *pow(2.0,float(num)), tint*(t-x) );\n#define D_(num, d_info) x = t; b = 0.0; d_info; y += instrument( 18.354 *pow(2.0,float(num)), tint*(t-x) );\n#define Dsharp_(num, d_info) x = t; b = 0.0; d_info; y += instrument( 19.445 *pow(2.0,float(num)), tint*(t-x) );\n#define E_(num, d_info) x = t; b = 0.0; d_info; y += instrument( 20.602 *pow(2.0,float(num)), tint*(t-x) );\n#define F_(num, d_info) x = t; b = 0.0; d_info; y += instrument( 21.827 *pow(2.0,float(num)), tint*(t-x) );\n#define Fsharp_(num, d_info) x = t; b = 0.0; d_info; y += instrument( 23.125 *pow(2.0,float(num)), tint*(t-x) );\n#define G_(num, d_info) x = t; b = 0.0; d_info; y += instrument( 24.500 *pow(2.0,float(num)), tint*(t-x) );\n#define Gsharp_(num, d_info) x = t; b = 0.0; d_info; y += instrument( 25.957  *pow(2.0,float(num)), tint*(t-x) );\n// \nvec2 mainSound( in int samp,float time)\n{\n    float x = 0.0;\n    float y = 0.0;\n    float b = 0.0;\n    float t = time/tint;\n    \n    //t+= 36.0;//debug\n    \n    Asharp_(1,\n       D(0.0)\n       D(26.0)D(26.666)D(27.333));\n    \n    F_(1,\n       D(19.0));\n    \n    Asharp_(2,\n       D(0.0)\n       D(8.333)D(11.333)D(13.333)D(13.666)D(14.0)\n       D(34.0)D(35.0)D(35.333));\n    \n    F_(2,\n       D(11.0)D(13.333)D(13.666)D(14.0)\n       D(19.0)\n       D(23.0)D(24.0)D(24.666)D(25.0)D(25.333)\n       D(29.0)D(31.0)D(32.0)D(32.666)D(33.0)D(33.333));\n    \n    A_(2,\n       D(11.0));\n    \n    Asharp_(2,\n       D(19.0)\n       D(21.0)D(26.0)D(26.666)D(27.333)D(34.0)D(35.0)D(35.333));\n    \n    C_(3,\n       D(11.0)\n       );\n    \n    D_(3,\n       D(17.0)D(17.333)D(17.666)D(18.0));\n    \n    Dsharp_(3,\n       D(8.0)D(8.666)\n       D(19.0)\n       D(21.0)\n           );\n    \n    F_(3,\n       D(4.333)D(6.333)\n       D(11.0)D(11.333)D(13.333)D(13.666)D(14.0)\n       D(17.0)D(17.333)D(17.666)D(18.0)\n       D(20.0)D(21.0)\n       D(23.0)D(24.0)D(24.666)D(25.0)D(25.333)\n       D(29.0)D(31.0)D(32.0)D(32.666)D(33.0)D(33.333)\n       D(38.0));\n    \n    G_(3,\n       D(36.666));\n    \n    Gsharp_(3,\n       D(9.0)\n       D(19.0)\n       D(23.0)\n       D(24.0)D(24.666)D(25.0)D(25.333)\n       D(31.0)D(32.0)D(32.666)D(33.0)D(33.333)\n       D(36.0)D(37.333));\n    \n    A_(3,\n       D(11.0)\n       D(38.0));\n    \n    Asharp_(3,\n       D(1.5)D(1.75)D(2.0)D(3.5)D(3.75)D(4.0)D(5.666)D(6.0)D(7.666)\n       D(8.333)D(11.0)D(12.0)D(13.333)D(13.666)D(14.0)\n       D(17.0)D(17.333)D(17.666)D(18.0)D(19.0)\n       D(21.0)\n       D(23.0)D(24.0)D(24.666)D(25.0)D(25.333)\n       D(31.0)D(32.0)D(32.666)D(33.0)D(33.333));\n    \n    B_(3,\n       D(36.666));\n    \n    C_(4,\n       D(11.0)\n       D(21.333)\n       D(29.333)\n       D(36.0)D(37.333)D(38.0));\n    \n    D_(4,\n       D(20.666)\n       D(28.666)\n       D(36.666));\n    \n    Dsharp_(4,\n       D(4.666)D(5.333)D(6.666)D(7.333)\n       D(8.0)D(8.666)D(10.0)\n       D(20.0)\n       D(23.0)D(24.0)D(24.666)D(25.0)D(25.333)\n       D(28.0)D(31.0)D(32.0)D(32.666)D(33.0)D(33.333)\n       D(36.0)D(37.333));\n    \n    F_(4,\n       D(5.0)D(7.0)D(11.333)D(11.666)\n       D(16.0)\n       D(26.0)D(34.0)\n       D(38.0));\n    \n    G_(4,\n       D(11.333)\n       D(36.666));\n    \n    Gsharp_(4,\n       D(7.333)D(7.5)D(7.666)\n       D(8.0)D(9.0)\n       D(36.0)D(37.333));\n    \n    A_(4,\n       D(11.407)\n       D(38.0));\n    \n    Asharp_(4,\n       D(4.666)D(4.8325)D(5.0)D(6.0)D(6.666)D(7.0)\n       D(9.0)D(10.333)D(10.5)D(10.666)D(11.481)D(12.0)\n       D(22.0)D(26.0)\n       D(30.0)D(34.0));\n    \n    B_(4,\n       D(36.666));\n    \n    C_(5,\n       D(11.555)\n       D(21.333)\n       D(29.333)\n       D(36.0)D(37.333)D(38.0));\n    \n    D_(5,\n       D(11.629)\n       D(20.666)D(26.0)\n       D(28.666)D(34.0)\n       D(36.666));\n    \n    Dsharp_(5,\n       D(5.666)D(6.333)\n       D(9.666)D(11.703)\n       D(20.0)D(22.0)\n       D(28.0)D(30.0)\n       D(36.0)D(37.333));\n    \n    F_(5,\n       D(5.0)D(5.333)D(6.0)D(7.0)D(7.666)\n       D(8.0)D(9.333)D(10.0)D(11.777)\n       D(16.0)\n       D(22.0)D(26.0)\n       D(30.0)D(34.0));\n    \n    G_(5,\n       D(11.851));\n    \n    Gsharp_(5,\n       D(10.0));\n    \n    A_(5,\n       D(11.925));\n    \n    Asharp_(5,\n       D(0.0)D(12.0)\n       D(22.0)\n       D(30.0));\n    \n    Asharp_(6,\n       D(0.0)D(12.0));\n    \n    \n   \n    return vec2(0.1,0.1)*y;\n    //return vec2(0.5 * sin(t),0.5*cos(t))*y;\n}","name":"Sound","description":"","type":"sound"}]}