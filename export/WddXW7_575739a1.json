{"ver":"0.1","info":{"id":"WddXW7","date":"1572165988","viewed":115,"name":"FM Synth","username":"xactac","description":"Simple fm synth.","likes":4,"published":1,"flags":8,"usePreview":0,"tags":["sound","fm","synth"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // Normalized pixel coordinates (from 0 to 1)\n    vec2 uv = fragCoord/iResolution.xy;\n\n    // Time varying pixel color\n    vec3 col = 0.5 + 0.5*cos(iTime+uv.xyx+vec3(0,2,4));\n\n    // Output to screen\n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"},{"inputs":[],"outputs":[],"code":"struct Note {\n    float f;\n    float r;\n    float a;\n    float on;\n    float off;\n    vec2 vol;\n};\n\n#define n 2\n\n#define repeat 6.\n\nfloat fn(float x)\n{\n    return x * abs(x);\n}\n\nfloat synth(float f, float r, float time, float a)\n{\n    float o = r * f;\n    // A 440 Hz wave that attenuates quickly overt time\n    return fn(sin(6.2831*f*time+sin(6.2831*o*time))) * exp(-time*a);\n}\n\nvec2 mainSound( in int samp,float time)\n{\n    time = mod(time, repeat);\n    Note[n] song = Note[n](Note(440., 0.5, 2., 0., 3., vec2(1., 1.)),\n                          Note(480., 0.5, 2., 1., 4., vec2(1., 1.)));\n    vec2 acc = vec2(0.);\n    for (int i = 0; i < n; i++) {\n        Note c = song[i];\n        if ((c.on <= time) && (c.off >= time)) {\n            acc += c.vol * synth(c.f, c.r, time - c.on, c.a);\n        }\n    }\n//  return vec2(synth(440., 0.5, time, 2.));\n    return acc;\n}","name":"Sound","description":"","type":"sound"}]}