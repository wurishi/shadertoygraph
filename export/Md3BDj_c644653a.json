{"ver":"0.1","info":{"id":"Md3BDj","date":"1526963971","viewed":410,"name":"Cartoon Road 2","username":"Kats","description":"Playing around with skewing circles and rectangles","likes":9,"published":1,"flags":0,"usePreview":0,"tags":["cartoon","road"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define S(a,b,t) smoothstep(a,b,t)\n#define sat(x) clamp(x,0.,1.)\nvec2 within(vec2 uv,vec4 rect){\n\treturn (uv - rect.xy)/(rect.zw-rect.xy);\n}\n\nvec2 Rotation(vec2 uv,float angle){\n\tfloat d = length(uv);\n    \n    vec2 dc = uv - vec2(0.,0.);\n    vec2 right = normalize(vec2(dc.y,-dc.x));\n    \n    uv += (vec2(d)*right*angle);\n\n    return uv;\n}\n\nfloat band(float t,float start,float end,float blur){\n\tfloat step1 = S(start-blur,start,t);\n    float step2 = S(end,end-blur,t);\n    return step1*step2;\n}\n\nfloat Rectangle(vec2 uv,float h,float b,float l,float r,float blur){\n\tfloat x = band(uv.x,l,r,blur);\n    float y = band(uv.y,h,b,blur);\n    return x*y;\n}\n\nvec4 Rays(vec2 uv){\n    uv.y += 0.01;\n    float x = uv.x;\n    float y = uv.y;\n    uv.x = abs(uv.x);\n    \n    float d = length(uv); \n    \n\tvec4 rayLight = vec4(0.9,0.7,0.2,1.)*1.4;\n    float rayMask = Rectangle(uv,0.,0.85,-0.01-y*0.1,0.01+y*0.1,0.01);\n    \n    rayMask += Rectangle(Rotation(uv,-0.7),0.,0.85,-0.005-y*0.1,0.005+y*0.1,0.01);\n    rayMask += Rectangle(Rotation(uv/2.4,-1.7),0.,0.85,-0.001-y*0.1,0.001+y*0.1,0.01);\n    rayMask += Rectangle(Rotation(uv/7.4,-5.7),0.,0.85,-0.001-y*0.1,0.001+y*0.1,0.01);\n   \n    \n    rayLight.a = rayMask*S(0.4,0.9,d)*(sin(iTime*0.5)-1.-0.5)*0.07;\n    return rayLight;\n}\n\nvec4 Sky(vec2 uv){\n    vec4 c = vec4(0.9,0.96,0.78,1.);\n    float d = length(uv+vec2(0.,0.09));\n    float skyMask = S(0.2*(sin(iTime)+1.)/2.,1.,d)*0.8;\n\tc = mix(c,vec4(0.2,0.65,0.9,1.),skyMask);\n    return c;\n}\n\nvec4 Grass(vec2 uv,float height){\n    vec4 c = vec4(0.);\n    \n    c.rgb = vec3(109./255.,172./255.,29./255.);\n    c.a = 1. - step(height,uv.y);\n    \n\treturn c;\n}\n\nvec4 Road(vec2 uv){    \n    \n    uv.x = abs(uv.x);\n    float x = uv.x;\n    float y = uv.y;\n    \n    vec4 back = vec4(144./255.,138./255.,126./255.,1.);\n    float rect = Rectangle(uv,-0.52,0.2,-0.05+y*0.8,0.05-y*0.8,0.02);\n    \n    back.a = rect;\n    back *= rect;\n    \n    float size = S(0.,-0.5,uv.y)*2.9;\n    \n    vec4 line = vec4(0.9,0.6,0.2,1.)*1.2;\n    float lineMask = Rectangle(uv+(vec2(y*0.75,0.))+vec2(-0.029,0.),-0.52,0.2,-0.01*size*0.8+y*0.04,0.01*0.8,0.01);\n    back = mix(back,line,lineMask);\n    \n    vec4 Wline = vec4(.95);\n    float WlineMask = Rectangle(uv+vec2(0.01,0.),-0.32,-0.2,-0.003+y*0.1,0.003-y*0.1,0.005);\n    WlineMask += Rectangle(uv/0.6+(vec2(-0.002,-0.11)),-0.32,-0.22,-0.003+y*0.1,0.003-y*0.1,0.005);\n    back = mix(back,Wline,WlineMask);\n    \n    return back;\n}\n\nvec4 Mount(vec2 uv,vec4 bounds,vec4 hCol,float shadowCurve){\n    float x = uv.x; \n\tuv = within(uv,bounds);\n    float d = length(uv);\n    float hillMask = S(0.5,0.47,d);\n    uv.x += pow(uv.y,shadowCurve)-0.2;\n    uv.y += sin(uv.x*10.*uv.x)*0.08;\n    \n    float shadeMask = S(0.0,0.1,uv.x);\n    float snowMask = S(0.4,0.42,uv.y);\n    \n    vec4 snowCol = vec4(1.);\n    vec4 hillCol = hCol;\n    hillCol = mix(hCol,snowCol,snowMask);\n    vec4 shadeCol = hillCol*0.85; \n    \n    \n    vec4 col = mix(hillCol,shadeCol,shadeMask);\n    \n    col.a = hillMask;\n    return col*hillMask;\n}\n\nvec4 Hill(vec2 uv,vec4 bounds,vec4 hCol,float shadowCurve){\n\tuv = within(uv,bounds);\n    float d = length(uv);\n    float hillMask = S(0.5,0.48,d);\n    uv.x += pow(uv.y,shadowCurve);\n    float shadeMask = S(0.0,0.1,uv.x);\n    \n    vec4 hillCol = hCol;\n    vec4 shadeCol = hillCol*0.85; \n    \n    vec4 col = mix(hillCol,shadeCol,shadeMask);\n    col.a = hillMask;\n    return col*hillMask;\n}\n\nvec4 Hills(vec2 uv){\n    uv.x = abs(uv.x);\n    uv.x -= 0.08;\n    vec4 col = vec4(0.);\n    \n    vec4 capMount = Mount(uv,vec4(0.13+uv.y*0.03,-0.01,0.4-uv.y*0.3,0.7),vec4(0.447059,0.464706,0.164706,1.),2.);\n    capMount += Mount(uv,vec4(0.37+uv.y*0.03,-0.01,0.8-uv.y*0.3,0.7),vec4(0.447059,0.764706,0.464706,1.),2.)*(1. - capMount.a);\n    vec4 smallHill = Hill(uv,vec4(0.3,-0.07,0.7,0.2),vec4(0.3,0.6,0.1,1.),3.);\n    vec4 medHill = Hill(uv,vec4(0.4,-0.17,0.8,0.5),vec4(0.2,0.7,0.1,1.),3.);\n    smallHill += Hill(uv,vec4(-0.6,-0.07,-1.0,0.2),vec4(0.3,0.6,0.1,1.),3.);\n    smallHill += Hill(uv,vec4(-0.9,-0.01,-1.3,0.6),vec4(0.2,0.63,0.4,1.),3.)*(1. - smallHill.a); \n    smallHill += Hill(uv,vec4(0.7,-0.01,1.1,0.6),vec4(0.2,0.63,0.4,1.),3.)*(1. - smallHill.a);    \n    medHill += Hill(uv,vec4(-0.5,-0.17,-1.1,0.5),vec4(0.2,0.7,0.1,1.),3.);\n    \n    col = mix(col,capMount*capMount.a,capMount.a);\n    col = mix(col,medHill,medHill.a);\n    col = mix(col,smallHill,smallHill.a);\n    \n    \n    return col;\n}\n\nvec4 Scene(vec2 uv){\n    //uv += vec2(sin(iTime),cos(iTime))*0.2;\n    vec4 col = vec4(0.);\n    vec4 grass = Grass(uv,-0.035);\n    vec4 sky = Sky(uv);\n    vec4 road = Road(uv);\n    vec4 rayLight = Rays(uv);\n    vec4 hills = Hills(uv);\n    \n    col.rgb = mix(col.rgb,grass.rgb,grass.a);\n    col.rgb = mix(col.rgb,sky.rgb,sky.a*(1.-grass.a));\n    col.rgb = mix(col.rgb,road.rgb,road.a*grass.a);\n    col.rgb = mix(col.rgb,rayLight.rgb,rayLight.a);\n    col.rgb = mix(col.rgb,hills.rgb,hills.a*(1.-grass.a));\n    \n    return col;\n    \n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // Normalized pixel coordinates (from 0 to 1)\n    vec2 uv = fragCoord/iResolution.xy;\n    uv -= 0.5;\n\tuv.x *= iResolution.x/iResolution.y;\n    fragColor = Scene(uv);\n    \n}","name":"Image","description":"","type":"image"}]}