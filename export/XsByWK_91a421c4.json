{"ver":"0.1","info":{"id":"XsByWK","date":"1493729616","viewed":142,"name":"SimpleMagma","username":"aspect26","description":"Very simple magma simulator for my homweork assignment ","likes":1,"published":1,"flags":0,"usePreview":0,"tags":["magmasimple"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4sf3Rr","filepath":"/media/a/ad56fba948dfba9ae698198c109e71f118a54d209c0ea50d77ea546abad89c57.png","previewfilepath":"/media/ap/ad56fba948dfba9ae698198c109e71f118a54d209c0ea50d77ea546abad89c57.png","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XdXGzr","filepath":"/media/a/8979352a182bde7c3c651ba2b2f4e0615de819585cc37b7175bcefbca15a6683.jpg","previewfilepath":"/media/ap/8979352a182bde7c3c651ba2b2f4e0615de819585cc37b7175bcefbca15a6683.jpg","type":"texture","channel":1,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"bool isLandAt(vec2 position) {\n    return textureLod(iChannel1, vec2(position.x/1280.0, position.y/960.), 0.0).x > 0.55;\n}\n\nfloat getLandDistance(in vec2 position) {\n    float k = 10.0;\n\n    for (float landDistance = 0.0; landDistance < 1.0; landDistance += 0.05) {\n        if (isLandAt(vec2(position.x - landDistance*k, position.y))) {\n        \treturn landDistance;\n        }\n        if (isLandAt(vec2(position.x + landDistance*k, position.y))) {\n        \treturn landDistance;\n        }\n        if (isLandAt(vec2(position.x, position.y + landDistance*k))) {\n        \treturn landDistance;\n        }\n        if (isLandAt(vec2(position.x, position.y - landDistance*k))) {\n        \treturn landDistance;\n        }\n    }\n    \n    return 1.0;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    if (isLandAt(fragCoord)) {\n    \tfragColor = vec4(0.0, 0.0, 0.0, 0.0);\n    } else {   \n        float landDistance = getLandDistance(fragCoord);\n        \n        vec4 textureCol = textureLod(iChannel0, vec2(fragCoord.x/640.0 + iTime / 45.0, fragCoord.y/480.0), 0.0);\n        float intensity = textureCol.x;\n        float red = 1.0;\n        float green = 1.0 - intensity;\n\n        float k = sin(iTime) / 4.0 + 1.0;\n        green *= k * landDistance;\n        if (landDistance < 0.3) {\n            red *= (1.0 - landDistance) / 1.0;\n        }\n\n        fragColor = vec4(red, green, 0.0, 0.0);\n    }\n}","name":"Image","description":"","type":"image"}]}