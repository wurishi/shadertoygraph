{"ver":"0.1","info":{"id":"McdGDB","date":"1712138506","viewed":252,"name":"Temper - PC 64k intro","username":"dok","description":"CW: flashing lights\n\nLinux intro released at Revision 2024 for the PC 64k compo, by dok & jon\n\n\npouet: https://www.pouet.net/prod.php?which=96647\ndemozoo: https://demozoo.org/productions/342431/\nmusic: https://soundcloud.com/brnjnt/temper\n","likes":15,"published":1,"flags":64,"usePreview":0,"tags":["revision"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"lsKGzR","filepath":"https://soundcloud.com/brnjnt/temper","previewfilepath":"https://soundcloud.com/brnjnt/temper","type":"musicstream","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":0}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// how to get the sound in sync:\n// - pause\n// - wait for the audio track to load from soundcloud in the iChannel0\n// - reset the shader timer\n// - play\n\n\n#define r2(a)mat2(cos(a),-sin(a),sin(a),cos(a))\n#define time iTime\n#define v2Resolution iResolution\nconst float pi=acos(-1.),bpm=131./60.;\nvec4 s,t;\n\nfloat sd_oct(vec3 p, float s){\n        p=abs(p);\n        float m=p.x+p.y+p.z-s;\n        vec3 o=p-m/3.,k=min(o,.0);\n        return length(p-clamp(o+(k.x+k.y+k.z)*.5-k*1.5,.0,s))*sign(m);\n}\nfloat sd_box(vec3 p, vec3 b){p=abs(p)-b;return length(max(p,.0))+min(max(p.x,max(p.y,p.z)),.0);}\nfloat fm(vec3 p)\n{\n        float d1;\n\n        d1 = sd_oct(p, min(floor(s.x)/16.,1.)) - 0.025;\n        if (s.z>4.&&s.z<6.){\n                p*=mix(10.,5.,smoothstep(.3,.9,t.x));\n                d1 += .1*smoothstep(.3,.9,t.x);\n                d1 += .1*smoothstep(.4,.6,t.x)*.5*(sin(p.x)*sin(p.y)*sin(p.z));\n        }\n        return d1;\n}\nvec3 n(vec3 p){\n        vec2 h=vec2(1e-4,0);\n        return normalize(vec3(fm(p+h.xyy)-fm(p-h.xyy), fm(p+h.yxy)-fm(p-h.yxy), fm(p+h.yyx)-fm(p-h.yyx)));\n}\nvoid mainImage(out vec4 o_col, in vec2 i_fragcoord){\n        vec2 uv = (i_fragcoord.xy-.5*v2Resolution.xy)/v2Resolution.y;\n        s=bpm*time/vec4(1,4,16,64),t=fract(s);\n        vec3 col = vec3(1), ro = vec3(cos(pi*2.*t.z),sin(pi*2.*t.z),-4.);\n        float h,r,d,d1,d2,i,N=1e2,E=1e-3,v=.5,j,m;\n        if (s.z>2.&&s.z<3.){ro = vec3(sin(t.z*pi),1,1);}\n        if (s.z>3.&&s.z<4.){ro = vec3(sin(-t.z*pi),-1,1);}\n        if (s.z>5.&&s.z<6.){ro = vec3(sin(t.z*pi),1.5,.5+2.*t.z);}\n        if (s.z>9.&&s.z<10.){ro = vec3(1.5,-1.5,4.*cos(-t.z*pi));}\n        if (s.z>10.&&s.z<11.){ro = vec3(0,-2,1.+.25*sin(t.z));}\n        if (s.z>11.&&s.z<12.){ro = vec3(-2.*sin((1.-t.z)*pi),-2.*sin(t.z*pi),2);}\n        if (s.z>13.&&s.z<14.){ro = vec3(1.5,-1.5,4.*cos(-t.z*pi));}\n        if (s.z>14.&&s.z<15.){ro = vec3(0,1.,-4);}\n        if (s.z>17.&&s.z<18.){ro = vec3(0,0,-4.+2.*cos(t.z*pi)), v = .15;}\n        if (s.z>18.&&s.z<19.){ro = vec3(0,0,2), v = .25;}\n        if (s.z>19.&&s.z<20.){ro = vec3(0,-1.5,-4);}\n        if (s.z>20.&&s.z<21.){ro = vec3(0,1.5,4);}\n        if (s.z>22.){ro += vec3(10,10,-4)*(s.z-22.);}\n        vec3 p,q,\n                cf=normalize(-ro),\n                cl=normalize(cross(cf,vec3(0,1,0))),\n                cu=normalize(cross(cl,cf)),\n                rd=mat3(cl,cu,cf)*normalize(vec3(uv,v));\n        for(h=r=.0,i=.0;i<N;i++){\n                d=1e9;\n                p=ro+r*rd;\n                if(h<9.)\n                {\n                        d = min(d,fm(p));\n                        if(d<E){col*=1.-pow(1.-dot(-rd,n(p)),2.);ro=p;r=1e-3;rd=reflect(rd,n(p));h+=1.;continue;}\n                }\n                if (s.z<6.||(s.z>12.&&s.z<13.))\n                {\n                        q=p;\n                        j=round(q.z);\n                        m=16.+floor(s.x);\n                        q.z -= clamp(round(q.z),-m,m);\n                        q.y += .6*(sin(q.x*.5+time+t.x+j*.1));\n                        q.xy = abs(q.xy) - 3.;\n                        q.xy *= r2(pi*.25*floor(4.*t.y));\n                        q.y += 2.*t.y;\n                        d1=sd_box(q, vec3(1e2,.01,.02));\n                        d = min(d,d1);\n               }\n               if (s.z>6.&&s.z<8.)\n               {\n                        q=p;\n                        q.z += s.x;\n                        q.z -= s.z<7. ? 2.*round(q.z/2.) : round(q.z);\n                        q.xy = abs(q.xy);\n                        q.xy *= r2(pi/4.);\n                        q.y -= 2.+.2*sin(q.x*.5+time);\n                        d1=mix(.01,.05,1.-t.x);\n                        d1=sd_box(q, vec3(1e2,d1,d1));\n                        d=min(d,d1);\n               }\n               if (s.z>8.&&s.z<12.)\n               {\n                        q=p;\n                        q.z += s.x;\n                        q.z -= .5*round(q.z/.5);\n                        q.xy = abs(q.xy);\n\n                        q.xy *= r2(pi/4.*floor(4.*t.x));\n                        q.y -= 2.+.2*sin(q.x*.5+time);\n                        d1 = mix(.01,.05,1.-fract(4.*t.x));\n                        d1 = sd_box(q, vec3(1e2,d1,d1));\n                        d1 *= step(.5,fract(4.*t.x));\n                        d = min(d,d1);\n               }\n               if (s.z>13.&&s.z<25.)\n               {\n                        q=p;\n                        q.z += 4.*s.x;\n                        j = q.z;\n                        q.xy *= r2(.05*j);\n                        q.z -= round(q.z);\n                        if (s.z>22.) q.xy = abs(q.xy) - (5.+1e1*(s.z-22.));\n                        else\n                        if (s.z<17.||s.z>21.) q.xy = abs(q.xy) - 4.5;\n                        q.xy *= r2(.1*j+time*.1);\n                        d1=sd_box(q, vec3(3,3,.025));\n                        if (s.z>21.)\n                                d1 = sd_box(q, vec3(3.,3.,.025+.5*t.z));\n                        if (s.z<22.)\n                                d1 = max(d1, -sd_box(q, vec3(2.5+.5*t.x)));\n                        if (s.z>17.&&s.z<21.)\n                                d1 *= step(.5,fract(4.*t.x));\n                        d=min(d,d1);\n                }\n                if(d>.0)r+=d*.9;\n                if(d<E||r>4e3)break;\n        }\n        if (i<N&&r>.0)col *= clamp(1./(r*.1),.0,1.);\n        else col = vec3(0);\n        o_col = vec4(col,1);\n}","name":"Image","description":"","type":"image"}]}