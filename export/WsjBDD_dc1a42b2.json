{"ver":"0.1","info":{"id":"WsjBDD","date":"1590081499","viewed":453,"name":"Particles and Waves","username":"wyatt","description":"Fun experiment combining particle tracking and  wave simulating. Best sped up.","likes":9,"published":3,"flags":32,"usePreview":0,"tags":["fakephysics"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XdfGR8","filepath":"/media/previz/buffer03.png","previewfilepath":"/media/previz/buffer03.png","type":"buffer","channel":3,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"Main {\n\t vec4 a = A(U), d= D(U);\n    float p = exp(-length(U-a.xy));\n    Q = 0.5+0.5*sin(3.1*(p+length(d.zw))+vec4(1,2,3,4));\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XdfGR8","filepath":"/media/previz/buffer03.png","previewfilepath":"/media/previz/buffer03.png","type":"buffer","channel":3,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"void X (inout vec4 Q, vec2 U, vec2 r ) {\t\n   vec4 a = A(U+r);\n   if (length(U-a.xy)<length(U-Q.xy))\n       Q = a;\n}\nvoid Y (inout vec4 Q, vec2 U, float r) {\n\tX(Q,U,vec2(0,r));\n\tX(Q,U,vec2(r,0));\n\tX(Q,U,vec2(0,-r));\n\tX(Q,U,vec2(-r,0));\n}\nMain {\n\tQ = A(U);\n\tY(Q,U,1.);\n\tY(Q,U,3.);\n    \n   \tvec2 f = vec2(0);\n    for (int x = -1; x <= 1; x++)\n        for (int y = -1; y <= 1; y++) {\n        \tvec2 r = vec2(x,y);\n            vec4 d = D(Q.xy+r);\n            f -= r*dot(d.zw,d.zw);\n        }\n    f *= 2e-2;\n    Q.zw += f;\n    Q.xy += f+Q.zw/sqrt(1.-dot(Q.zw,Q.zw));\n    \n    if (Q.x<20.) {Q.x = 20.; Q.z *= -1.;}\n    if (Q.x>R.x-20.) {Q.x = R.x-20.; Q.z *= -1.;}\n    if (Q.y<20.) {Q.y = 20.; Q.w *= -1.;}\n    if (Q.y>R.y-20.) {Q.y = R.y-20.; Q.w *= -1.;}\n    \n    if (iFrame < 1) {\n    \tQ = vec4(round(U/30.)*30.,0,0);\n    }\n}","name":"Buffer A","description":"","type":"buffer"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XdfGR8","filepath":"/media/previz/buffer03.png","previewfilepath":"/media/previz/buffer03.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"XsXGR8","channel":0}],"code":"Main {\n    vec4 a = A(U);\n    float p = W;\n\tQ = B(U);\n    vec4 \n        l = (1./6.)*(\n        \tB(U+vec2(0,1))+\n        \tB(U+vec2(1,0))+\n        \tB(U-vec2(0,1))+\n        \tB(U-vec2(1,0))+\n            .5*(B(U+vec2(1,1))+\n            B(U+vec2(1,-1))+\n            B(U-vec2(1,1))+\n            B(U-vec2(1,-1)))\n            \n        )-Q;\n    vec2 f = Q.zw*(p+Z);\n    Q.xy += l.zw - f;\n    Q.zw += Q.xy - M*f;\n    \n    Q = clamp(Q,-2.,2.);\n    if (iFrame < 1||(iMouse.z>0.&&length(U-iMouse.xy)<5.)) {\n    \tQ = vec4(.1,.1,-.5,.5);\n    }\n    if (U.x <1.||U.y<1.||R.x-U.x<1.||R.y-U.y<1.) Q.zw=vec2(1);\n}","name":"Buffer B","description":"","type":"buffer"},{"inputs":[],"outputs":[],"code":"#define R iResolution.xy\n#define A(U) texture(iChannel0,(U)/R)\n#define B(U) texture(iChannel1,(U)/R)\n#define C(U) texture(iChannel2,(U)/R)\n#define D(U) texture(iChannel3,(U)/R)\n#define Main void mainImage(out vec4 Q, vec2 U)\n\n#define W -.3/(1.+length(U-a.xy))\n#define Z .4*(abs(length(Q.zw)-.5))\n\n\n#define M 1.","name":"Common","description":"","type":"common"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4sXGR8","channel":0}],"code":"Main {\n    vec4 a = A(U);\n    float p = W;\n\tQ = B(U);\n    vec4 \n        l = (1./6.)*(\n        \tB(U+vec2(0,1))+\n        \tB(U+vec2(1,0))+\n        \tB(U-vec2(0,1))+\n        \tB(U-vec2(1,0))+\n            .5*(B(U+vec2(1,1))+\n            B(U+vec2(1,-1))+\n            B(U-vec2(1,1))+\n            B(U-vec2(1,-1)))\n            \n        )-Q;\n    vec2 f = Q.zw*(p+Z);\n    Q.xy += l.zw - f;\n    Q.zw += Q.xy - M*f;\n    \n    Q = clamp(Q,-2.,2.);\n    if (iFrame < 1||(iMouse.z>0.&&length(U-iMouse.xy)<5.)) {\n    \tQ = vec4(.1,.1,-.5,.5);\n    }\n    if (U.x <1.||U.y<1.||R.x-U.x<1.||R.y-U.y<1.) Q.zw=vec2(1);\n}","name":"Buffer C","description":"","type":"buffer"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4sXGR8","filepath":"/media/previz/buffer02.png","previewfilepath":"/media/previz/buffer02.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"XdfGR8","channel":0}],"code":"Main {\n    vec4 a = A(U);\n    float p = W;\n\tQ = B(U);\n    vec4 \n        l = (1./6.)*(\n        \tB(U+vec2(0,1))+\n        \tB(U+vec2(1,0))+\n        \tB(U-vec2(0,1))+\n        \tB(U-vec2(1,0))+\n            .5*(B(U+vec2(1,1))+\n            B(U+vec2(1,-1))+\n            B(U-vec2(1,1))+\n            B(U-vec2(1,-1)))\n            \n        )-Q;\n    vec2 f = Q.zw*(p+Z);\n    Q.xy += l.zw - f;\n    Q.zw += Q.xy - M*f;\n    \n    Q = clamp(Q,-2.,2.);\n    if (iFrame < 1||(iMouse.z>0.&&length(U-iMouse.xy)<5.)) {\n    \tQ = vec4(.1,.1,-.5,.5);\n    }\n    if (U.x <1.||U.y<1.||R.x-U.x<1.||R.y-U.y<1.) Q.zw=vec2(1);\n}","name":"Buffer D","description":"","type":"buffer"}]}