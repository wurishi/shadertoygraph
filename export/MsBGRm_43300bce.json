{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[],"code":"//#define _DEBUG\n#ifdef _DEBUG\nconst float kEpsilon = 0.01;\n#endif\nconst int kGridSize = 4;\n \nvec3 sampleVoronoi(vec2 uv, float size)\n{\t\n\tfloat nbPoints = size*size;\n\tfloat m = floor(uv.x*size);\n\tfloat n = floor(uv.y*size);\t\n\t\n\t#if defined _DEBUG\n\tif ( ((uv.x*size-m)<kEpsilon) || ((uv.y*size-n)<kEpsilon))\n\t\treturn vec3(1.0,1.,0.);\n\t#endif\n\t\n\tvec3 voronoiPoint = vec3(0.);;\t\t\t\n\tfloat dist2Max = 3.;\n\tconst float _2PI = 6.28318530718;\n\t\n\tfor (int i=-1; i<2; i++)\n\t{ \n\t\tfor (int j=-1; j<2; j++)\n\t\t{\n\t\t\tvec2 coords = vec2(m+float(i),n+float(j));\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\tfloat phase = _2PI*(size*coords.x+coords.y)/nbPoints;\n\t\t\tvec2 delta = 0.25*vec2(sin(iTime+phase), cos(iTime+phase));\n\t\t\tvec2 point = (coords +vec2(0.5) + delta)/size;\n\t\t\tvec2 dir = uv-point;\n\t\t\tfloat dist2 = dot(dir,dir);\n\t\t\t\n\t\t\t#if defined _DEBUG //displaying points\n\t\t\tif (dist2<=kEpsilon*kEpsilon)\n\t\t\t{\n\t\t\t\treturn vec3(1.0,1.,0.);\n\t\t\t}\n\t\t\t#endif\t\n\t\t\t\t\n\t\t\tfloat t = 0.5*(1.+sign(dist2Max-dist2));\n\t\t\tvec3 tmp = vec3(point,dist2);\n\t\t\tdist2Max = mix(dist2Max,dist2,t);\n\t\t\tvoronoiPoint = mix(voronoiPoint,tmp,t);\t\t\t\t\n\t\t}\n\t}\t\n\treturn voronoiPoint;\t\t\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\t\n\tvec2 uv = fragCoord.xy/iResolution.y;\n\tvec3 voronoi = sampleVoronoi(uv,float(kGridSize));\n\tfragColor = exp(-11.*float(kGridSize)*voronoi.z)*vec4(voronoi.xy, 5.*sqrt(voronoi.z),1.); \n}","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"MsBGRm","date":"1385124218","viewed":693,"name":"Voronoi Diagram","username":"benito_luna","description":"Control points are stored in a grid. This optimizes quite a lot the voronoi algorithm.\n\n","likes":15,"published":1,"flags":0,"usePreview":0,"tags":["voronoiprocedural"],"hasliked":0,"parentid":"","parentname":""}}