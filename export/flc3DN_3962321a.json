{"ver":"0.1","info":{"id":"flc3DN","date":"1636371699","viewed":72,"name":"Ellipse from bounding box","username":"singintime","description":"Draw an ellipse with fill and stroke given its bounding box. Antialiased.","likes":0,"published":1,"flags":0,"usePreview":0,"tags":["ellipse"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"/**\n * @author singintime\n *\n * Draw an ellipse given its bounding box (top left corner, width, and height),\n stroke width, stroke color, and fill color.\n */\nvec4 ellipse(vec2 uv, vec2 pos, float w, float h, float strokeWidth, vec4 strokeColor, vec4 fillColor) {\n    vec2 p = uv - pos;\n    vec2 pp = p * p;\n    vec2 d = vec2(w, h) / 2.0;\n    float s = strokeWidth / 2.0;\n    vec2 dFillIn = d - s - 0.5;\n    vec2 dFillOut = d - s + 0.5;\n    float magFillIn = dot(pp, 1.0 / dFillIn / dFillIn);\n    float magFillOut = dot(pp, 1.0 / dFillOut / dFillOut);\n    float blend;\n    \n\tif (magFillIn < 1.0) {\n\t\treturn fillColor;\n\t}\n    \n    if (magFillOut < 1.0) {\n        blend = (1.0 - magFillOut) / (magFillIn - magFillOut);\n        return strokeWidth <= 0.0\n            ? vec4(fillColor.rgb, blend)\n            : fillColor * blend + strokeColor * (1.0 - blend);\n    }\n\n    vec2 dStrokeIn = d + s - 0.5;\n    vec2 dStrokeOut = d + s + 0.5;\n    float magStrokeIn = dot(pp, 1.0 / dStrokeIn / dStrokeIn);\n    float magStrokeOut = dot(pp, 1.0 / dStrokeOut / dStrokeOut);\n    \n    if (magStrokeIn < 1.0) {\n        return strokeColor;\n    }\n\n    if (magStrokeOut < 1.0) {\n        blend = (1.0 - magStrokeOut) / (magStrokeIn - magStrokeOut);\n        return vec4(strokeColor.rgb, blend);\n    }\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord) {\n\tvec2 uv = fragCoord.xy;\n\tvec2 center = iResolution.xy * 0.5;\n\tfloat width = (0.3 + 0.2 * cos(iTime)) * iResolution.y;\n\tfloat height = (0.3 + 0.2 * sin(iTime)) * iResolution.y;\n    float strokeWidth = 10.0 + 10.0 * cos(iTime / 5.0);\n    \n    // Background\n\tvec4 layer1 = vec4(0.65, 0.65, 0.65, 1.0);\n\t\n\t// Ellipse\n\tvec4 black = vec4(0.0, 0.0, 0.0, 1.0);\n    vec4 white = vec4(1.0, 1.0, 1.0, 1.0);\n\tvec4 layer2 = ellipse(uv, center, width, height, strokeWidth, black, white);\n\t\n\t// Blend the two\n\tfragColor = mix(layer1, layer2, layer2.a);\n}","name":"Image","description":"","type":"image"}]}