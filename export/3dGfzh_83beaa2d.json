{"ver":"0.1","info":{"id":"3dGfzh","date":"1606506764","viewed":302,"name":"chromaticabberation+lens distort","username":"Firepal","description":"yes","likes":6,"published":1,"flags":0,"usePreview":1,"tags":["barreldistortion"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4sXGRn","filepath":"/media/a/95b90082f799f48677b4f206d856ad572f1d178c676269eac6347631d4447258.jpg","previewfilepath":"/media/ap/95b90082f799f48677b4f206d856ad572f1d178c676269eac6347631d4447258.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define gridify(uv) smoothstep(-0.002,0.0,uv)\n\n// slightly altered https://www.shadertoy.com/view/wtBXRz\nvec2 brownConradyDistortion(in vec2 uv, in float k1)\n{\n    uv = uv * 2.0 - 1.0;\t// brown conrady takes [-1:1]\n\n    // positive values of K1 give barrel distortion, negative give pincushion\n    float r2 = uv.x*uv.x + uv.y*uv.y;\n    uv *= 1.0 + k1 * r2;\n    \n    uv = (uv * .5 + .5);\t// restore -> [0:1]\n    return uv;\n}\n\nfloat grid(in vec2 uv){\n    vec2 fw = fwidth(uv);\n\tfloat xx = smoothstep(-fw.x,fw.x,uv.x) * smoothstep(-fw.x,fw.x,1.0-uv.x);\n\tfloat xy = smoothstep(-fw.y,fw.y,uv.y) * smoothstep(-fw.y,fw.y,1.0-uv.y);\n\treturn xx*xy;\n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // Normalized pixel coordinates (from 0 to 1)\n    vec2 uv = fragCoord/iResolution.xy;\n    float DISTORT = sin(iTime)*0.05;\n    \n\tuv = brownConradyDistortion(uv,DISTORT*3.0);\n\tvec2 texuv = uv+vec2(iTime*0.1,0.0);\n    \n    \n    vec2 yo;\n    yo.x = (uv.x-0.5)*-DISTORT;\n    yo.y = (uv.x-0.5)*DISTORT;\n\t\n    vec2 xo;\n    xo.x = (uv.y-0.5)*-DISTORT;\n    xo.y = (uv.y-0.5)*DISTORT;\n    \n    vec3 col;\n    col.r = texture(iChannel0,texuv+vec2(yo.x,xo.x)).r;\n    col.g = texture(iChannel0,texuv).r;\n    col.b = texture(iChannel0,texuv+vec2(yo.y,xo.y)).r;\n\t\n    col *= grid(uv);\n    \n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}