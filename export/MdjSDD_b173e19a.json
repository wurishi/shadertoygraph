{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[{"channel":0,"type":"texture","id":"Xdf3zn","filepath":"/media/a/85a6d68622b36995ccb98a89bbb119edf167c914660e4450d313de049320005c.png","sampler":{"filter":"nearest","wrap":"repeat","vflip":"false","srgb":"false","internal":"byte"}},{"channel":1,"type":"texture","id":"Xsf3Rn","filepath":"/media/a/cbcbb5a6cfb55c36f8f021fbb0e3f69ac96339a39fa85cd96f2017a2192821b5.png","sampler":{"filter":"nearest","wrap":"clamp","vflip":"false","srgb":"false","internal":"byte"}}],"code":"#define EPSILON \t0.005\n#define MAXDIST \t100.0\n#define MAXSTEPS\t100\n#define FOV\t\t\t60.0\n#define MSAA\n\nmat3 rotate_x (float fi) {\n\tfloat cfi = cos (fi);\n\tfloat sfi = sin (fi);\n\treturn mat3 (\n\t\tvec3 (1.0, 0.0, 0.0),\n\t\tvec3 (0.0, cfi, -sfi),\n\t\tvec3 (0.0, sfi, cfi)\n\t);\n}\n\nmat3 rotate_y (float fi) {\n\tfloat cfi = cos (fi);\n\tfloat sfi = sin (fi);\n\treturn mat3 (\n\t\tvec3 (cfi, 0.0, sfi),\n\t\tvec3 (0.0, 1.0, 0.0),\n\t\tvec3 (-sfi, 0.0, cfi)\n\t);\n}\n\nmat3 rotate_z (float fi) {\n\tfloat cfi = cos (fi);\n\tfloat sfi = sin (fi);\n\treturn mat3 (\n\t\tvec3 (cfi, -sfi, 0.0),\n\t\tvec3 (sfi, cfi, 0.0),\n\t\tvec3 (0.0, 0.0, 1.0)\n\t);\n}\n\nvec4 tex3d (sampler2D t, vec3 pt, vec3 pn, float scale) {\n\treturn \n\t\ttexture  (t, pt.yz*scale)*abs (pn.x) +\n\t\ttexture  (t, pt.xz*scale)*abs (pn.y) +\n\t\ttexture  (t, pt.xy*scale)*abs (pn.z);\n}\n\nfloat map (vec3 p, float t) {\n    vec3 b = vec3 (0.5, 2.0, 0.5);\n    float r = 0.1;\n \treturn length(max(abs(p)-b,0.0))-r; //length(max(abs(p) - b, 0.0));\n}\n\nvec3 normal (vec3 p, float t) {\n    float d = map (p, t);\n    return normalize (vec3 (\n        map (p - vec3 (EPSILON, 0.0, 0.0), t) - d,\n        map (p - vec3 (0.0, EPSILON, 0.0), t) - d,\n        map (p - vec3 (0.0, 0.0, EPSILON), t) - d\n    ));\n}\n\nfloat march (vec3 ro, vec3 rd, float time) {\n \tfloat d = EPSILON;\n    float t = 0.0;\n    \n    for (int i = 0; i < MAXSTEPS; ++i) {\n     \tvec3 p = ro + rd * d;\n       \tt = map (p, time);\n        if (t < EPSILON || d >= MAXDIST) \n            break;\n        d += t;\n    }\n    return d;\n    \n}\n\nvec3 hsv2rgb (vec3 c) {\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nvec4 frame (vec2 uv, float t) {\n    uv *= tan (radians (FOV)/2.0);\n\tvec3 up = vec3 (0.0, 1.0, 0.0) ;\n\tvec3 fw = vec3 (1.0, 0.0, 0.0) * rotate_y (t);\n\tvec3 rt = cross (fw, up); \n    \n    vec3 rd = normalize (uv.y * up + uv.x * rt + fw);\n    vec3 ro = -5.0*fw;\n    \n    \n    float d = march (ro, rd, t);\n    vec3 p = ro + d*rd;\n    vec3 nm = normal (p, t);\n    \n    float dl = max (dot (nm, fw), 0.0);\n \n        \n    if (d < MAXDIST) {\n     \treturn vec4 (hsv2rgb (vec3 (tex3d (iChannel0, p, nm, 0.25).r, 1.0, 1.0))*pow (dl,2.0),1.0);\n    }\n    \n    return vec4 (1.0);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n    vec2 uv = (iResolution.xy - 2.0*fragCoord.xy)/\n\t\tmin (iResolution.x, iResolution.y);\n    \n    float t = iTime + cos (uv.y)*sin (iTime)*uv.y*4.0;\n    float d = 0.25/min (iResolution.x, iResolution.y);\n    #ifdef MSAA\n\tfragColor = 0.125*(\n        frame (uv+1.0*vec2(+d, +d), t)+\n        frame (uv+1.0*vec2(-d, +d), t)+\n        frame (uv+1.0*vec2(-d, -d), t)+\n        frame (uv+1.0*vec2(+d, -d), t)+        \n        frame (uv+2.0*vec2(+d, +d), t)+\n        frame (uv+2.0*vec2(-d, +d), t)+\n        frame (uv+2.0*vec2(-d, -d), t)+\n        frame (uv+2.0*vec2(+d, -d), t)\n   );\n    #else\n\tfragColor = frame (uv, t);\n    #endif        \n    \n}","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"MdjSDD","date":"1412360107","viewed":1404,"name":"Twisty bendy","username":"Coldberg","description":"oldschool rubber/jelly box effect","likes":22,"published":1,"flags":0,"usePreview":0,"tags":["effect","rubber","box","twist","jelly"],"hasliked":0,"parentid":"","parentname":""}}