{"ver":"0.1","info":{"id":"4sVXDt","date":"1467422329","viewed":507,"name":"kaleidoscope IFS","username":"zackpudil","description":"Kaleidoscope....Yay!","likes":22,"published":1,"flags":0,"usePreview":0,"tags":["raymarching","fractal","simple"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XdX3zn","filepath":"/media/a/488bd40303a2e2b9a71987e48c66ef41f5e937174bf316d3ed0e86410784b919.jpg","previewfilepath":"/media/ap/488bd40303a2e2b9a71987e48c66ef41f5e937174bf316d3ed0e86410784b919.jpg","type":"cubemap","channel":0,"sampler":{"filter":"mipmap","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void rotate(inout vec2 p, float a) {\n\tfloat s = sin(a);\n\tfloat c = cos(a);\n\t\n\tp = mat2(c, s, -s, c)*p;\n}\n\nvec4 orb;\nfloat de(vec3 p) {\n\torb = vec4(10000.0);\n\tfor(int i = 0; i < 8; i++) {\n\t\trotate(p.xy, 0.8);\n\t\trotate(p.xz, 0.4 + 0.4*cos(iTime));\n\t\tp = abs(p);\n\t\tp = 2.0*p - 1.0;\n\t\t\n\t\torb = min(orb, vec4(abs(p), length(p)));\n\t}\n\t\n\treturn length(p.xz)*pow(2.0, -8.0) - 0.01;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n\tvec2 p = -1.0 + 2.0*fragCoord.xy/iResolution.xy;\n\tp.x *= iResolution.x/iResolution.y;\n\t\n\tfloat atime = iTime*0.3;\n\t\n\tvec3 ro = 2.0*vec3(cos(atime), 0, -sin(atime));\n\tvec3 ww = normalize(vec3(0, sin(iTime), 0) - ro);\n\tvec3 uu = normalize(cross(vec3(0, 1, 0), ww));\n\tvec3 vv = normalize(cross(ww, uu));\n\tvec3 rd = normalize(uu*p.x + vv*p.y + 1.97*ww);\n    \n    vec3 col = texture(iChannel0, -rd).xyz;\n\t\n\tfloat t = 0.0;\n    \n\tfor(int i = 0; i < 100; i++) {\n\t\tfloat d = de(ro + rd*t);\n\t\tif(d < 0.001*t || t >= 10.0) break;\n\t\tt += d;\n\t}\n\t\n\tif(t < 10.0) {\n        vec3 pos = ro + rd*t;\n\t\tvec2 h = vec2(0.001, 0.0);\n\t\tvec3 nor = normalize(vec3(\n\t\t\tde(pos + h.xyy) - de(pos - h.xyy),\n\t\t\tde(pos + h.yxy) - de(pos - h.yxy),\n\t\t\tde(pos + h.yyx) - de(pos - h.yyx)\n\t\t));\n\t\t\n\t\tfloat o = 0.0, w = 1.0, s = 0.01;\n\t\tfor(int i = 0; i < 15; i++) {\n\t\t\tfloat d = de(pos + nor*s);\n\t\t\to += (s - d)*w;\n\t\t\tw *= 0.9;\n\t\t\ts += s/(float(i) + 1.0);\n\t\t}\n\t\t\n\t\tvec3 orbitColor = cos(vec3(0.1,0.6,1.6))*orb.x\n\t\t\t+ sin(vec3(0.0,0.6,1.0))*orb.y \n\t\t\t+ cos(vec3(0.8,0.78,1.0))*orb.z \n\t\t\t+ sin(vec3(0.1,0.7,0.4))*orb.w;\n\t\t\n\t\tcol = mix(vec3(1, 0.4, 0.4), 3.0*orbitColor, 0.1);\n\t\t\n\t\tcol *= vec3(1.0 - clamp(o, 0.0, 1.0));\n    }\n    \n\tfragColor = vec4(col, 1);\n}","name":"Image","description":"","type":"image"}]}