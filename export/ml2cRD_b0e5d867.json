{"ver":"0.1","info":{"id":"ml2cRD","date":"1691551041","viewed":29,"name":"Ball Shading three Gamma","username":"Leslie","description":"Gamma correct\nBetter Lighting","likes":0,"published":1,"flags":0,"usePreview":0,"tags":["3d"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGRn","filepath":"/media/a/10eb4fe0ac8a7dc348a2cc282ca5df1759ab8bf680117e4047728100969e7b43.jpg","previewfilepath":"/media/ap/10eb4fe0ac8a7dc348a2cc282ca5df1759ab8bf680117e4047728100969e7b43.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XdX3zn","filepath":"/media/a/488bd40303a2e2b9a71987e48c66ef41f5e937174bf316d3ed0e86410784b919.jpg","previewfilepath":"/media/ap/488bd40303a2e2b9a71987e48c66ef41f5e937174bf316d3ed0e86410784b919.jpg","type":"cubemap","channel":1,"sampler":{"filter":"mipmap","wrap":"clamp","vflip":"false","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"/*\nI don't know weither my Gamma operations are correct or not, if not, please remind me!\n*/\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    float scale = min(iResolution.x, iResolution.y);\n    vec2 uv = (2.*fragCoord-iResolution.xy)/scale;\n    vec2 res = iResolution.xy/scale;\n    \n    float z = sqrt(   max(pow(0.8 , 2.)-pow(length(uv), 2.), 0.0)  );\n    vec3 fp = vec3(uv, z);\n    vec3 clr = texture(iChannel1, fp).rgb; // ballColor\n    vec3 bClr = texture(iChannel0, uv/res/2.+0.5).rgb; // backColor\n    vec3 gm = vec3(2.2);\n    \n    // gamma decode\n    clr = pow(clr, gm);\n    bClr = pow(bClr, gm);\n    \n\n    vec3 nrml = normalize(fp);\n    vec3 lit = vec3(10.*sin(iTime), 5., 10.*cos(iTime));\n    vec3 vLit = lit-fp;\n    float lLit = length(vLit);\n    vec3 uvLit = vLit/lLit;\n    vec3 midLitNrml = normalize(vec3(0., 0., 1.)+uvLit);\n\n    float cosDiffuse = smoothstep(0., 1., dot(uvLit, nrml)); // Better Diffuse Coeffe\n    float cosSpecular = max(0., dot(midLitNrml, nrml)); //Specular Coeffe\n\n    float I = 400.;\n    clr = 0.1*clr\n         + clr*I/lLit/lLit*cosDiffuse // Diffusion\n         + mix(clr, vec3(1.), .3)*I/lLit/lLit*pow(cosSpecular, 100.); // Better Specular, mix ballColor with white color\n         \n\n\n    clr = clamp(clr, 0., 1.);\n    \n    float blur = 3./scale; // keep blur width be same in pixel size\n    float smth = smoothstep(0.8-blur, 0.8+blur, length(uv));\n    \n    fragColor = vec4(pow(mix(clr, bClr, smth), 1./gm), 1.); // gamma encode\n}","name":"Image","description":"","type":"image"}]}