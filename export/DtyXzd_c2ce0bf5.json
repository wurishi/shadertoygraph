{"ver":"0.1","info":{"id":"DtyXzd","date":"1686277842","viewed":25,"name":"yeyidk","username":"JJmartinodev","description":"cool raymarcher","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["mayberaymarch"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"struct Ray {\n    vec3 pos;\n    vec3 dir;\n};\n\nstruct Sphere {\n    vec3 pos;\n    float r;\n};\n\nstruct Result {\n    bool hit;\n    vec3 normal;\n};\n\n#define qual_mar 0.1\n\nfloat dst_calc(Sphere s0,Sphere s1, Ray r) {\n    return min(\n    distance(s0.pos,r.pos)-s0.r,distance(s1.pos,r.pos)-s1.r);\n}\n\nResult march( Sphere s0,Sphere s1, Ray r) {\n    Result res;\n    res.hit = false;\n    res.normal = vec3(0);\n    \n    for(int i = 0; i < 500; i++) {\n        float dst = dst_calc(s0,s1,r);\n        if(dst < 1.0) {\n            res.hit = true;\n            float d0 = distance(r.pos,s0.pos)-s0.r;\n            float d1 = distance(r.pos,s1.pos)-s1.r;\n            if(d0 < d1)\n            res.normal = -normalize(s0.pos - r.pos);\n            else\n            res.normal = -normalize(s1.pos - r.pos);\n            return res;\n        }\n        r.pos += r.dir * min(dst,qual_mar);\n    }\n    \n    return res;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    float asp = iResolution.x/iResolution.y;\n    vec2 uv = fragCoord/iResolution.xy * 2.0 - 1.0;\n    vec2 m = iMouse.xy/iResolution.xy * 2.0 - 1.0;\n    m.x *= asp;\n    uv.x *= asp;\n    float near = 0.7;\n    vec3 cam = vec3(0,0,0.0);\n    Sphere s0;\n    s0.pos = vec3(abs(2.0*sin(iTime))+3.0);\n    s0.pos.xy = -m * s0.pos.z * 2.0;\n    s0.r = 1.5;\n    Sphere s1;\n    s1.pos = vec3(sin(iTime)*2.0,1.0,abs(2.0*sin(iTime))+3.0);\n    s1.r = 1.7;\n    Ray r;\n    r.pos = vec3(uv,-near) + cam;\n    r.dir = normalize(cam - r.pos);\n    \n    vec3 l = vec3(cos(iTime),cos(iTime),sin(iTime));\n    \n    \n    Result res = march(s0,s1,r);\n    fragColor = vec4(0.9,0.4,0.5,1.0);\n    if(res.hit)\n    fragColor = vec4(dot(res.normal,l));\n}","name":"Image","description":"","type":"image"}]}