{"ver":"0.1","info":{"id":"7sK3WK","date":"1632498539","viewed":501,"name":"Soccermania","username":"kastorp","description":"Derby is coming!\nmouse:  player/ball direction\nA= shot, S=pass\n","likes":44,"published":1,"flags":48,"usePreview":0,"tags":["game","football","soccer"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGRr","filepath":"/presets/tex00.jpg","previewfilepath":"/presets/tex00.jpg","type":"keyboard","channel":3,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4dXGzr","filepath":"/media/a/08b42b43ae9d3c0605da11d0eac86618ea888e62cdd9518ee8b9097488b31560.png","previewfilepath":"/media/ap/08b42b43ae9d3c0605da11d0eac86618ea888e62cdd9518ee8b9097488b31560.png","type":"texture","channel":2,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"nearest","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":1,"sampler":{"filter":"nearest","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// Soccermania by Kastorp\n//-------------------------------\n// controls:\n//   use mouse to control  player and ball direction\n//   A= shot\n//   S= pass\n// toggles:\n//   E= practice on/off \n//   C= auto shot on/off\n//--------------------------------\n\nfloat pitch(vec2 uv)\n{\n    float d =1e5;\n    uv=abs(uv);\n    d=min(d,abs(length(uv) - .18));\n    d=min(d,max(uv.x- PC.x +.34, abs(length(uv-vec2(PC.x-.27,0)) - .18)));\n    d=min(d,abs(sdBox(uv-vec2(PC.x/2.,0),vec2(PC.x/2.,PC.y))));\n    d=min(d,abs(sdBox(uv-vec2(PC.x-.17,0),vec2(.17,.4))));\n    d=min(d,abs(sdBox(uv-vec2(PC.x-.05,0),vec2(.05,.15))));\n    d=min(d,length(uv-vec2(PC.x-.25,0.)));\n    return d;\n}\n\n\nvoid mainImage( out vec4 O, in vec2 U )\n{\n    \n    vec2 uv = position(U);\n    vec4 ball=  texelFetch(iChannel0,ivec2(0),0);         \n    vec4 zBall=texelFetch(iChannel1,ivec2(coord(ball.xy)),0);    \n\n#if 0\n    uv.y=(uv.y-2.5);\n    uv.x+=ball.x*2.7;\n    uv.x*=-.8/uv.y;\n    uv.y=-2.6*(uv.y+ 2.4)/uv.y;\n#endif\n\n    vec3 col = vec3(0.2,0.5,0.1)*(.9+.1*step(0.1,mod(uv.x,.2)))*(.9+.1*step(0.1,mod(uv.y,.2)));         \n    col=mix(col,vec3(1), smoothstep(tk,.0,pitch(uv)));    \n    col=mix(col,vec3(.7), smoothstep(tk,.0,sdBox(abs(uv)-vec2(PC.x+.02,0),vec2(.02,.07))));\n    \n    ivec4 mode= ivec4( texelFetch(iChannel0,ivec2(24,0),0));\n    ivec4 sc= ivec4( texelFetch(iChannel0,ivec2(25,0),0));\n    drawChar(iChannel2, col, vec3(0.,.7,0), uv, vec2(-0.05,.45), vec2(.1), 48+sc.x);\n    drawChar(iChannel2,col, vec3(0.,.7,0), uv, vec2(0.05,.45), vec2(.1), 48+sc.y);\n\n\n\n    \n    if(texelFetch(iChannel3,ivec2(32,2),0).x>0.){\n        vec4 d=texelFetch(iChannel1,ivec2(U),0);\n        float side = sign(zBall.x-11.5 );\n        float cScore= abs(score(side,position(U),ball,d));\n                                \n        int j = int(d.x);\n        vec4 zBallt=texelFetch(iChannel1,ivec2(coord(ball.xy+ball.zw*1.)),0);\n        //team zones\n        \n        col=mix(col,  ((j<12? vec3(.5,0,0):vec3(0,0,.7))), .8*smoothstep(-.3,.3,cScore));\n        vec4 b=texelFetch(iChannel0,ivec2(0,0),0);\n        col=mix(col, vec3(1,1,0),smoothstep(tk,.0,-.01+length(uv-b.xy-b.zw*1.))); //ball target \n        vec4 pl=texelFetch(iChannel0,ivec2(zBall.x,0),0);\n        col=mix(col, vec3(1,0,1),smoothstep(tk,.0,-.01+length(uv-pl.xy))); //closest player\n        vec4 plt=texelFetch(iChannel0,ivec2(zBallt.x,0),0);\n        col=mix(col, vec3(0,1,1),smoothstep(tk,.0,-.01+length(uv-plt.xy))); //target player   \n        vec2 offs=texelFetch(iChannel0,ivec2(27,0),0).xy;\n        col=mix(col, vec3(.5,.5,0),smoothstep(tk,0.,min(abs(uv.x-offs.x),abs(uv.x-offs.y))));\n    } \n    \n    for(int i=0;i<=22;i++)\n    {\n        vec4 pl=  texelFetch(iChannel0,ivec2(i,0),0);\n        vec2 pd=(uv-pl.xy)*mat2(cos(pl.z),sin(pl.z),-sin(pl.z),cos(pl.z));\n        \n        float fl= abs(mod(pl.w*.5,0.04)-0.02);\n        if(i>0 && sdBox(uv-pl.xy,vec2(.03))<0. ) {\n            vec3 c=((i%11)==1?vec3(0,1,0): (i<12? vec3(1,0,0):vec3(0,.7,1)));\n            col=mix(col, vec3(0), smoothstep(tk,.0,sdBox(pd +vec2(-fl+.005,.01),vec2(.005,.002))  ));\n            col=mix(col, vec3(0), smoothstep(tk,.0,sdBox(pd +vec2(-.015+fl,-.01),vec2(.005,.002))  ));\n            col=mix(col, c, smoothstep(tk,.0,sdBox(pd ,vec2(.006,.012))  ));\n            col=mix(col, c, smoothstep(tk,.0,sdBox(pd +vec2(-.006+fl*.5,.014),vec2(.005,.002))  ));\n            col=mix(col, c, smoothstep(tk,.0,sdBox(pd +vec2(-fl*.5+.002,-.014),vec2(.005,.002))  ));\n            \n            vec3 head=vec3(0.4,0.2,0.2);\n            if(iMouse.z>0. && zBall.x<11.5  && int(zBall.x)==i)  head=vec3(1,1,0);\n            if(iMouse.z>0. && zBall.z<11.5  && int(zBall.z)==i)  head=vec3(1,1,0);\n            col=mix(col, head,smoothstep(tk,.0,-.007+length(uv-pl.xy)));\n            \n        }else if(i==0 && length(uv-pl.xy)<.01){\n        //from https://www.shadertoy.com/view/fsBfz3 \"soccer ball 3d\" by 4eckme  \n          #define o(a,i)  abs( mod( dot( i, vec2(-sin(a),cos(a)) ) , 60.) - 30. ) \n          vec2 i = (uv-pl.xy)*100.; \n          float z=length(i);                          \n          i = i/cos(z)*50.-pl.xy*1500.;\n          col*=0.;\n          col +=  smoothstep(-5.,5.,o(0.,i)+o(1.05,i)+o(2.1,i) -54.);\n          i.y += 40.;\n          col += smoothstep(-5.,5.,o(0.,i)+o(1.05,i)+o(2.1,i) -54.);\n          col *= cos(z);\n        }\n    }\n\n\n    if(iMouse.z>0.) {\n        col=mix(col, vec3(1,1,0), smoothstep(.001,.0,-.005*R.y+length(U-iMouse.xy)));         \n    }\n    \n\n   \n    O = vec4(col,1.0);    \n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGRr","filepath":"/presets/tex00.jpg","previewfilepath":"/presets/tex00.jpg","type":"keyboard","channel":3,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"nearest","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":1,"sampler":{"filter":"nearest","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"//BUFFER A: game engine\n#define module 1\nvec2 T[22] =vec2[22](\n    //red team 4-4-2\n    vec2(.92,0),\n    vec2(.6,.36),vec2(.6,.12),vec2(.6,-.12),vec2(.6,-.36),\n    vec2(.3,.36),vec2(.3,.12),vec2(.3,-.12),vec2(.3,-.36),\n    vec2(.05,.18),vec2(.05,-.18),\n    //blue team \n    vec2(-.92,0),\n#if (module==1) \n    // 4-3-3\n    vec2(-.6,.36),vec2(-.6,.12),vec2(-.6,-.12),vec2(-.6,-.36),\n    vec2(-.3,-.32), vec2(-.4,.0),vec2(-.3,.32),\n    vec2(-.05,.25),vec2(-.05,.0),vec2(-.05,-.25)\n#elif(module==2)\n    // 4-4-2\n    vec2(-.6,.36),vec2(-.6,.12),vec2(-.6,-.12),vec2(-.6,-.36),\n    vec2(-.3,.36),vec2(-.3,.12),vec2(-.3,-.12),vec2(-.3,-.36),\n    vec2(-.05,.18),vec2(-.05,-.18)\n#elif(module==3)\n    // 3-4-3\n    vec2(-.6,.24),vec2(-.6,.0),vec2(-.6,-.24),\n    vec2(-.4,.36),vec2(-.3,.12),vec2(-.3,-.12),vec2(-.4,-.36),\n    vec2(-.05,.18),vec2(-.0,0.),vec2(-.05,-.18)\n#else\n    //4-2-4\n    vec2(-.6,.36),vec2(-.6,.12),vec2(-.6,-.12),vec2(-.6,-.36),\n    vec2(-.3,.12), vec2(-.3,-.12),\n    vec2(-.05,.36),vec2(-.05,.18),vec2(-.05,-.18),vec2(-.05,-.36)\n#endif\n  );\n\n\nvec2 hash21(float p)\n{\n\tvec3 p3 = fract(vec3(p) * vec3(.1031, .1030, .0973));\n\tp3 += dot(p3, p3.yzx + 33.33);\n    return fract((p3.xx+p3.yz)*p3.zy);\n\n}\nvoid mainImage( out vec4 O, in vec2 U )\n{\n    if(U.y>1. || U.x>28.) discard;\n    \n    //who am I?\n    int i=int(U.x);\n    //who's near ball?\n    vec4 ball=  texelFetch(iChannel0,ivec2(0),0);\n    vec4 zBall=texelFetch(iChannel1,ivec2(coord(ball.xy) ),0);     \n    float zBalld= sdSegment(texelFetch(iChannel0,ivec2(zBall.x,0),0).xy,ball.xy,ball.xy-ball.zw*.04);\n    \n    ivec4 mode= ivec4( texelFetch(iChannel0,ivec2(24,0),0));\n    bool demo = !(texelFetch(iChannel3,ivec2(67,2),0).x>0.);\n \n    \n    if(iFrame==0) //initialize\n        O = i==0 ? vec4(0,0,0,0): //ball\n             i<23 ? vec4(.48 - U.x*.04,.0 ,0,0): //players\n             i==24? vec4(0,F_START,0,0): //mode\n                    vec4(0); //score && last player kick\n    else if(i==24){ //mode (0=goal kick, 1 =game, 2=throw-in)\n       int lastP= int( texelFetch(iChannel0,ivec2(26,0),0).x);\n       if(any(greaterThan(ball.xy,PC)) || any(lessThan(ball.xy,-PC))) mode=ivec4(CORNERS,iFrame+F_START,lastP,0);\n       else if( mode.x==0 && iFrame>mode.y) mode=ivec4(1,iFrame+F_START,0,0);\n       else if( mode.x==2 && length(ball.zw)>.001 ) mode=ivec4(1,iFrame+F_START*(length(ball.xy)<.05?53:1) ,0,0);\n              \n       O=vec4(mode);       \n    }\n    else if(i==25){ //scores\n        ivec4 sc= ivec4( texelFetch(iChannel0,ivec2(25,0),0));\n        if( abs(ball.y)<=.07 && mode.x==1){ \n            if(ball.x>PC.x ) sc.x++; //blue goal\n            if(ball.x<-PC.x) sc.y++; //red goal\n            if(max(sc.x,sc.y)>9) sc.xy=ivec2(0);//reset\n        }\n        O=vec4(sc);       \n    }\n    else if(i==26 ){\n        // stores last kicking player \n        O= texelFetch(iChannel0,ivec2(26,0),0);\n        if(mode.x==1  &&  zBalld <.01){           \n                if((iMouse.z>0. && zBall.x<11.5  )\n                || (zBall.x>11.5 || demo)) O=vec4(zBall.x);\n        }\n        if(mode.x==2 && zBalld<.01) O=vec4(zBall.x);\n    }\n    else if(i==27 ){\n        O =vec4(0); //offside position (midfield)\n        for(int i=1;i<=22;i++)\n        {\n            vec2 p=  texelFetch(iChannel0,ivec2(i,0),0).xy;\n            if(i>1&& i<12) O.x=max(O.x,p.x);\n            if(i>13) O.y=min(O.y,p.x);\n        }\n        \n        \n    }\n    else if(i==0 ){ //ball\n        O =  texelFetch(iChannel0,ivec2(0),0);\n        \n        //ball movement\n        vec2  pBall=vec2(O.xy), vBall=vec2(O.zw);\n        vBall*=.96;\n        pBall+= vBall*.04;\n        \n        if(mode.x==1 ){//&& all(greaterThanEqual(pBall,-PC)) || all(lessThanEqual(pBall,PC))){\n            //ball kicked\n            if( zBalld<.01 ){            \n                if(iMouse.z>0. && zBall.x<11.5  ){\n                    //mouse target\n                    vec2 pMouse =position(iMouse.xy);\n                    float power=  max(length(pBall-pMouse),.12);                              \n                    if(texelFetch(iChannel3,ivec2(65,0),0).x>0.) power=.9 ;\n                    if(texelFetch(iChannel3,ivec2(83,0),0).x>0.) power=.5 ;\n                    vBall =-normalize(pBall-pMouse)*min(power,.9) *1.2;\n                }       \n                else if(zBall.x>11.5 || demo) {\n                    //find best shot on random set\n                    float side = sign(zBall.x-11.5 );\n                    float score=-1.;\n                    for(int j=0;j< 300;j++){\n                        vec2 tDir =-normalize(pBall- vec2(side*PC.x,0))*.4;\n                        vec2 cvBall= tDir + hash21(iTime +float(j)*3.1)*1.-.5 ;\n\n                        vec2 tPos=pBall + cvBall*1.02; //final ball position (estimation)\n                        if(any(greaterThan(tPos,PC*1.05)) || any(lessThan(tPos,-PC*1.05)))  \n                        {\n                            //evaluate shot score\n                            float cScore = +( abs(tPos.y) <.07  && -tPos.x*side>PC.x ?5.:0.);\n                            if (cScore>score) {\n                                vBall=cvBall;\n                                score=cScore;\n                            }\n                        } \n                        vec4 zzBall=texelFetch(iChannel1,ivec2(coord(tPos) ),0); \n                        // evaluate passing score\n                        float cScore= -.1 + abs(score(side,tPos,ball,zzBall));\n                        //(tPos.x-zBall.x)*side *(.03+  smoothstep(.05,.2, zzBall.w-zzBall.y)*2.)  *smoothstep(PC.y*.9,PC.y*.5,abs(tPos.y));\n                        if(score<0. ||(cScore>score &&  sign(zzBall.x-11.5 )*side>0. )){\n                            vBall=cvBall;\n                            score=cScore;\n                        }\n                    }\n                 }          \n            }\n\n            O = vec4(pBall,vBall);\n        }\n        else if(mode.x==2 ) {           \n            //WORK IN PROGRESS \n            if( abs(pBall.x)>PC.x && abs(pBall.y)<.07) O=vec4(-.01*sign(pBall.x),0,0,0); //goal\n            else if(pBall.x>PC.x && mode.z <=11)  O=vec4(vec2(PC.x,PC.y*sign(pBall.y)),vec2(0)); //corner blue\n            else if(pBall.x<-PC.x && mode.z> 11) O=vec4(vec2(-PC.x,PC.y*sign(pBall.y)),vec2(0)); //corner red\n            else if(pBall.x>PC.x && mode.z> 11)  O=vec4(vec2(PC.x-.10,.15*sign(pBall.y)),vec2(0)); //throw in red\n            else if(pBall.x<-PC.x && mode.z<= 11) O=vec4(vec2(-PC.x+.10,.15*sign(pBall.y)),vec2(0)); //throw in blue\n            else if(abs(pBall.y)>PC.y)  O=vec4(pBall.x,PC.y*sign(pBall.y),0,0); //lateral             \n            else if(zBalld<.01  && iFrame>mode.y) O= vec4(pBall.xy, -normalize(pBall- vec2(0.))*.02) ;\n        }\n        else if(mode.x==0 ) O=vec4(max(-PC,min(PC,pBall)),vec2(0)); \n\n    }\n    else if(i>=1 && i<=22){ //player         \n            \n        //target position\n        vec2 p=  T[i-1];\n        //current position\n        vec4 p0=  texelFetch(iChannel0,ivec2(U),0);\n        \n        if(mode.x==2 ){\n            bool kickoff=  length(ball.xy)<.05;\n            //attack/defense\n            if(i>12 && !kickoff ) p+=  vec2( ball.x*.5  +.22 +sign(float(mode.z)-11.5) *.03 , 0);\n            if(i>1 && i<12 && !kickoff ) p+= vec2( ball.x*.5 -.22 +sign(float(mode.z)-11.5) *.03, 0);          \n            if((int(zBall.x)==i || int(zBall.z)==i  )  && ((mode.z >=12 && i<=11) || (mode.z <=11 && i>=12)) ) p=ball.xy;\n            else if( !kickoff)  p =mix( p,-ball.xy, smoothstep(.2,-.2,length(p-ball.xy)));\n        }\n        \n        if(mode.x==1 ){\n            if( (i>5 && i<12) || i>16 ){\n                  //random movements\n                  int j= (iFrame/90);\n                  vec2 rp= hash21(float(j*24 + i));                 \n                  p = clamp(p+ rp.xy*.4-.2,-PC,PC);\n            }\n            \n        \n            //attack/defense\n            if(i>12 ) p+=  vec2( ball.x*.7  +.3, ball.y*.3);\n            if(i>1 && i<12 ) p+= vec2( ball.x*.7  -.3, ball.y*.3);\n            \n            //return from offside\n            vec2 offs=texelFetch(iChannel0,ivec2(27,0),0).xy;          \n            if(i>1 && i<12)  p.x=max(p.x,offs.y);\n            if(i>13)  p.x=min(p.x,offs.x);\n           \n  \n            //ball is mine       \n            if(int(zBall.x)==i || int(zBall.z)==i  ) p=ball.xy;\n            else if(mode.x ==1 ) {\n                \n                vec2 pBall=max(-PC,min(PC,ball.xy +ball.zw*1.));\n                zBall=texelFetch(iChannel1,ivec2(coord(pBall)),0); \n                //ball is directed to me\n                if(int(zBall.x)==i || int(zBall.z)==i ) p=pBall;// +ball.zw*.5;\n                else {\n                \n                   // pressing  \n                    p =mix( p,max(-PC,min(PC,ball.xy)), smoothstep(.5,-.2,length(p-ball.xy)));\n                }\n            }\n        }\n        /*\n        //mouse target\n        vec2 pMouse =position(iMouse.xy);\n        if(iMouse.z>0. && dot(pMouse,p0.xy-ball.xy)<-0.5) {            \n            if(zBall.x<11.5  && int(zBall.x)==i  ) p =pMouse;\n            if(zBall.z<11.5  && int(zBall.z)==i  ) p =pMouse;\n        } */\n        \n        //player movement \n        float move =.0035; \n        if( (texelFetch(iChannel3,ivec2(69,2),0).x>0.) && i>11) move*=.1; ;\n        p = p0.xy+  normalize(p-p0.xy)*move * min(length(p-p0.xy)*50.,1.); \n        \n        //players collisions        \n        vec4 zP=texelFetch(iChannel1,ivec2(coord(p)),0);\n        vec2 p1 =texelFetch(iChannel0,ivec2(zP.z,0),0).xy;\n        if(int(zP.z)!=i && length(p-p1)<.02) {\n            \n             p +=  normalize(p-p1)*.0035; \n        }         \n        \n        //players remain inside field\n        float run= length(p-p0.xy);\n        O = vec4(p ,run<.001? atan(-p.y+ball.y,-p.x+ball.x): atan(p.y-p0.y,p.x-p0.x),p0.w+length(p-p0.xy));\n    }\n}","name":"Buffer A","description":"","type":"buffer"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"XsXGR8","channel":0}],"code":"//BUFFER B: \n// x= closest player for each position, y=distance\n// z= closest player for the other team, w=distance\n\nvoid mainImage( out vec4 O, in vec2 U )\n{\n    O = vec4(0,1e5,0,1e5);\n    vec2 uv =  position(U);\n    vec4 ball=  texelFetch(iChannel0,ivec2(0),0);\n    \n    for(int i=1;i<=22;i++)\n    {\n        vec2 p=  texelFetch(iChannel0,ivec2(i,0),0).xy;\n        float  d_fin=  length(p-uv); //final position\n        \n        if(i<12 && d_fin<O.y)  O.xy =vec2(i,d_fin);              \n        if(i>=12 && d_fin<O.w)O.zw=vec2(i,d_fin);              \n\n    }\n    for(int i=1;i<=22;i++)\n    {\n        vec2 p=  texelFetch(iChannel0,ivec2(i,0),0).xy;\n        //TODO: implement ball marching instead of approximation\n        float d_int=  sdSegment(p,ball.xy,uv)+.03- length(ball.xy-p)*.15; //interception distance \n        if(i<12 && d_int<0.) O.w=1e5;\n        if(i>=12 && d_int<0.) O.y=1e5;\n\n    }   \n    if(O.w<O.y) O= O.zwxy;\n    \n    \n    \n}","name":"Buffer B","description":"","type":"buffer"},{"inputs":[],"outputs":[],"code":"#define R iResolution\n#define PC vec2(.95,.52) //pitch size \n#define F_START 180 //waiting time before kick off\n#define tk .006 //line thickness\n//#define DEBUG\n#define CORNERS 2 //0=disabled, 2= enable corners & throw-ins\n\nfloat sdBox( in vec2 p, in vec2 b )\n{\n    vec2 d = abs(p)-b;\n    return length(max(d,0.0))  + min(max(d.x,d.y),0.0);\n}\n\nfloat sdSegment( in vec2 p, in vec2 a, in vec2 b )\n{\n    vec2 pa = p-a, ba = b-a;\n    float h = clamp( dot(pa,ba)/dot(ba,ba), 0.0, 1.0 );\n    return length( pa - ba*h );\n}\n\n// from https://www.shadertoy.com/view/3tyfzV\nvoid drawChar(sampler2D ch, inout vec3 color, in vec3 charColor, in vec2 p, in vec2 pos, in vec2 size, in int char) {\n    p = (p - pos) / size + 0.5;\n    if (all(lessThan(abs(p - 0.5), vec2(0.5)))) {\n        float val = textureGrad(ch, p / 16.0 + fract(vec2(char, 15 - char / 16) / 16.0), dFdx(p / 16.0), dFdy(p / 16.0)).r;\n        color = mix(color, charColor, val);\n    }\n}\n\n#define coord(p) (p*min(R.y/PC.y/2.,R.x/PC.x/2.)/1.05 + R.xy*.5)\n#define position(U) ((U - R.xy*.5) /min(R.y/PC.y/2.,R.x/PC.x/2.)*1.05)\n\n#define score(s,p,b,d) s*( b.x)*(.03+  smoothstep(.05,.2,abs( d.w-d.y))*2.)*smoothstep(PC.y*.95,PC.y*.6,abs(p.y))\n                     ","name":"Common","description":"","type":"common"}]}