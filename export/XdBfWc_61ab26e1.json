{"ver":"0.1","info":{"id":"XdBfWc","date":"1502392744","viewed":149,"name":"ESM","username":"steverock","description":"fdsa","likes":0,"published":1,"flags":0,"usePreview":0,"tags":["shadow"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// Trying out ESM using float->vec4 encoding:\n// https://stackoverflow.com/questions/7059962/how-do-i-convert-a-vec4-rgba-value-to-a-float/7237286#7237286\n\nvec4 encode32(float f) {\n    float e =5.0;\n\n    float F = abs(f); \n    float Sign = step(0.0,-f);\n    float Exponent = floor(log2(F)); \n    float Mantissa = (exp2(- Exponent) * F);\n    Exponent = floor(log2(F) + 127.0) + floor(log2(Mantissa));\n    vec4 rgba;\n    rgba[0] = 128.0 * Sign  + floor(Exponent*exp2(-1.0));\n    rgba[1] = 128.0 * mod(Exponent,2.0) + mod(floor(Mantissa*128.0),128.0);  \n    rgba[2] = floor(mod(floor(Mantissa*exp2(23.0 -8.0)),exp2(8.0)));\n    rgba[3] = floor(exp2(23.0)*mod(Mantissa,exp2(-15.0)));\n    return rgba / 255.0;\n}\n\nfloat decode32(vec4 rgba) {\n    rgba *= 255.0;\n    float Sign = 1.0 - step(128.0,rgba[0])*2.0;\n    float Exponent = 2.0 * mod(rgba[0],128.0) + step(128.0,rgba[1]) - 127.0; \n    float Mantissa = mod(rgba[1],128.0)*65536.0 + rgba[2]*256.0 +rgba[3] + float(0x800000);\n    float Result =  Sign * exp2(Exponent) * (Mantissa * exp2(-23.0 )); \n    return Result;\n}\n\nfloat C = 70.0;\n\nfloat sat(float x) {\n    return min(1.0, max(0.0, x));\n}\nvec4 sat4(vec4 v) {\n    return vec4(sat(v.r), sat(v.g), sat(v.b), sat(v.a));\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 uv = fragCoord.xy / iResolution.xy;\n    float z = uv.y + sin(uv.x*iTime*6.2/10.0 + iTime*10.0)*0.005;\n    float d = uv.x;\n    float blockerExp = exp(C*z);\n    \n    // simulate being written to RGBA and back.\n    blockerExp = decode32(sat4(encode32(blockerExp)));\n    \n    float fragExp = exp(-C*d);\n    float r = blockerExp * fragExp;\n\tfragColor = vec4(r, r, r, 1.0);\n}","name":"Image","description":"","type":"image"}]}