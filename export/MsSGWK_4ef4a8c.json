{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[{"channel":0,"type":"cubemap","id":"4dX3zn","filepath":"/media/a/550a8cce1bf403869fde66dddf6028dd171f1852f4a704a465e1b80d23955663.png","sampler":{"filter":"mipmap","wrap":"clamp","vflip":"false","srgb":"false","internal":"byte"}},{"channel":1,"type":"texture","id":"XdX3Rn","filepath":"/media/a/52d2a8f514c4fd2d9866587f4d7b2a5bfa1a11a0e772077d7682deb8b3b517e5.jpg","sampler":{"filter":"mipmap","wrap":"repeat","vflip":"false","srgb":"false","internal":"byte"}},{"channel":2,"type":"texture","id":"XdXGzr","filepath":"/media/a/8979352a182bde7c3c651ba2b2f4e0615de819585cc37b7175bcefbca15a6683.jpg","sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"}}],"code":"float rand(vec2 n) { return 0.5 + 0.5 * fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453); }\n\nfloat water(vec3 p) {\n\tfloat t = iTime / 3.;\n\tp.z += t * 2.; p.x += t * 2.;\n\tvec3 c1 = texture(iChannel2, p.xz / 30.).xyz;\n\tp.z += t * 3.; p.x += t * 0.52;\n\tvec3 c2 = texture(iChannel2, p.xz / 30.).xyz;\n\tp.z += t * 4.; p.x += t * 0.8;\n\tvec3 c3 = texture(iChannel2, p.xz / 30.).xyz;\n\tc1 += c2 - c3;\n\tfloat z = (c1.x + c1.y + c1.z) / 3.;\n\treturn p.y + z / 4.;\n}\n\n\nfloat map(vec3 p) {\n\tfloat d = 100.0;\n\td = water(p);\n\treturn d;\n}\n\nfloat intersect(vec3 ro, vec3 rd) {\n\tfloat d = 0.0;\n\tfor (int i = 0; i <= 100; i++) {\n\t\tfloat h = map(ro + rd * d);\n\t\tif (h < 0.1) return  d;\n\t\td += h;\n\t}\n\treturn 0.0;\n}\n\nvec3 norm(vec3 p) {\n\tfloat eps = .1;\n\treturn normalize(vec3(\n\t\tmap(p + vec3(eps, 0, 0)) - map(p + vec3(-eps, 0, 0)),\n\t\tmap(p + vec3(0, eps, 0)) - map(p + vec3(0, -eps, 0)),\n\t\tmap(p + vec3(0, 0, eps)) - map(p + vec3(0, 0, -eps))\n\t));\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n\tvec2 uv = fragCoord.xy / iResolution.xy - 0.5;\n\tuv.x *= iResolution.x / iResolution.y;\n\tvec3 l1 = normalize(vec3(1, 1, 1));\n\tvec3 ro = vec3(-3, 7, -5);\n\tvec3 rc = vec3(0, 0, 0);\n\tvec3 ww = normalize(rc - ro);\n\tvec3 uu = normalize(cross(vec3(0,1,0), ww));\n\tvec3 vv = normalize(cross(rc - ro, uu));\n\tvec3 rd = normalize(uu * uv.x + vv * uv.y + ww);\n\tfloat d = intersect(ro, rd);\n\tvec3 c = vec3(0.0);\n\tif (d > 0.0) {\n\t\tvec3 p = ro + rd * d;\n\t\tvec3 n = norm(p);\n\t\tfloat spc = pow(max(0.0, dot(reflect(l1, n), rd)), 30.0);\n\t\tvec4 ref = texture(iChannel0, normalize(reflect(rd, n)));\n\t\tvec3 rfa = texture(iChannel1, (p+n).xz / 6.0).xyz * (8./d);\n\t\tc = rfa.xyz + (ref.xyz * 0.5)+ spc;\n\t}\n\tfragColor = vec4((c - 0.5) * 1.1 + 0.5, 1.0 );\n}","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"MsSGWK","date":"1393520141","viewed":16493,"name":"A river","username":"Pierco","description":"Just a river. Splamer's version is much more interesting: https://www.shadertoy.com/view/WsByzd","likes":133,"published":1,"flags":0,"usePreview":0,"tags":["raymarching"],"hasliked":0,"parentid":"","parentname":""}}