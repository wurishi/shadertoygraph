{"ver":"0.1","info":{"id":"ftcfz2","date":"1663333046","viewed":65,"name":"Trying raymarching","username":"MrSprinkle","description":"Tried raymarching, I'm still pretty new to graphics programming but I think I am understanding it!","likes":0,"published":1,"flags":0,"usePreview":0,"tags":["raymarching"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// https://iquilezles.org/articles/distfunctions/\nfloat sdSphere(vec3 p, float r)\n{\n    return length(p) - r;\n}\nfloat sdBox( vec3 p, vec3 b )\n{\n  vec3 q = abs(p) - b;\n  return length(max(q,0.0)) + min(max(q.x,max(q.y,q.z)),0.0);\n}\nfloat sdScene(vec3 p)\n{\n    float d = sdBox(p + vec3(0.0, 1.0, 0.0), vec3(2.0, 0.1, 2.0));\n    d = min(d, sdSphere(p, 1.0));\n    return d;\n}\n\n// https://iquilezles.org/articles/normalsSDF/\nvec3 calcNormal(vec3 p) // for function f(p)\n{\n    const float h = 0.0001; // replace by an appropriate value\n    const vec2 k = vec2(1,-1);\n    return normalize( k.xyy*sdScene( p + k.xyy*h ) + \n                      k.yyx*sdScene( p + k.yyx*h ) + \n                      k.yxy*sdScene( p + k.yxy*h ) + \n                      k.xxx*sdScene( p + k.xxx*h ) );\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord / iResolution.xy * 2.0 - 1.0;\n    float aspect = iResolution.x / iResolution.y;\n    float fov = 70.0;\n    \n    vec3 origin = vec3(sin(iTime), 0.0, 4.0);\n    vec3 dir = normalize(vec3(uv.x * tan(fov / 2.0 * 3.1415 / 180.0) * aspect, uv.y * tan(fov / 2.0 * 3.1415 / 180.0), -1.0));\n    \n    bool hit = false;\n    float depth = 0.0;\n    for (int i = 0; i < 128; i++) {\n        float dist = sdScene(origin + dir * depth);\n        if (dist <= 0.001 && dist > 0.0) {\n            hit = true;\n            break;\n        }\n        depth += dist;\n    }\n\n    // Output to screen\n    if (hit) {\n        fragColor = vec4(calcNormal(origin + dir * depth), 1.0);\n    } else {\n        fragColor = vec4(0.0, 0.0, 0.0, 1.0);\n    }\n}","name":"Image","description":"","type":"image"}]}