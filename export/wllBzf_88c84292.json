{"ver":"0.1","info":{"id":"wllBzf","date":"1597377581","viewed":117,"name":"Fractal stadium","username":"gaz","description":"fractal","likes":9,"published":1,"flags":0,"usePreview":0,"tags":["fractal"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define PI acos(-1.0)\n#define pmod(p,n)length(p)*sin(vec2(0.,PI*.5)+mod(atan(p.y,p.x),PI*2./n)-PI/n)\n#define fold45(p)(p.y>p.x)?p.yx:p\n#define rot(p,a)p*cos(a)+vec2(-p.y,p.x)*sin(a)\n\nfloat orbit;\nfloat map(vec3 p)\n{\n    float scale=3.;\n    vec3 off=vec3(10,1.,.2);\n\tfloat s=2.,de;\n    orbit=0.;\n\tfor(int i=0;++i<9;)\n\t{\n\t    p.xz=pmod(p.xz,5.);\n        p.z-=.7;\n        p.xz=abs(p.xz);\n\t\tp.xz=fold45(p.xz);\n\t\tp.z=1.-abs(p.z-1.);\n\t\t//p.z=abs(p.z-1.)-1;\n\t\tp.xy=fold45(p.xy);\n\t\tp-=off;\n\t\tp*=scale;\n\t\tp+=off;\n\t\ts*=scale;\n        de=length(p)/s-.002;\n        if(de<0.001)break;\n        orbit++;\n\t}\n\treturn de;\n}\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 uv=(2.*fragCoord-iResolution.xy)/iResolution.y;\n\tvec3 p;\n  \tvec3 ro=vec3(0,5,-1.+12.*fract(iTime*.1));\n  \tvec3 w=normalize(vec3(0,.1,-1));\n  \tvec3 u=normalize(cross(w,vec3(0,1,0)));\n  \tvec3 rd=mat3(u,cross(u,w),w)*normalize(vec3(uv,2));\n\tfloat h=0.,d,i;\n\tfor(i=1.;i<100.;i++)\n    {\n    \tp=ro+rd*h;\n        p.xz=rot(p.xz,iTime*.2);\n\t\td=map(p);\n    \tif(d<.0001||h>50.)break;\n    \th+=d;\n\t}\n    fragColor.xyz=25.*vec3(cos(vec3(.2,.8,.7)*orbit)+(cos(p.xyy)*.5+.5))/i;\n}\n","name":"Image","description":"","type":"image"}]}