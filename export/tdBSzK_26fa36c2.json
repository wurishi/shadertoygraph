{"ver":"0.1","info":{"id":"tdBSzK","date":"1554408641","viewed":379,"name":"Colorful Voxels","username":"scratch13764","description":"Wayyy to lazy to clean this up at the moment.","likes":16,"published":1,"flags":0,"usePreview":0,"tags":["voxel","dda","branchless"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4sfGRr","filepath":"/media/a/27012b4eadd0c3ce12498b867058e4f717ce79e10a99568cca461682d84a4b04.bin","previewfilepath":"/media/ap/27012b4eadd0c3ce12498b867058e4f717ce79e10a99568cca461682d84a4b04.bin","type":"volume","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XdX3Rr","filepath":"/media/a/aea6b99da1d53055107966b59ac5444fc8bc7b3ce2d0bbb6a4a3cbae1d97f3aa.bin","previewfilepath":"/media/ap/aea6b99da1d53055107966b59ac5444fc8bc7b3ce2d0bbb6a4a3cbae1d97f3aa.bin","type":"volume","channel":1,"sampler":{"filter":"nearest","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"vec3 minVec3 (vec3 a)\n{\n    return vec3(step(a.x, min(a.y, a.z)),\n                step(a.y, min(a.x, a.z)), \n                step(a.z, min(a.x, a.y)));\n}\n\nbool voxel(vec3 p)\n{\n    return (texture(iChannel0, p/300.).r >= .7);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // Normalized pixel coordinates (from 0 to 1)\n    vec2 uv = (fragCoord - iResolution.xy * .5) / iResolution.y;\n    \n    vec3 ro = vec3(iTime);\n    vec3 rs = normalize(vec3(uv, 1));\n    rs.xz *= mat2(cos(iTime/5.),-sin(iTime/5.),sin(iTime/5.),cos(iTime/5.));\n    vec3 r;\n    float d = 1.;\n    \n    vec3 pos = round(ro + rs*d);\n    vec3 near;\n    vec3 nearDist;\n    vec3 realDist;\n    vec3 signRs = sign(rs);\n    vec3 distMult = abs(1./rs);\n    \n    vec3 light = normalize(vec3(-1,1,2));\n    \n    vec3 col;\n    \n    for (int i = 0; i <= 135; i++)\n    {\n        r = ro + rs*d;\n        if (voxel(pos))\n        {\n            col = texture(iChannel1, pos/32.).rgb;\n            col *= 1./length(r-pos);\n            fragColor.rgb = mix(vec3(.25), col, \n                                pow(sin(length(pos)/5.+iTime)*.5+.5, 4.));\n            col -= d/250.;\n            break;\n        }\n        near = pos + .5*signRs;\n        nearDist = abs(near-r);\n        realDist = nearDist*distMult;\n        d += min(min(realDist.x, realDist.y), realDist.z);\n        pos += signRs * minVec3(realDist);\n    }\n    \n    fragColor *= 1.+dot(signRs*minVec3(realDist), light)*.25;\n    fragColor *= 1.+pow(max(dot(reflect(rs, -signRs*minVec3(realDist)), light), 0.), 150.);\n}","name":"Image","description":"","type":"image"}]}