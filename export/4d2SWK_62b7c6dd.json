{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[],"code":"// Created by Eduardo Castineyra - casty/2015\n// Creative Commons Attribution 4.0 International License\n\nmat4 iM = mat4(vec4(0.0,1.0,2.0,3.0), \n               vec4(4.0,5.0,6.0,7.0), \n               vec4(8.0,9.0,10.0,11.0), \n               vec4(12.0,13.0,14.0,15.0));\nmat4 oneM = mat4(vec4(1.0), vec4(1.0), vec4(1.0), vec4(1.0));\n    \nmat4 example;\n\nvoid fillExample(){\n    for (int i = 0; i < 16; i++)\n        example[int(float(i)/4.0)][int(mod(float(i),4.0))] = sin(3.14 * float(i) / 16.0);\n\t}\n\nmat4 getIndexingMat(float idx){\n    mat4 m = iM - oneM * idx;\n    m = mat4(abs(sign(m[0])), abs(sign(m[1])) ,abs(sign(m[2])), abs(sign(m[3])));\n    return (oneM - m);\n\t}\n\nfloat getValue(mat4 array, float idx){\n    mat4 m = matrixCompMult(getIndexingMat(idx), array);   \n    return length(m * vec4(1.0));\n\t}\n\nvoid setValue(inout mat4 array, float idx, float value){\n\tmat4 m = getIndexingMat(idx);\n\tmat4 ma = matrixCompMult(m, array);\n\tarray -= ma;\n\tarray += m * value;\n\t}\n\nvoid fillExampleUsingSetIndex(int modNumber){    \n    for (int i = 0; i < 16; i++)\n        setValue(example, mod(float(i + modNumber), 16.0), sin(3.14 * float(i) / 16.0));\n\t}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 uv = fragCoord.xy / iResolution.xy;\n    fillExampleUsingSetIndex(int(floor(uv.x*52345.0)));\n    \n\tfragColor = vec4(vec2(0.0),getValue(example,mod(floor(iTime * 2.0), 16.0)),1.0);\n}","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"4d2SWK","date":"1416010643","viewed":1451,"name":"dynamically indexing arrays","username":"casty","description":"cheap (not costless) way to index 16 float arrays. Matrices can also be filled sequentially.","likes":4,"published":1,"flags":0,"usePreview":0,"tags":["array","matrix","indexing"],"hasliked":0,"parentid":"","parentname":""}}