{"ver":"0.1","info":{"id":"Xf2czh","date":"1721912238","viewed":78,"name":"nanikano_livecoding","username":"FoRenard","description":"asdasd","likes":10,"published":1,"flags":32,"usePreview":0,"tags":["livecoding"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void mainImage(out vec4 o,in vec2 c){o=texelFetch(iChannel0,ivec2(c),0);}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"#define fGlobalTime iTime\n#define v2Resolution vec2(iResolution.xy)\n#define texPreviousFrame iChannel0\n\n#define backbuffer texPreviousFrame\n#define sat(x) clamp(x,.0,1.)\n#define norm(x) normalize(x)\n#define rep(i,n) for(int i=0;i<n;i++)\n#define sc(x) hash(vec3(1.4,x,bt))\n#define nsc(x) hash(vec3(1.4,x,bt+1))\n#define uvq(u,q) vec2 ruv=(u)*(q),fuv=fract(ruv),iuv=floor(ruv),quv=(iuv+.5)/(q);\nconst float pi=acos(-1.),tau=2.*pi;\nvec3 hash(vec3 x){uvec3 v=floatBitsToUint(x);v=v*20240413u+1212121212u;v.x+=v.y*v.z;v.y+=v.z*v.x;v.z+=v.x*v.y;v^=v>>16u;v.x+=v.y*v.z;v.y+=v.z*v.x;v.z+=v.x*v.y;return vec3(v)/float(-1u);}\nmat2 rot(float a){float s=sin(a),c=cos(a);return mat2(c,s,-s,c);}\nvec3 erot(vec3 p, vec3 ax, float ro) { return mix(dot(ax, p)*ax,p,cos(ro))+cross(ax,p)*sin(ro);}\nmat3 bnt(vec3 T){T=norm(T);vec3 N=vec3(0,1,0);vec3 B=norm(cross(N,T));N=norm(cross(T,B));return mat3(B,N,T);}\nvec3 cyc(vec3 p,float f){vec4 n=vec4(0);mat3 b=bnt(vec3(1,2,3));rep(i,8){p+=sin(p.yzx);n+=vec4(cross(cos(p),sin(p.zxy)),1);p*=b*f;}return n.xyz/n.w;}\nfloat alt,lt,atr,tr;int bt;vec2 fc,res,asp,asp2;\n\nvec3 ch(vec2 suv,float s)\n{\n  suv.y+=alt*mix(-.5,.5,hash(floor(suv*5.).xxx).x);\n  vec2 g=floor(suv*7.*5.),i=mod(g,7.);\n  vec2 o=fract(i*.5)*2.;\n  float c=max(o.x,o.y)*step(hash(vec3(g,float(bt)+s)).x,.5)+min(o.x,o.y);\n  c*=i.x*(6.-i.x)*i.y*(6.-i.y);\n  vec3 h=hash(vec3(floor(g/7.),s+float(bt)));\n  return (h.x<.1?vec3(0,0,1):h.x<.5?vec3(1):vec3(0))*sat(c);\n}\nvec3 s0(vec2 suv)\n{\n  vec3 c=vec3(0);\n  vec3 rp,rd,ro,dir;\n  float z,l;\n  z=1.-length(suv)*.2;\n  ro=cyc(vec3(1,2,alt*.1),1.2);\n  rd=norm(vec3(suv,z));\n  rep(i,3)\n  {\n    float l=float(i)+1.-ro.z;\n    vec3 ch=ch(rd.xy/rd.z*l,float(i));\n    if(.0<length(ch)){c=ch*exp(-l*.1);break;}\n  }\n  return c;\n}\nvec3 s1(vec2 suv)\n{\n  vec3 h0=sc(0)*20.-10.,h1=sc(1),h2=sc(2);\n  suv*=h1.x<.2?suv.xx:h1.x<.4?suv.yy:vec2(1);\n  return sat(sin(dot(h0.xy,suv)-alt*h0.z+h2*tau));\n}\nvec3 s2(vec2 suv)\n{\n  ivec2 i=ivec2(fc/4.+res);\n  vec3 h=hash(vec3(floor(alt*4.),1,2));\n  return vec3(1)*float((i.x^i.y)%int(mix(64.,128.,h.x))%int(mix(16.,32.,h.y))<6);\n}\n\nfloat sdf(vec3 p)\n{\n  rep(i,3)\n  {\n    p=abs(p)-sc(1.2);\n    p=erot(p,norm(mix(sc(-1),nsc(-1),tr)),pi+length(p));\n  }\n  return (length(p.xz)-.3)*.5;\n}\nvec3 s3(vec2 suv)\n{\n  if(sc(-1.2).x<.5)suv.x=abs(suv.x);\n  vec3 c=vec3(0);\n  vec3 rp,rd,ro,dir;\n  float z,l=0.,d;\n  z=1.-length(suv)*.2;\n  ro=norm(sc(2)*2.-1.)*5.;\n  ro=erot(ro,norm(sc(3)*2.-1.),tr);\n  dir=-ro;\n  rd=bnt(dir)*norm(vec3(suv,z));\n  rep(i,99)\n  {\n    rp=rd*l+ro;\n    l+=d=sdf(rp);\n  }\n  vec3 n=norm(cross(dFdy(rp),dFdx(rp)));\n  return sat(cyc(n,1.2).xxx*4.*exp(-l*.1));\n}\nvec3 s4(vec2 suv)\n{\n  suv=abs(suv)-alt*.1;\n  return step(fract(cyc(vec3(suv,alt*.1),1.5).x*6.),.5)*vec3(1,0,0);\n}\nvec4 main_livecoidng()\n{\n  lt=alt=2.*134./60.*fGlobalTime,tr=atr=fract(lt),bt=int(lt);tr=1.-exp(-tr*3.);lt=float(bt)+tr;\n  fc=gl_FragCoord.xy,res=v2Resolution,asp=res/min(res.x,res.y),asp2=res/max(res.x,res.y);\n  vec2 uv=fc/res,suv=(uv*2.-1.)*asp;\n\tvec3 col=vec3(0);\n  vec2 h=mix(vec2(0),vec2(.5),sc(-1).xy),h2=mix(vec2(.3),vec2(.7),sc(-2).xy);\n  vec3 hh=sc(-1.4);\n  float sa=mix(.99,1.01,hh.x);\n  vec2 sf=mix(-vec2(.01),vec2(.01),(floor(hh.yz*3.)+.5)/3.);\n  uv=(uv-.5)*sa+.5+sf;\n  if(uv!=clamp(uv,h,h+h2)&&bt%8!=0)\n  //if(uv!=clamp(uv,h,h+h2))\n  {\n    return texture(backbuffer,uv);\n  }\n  \n  //float m=sc(.1).x;\n  float m=(float(bt%5)+.5)/5.;\n  if(m<.2){\n    col+=s0(suv);\n  }\n  else if(m<.4)\n  {\n    col+=s1(suv);\n  }\n  else if(m<.6)\n  {\n    col+=s2(suv);\n  }\n  else if(m<.8)\n  {\n    col+=s3(suv);\n  }\n  else\n  {\n    col+=s4(suv);\n  }\n  \n  vec3 b=vec3(0);\n  vec2 buv=uv;\n  rep(i,16)\n  {\n    float f=(float(i)+.5)/16.;\n    b+=texture(backbuffer,buv+=cyc(vec3(buv,alt*.1),1.2).xy*.1/16.).rgb*(.5+.5*cos(tau*(f+vec3(0,1,2)/3.)))*2./16.;\n  }\n  float ema=.0;\n  col=mix(col,b,ema);\n  return vec4(col,1);\n}\nvoid mainImage(out vec4 o,in vec2 c){o=main_livecoidng();}","name":"Buffer A","description":"","type":"buffer"}]}