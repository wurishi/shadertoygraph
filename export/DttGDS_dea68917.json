{"ver":"0.1","info":{"id":"DttGDS","date":"1683041198","viewed":64,"name":"Shiny Donutz","username":"svantana","description":"Attempt at the simplest possible \"non-trivial\" phong-shaded example. Use mouse to control the light source.","likes":5,"published":1,"flags":0,"usePreview":0,"tags":["phong"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define PI 3.14159265359\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord)\n{\n    vec2 uv = ((fragCoord-.5*iResolution.xy)/iResolution.x) * 4.0 + iTime * vec2(.0,.5);\n    vec2 dMouse = (iMouse.xy - fragCoord.xy) / iResolution.x;\n        \n    vec2 r = vec2(1.0,1.73);\n    vec2 h = r*.5;\n    vec2 gv1 = mod(uv  , r) - h;\n    vec2 gv2 = mod(uv+h, r) - h;\n    vec2 gv = dot(gv1,gv1) < dot(gv2,gv2) ? gv1 : gv2;\n    vec2 id = uv-gv;\n    gv *= 2.0;\n    \n    float a = mod(atan(gv.y, gv.x), 2.*PI);\n    float sc = mod(floor((a + PI/6.0) / (PI/1.5)), 3.);\n    float ca = sc*PI/1.5 +PI/6.0;\n    vec2 bv = gv - vec2(cos(ca), sin(ca))*1.15;\n    \n    float cd = distance(bv, vec2(0));\n    float width = .3;\n    float mask = max(0.0, smoothstep(.6+width+.01, .6+width, cd) - smoothstep(.6-width, .6-width-.01, cd));\n\n    vec2 D = normalize(bv);\n    vec3 normal = normalize(vec3((cd-.577)/width*2. * D, 1.0));\n\n    float dist = distance(dMouse, vec2(0));\n    vec3 col = mask * normal * 0.8 + 0.5 / (1.0 + 30.0 * dist*dist);\n    \n    //specular\n    vec3 lightPos = vec3(dMouse, 0.04);\n    float spec0 = max(0.0, reflect(-normalize(lightPos), normal).z);\n    col += mask * pow(spec0, 20.0);\n\n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}