{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[{"channel":0,"type":"texture","id":"Xsf3zn","filepath":"/media/a/f735bee5b64ef98879dc618b016ecf7939a5756040c2cde21ccb15e69a6e1cfb.png","sampler":{"filter":"mipmap","wrap":"repeat","vflip":"false","srgb":"false","internal":"byte"}}],"code":"// Created by Hazel Quantock - 2013\n// License Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License.\n\nvec2 glFragCoord;\n\nfloat noise( in vec3 x )\n{\n    vec3 p = floor(x);\n    vec3 f = fract(x);\n\tf = f*f*(3.0-2.0*f);\n\t\n\t// there's an artefact because the y channel almost, but not exactly, matches the r channel shifted (37,17)\n\t// this artefact doesn't seem to show up in chrome, so I suspect firefox uses different texture compression.\n\tvec2 uv = (p.xy+vec2(37.0,17.0)*p.z) + f.xy;\n\tvec2 rg = textureLod( iChannel0, (uv+ 0.5)/256.0, 0.0 ).yx;\n\treturn mix( rg.x, rg.y, f.z );\n}\n\nvec4 map( vec3 p )\n{\n\tfloat den = -1.0 - (abs(p.y-0.5)+0.5)/2.0;\n\n    // clouds\n\tfloat f;\n\tvec3 q = p*.5                          - vec3(0.0,0.0,1.5)*iTime + vec3(sin(0.7*iTime),0,0);\n    f  = 0.50000*noise( q ); q = q*2.02 - vec3(0.0,0.0,0.0)*iTime;\n    f += 0.25000*noise( q ); q = q*2.03 - vec3(0.0,0.0,0.0)*iTime;\n    f += 0.12500*noise( q ); q = q*2.01 - vec3(0.0,0.0,0.0)*iTime;\n    f += 0.06250*noise( q ); q = q*2.02 - vec3(0.0,0.0,0.0)*iTime;\n    f += 0.03125*noise( q );\n\n\tden = clamp( den + 4.0*f, 0.0, 1.0 );\n\t\n\tvec3 col = mix( vec3(1.0, 1.0, 1.0), vec3(0.6,0.5,0.4), den*.5 );// + 0.05*sin(p);\n\t\n\treturn vec4( col, den*.7 );\n}\n\nconst vec3 sunDir = vec3(-1,.2,-1);\n\nfloat testshadow( vec3 p, float dither )\n{\n\tfloat shadow = 1.0;\n\tfloat s = 0.0; // this causes a problem in chrome: .05*dither;\n\tfor ( int j=0; j < 5; j++ )\n\t{\n\t\tvec3 shadpos = p + s*sunDir;\n\t\tshadow = shadow - map(shadpos).a*shadow;\n\t\t\n\t\ts += .05;\n\t}\n\treturn shadow;\n}\n\nvec3 raymarch( in vec3 ro, in vec3 rd )\n{\n\tvec4 sum = vec4( 0 );\n\t\n\tfloat t = 0.0;\n\n    // dithering\t\n\tfloat dither = texture( iChannel0, glFragCoord.xy/iChannelResolution[0].x ).x;\n\tt += 0.1*dither;\n\t\n\tfor( int i=0; i<65; i++ )\n\t{\n\t\tif( sum.a > 0.99 ) continue;\n\t\t\n\t\tvec3 pos = ro + (t+.2*t*t)*rd;\n\t\tvec4 col = map( pos );\n\n\t\tfloat shadow = testshadow(pos, dither);\n\t\tcol.xyz *= mix( vec3(0.4,0.47,0.6), vec3(1.0,1.0,1.0), shadow );\n\t\t\n\t\tcol.rgb *= col.a;\n\n\t\tsum = sum + col*(1.0 - sum.a);\t\n\n\t\tt += 0.1;\n\t}\n\n\tvec4 bg = mix( vec4(.3,.4,.5,0), vec4(.5,.7,1,0), smoothstep(-.4,.0,rd.y) ); // sky/ocean\n\n\t/*// floor\n\tif ( rd.y < -.2 )\n\t{\n\t\tvec3 pos = ro + rd*(ro.y+1.0)/(-rd.y);\n\t\t\n\t\tfloat shadow = testshadow(pos+sunDir/sunDir.y, dither);\n\t\tbg.xyz = mix( vec3(0), vec3(.5), shadow*.8+.2 );\n\t}*/\n\n\tsum += bg*(1.0 - sum.a);\n\t\n\treturn clamp( sum.xyz, 0.0, 1.0 );\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    glFragCoord = fragCoord;\n    \n\tvec2 q = fragCoord.xy / iResolution.xy;\n    vec2 p = -1.0 + 2.0*q;\n    p.x *= iResolution.x/ iResolution.y;\n\t\n    vec2 mo = iMouse.xy / iResolution.xy;\n    if( iMouse.w<=0.00001 ) mo=vec2(0.5);\n\t\n    // camera\n    vec3 ro = 6.0*normalize(vec3(cos(3.0*mo.x+.0), 1.0 - 1.0*(mo.y+.0), sin(3.0*mo.x+.0)));\n\tvec3 ta = vec3(0.0, 1.0, 0.0);\n\tfloat cr = 0.15*cos(0.7*iTime);\n\t\n    // shake\t\t\n\tro += 0.02*(-1.0+2.0*texture( iChannel0, iTime*vec2(0.010,0.014) ).xyz);\n\tta += 0.02*(-1.0+2.0*texture( iChannel0, iTime*vec2(0.013,0.008) ).xyz);\n\t\n\t// build ray\n    vec3 ww = normalize( ta - ro);\n    vec3 uu = normalize(cross( vec3(sin(cr),cos(cr),0.0), ww ));\n    vec3 vv = normalize(cross(ww,uu));\n    vec3 rd = normalize( p.x*uu + p.y*vv + 2.0*ww );\n\t\n    // raymarch\t\n\tvec3 col = raymarch( ro, rd );\n\t\n\t// contrast and vignetting\t\n\tcol = col*0.5 + 0.5*col*col*(3.0-2.0*col);\n\tcol *= 0.25 + 0.75*pow( 16.0*q.x*q.y*(1.0-q.x)*(1.0-q.y), 0.1 );\n\t\n    fragColor = vec4( col, 1.0 );\n}\n","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"lssGRX","date":"1376319769","viewed":4759,"name":"TekF Clouds","username":"TekF","description":"Based on Inigo Quilez's Hell. https://www.shadertoy.com/view/MdfGRX","likes":91,"published":1,"flags":0,"usePreview":1,"tags":["procedural","clouds"],"hasliked":0,"parentid":"","parentname":""}}