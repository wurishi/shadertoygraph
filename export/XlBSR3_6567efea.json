{"ver":"0.1","info":{"id":"XlBSR3","date":"1445190243","viewed":258,"name":"Pincusion Distortion","username":"zazabe","description":"pincusion distortion correction","likes":5,"published":1,"flags":0,"usePreview":0,"tags":["oculusrift","vr"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"Xdf3zn","filepath":"/media/a/85a6d68622b36995ccb98a89bbb119edf167c914660e4450d313de049320005c.png","previewfilepath":"/media/ap/85a6d68622b36995ccb98a89bbb119edf167c914660e4450d313de049320005c.png","type":"texture","channel":0,"sampler":{"filter":"nearest","wrap":"repeat","vflip":"false","srgb":"false","internal":"byte"},"published":1}],"outputs":[],"code":"vec2 distortion = vec2(0.441, 0.156);\nvec2 leftCenter = vec2(0.5, 0.5);\nvec2 rightCenter = vec2(0.5, 0.5);\nvec4 background = vec4(0.0, 0.0, 0.0, 1.0);\n\nfloat poly(float val) {\n  return 1.0 + (distortion.x + distortion.y * val) * val;\n}\n\nvec2 barrel(vec2 v, vec2 center) {\n  vec2 w = v - center;\n  return poly(dot(w, w)) * w + center;\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord ) \n{\n\n  vec2 vUV = fragCoord.xy / iResolution.xy;\n    \n    \n  bool isLeft = (vUV.x < 0.5);\n  float offset = isLeft ? 0.0 : 0.5;\n  vec2 a = barrel(vec2((vUV.x - offset) / 0.5, vUV.y), isLeft ? leftCenter : rightCenter);\n  if (a.x < 0.0 || a.x > 1.0 || a.y < 0.0 || a.y > 1.0) {\n      fragColor = background;\n  } else {\n      fragColor = texture(iChannel0, vec2(a.x * 0.5 + offset, a.y));\n  }\n}\n","name":"","description":"","type":"image"}]}