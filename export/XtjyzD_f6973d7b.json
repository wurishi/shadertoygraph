{"ver":"0.1","info":{"id":"XtjyzD","date":"1507693011","viewed":278,"name":"Low bits","username":"dahart","description":"Show only the low N bits - a way to visualize SNR","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["noise","bits"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"Xdf3Rn","filepath":"/media/a/e81e818ac76a8983d746784b423178ee9f6cdcdf7f8e8d719341a6fe2d2ab303.webm","previewfilepath":"/media/ap/e81e818ac76a8983d746784b423178ee9f6cdcdf7f8e8d719341a6fe2d2ab303.webm","type":"video","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// Render only the low DST_BITS, discarding high bits\n// this is one way to check the SNR of an image\n// when the low bits are pure noise and no structure is visible,\n// then the high bits are signal.\n// For example, with the Britney video, some structure is visible when DST_BITS==3\n// but when DST_BITS==2, it's only noise and compression artifacts.\n// So there are (mostly) between 5-6 bits of signal, and 2-3 bits of noise.\n\n#define SRC_BITS 8\n#define DST_BITS 6 // adjust this\n#define SHIFT_BITS (SRC_BITS - DST_BITS)\n\n#define SRC_MAX   ((1 << SRC_BITS  ) - 1)\n#define DST_MAX   ((1 << DST_BITS  ) - 1)\n#define SHIFT_MAX ((1 << SHIFT_BITS) - 1)\n\nfloat lowbits(float src) {\n    int isrc = int(src * float(SRC_MAX));\n    int dst = (isrc & DST_MAX) << SHIFT_BITS;\n    return float(dst) / float(DST_MAX);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord.xy / iResolution.xy;\n\tvec4 color = texture(iChannel0, uv);\n\n    float r = lowbits(color.r);\n    float g = lowbits(color.g);\n    float b = lowbits(color.b);\n    \n    fragColor = vec4(r, g, b, 1.0);\n}\n","name":"Image","description":"","type":"image"}]}