{"ver":"0.1","info":{"id":"Nl2czy","date":"1650212064","viewed":749,"name":">((:[))<","username":"louis_C","description":"I wanted to test out the euclidean rhythms of 0b5vr  :)\nFrom this shader : https://www.shadertoy.com/view/7ljczz","likes":23,"published":1,"flags":40,"usePreview":0,"tags":["raymarching","audio"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"vec3 ov(vec3 base, vec3 blend) {\n    return mix((2.0*base*blend),(1.0-2.0*(1.0-base)*(1.0-blend)),step(vec3(0.5),base));}\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord/iResolution.xy;\n    vec2 u2 = (uv-0.5)*2.;\n    u2.x *= iResolution.x/iResolution.y;\n    vec4 t = clamp(texture(iChannel0,uv),0.,1.);\n    float bm = texture(iChannel0,vec2(0.9,0.5)).x;\n    vec3 t2 = ov(pow(vec3(texture(iChannel0,uv).a),vec3(bm+vec3(0.025,0.2,0.2))),\n    0.5*vec3(smoothstep(0.8,1.5,length(u2))))*smoothstep(0.5,1.5,length(u2));\n    fragColor = max(vec4(t2,0.)*clamp(iTime*0.25,0.,1.),t*step(uv.x,0.8));\n}","name":"Image","description":"","type":"image"},{"inputs":[],"outputs":[],"code":"vec2 hs2(vec2 t){return fract(sin(vec2(dot(t.x,45.125),dot(t.y,45.125)))*7845.236)-0.5;}\nfloat rd(float t){return fract(sin(dot(floor(t),45.125))*7845.236)-0.5;}\nfloat rdt(float t){return fract(sin(dot(floor(t),45.125))*7845.236);}\nvec2 rd2(vec2 t){return fract(sin(vec2(dot(floor(t.x),45.125),dot(floor(t.y),45.125)))*7845.236)-0.5;}\nfloat no(float t){ return mix(rd(t),rd(t+1.),smoothstep(0.,1.,fract(t)));}\nvec2 no2(vec2 t){ return mix(rd2(t),rd2(t+1.),smoothstep(0.,1.,fract(t)));}\nfloat it(float t){float r = 0.;float a = 0.5;for(int  i = 0 ; i <7 ; i++){\nr += no(t/a)*a;a *=0.5;} return r;}\nvec2 it2(vec2 t){vec2 r = vec2(0.);float a = 0.5;for(int  i = 0 ; i <5 ; i++){\nr += no2(t/a)*a;a *=0.5;} return r;}\nvec2 pa (float t,int nb,float f){vec2 r = vec2( 0.);\nfloat nbb = float(nb)-1.;\nfor(int  i = 1 ; i < nb ; i++){\nfloat it = pow(float(i)/nbb,0.2);\nvec2 bb = vec2(t+it*0.05,t+it*0.5);\nvec2 bb2 = vec2(t+it*0.05,t+it*0.1);\nvec2 bb3 = vec2(t+it*0.05,t+it*0.051);\nvec2 bm1 = pow(bb,vec2(it))*f*(1.-it);\nvec2 bm2 = pow(bb2,vec2(it))*f*(1.-it);\nvec2 bm3 = pow(bb3,vec2(it))*f*(1.-it);\nr += it2(pow(bm3,vec2(0.9)))+no2(pow(bm2,vec2(0.9)))*0.5+sin(bm1);\n}\nreturn (r/nbb);}\nfloat eu( float tp, float nb, float time ){\n    float t = mod(floor( time )*tp,nb);\n    return floor((t-tp)/tp)+1.0+fract(time);}\n    float hs(float t){return fract(sin(dot(t,45.125))*7845.236)-0.5;}\nvec2 ps(float t,float tt,vec2 rp,float nbb){vec2 r = vec2(0.);\nfor(int  i = 1 ; i <int(nbb) ; i++){\nfloat it = pow(float(i)/nbb,10.);\nvec2 b = pow(vec2((1.-clamp(tt,0.,float(i)*0.5))*0.25+0.5),rp*(nbb-float(i)));\nr += hs2(vec2(t,t+it*0.01)*it+hs(t*0.1)*0.0001)*b;}\nreturn clamp(r*4.,-1.,1.);}\nvec2 vo(float t,float e){vec2 v = vec2(0.);\nfloat t1 = mix(60.,30.,step(0.5,fract(t*2.)));\nfloat t2 = mix(0.5,2.,step(0.5,fract(t*4.)));\nfloat t3  = mix(0.2,0.4,step(0.5,fract(t*0.25)));\nfor(int  i = 0 ; i< 16 ; i++){\nfloat h = float(i);\nfloat f = t1+pow(t2+.01,(h-8.)*0.2);\nfloat tt = fract(t+h*t3)*5.;\nfloat x = fract(tt *f)/f;\nfloat m = (sin(e*tt*5.)*0.4+sin(e*tt*14.)+sin(e*tt *25.)*0.2)*\nmin(1.,x*1000.)*exp(x*-200.);\nfloat b = hs(h);\nv.x += m*b;\nv.y += m*(1.-b);}\nreturn v*0.1;}\nvec2 ss (float time){\nvec2 d = vec2(0.);\nfloat bm = step(0.65,rdt(time*0.1+487.));\nfloat bm2 = step(0.5,rdt(time*0.1+145.));\nfloat bt = mix(16.,mix(32.,8.,bm),bm2);\n    float t = time*mix(clamp(time*0.5,0.,8.),8.,step(8.5,time));\n    float tm = step(mix(0.5,0.75,step(0.5,fract(time*0.25))),fract(time*0.5));\n    float tb = mix(mix(6.,8.,tm)*(1.+mix(0.5,1.,step(0.75,fract(time*0.125)))*step(0.5,\n    step(0.5,fract(time*0.0625)))),4.,step(0.75,fract(time*0.125+0.5)))*\n    mix(1.,\n     mix(1.,\n      mix(mix(2.,4.,step(0.5,rdt(time*0.2+116.))),\n          mix(0.5,0.25,step(0.5,rdt(time*0.2+735.))),bm)\n     ,step(0.5,rdt(time*0.2+679.)))\n    ,bm2);\n    float p1 = 0.75;\n    float tb2 = 4.;\n    float p2 = 0.75;\n    float fs1 = mix(400.,350.,tm);\n    float t1 = eu(tb,bt,t);\n    vec2 s1 = pa(t1,6,fs1);\n    d += s1*p1;\n    float t2 = eu(tb,bt,t+4.);\n    vec2 s2 = pa(t2,6,fs1);\n    d += s2*p1;\n    int nr =6;float fs = 400.;\n    float t3 = eu(tb2,bt,t);\n    vec2 s3 = pa(t3,nr,fs);\n    d += s3*p2;\n    float t4 = eu(tb2,bt,t+4.);\n    vec2 s4 = pa(t4,nr,fs);\n    d += s4*p2;\n    d += 0.25;\n    float tt5 = step(0.25,fract(time*0.5));\n    float t5 = eu(mix(16.,12.,tt5),bt,t);\n    float tv5 = (1.-fract(time*4.))*t5;\n    vec2 s5 = ps(t,t5,vec2(4.+cos(tv5),4.+sin(tv5))*mix(0.9,0.7,tt5),fract(time*0.1)*4.+2.);\n    d += s5*0.1;\n    float tt6 = mix(7.,8.,step(0.5,time*0.25))*(floor(fract(time*0.0625)*4.)*0.5+0.5);\n    float tb6 = 2.*step(0.5,fract(time*0.125+0.5));\n    d += vo(time,pow(eu(tt6,bt,t+tb6),0.3)*20.)*0.5;\n    d += vo(time,pow(eu(tt6,bt,t+4.+tb6),0.3)*10.)*0.5;\n    float tc = mix(1.,2.,step(0.5,rd(time*0.25+471.)));\n    d += (clamp(vec2(eu(tc,tb ,t*2.),eu(tc,tb ,t*2.+0.1)),0.,1.)-0.5)*0.25;\n    return d;}\n    vec2 ree (float t){\n    float v4 = 1.5;\n  float v5 =0.5;\n  vec2 r = vec2(0.);\n  for(int  i = 0 ; i < 6; i++){\n    float tt= float(i)*0.5;\n    r += ss(t+tt)/(float(i+1));}\n  return r/5.*v4+ss(t)*v5;}\n \nvec2 re2 (float t){\n  float v4 = 0.016;\n   float v6 =0.14;\n  float v7 = 0.68;\n  vec2 r =vec2( 0.);\n  for(int  i = 0 ; i < 30; i++){\n    float tt= float(i)*0.0005*v4;\n    r += ss(t+tt)/(float(i+1)+mix(vec2(0.),vec2(0.3),vec2(hs(t+tt),hs(t+487.+tt))));}\n  return r*v6+ss(t)*v7;}\n\nvec2 mainSound( int samp, float time )\n{\nfloat tt = time;\n    vec2 d = ss(tt)+ ss(clamp(tt*2.-20.,0.,1000.))*clamp(pow(rdt(tt*0.25),1.5),0.,0.4)*\n    clamp(tt*0.25-5.,0.,1.);\n    return vec2(d);\n}","name":"Sound","description":"","type":"sound"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"\nfloat rdt(float t){return fract(sin(dot(floor(t),45.125))*7845.236);}\nfloat eu( float tp, float nb, float time ){\n    float t = mod(floor( time )*tp,nb);\n    return floor((t-tp)/tp)+1.0+fract(time);}\nstruct scene{float dist;int em;float re;vec3 col;};\nfloat se = 0.0;\nfloat rd() {return (fract(sin( (se += 1.0)) * 43758.5453));}\nfloat rd(float t){return fract(sin(dot(floor(t),95.265))*7845.236);}\nfloat no(float t){return mix(rd(t),rd(t+1.),smoothstep(0.,1.,fract(t)));}\nfloat sph (vec3 p, float r){return length(p)-r;}\nmat2 rotate(float a) {\n    float c = cos(a);\n    float s = sin(a);\nreturn mat2(c,-s,s,c   );}\nfloat smin (float a,float b,float k){float h = clamp (0.5+0.5*(b-a)/k,0.0,1.0);\nreturn mix (b,a,h)-k*h*(1.0-h);}\nfloat smax (float a,float b,float k){float h = clamp (0.5+0.5*(b-a)/k,0.0,1.0);\nreturn mix (a,b,h)-k*h*(h);}\nfloat sbox( vec3 p, vec3 b, float r ){return length(max(abs(p)-b,0.0))-r;}\nfloat cy( vec3 p, vec2 h ,float r){vec2 d = abs(vec2(length(p.xz),p.y)) - h;\n  return min(max(d.x,d.y),0.0) + length(max(d,0.0))-r;}\nfloat hex( vec3 p, vec2 h){vec3 q = abs(p);\n  return max(q.x-h.y,max((q.z*0.866025+q.y*0.5),q.y)-h.x);}\nvec3 rdv(){\n    float theta = rd() * (6.283);\n    float z = rd() * 2.0 - 1.0;\n    float a = sqrt(1.0 - z * z);\n    vec3 v = vec3(a * cos(theta), a * sin(theta), z);\n    return v * sqrt(rd());}\nmat2 rot(float r){float c = cos(r);float s = sin(r);return mat2(c, s, -s, c);}\nfloat box(vec3 p, vec3 s){vec3 d = abs(p) - s;\nreturn length(max(d, 0.0)) + min(max(d.x, max(d.y, d.z)), 0.0);}\nscene opOR(in scene a, in scene b){\n    if (a.dist < b.dist){return a;}\n    return b;}\nscene map(vec3 c,vec4 tt){\n    vec3 p = vec3(c.x-0.5,-c.y+1.5,c.z)*0.25;\n    p.zy *= rot(-tt.x*0.25); \n    p.xz *= rot(-tt.y*0.25); \n    vec3 pa = p;\n    float bar = mix(1.,-1.,step(0.,p.x));\n    float s1 = sph ((p*vec3(1.,1.,0.9))+vec3(0.,0.3,-0.1),2.);\n    float a = mix(-1.,1.,step(0.,p.x))*0.3;\n    float ba =distance(vec2(a,1.4),mix(vec2(a,p.y),p.xy,mix(step(a,p.x),step(p.x,a),step(p.x,0.))));\n    vec3 p1 = p+vec3(0.,0.,clamp(smoothstep(0.7,0.15,ba)*0.1\n     -mix(0.,smoothstep(0.15,0.,length(p.x))*0.05,step(p.y,1.3)),0.,1.)\n                     -smoothstep(0.3,0.,distance(vec2(0.,1.75),p.xy*vec2(0.6,1.)))*0.05+\n                     smoothstep(0.4,0.,distance(vec2(0.,2.1),p.xy*vec2(0.6,1.)))*0.05);\n    float s2 = cy((p1+vec3(0.,-0.8,0.3)+vec3(0.,0.,(1.-smoothstep(0.,2.,distance(0.8,p.y)))*0.3))\n    *vec3(mix(1.,2.,smoothstep(1.,4.,p.y)),1.,1.),vec2(0.5,1.3),1.);\n    float s2b = box(p+vec3(0.,0.,mix(1.,1.7,clamp(p.y,-2.,2.5))),vec3(2.,2.2,1.5+smoothstep(2.,0.,distance(p.x,0.))));\n    float s2c = smax(s2,s2b,0.1);\n    float s3 = smin(s1,s2c,0.3);\n    float s4 = box(p,vec3(1.2-((smoothstep(1.,0.,distance(p.z,-0.9))*-p.y)*0.001)+smoothstep(1.5,0.,distance(p.z,0.5))*0.25,2.,2.));\n    float s5 = smax(s3,s4,0.3); \n\t vec3 p2 = p1*vec3(1.,mix(0.2,4.,clamp(distance(p1.z,mix(-2.4,-2.2,smoothstep(1.,0.8,distance(p.y,1.)))),0.,1.)),1.)+vec3(0.,0.,2.18)\n         +vec3(0.,0.,(smoothstep(0.6,0.,distance(0.,p.x)))*0.6)+vec3(0.,smoothstep(1.5,1.,distance(p.x,0.))*0.3*\n                        smoothstep(0.5,0.,distance(p.y,-0.2)),0.);\n    p2.zy*=rotate(0.7);\n    float s6 = hex(p2,vec2(0.8,2.));\n    float s7 = max(s5,-s6-0.1);\n    float s8 = sbox(p1+vec3(0.,mix(0.,-0.1,1.-smoothstep(-2.3,-2.6,p1.z))\n                            +smoothstep(0.15,0.,distance(0.,p.x))*smoothstep(0.5,0.,distance(p.z,-2.2))*-0.1*step(0.,p.y)\n                            ,mix(0.9,1.35,smoothstep(-1.,1.,distance(p.y,0.0)))+smoothstep(0.4,0.,distance(p.y,-0.55))*0.25)\n    *vec3(1.,1.,mix(0.78,1.05,distance(p.y,-0.7)))+vec3(0.,0.,(1.-smoothstep(0.,2.,distance(0.,p.x)))*0.7),\n                    \n    vec3(mix(1.,mix(0.01,0.3,smoothstep(-2.25,-1.4,p.z+p.y*0.5))\n    *mix(.5,1.8,smoothstep(0.4,0.,distance(0.25,p.y)))*mix(1.,3.,smoothstep(0.3,0.,distance(0.7,p.y)))\n    *mix(1.,mix(1.3,0.3,smoothstep(-1.9,-1.6,p1.z+p.y*0.5)),smoothstep(0.3,0.,distance(0.7,p.y)))\n             ,1.-smoothstep(-0.15,-0.8,p.y)),0.7,0.2),0.03);\n    float s9 = smin(s7,s8,0.1);\n    vec3 p3 = (p+vec3(0.,0.1,(smoothstep(3.,0.,distance(0.,p.x)))*0.5)+vec3(0.,-1.5,1.9))\n        *vec3(1.5,mix(0.6,2.,smoothstep(0.3,1.,distance(p.x,0.))),0.6)+vec3(0.,mix(-0.01,0.,clamp(distance(p.x*9.,0.),0.,1.)),0.)\n        +vec3(0.,-0.05+smoothstep(0.7,0.5,distance(p.x,0.))*0.05,0.);\n    p3.zy *=rotate(0.6);\n    float s10 = sbox(p3,vec3(1.,0.05,0.1),0.05);\n    float s11 = max(-s10,s9-0.01);\n    vec3 p4 = (p+vec3(bar*0.7,0.1,1.4));     \n    p4.zy*=rotate(0.6);\n    p4.zx*=rotate(bar*-0.28);\n    p4.xy*=rotate(bar*0.2);\n    p4+=+mix(vec3(0.,smoothstep(0.2,0.5,distance(-0.8,p.x))*-0.37+smoothstep(1.2,0.,distance(-1.6,p.x))*-0.2\n    ,smoothstep(0.4,0.,distance(-0.8,p.x))*clamp(distance(-0.2,p.y),0.,1.)*0.3),\n    vec3(0.,smoothstep(0.2,0.5,distance(0.8,p.x))*-0.37+smoothstep(1.,0.,distance(1.7,p.x))*-0.5\n    ,smoothstep(0.4,0.,distance(0.8,p.x))*clamp(distance(-0.2,p.y),0.,1.)*0.3),step(0.,p.x));\n    float s12 = sbox(p4,vec3(0.43,0.3,0.3),0.01);\n    float s13 = smin(s11,s12,0.03);\n    vec3 p5 = p+vec3(bar*0.78,-0.1,1.8);\n    p5.zx*=rotate(bar*-0.25);\n    p5.xy*=rotate(bar*0.1);\n    p5+=vec3(0.,distance(p5.x,bar*0.32)*0.15,0.);\n    float s14 = sbox(p5,vec3(0.32,clamp(distance(p5.x,bar*0.32)*mix(0.,20.,smoothstep(0.2,0.,distance(-0.1,p5.y))),0.,1.)\n     *clamp(distance(p5.x,bar*-0.32)*7.,0.,1.)\n     *distance(0.2,p5.z),0.2),0.01);\n    float s15 = max(s13,-s14);\n    vec3 p6 = (pa+vec3(bar*0.75,0.1,1.68))*vec3(0.85,1.,1.)+vec3(0.,distance(p.x,0.)*-0.1,distance(p.x,0.)*-0.3);\n    vec3 p7 = p+vec3(bar*1.68,-0.4,0.1);\n    p7.zx*=rotate(bar*0.6);\n    p7.zy*=rotate(-0.4);\n    p7+=vec3(smoothstep(0.6,0.,distance(p7.y,0.1))*bar*0.05,0.,0.);\n    float s18 = sbox(p7,vec3(0.0,mix(0.55,0.2,smoothstep(mix(0.4,0.8,smoothstep(1.,0.,distance(p7.y,-0.5))),0.,\n    distance(p7.z,-.5))),0.2+smoothstep(1.,0.,distance(p7.y,-0.1))*0.3*step(0.,p7.z)),0.08);\n    float s19 = smin(s15,s18,0.1);\n    float s20 = sbox(p+vec3(0.,0.6,mix(2.,2.59,smoothstep(2.,0.,distance(p.x,0.)))),vec3(1.5,0.3,0.3),0.1);\n    float s21 = max(s19,-s20);\n    vec3 p8 =p7+vec3(bar*0.1,(smoothstep(0.4,0.,distance(p7.z,0.))*-0.1)+0.1,-0.16\n                     +smoothstep(0.18,0.,distance(p.y,0.5))*step(p.z,0.)*0.15);\n    p8.zx*=rotate(bar*-0.3);\n    p8.zy*=rotate(0.1);\n    p8+=vec3(0.,smoothstep(0.15,0.,distance(-0.05,p.z))*0.1*step(0.,p8.y),0.);\n    float s22 = sbox(p8,vec3(0.,0.25,0.1*smoothstep(0.8,0.,distance(p.y,0.3))),0.15);\n    float s23 = max(s21,-s22);\n    vec3 p9 =p+vec3(bar*1.7,0.,0.);\n    p9.zy*=rotate(-0.7);\n    p9.zx*=rotate(bar*0.5);\n    p9.yx*=rotate(bar*-0.3);\n    p9+=vec3(0.,-0.05+smoothstep(0.,0.3,distance(p9.z,0.25))*-0.15,-0.28);\n    float s24 = sbox(p9,vec3(0.,.1,.25),0.07);\n    float s25 = min(s23,s24);\n        float s16 = sph(p6,0.3);\n    float s17 = min(s25,s16);\n    \n    scene tet = scene (s17,0,2.,vec3(0.4,0.1,0.1));\n    scene wat = scene (length(c+vec3(10.,20.,20.))-10.,1,1.,\n    vec3(20.));\n    scene scene = opOR(tet, wat);\n  \n    return scene;\n}\nvec3 norm(vec3 p,vec4 tt){vec2 e=vec2(0,0.01);return normalize(map(p,tt).dist \n\t\t-vec3(map(p-e.yxx,tt).dist,map(p-e.xyx,tt).dist,map(p - e.xxy,tt).dist));}\nfloat zo = 0.;\nscene raymarch(in vec3 ro, in vec3 rd,vec4 tt){\n    float t = 0.0;\n    int bs = int(mix(1.,64.,tt.z));\n    scene sceneOutput = scene(50.,  0, 1.2, vec3(0.03));\n    for (int i = 0; i < bs; ++i){\n        scene sce = map(ro + rd * t,tt);\n        if (sce.dist < 0.01){\n            sceneOutput = scene(t, sce.em,sce.re,sce.col);\n            break;}\n        t += sce.dist;\n        if (t > 60.){break;}\n    }\n    return sceneOutput;}\n\nvec4 raytrace(in vec2 uv,vec4 tt){\n    float time = iTime;\n    vec3 ro = vec3(uv, -30.);  \n    vec3 rd = normalize(vec3(uv, 2.8));\n    vec3 color = vec3(0.0);\n    vec3 mco = vec3(0.0);\n    float atten = 1.0;\n    float depth = 0.;\n    float bounces = 1.0;\n    for (int i = 0; i <=2; ++i)\n    {\n        scene sce = raymarch(ro, rd,tt);\n        if (i == 0) depth =  sce.dist;\n        if (sce.em == 0)\n        {\n        \tvec3 p = ro + rd * sce.dist;\n            vec3 n = norm(p,tt);           \n            rd = n + rdv() * sce.re;\n            ro = p + rd * 0.1;\n            mco += (sce.col) * atten;\n            bounces += 1.0; \n            atten *= 0.5;\n        }\n        else\n        { color = mix(sce.col, mco * sce.col, max(0.0, float(i)));\n         break;}\n\n    } \n    return vec4(color/bounces,depth);\n}\nstruct scene2{float dist2;int em2;float col2;};\nscene2 opOR(in scene2 a, in scene2 b){\n    if (a.dist2 < b.dist2){return a;}\n    return b;}\n    scene2 map2(vec3 p){\n    vec3 b = p;\n    for(int i =0 ; i < 9; i ++ ) {\n     b = vec3(1.5,1.95,1.5)*abs(b/dot(b,b))-vec3(0.2,0.5,0.5);}    \n    scene2 li = scene2(length(p)-0.1, 1, 40.);   \n    scene2 art = scene2( length(b)-0.4,0, 1.);\n    scene2 scene2 = opOR(li, art);  \n    return scene2;\n}\nvec3 norm2(vec3 p){vec2 e=vec2(0,0.01);return normalize(map2(p).dist2 \n\t\t-vec3(map2(p-e.yxx).dist2,map2(p-e.xyx).dist2,map2(p - e.xxy).dist2));}\n        scene2 raymarch2(in vec3 ro, in vec3 rd){\n    float t = 0.0;\n    scene2 sceneOutput = scene2(50.,  0,  0.03);\n    float bt = step(8.,iTime);\n    int tp = int(mix(64.,0.,bt));\n    for (int i = 0; i < 100; ++i){\n        scene2 sce = map2(ro + rd * t);\n        if (sce.dist2 < 0.01){\n            sceneOutput = scene2(t, sce.em2,sce.col2);\n            break;}\n        t += sce.dist2;\n        if (t > 20.){break;}\n    }\n    return sceneOutput;}\n\nfloat raytrace2(in vec2 uv){\n\n    vec3 ro = vec3(uv, 0.0);\n    vec3 rd = normalize(vec3(uv, 1.));\n\n    float color = 0.;\n    float mco = 0.;\n    float atten = 1.0;\n    float bounces = 1.;\n    float bt = step(8.,iTime);\n    int tp = int(mix(5.,0.,bt));\n    for (int i = 0; i <tp; ++i)\n    {\n        scene2 sce = raymarch2(ro, rd);\n        if (sce.em2 == 0)\n        {\n        \tvec3 p = ro + rd * sce.dist2;\n            vec3 n = norm2(p); \n            rd = n + rdv() *1.2;\n            ro = p + rd * 0.1;\n            mco += (sce.col2) * atten; \n            bounces += 1.0;\n            atten *= 0.5;\n        }\n        else\n        { color = mix(sce.col2, mco * sce.col2, max(0.0, float(i)));\n         break;}\n\n    } \n    color/=bounces;\n    if(bt==0.){    \n    return color ;}\n    else{return 0.;}\n    \n}\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord)\n{\n    vec2 uc = fragCoord.xy / iResolution.xy;\n    float time = iTime;\n    \n    se = (iResolution.y * fragCoord.x / iResolution.x + fragCoord.y / iResolution.y);\n    se += time;\n    vec2 uv = (fragCoord.xy / iResolution.xy * 2.0 - 1.0) ;\n    uv.x *= iResolution.x/iResolution.y;\n    float tm = step(mix(0.5,0.75,step(0.5,fract(time*0.25))),fract(time*0.5));\n    float bm = step(0.65,rdt(time*0.1+487.));\n    float bm2 = step(0.5,rdt(time*0.1+145.));\n    float bt = mix(16.,mix(32.,8.,bm),bm2);\n    float tb = mix(mix(6.,8.,tm)*(1.+mix(0.5,1.,step(0.75,fract(time*0.125)))*step(0.5,\n    step(0.5,fract(time*0.0625)))),4.,step(0.75,fract(time*0.125+0.5)))*\n    mix(1.,\n     mix(1.,\n      mix(mix(2.,4.,step(0.5,rdt(time*0.2+116.))),\n          mix(0.5,0.25,step(0.5,rdt(time*0.2+735.))),bm)\n     ,step(0.5,rdt(time*0.2+679.)))\n    ,bm2);\n    float t = time*8.;\n    float t1 = eu(tb,bt,t);\n    float t3 = eu(4.,bt,t);\n    float tt5 = step(0.25,fract(time*0.5));\n    float t5 = eu(mix(16.,12.,tt5),bt,t);\n    vec4 tt = vec4(t1,t3, clamp(iTime/8.,0.,1.),0.);\n    vec4 color = raytrace(uv,tt );\n    float color2 = raytrace2(uv*0.5 );\n    vec4 prevColor = texture(iChannel0, fragCoord.xy / iResolution.xy);\n    vec3 col = max(color.xyz,texture(iChannel0,uc).xyz*0.8);\n    float frames = 1.0 / float(iFrame + 1);\n    float fd = 0.;\n    if (iFrame > 1)\n        color2 = mix(prevColor.a, color2, frames);\n    if(step(8.,iTime)==0.){    \n    fd = color2;}\n    else{fd = prevColor.a;}\n    fragColor = vec4(mix(col,vec3(t5),step(1.4,uv.x)),fd);\n    \n}\n\n","name":"Buffer A","description":"","type":"buffer"}]}