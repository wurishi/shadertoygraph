{"ver":"0.1","info":{"id":"Xd3Gzs","date":"1451565525","viewed":374,"name":"first tunnel","username":"nexor","description":"first try on creating the old 3d tunnel effect","likes":15,"published":1,"flags":0,"usePreview":0,"tags":["tunnel","3dtunnel"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[],"code":"#define sig(x) (2.*step(0.,x)-1.)\n#define ss(x,f) sig(x)*smoothstep(abs(f)+(sss),abs(f)-(sss),abs(x))\n\n#define rpt(x,m) (mod(x,m)-m*.5)\n#define pix(x,b) ((floor(x*float(b))+.5)/float(b))\n\n#define cos2(x) (2.*(cos(x)+1.))\n#define sin2(x) (2.*(sin(x)+1.))\n\nfloat time;\nvec2 resolution;\n\nconst float pi = 3.14159265359;\nconst float pi2 = pi*2.;\nconst float pih = pi*.5;\nfloat sq2;\nfloat sq2h;\nfloat sq3;\nfloat sq3h;\nfloat sq3t;\nconst float sss = 1e-3;\n\nvoid init()\n{\n    time = iTime;\n    resolution = iResolution.xy;\n    sq2h = sq2*.5;\n    sq3 = sqrt(3.);\n    sq3h = sq3*.5;\n    sq3t = 1./sq3;\n}\n\nvec2 tr(vec2 p)\n{\n\t p /= resolution.xy;\n\t p = -1.0+2.0*p;\n\t p.y *= resolution.y/resolution.x;\n\t return p;\n}\n\nmat2 rotmd(float a)\n{\n\t a=radians(a);\n\t float c=cos(a),s=sin(a);\n\t return mat2(c,-s,s,c);\n}\n\nmat2 rotmr(float a)\n{\n\t float c=cos(a),s=sin(a);\n\t return mat2(c,-s,s,c);\n}\n\nfloat saw(float x)\n{\n\t return abs(fract(x)*2.-1.);\n}\n\nfloat saw2(float x)\n{\n\t return abs(fract(x)*4.-2.)-1.;\n}\n\nfloat rct(vec2 p,float w,float h)\n{\n\tp=abs(p);\n\treturn ss(p.x,w)\n\t      *ss(p.y,h);\n}\n\nfloat rct(vec2 p, float s)\n{\n\treturn rct(p,s,s);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    init();\n\tvec2 glfc = fragCoord.xy;\n\tvec2 p = tr(glfc);\n\tvec2 q = p;\n\tvec3 col = vec3(0.);\n\tmat2 r = rotmr(time*.1);\n\n    p+=vec2(cos(time)*.2,sin(time*.7)*.5);\n    float a = atan(p.y,p.x);\n    float len = length(p);\n\n    q.x=1.5/len+.5*time;\n    q.y=a*6.+time*.3;\n    q.y/=pi;\n  \n    float v = .0\n    +(rct(rpt(q,1./8.),1./32.))\n \t*saw2(.5*(q.y+2.*saw(.5*q.x)))\n \t;\n \tv*=smoothstep(.0,.7,len);\n\n    col+=v*v;\n    col*=vec3(cos2(4.*q.x),cos2(4.*q.x+2.),sin2(q.x+q.y));\n    col*=exp(.7);\n\tfragColor = vec4( col, 1.0 );\n}","name":"Image","description":"","type":"image"}]}