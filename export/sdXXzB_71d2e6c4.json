{"ver":"0.1","info":{"id":"sdXXzB","date":"1618944448","viewed":115,"name":"Color bit depth","username":"curvedcubes","description":"I'm fairly new to GLSL and shaders and thought i'd implement a simple bit depth conversion. X coordinate of mouse controls blue value.","likes":1,"published":1,"flags":0,"usePreview":0,"tags":["palette","rgb","bitdepth"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"uvec3 to_rgb255(vec3 color, int bit_depth)\n{\n    color *= pow(2., float(bit_depth));\n    return uvec3(int(color.r), int(color.g), int(color.b));\n}\n\nuvec3 lower_bitdepth(uvec3 color, int bit_depth, int target_depth)\n{\n    return color >> (bit_depth - target_depth);\n}\n\nuvec3 higher_bitdepth(uvec3 color, int bit_depth, int target_depth)\n{\n    uvec3 shift_color = color;\n    int simulation = bit_depth;\n    int shift_count = 0;\n    \n    // counting how many shifts are necessary\n    while(simulation < target_depth)\n    {\n        simulation += bit_depth;\n        shift_count += 1;\n    }\n    \n    // shift and addition (example: 7/111 << 3 = 111 000 -> + 111 = 111111 = 63)\n    for(int i=0; i< shift_count; i++)\n    {\n        shift_color = shift_color << bit_depth;\n        shift_color += color;\n    }\n    \n    // in case of overshoot\n    for(int i=0; i< (simulation-target_depth); i++)\n    {\n        shift_color = shift_color >> 1;\n    }\n    return shift_color;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // Normalized pixel coordinates (from 0 to 1)\n    vec2 uv = fragCoord/iResolution.xy;\n    vec2 mouse = iMouse.xy/iResolution.xy;\n    int bd = int(3.5*sin(iTime)+4.5);\n\n    vec3 col = vec3(uv.x, uv.y, mouse.x);\n    uvec3 col_int = to_rgb255(col, 8);\n    col_int = lower_bitdepth(col_int, 8, bd);\n    col_int = higher_bitdepth(col_int, bd, 8);\n    col = vec3(float(col_int.r), float(col_int.g), float(col_int.b)) / 255.;\n\n    // Output to screen\n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}