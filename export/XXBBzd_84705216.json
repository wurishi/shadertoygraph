{"ver":"0.1","info":{"id":"XXBBzd","date":"1730841077","viewed":75,"name":"Torus 2 flows - universal cover","username":"Fred_The_Red","description":"Dynamics on the universal cover of the 2-torus","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["dynamics"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define scale 3\n#define univCover true\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // Normalized pixel coordinates (from 0 to 1)\n    vec2 uv = fragCoord/iResolution.xy;\n\n    uv = vec2(scale, scale)*uv;\n    if (univCover) {uv = uv - floor(uv);}\n    else{uv -= vec2(scale/2);}\n\n    vec3 col;\n    // Time varying pixel color\n    if ((uv.x >= 0.) && (uv.y >= 0.) && (uv.x <= 1.) && (uv.y <= 1.))\n        //{col = texture(iChannel0, uv).rgb;}\n        {vec2 newPos = f(uv, iTime);\n        fragColor = initialImage(newPos);}\n    else\n        {col = vec3(0.);\n        fragColor = vec4(col,1.0);}\n}","name":"Image","description":"","type":"image"},{"inputs":[],"outputs":[],"code":"#define PI 3.1415\n#define nb_flows 2\n#define SPEED 0.5\n#define Cwidth 10.\n\nfloat distance1(float x)\n{\nreturn (x < 0.5 ? x : (1.-x));\n}\n\nfloat distance2(vec2 pos)\n{\nreturn distance1(pos.x)*distance1(pos.x) + distance1(pos.y)*distance1(pos.y);\n}\n\nvec2 flow1(vec2 pos,float t)\n{\n    vec2 flow;\n    flow = vec2(pos.x, mod(pos.y + t*sin(2.*PI*pos.x), 1.));\n    // Rotation :\n    //flow = vec2(mod(pos.x+t, 1.), mod(pos.y+0.9*t, 1.));\n    // Rotation avec point d'arrÃªt : NON\n    //float alpha = 0.41421356237;\n    //float d = distance2(pos);\n    //flow = vec2(mod(pos.x+d*t, 1.), mod(pos.y+d*alpha*t, 1.));    \n    return flow;\n}\n\nvec2 flow2(vec2 pos,float t)\n{\n    return vec2(mod(pos.x + t*sin(2.*PI*pos.y), 1.), pos.y);\n}\n\n// Time t isotopy\nvec2 f(vec2 pos, float t)\n{\nt = t * SPEED;\nif(nb_flows == 1){pos = flow1(pos, -t);}\nelse{\n    float n = floor(t);\n    float tt = t - n;\n    bool even = (mod(n, 2.) == 0.);\n    // Last flow\n    if(even){pos=flow1(pos, -tt);}else{pos = flow2(pos, -tt);};\n    \n    // Iterations\n    while(n>0.)\n        {\n        if(even){pos = flow2(pos, -1.);}\n        else{pos = flow1(pos, -1.);}\n        even = !even;\n        n -= 1.;\n        };\n    }\n    return pos;\n}\n\n\n// Matrice de rotation autour de l'axe Y\nmat3 rotationY(float angle) {\n    float c = cos(angle);\n    float s = sin(angle);\n    return mat3(\n        c, 0.0, -s,\n        0.0, 1.0, 0.0,\n        s, 0.0, c\n    );\n}\n\n// Matrice de rotation autour de l'axe X\nmat3 rotationX(float angle) {\n    float c = cos(angle);\n    float s = sin(angle);\n    return mat3(\n        1.0, 0.0, 0.0,\n        0.0, c, -s,\n        0.0, s, c\n    );\n}\n\n\n\nvec3 sdfRectangle(vec2 uv, float width, float height, vec2 center) {\n    float x = uv.x - center.x;\n    float y = uv.y - center.y;\n    float d = max(abs(x)-width, abs(y)-height);\n    \n    return d > 0. ? vec3(0.) : vec3(1., 0., 0.);\n}\n\nvec3 sdfSquare(vec2 uv, float size, vec2 center) {return sdfRectangle(uv, size, size, center);}\n\n// Two squares\nvec4 initialImage1(vec2 pos)\n{\nvec4 square1 = vec4(sdfSquare(pos, 0.25, vec2(0.25, 0.25)), 0.);\nvec4 square2 = vec4(sdfSquare(pos, 0.25, vec2(0.75, 0.75)), 0.);\nreturn square1 + square2;\n}\n\n// Chessboard\nvec4 initialImage1b(vec2 pos)\n{\nbool test1 = (mod(pos.x*Cwidth, 1.)<=0.5) && (mod(pos.y*Cwidth, 1.)<=0.5); \nbool test2 = (mod(pos.x*Cwidth, 1.)>=0.5) && (mod(pos.y*Cwidth, 1.)>=0.5); \nif(test1 || test2){return vec4(1.,0.,0., 0.);}\nelse{return vec4(0.);}\n}\n\n\n// Horizontal curve\nvec4 horizontalCurve(vec2 pos)\n{\nvec4 curve = vec4(sdfRectangle(pos, 1., 0.1, vec2(0.5, 0.75)), 0.);\nreturn curve;\n}\n\n\n// Vertical curve\nvec4 verticalCurve(vec2 pos)\n{\nvec4 curve = vec4(sdfRectangle(pos, 0.002, 1., vec2(0.25, 0.)), 0.);\nreturn curve;\n}\n\n// Initial image\nvec4 initialImage(vec2 pos)\n{\nvec4 image = initialImage1b(pos);\n//vec4 image = horizontalCurve(pos);\nreturn (image.x <= 0.01)&&(image.y <= 0.01)&&(image.z <= 0.01) ? vec4(0.3) : image;\n}\n\n","name":"Common","description":"","type":"common"}]}