{"ver":"0.1","info":{"id":"ttdczX","date":"1609645528","viewed":109,"name":"Weaving Waves","username":"mherreshoff","description":"Ripples made of little bits of yarn, weaving themselves together in a Celtic knot style pattern.","likes":5,"published":1,"flags":0,"usePreview":0,"tags":["waves","weaving","celtic"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XsfGRn","filepath":"/media/a/1f7dca9c22f324751f2a5a59c9b181dfe3b5564a04b724c657732d0bf09c99db.jpg","previewfilepath":"/media/ap/1f7dca9c22f324751f2a5a59c9b181dfe3b5564a04b724c657732d0bf09c99db.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define PI 3.14159\n#define hue(v) ( .6 + .6 * cos( 2.*PI*(v) + vec4(0,-2.*PI/3.,2.*PI/3.,0) ) )\n#define hash21(p) fract(sin(dot(p, vec2(12.9898, 78.233))) * 43758.5453)\n\n// Returns color/clock position, texture, presence.\nvec3 ring (vec2 U, vec2 center, float speed, float spacing, float bandW, float m) {\n    vec2 d = U - center;\n    float r = length(d), passed = max(0., iTime*speed - r ), x = passed / spacing,\n        waveN = floor(x), f = fract(x), parity = mod(x, 2.0),\n        outer = r + fract(passed), theta = 2.*PI*hash21(vec2(waveN, 0)),\n        ropeR = (f-.5)*spacing/bandW, ropePos = outer*(mod(2.*PI+atan(d.y,d.x)+theta, 2.*PI)-PI),\n        q = 1.-.8*smoothstep(0., .5, abs(ropeR)), // Darken the edges of the rope for 3D Effect.\n        woodTex = texture(iChannel0, vec2(ropeR*.1, ropeR*.1+ropePos)).r,\n        ropeTex = (parity > 1. ? sqrt(woodTex) : woodTex) * q;\n    return vec3(m+.5*float(parity > 1.0), ropeTex, abs(ropeR) < .5);\n}\n\nvec4 render (in vec2 U) {\n    vec2 R = iResolution.xy, uv = (2.*U - R)/R.y;\n    vec3 x = ring(uv, vec2(0, .5), .1, .15, .05, .02),\n         y = ring(uv, vec2(0, -.5), .14, .15, .07, .16),\n         z = ring(uv, vec2(0, 0), .1, 1. , .025,.33), tmp;\n#define under(a, b) (a.z == 0.0 || (b.z != 0.0 && fract(b.x - a.x) < .5))\n#define sort(a, b) if (under(a, b)) {tmp=a;a=b;b=tmp;}\n    sort(x,y);sort(y,z);sort(x,y);\n          \n    int numRings = int(x.z + y.z + z.z);\n    if (numRings == 0)  return vec4(0);\n    else if (under(y, x) && under(z, x)) return hue(2.0*x.x)*x.y;\n    else return vec4((x.y + y.y + z.y)/3.);\n}\nvoid mainImage( out vec4 O, in vec2 U )\n{\n    // Anti-alias:\n    vec2 r = vec2(.5, 0), u = vec2(0,.5);\n    O = 0.25*(render(U+r) + render(U-r) + render(U+u) + render(U-u));\n}","name":"Image","description":"","type":"image"}]}