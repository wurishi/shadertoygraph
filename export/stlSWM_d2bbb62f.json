{"ver":"0.1","info":{"id":"stlSWM","date":"1625833242","viewed":165,"name":"Neural SDF (Testing)","username":"MacLin","description":"Neural SDF (Testing)","likes":2,"published":1,"flags":0,"usePreview":1,"tags":["test"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// Neural SDF shader\n// sgreen 25/11/2020\n// \n// based on \"Overfit Neural Networks as a Compact Shape Representation\":\n// https://arxiv.org/abs/2009.09808\n// \n// trained using Nathan Godwin's code:\n// https://github.com/nathanrgodwin/overfit-shapes\n//\n// WARNING - takes about 30 seconds to compile on Windows!\n\n// magic numbers!\nconst float weights0[] = float [] (\n0.1028, 1.6673, 1.4198, -0.3303, -0.3514, 0.3852, 1.2728, 0.0222, 1.9401, -1.0903, 0.2250, \n-0.7970, 0.0080, -0.0123, -0.0033, 0.7314, -0.3248, -1.9151, 0.2630, -1.7573, -1.3383, -0.0020, \n-0.0015, 0.0052, -1.0466, 0.5547, 0.8525, -0.6951, -1.5900, 0.9958, -1.9402, 0.1746, 0.0532, \n-0.8347, -1.5226, 0.9124, -0.0014, -0.0004, 0.0014, -0.1210, 0.1571, 0.9184, -0.1586, -0.3184, \n-0.2862, -0.0026, -0.0021, -0.0110, -0.0003, -0.0026, 0.0087, 1.1592, -1.5602, 0.5586, 0.9330, \n-0.7047, 0.1727, 0.9648, 1.1793, -0.1516, 0.3526, -0.3139, 0.4080, 1.5673, 0.5157, -0.3350, \n-1.5944, 0.8795, -0.4067, -1.7084, -0.5785, -0.8153, 0.2055, -1.1105, -0.1587, 1.3749, 0.4110, \n-1.1008, 0.0028, -0.0009, 0.0012, 0.1590, -0.7882, 0.9825, -1.0313, -0.3224, -0.9920, 0.1336, \n0.2857, -0.4648, 0.0005, -0.0010, 0.0007, 1.2120, 0.8832, 1.3406 );\nconst float biases0[] = float [] (\n-0.3867, 0.1746, -0.5758, 0.2307, -0.0157, -0.4884, -0.5818, -0.0094, 0.1981, -0.3026, -0.6063, \n-0.9125, -0.0030, 0.2129, 0.1765, -0.0106, -0.0065, -0.4815, 0.1919, 0.0849, 0.3321, -0.5782, \n-0.5608, -0.2297, 0.0756, -0.4128, -0.0041, -0.0205, -0.6315, 0.1674, -0.0015, -0.0256 );\nconst float weights1[] = float [] (\n0.2037, -0.9934, -0.1013, 1.9876, -0.0311, 1.0910, 1.4144, -0.0172, 0.0383, -0.6151, 0.0747, \n0.1972, -0.0219, 0.9227, -0.6424, -0.0347, 0.0025, 0.3911, 1.3110, 1.0343, 0.4547, 0.3814, \n-0.3754, -0.5237, 0.2852, 0.2478, 0.0114, 0.3030, -0.7501, -1.3647, 0.0013, -0.0365, 0.3817, \n0.2514, 1.4081, 0.5378, 0.0503, 1.6461, 0.5127, 0.0306, -0.3719, -1.5634, -0.2897, 0.8626, \n0.0213, -0.0374, -0.7606, 0.0238, -0.0194, 1.2464, 0.2474, -1.1886, 0.1409, -0.6562, 1.5343, \n0.3555, -0.0780, -0.1540, 0.0222, 0.7055, -1.0881, 0.0873, 0.0006, 0.8332, -0.1404, 0.2851, \n0.4923, 0.4213, -0.0087, 0.6011, -0.9928, -0.0172, 0.3074, 0.3870, 1.3318, 0.2964, -0.0056, \n0.2141, -0.1002, -0.0081, -0.0143, -0.0985, -1.3874, -0.8923, -1.0612, -0.2916, 0.7248, 1.4539, \n-0.3564, 0.6867, 0.0242, 1.6232, 0.5841, -0.5504, 0.0059, 0.3762, -0.5952, -0.8804, 0.2201, \n0.3750, 0.0023, -0.2354, -1.6843, -0.0005, 0.1014, 1.0131, 1.2806, -0.4663, -0.0161, -1.9120, \n0.7502, -0.0447, 0.0063, 0.6551, 0.7904, -0.3896, -0.3006, 0.0872, 0.7532, -0.2246, 1.3207, \n-0.5176, -0.0013, -0.5836, 2.0141, 0.1730, 0.0092, -1.6107, -1.0937, 0.8592, 0.9688, -0.3333, \n-0.0002, -0.3962, 1.5307, 0.0014, -0.4677, 0.9766, -0.2486, -1.1528, -0.0284, -0.1039, 0.5820, \n-0.0255, 0.0093, -0.0674, -2.1270, 0.0605, -0.4676, -1.6150, -0.9497, -0.1346, -0.8507, -0.7330, \n-0.0079, 0.0714, 0.9042, 0.3284, 0.0205, -0.5179, 0.8930, -0.0594, 0.5634, -0.6677, -0.0236, \n1.6660, 1.4573, -0.0043, 0.4389, 1.4000, -1.2570, -0.6729, -0.0014, -0.3419, 0.1299, -0.0183, \n0.0267, -0.4031, 0.3967, 1.6200, -0.5863, 0.2568, 0.6680, -0.4042, 0.0511, 0.0509, -0.0203, \n-0.7441, 0.6488, 0.1622, -0.0121, -2.5653, -0.9385, 0.5555, 1.3995, 0.6823, -0.0182, 0.7926, \n0.5731, -0.0199, -1.3147, 1.5697, 1.0589, -1.4346, -0.0208, -0.5872, 0.4184, -0.0236, -0.0104, \n0.5920, -0.3739, 1.0562, -0.1695, 0.7168, -0.1222, 1.2475, 0.1182, 1.8880, 0.0045, 0.4134, \n0.1631, 0.3327, 0.0013, 0.2165, 1.8016, -0.8695, -0.0612, -0.0868, -0.0187, 1.4634, -0.6077, \n0.0268, 0.3631, 1.1662, -0.3248, -0.2189, 0.0065, -0.2241, -0.5289, -0.0076, -0.0265, 0.4976, \n0.7993, 0.4770, -2.1075, 0.0480, 0.7668, 1.0906, 2.0608, -1.1112, -0.0115, 0.0232, -1.0531, \n0.1299, 0.0034, 0.6244, 0.3119, -0.8879, -0.3340, 1.2381, 0.0119, 0.9355, 0.7072, 0.0065, \n-0.3339, -1.1527, -0.5357, -1.6152, 0.0048, -0.1846, -0.4670, 0.0142, -0.0103, 0.7438, -0.8238, \n0.9325, -1.1223, 0.8473, -0.2862, 0.1433, 0.2211, 0.6259, -0.0016, -0.1737, 0.6370, 1.0181, \n-0.0076, 0.1137, 0.0257, -0.2435, 0.4916, -0.6622, -0.0122, 1.1284, 0.1538, -0.0188, -1.6081, \n0.1971, -0.8243, 1.1445, -0.0195, -0.0862, 0.7766, 0.0278, -0.0177, -2.1064, 0.9050, -0.7993, \n0.6642, 0.0200, -1.4298, -0.8543, 0.0843, -1.2796, 0.0050, -0.7540, -0.3004, 0.1340, -0.0052, \n0.5084, 1.2636, -0.6925, 0.4489, 0.1704, 0.0447, 0.1760, 0.8850, 0.0289, 0.9225, -0.8288, \n-2.6319, -0.3112, 0.0520, 0.7215, 1.1524, -0.0012, -0.0950, -0.9662, -0.0557, -0.4436, -0.3644, \n0.4808, 0.4563, 1.0721, 0.7606, 0.5439, -0.0465, 0.2752, 2.2401, 0.0122, -0.0097, 0.5794, \n0.8363, -0.5419, 0.7520, 0.4836, 0.0238, -0.2551, -1.2332, -0.0031, 0.5303, -3.3239, 1.1512, \n-0.3344, -0.0142, -0.8050, -0.7677, -0.0268, 0.0123, 2.1208, 1.2948, -0.6279, 0.9257, 0.7650, \n0.6576, -0.4323, 0.1682, 0.3560, -0.0402, -0.3861, 0.2759, -0.4253, 0.0035, -1.2439, -0.5303, \n-0.1853, 1.1040, -0.7702, 0.0052, 1.1034, -1.2570, -0.0054, 0.6655, -0.1019, 0.6065, 0.4453, \n-0.0201, 0.3580, 0.1536, 0.0236, 0.0157, -0.7890, -0.2546, 0.9625, 0.0331, -0.2407, -0.1174, \n-0.7600, -0.0255, -0.0418, -0.0146, 0.5293, 0.2750, 0.3407, 0.0133, 0.6635, -0.6473, 0.5342, \n-1.2486, 0.8833, 0.0117, -0.1282, 0.9030, -0.0028, -0.3492, 0.5184, -0.7364, -0.7152, -0.0184, \n-0.6800, 0.4175, -0.0082, -0.0126, 0.7757, -0.0689, -0.5726, -0.3400, -0.1183, 0.7625, 0.6138, \n0.9709, -0.3027, 0.0152, -0.1030, 0.5747, -0.3547, -0.0143, -0.7178, -1.9158, 0.4580, 0.0387, \n0.3652, 0.0227, 1.5282, -0.8287, -0.0097, -0.8330, 0.5614, 0.0884, 1.0802, 0.0024, 0.3256, \n0.8085, 0.0063, 0.0121, 0.2118, -0.3566, -0.7868, 0.8736, -0.0054, -2.5080, 0.6331, -1.8706, \n-0.3475, -0.0149, -1.7731, 0.1858, -0.5613, -0.0083, 0.7123, -0.1025, -0.2080, 0.9823, 0.1777, \n-0.0050, -1.2860, 1.9564, -0.0007, 0.5873, 1.4092, -0.7764, 0.0264, 0.0053, -1.2972, 0.0405, \n-0.0080, 0.0104, 0.8922, 0.7314, -1.1333, -0.1260, 0.7140, 0.7637, -0.1307, 0.5906, 0.3836, \n-0.0154, 0.4272, -0.1162, -1.5735, 0.0096, -0.2321, -0.7203, -0.2287, 0.3899, 0.3967, -0.0006, \n-0.3956, 1.0182, 0.0236, -0.2099, 1.3991, -0.9546, 0.4545, 0.0096, -0.7855, 0.0759, 0.0277, \n0.0009, 0.6718, 0.6082, -0.8759, -0.2590, 2.2639, -1.3199, 0.5501, 0.8974, -0.2472, 0.0049, \n1.0487, 0.6304, -0.8398, -0.0101, -0.2444, -0.2112, -0.3450, 1.2127, 1.5077, -0.0336, 0.4984, \n-0.6986, 0.0223, 0.2118, -0.4520, 0.8194, -1.7843, 0.0076, 0.0984, -0.5388, 0.0196, -0.0072, \n-2.6783, 1.5554, -1.4202, -0.9471, -0.3936, 0.5031, -3.0838, 1.2713, 1.0798, -0.0087, 0.7303, \n-0.2588, -0.1846, 0.0006, -0.4052, -0.6369, 0.3119, 0.4323, 0.0054, -0.0143, 0.3685, -0.4835, \n-0.0266, -1.5793, 0.6067, -0.4342, -0.4682, -0.0106, -1.4014, 1.0713, 0.0145, -0.0174, 0.5207, \n0.0846, -0.9906, 0.0876, -0.4465, -0.6580, -0.0191, 0.7347, 1.1991, -0.0038, -0.7814, -0.4180, \n0.4941, 0.0094, 0.4427, 0.2668, -0.3127, -0.3145, -0.2621, -0.0155, -1.5802, -0.3939, -0.0215, \n1.3082, 0.4412, -1.0850, 1.3372, 0.0135, 0.6136, -0.0857, -0.0550, 0.0084, -0.5590, 0.4500, \n-0.7855, -0.7416, 0.4621, -0.1073, -0.3524, -0.2267, -0.2371, 0.0066, -2.3679, 0.4380, 0.7111, \n-0.0063, -0.2289, 1.2687, -0.2270, 2.2731, 0.0502, 0.0197, 0.0309, -1.0093, 0.0257, 0.3545, \n1.1503, 0.2529, 0.9224, 0.0021, 0.1398, -0.9182, -0.0390, 0.0250, -0.2668, 0.0798, 0.4717, \n-0.4359, 1.1202, 2.0226, -1.0434, 0.6737, 0.6657, 0.0167, 0.1838, -0.2465, -0.1418, 0.0042, \n0.1769, 1.6190, -1.0459, 0.6003, -0.4237, -0.0138, -0.9754, 0.8761, 0.0129, 0.2913, 1.4255, \n0.4580, 0.1268, -0.0016, 0.5374, -0.8440, -0.0268, -0.0067, 1.0087, -0.5808, 0.7826, -0.1562, \n1.0863, -0.5791, 0.4325, -0.4241, -0.0534, 0.0298, 0.0342, 0.0151, -0.0065, -0.0091, 0.9946, \n-1.1303, 0.8997, -0.0430, 1.3105, 0.0019, -0.2920, -0.8047, -0.0037, -3.5439, -1.0579, -0.1618, \n0.2730, 0.0196, -1.1384, 0.0410, 0.0291, -0.0088, -1.1101, -0.4655, 0.4312, -0.0559, 0.7520, \n-0.4250, -0.0139, -0.9089, 0.4658, -0.0065, -0.3520, -0.0613, -0.5780, -0.0042, -1.9684, 0.3147, \n0.1511, -2.9015, -1.2924, 0.0067, 0.4367, 0.7907, 0.0409, -0.0092, 0.0893, 1.1817, 1.8916, \n0.0305, 0.7592, -0.3532, -0.0036, 0.0027, 0.0161, -0.1907, 0.2640, 0.8656, -0.0626, -1.1963, \n-0.4154, -0.1718, 0.2226, 0.0154, -0.7120, -2.0126, -0.2813, 0.0036, 0.7207, -0.6098, 0.7984, \n0.7752, -0.5314, 0.0052, -0.0414, -0.1651, 0.0057, 0.5989, 1.0892, 0.1319, 0.3109, 0.0059, \n0.7426, 0.0983, -0.0027, -0.0096, -0.3693, 0.1972, -0.3136, 0.2012, -0.8557, 1.0019, -0.0456, \n0.1568, -0.4816, -0.0289, 0.7012, -0.0070, -1.3532, -0.0126, 0.7353, 0.2742, -0.0492, -0.6741, \n-1.2868, -0.0046, -0.4192, -0.8904, 0.0277, 1.3388, 0.7458, 1.3360, -0.2728, 0.0222, 0.5238, \n-0.3320, -0.0117, 0.0052, -1.3869, 0.8517, 0.2338, 0.0462, -0.3682, 0.0710, -0.4171, 0.7230, \n-0.3606, 0.0188, 1.0865, -0.1551, 0.5649, 0.0002, -0.8437, -0.7892, 0.3777, -1.1529, 0.6962, \n-0.0340, 1.1519, -0.7880, 0.0153, -2.8821, 0.2298, 0.5041, 1.9120, 0.0188, 0.5011, 0.6910, \n0.0215, 0.0281, 0.4350, 0.1090, -0.3832, -0.1811, -1.3690, 1.6927, 0.4188, -0.3184, 0.2626, \n0.0012, 0.2696, 0.7107, -0.0048, -0.0088, -0.3968, -0.8103, 0.3826, -0.4114, -0.6385, -0.0198, \n-0.2688, 0.6372, -0.0088, 0.1554, -0.0194, -2.0871, -1.2823, 0.0087, -0.5485, 0.7810, -0.0204, \n-0.0089, 1.2859, -1.4324, -0.5725, -0.1087, -0.6173, -0.1060, -0.8380, -2.2218, 0.5243, 0.0044, \n0.5747, -0.3378, -0.0720, -0.0166, -1.5445, 1.5430, 0.7032, -0.7525, -0.0559, -0.0041, -1.2377, \n-1.2170, -0.0018, 0.5231, -0.5861, -0.6081, -0.4988, 0.0206, -0.8179, -0.5841, 0.0144, -0.0081, \n0.5576, -0.2768, 1.3184, -2.6706, -0.8319, 0.7488, -1.2921, 1.1092, 0.9105, -0.0002, 1.0260, \n2.3716, 0.4689, 0.0053, -1.3012, 1.2711, -0.3959, 0.0943, 0.6500, 0.0323, 1.2036, 1.1646, \n-0.0092, 0.5430, 0.5052, -0.8343, -1.8500, -0.0068, -0.0922, 0.6508, 0.0237, 0.0179, -0.7005, \n-0.1053, 0.1508, -0.4474, 0.3639, -0.6971, 0.8756, 0.0986, -1.2861, 0.0086, -0.7588, 0.6039, \n0.3871, 0.0121, 0.1241, -0.9219, -1.2378, -0.2337, 0.0130, 0.0313, -0.0768, -0.0065, -0.0211, \n0.0784, -0.9616, 0.6584, -0.9761, 0.0163, 0.2488, -0.2900, 0.0262, 0.0140, -1.3573, -0.4574, \n0.5340, -0.5836, -1.1061, 1.4119, -0.4821, 0.0306, -0.0235, -0.0006, -0.1824, 0.0119, 0.6443, \n-0.0080, 0.4768, 1.0888, 0.1294, 1.0769, -1.4735, 0.0000, -0.3588, -0.0484, 0.0013, 0.6951, \n1.1398, 0.5132, 0.7368, -0.0034, 0.1781, 0.3593, 0.0154, -0.0099, -0.6515, -0.8216, 0.1288, \n-0.0235, 0.5572, 0.5687, -1.8520, -0.2117, 1.3683, 0.0007, -0.2192, -0.1503, 0.1511, 0.0040, \n1.0312 );\nconst float biases1[] = float [] (\n-1.5903, -1.4000, -0.9304, 0.1078, 0.9444, -0.6151, -0.9163, -1.3614, -0.2150, 0.6524, -1.4286, \n-0.9360, -0.0450, -0.7075, 0.4856, -1.5841, -1.3737, -0.2277, -0.3577, -0.1831, -1.2139, -0.7175, \n0.3511, 0.0538, -0.5451, -0.7014, -0.2137, 1.2562, -0.7662, -0.4431, -0.5397, -0.1270 );\nconst float weights2[] = float [] (\n0.9615, 0.3641, 0.7108, -1.2565, 0.3426, 0.6257, -0.7591, -0.0381, -0.4440, 0.1910, -1.9792, \n-2.0162, 0.4773, 0.5271, -1.2467, 0.4459, 0.2079, -1.4212, -0.4179, -1.7670, 0.5310, -0.8521, \n1.5889, 0.3216, -0.7682, 1.1271, -0.1154, 0.7325, 1.1688, -0.6005, -0.2962, 0.3583, -2.7215, \n-0.4042, -0.0012, 0.5562, -0.4670, 0.9071, -0.9936, 1.1625, -0.4680, -0.2204, -0.0960, -1.2111, \n0.1886, 0.3161, -0.9386, -0.1220, 1.0281, -0.6877, -0.0207, 0.4580, 0.2693, 0.2066, 0.7433, \n-0.3463, -0.2147, -0.2686, -0.4448, 1.0437, -1.0937, 0.0168, 0.7392, 0.7671, 0.2446, -0.1433, \n0.5917, -1.7294, 0.2946, -0.3953, 0.6402, 0.3588, -0.1399, -0.4596, 0.4497, -0.4538, 0.1131, \n-0.2322, -0.8198, -1.2447, -1.1113, -1.0501, 0.3899, -0.1309, 0.1831, 0.8335, -0.8446, 0.6795, \n0.7655, 0.3024, -1.0631, 0.4893, -0.4582, -0.0787, 0.0855, -0.4888, 0.3321, 0.4959, 0.5852, \n-0.5971, 0.5776, 0.0800, 0.9763, 1.2146, -0.0915, -0.2013, 1.0210, 0.8808, -0.4526, -1.0551, \n1.4202, -0.6870, -0.7511, 0.2425, -0.0143, -0.0435, 0.9191, -0.9512, -0.3755, 0.9080, -0.0164, \n0.5603, -0.7134, -0.3008, 0.9320, 0.4597, 0.4154, -0.1626, -2.2732, 0.1601, 0.3804, -0.8411, \n0.8503, -0.7037, -0.7987, 0.2593, -1.5137, -1.2783, 1.1013, -0.6130, -0.5623, -0.6166, -0.2695, \n0.6681, 1.3198, 0.7440, -0.1295, 0.7677, -0.1668, -0.0025, 1.1210, -0.4676, -0.8589, 0.9940, \n-0.9835, 0.4436, -0.4369, 0.1079, 0.1360, -0.0825, -0.7095, 0.0681, -1.3845, 0.5852, 0.8321, \n0.0605, 1.1025, 0.3809, -0.7221, 0.5267, -0.1641, -0.6587, -0.7080, 0.3581, -0.4730, -1.2431, \n0.7567, 0.4748, 0.2086, -0.3209, 0.4044, -0.0655, -0.6807, -0.5062, -0.1792, 0.9899, 0.0738, \n-0.4651, 0.5615, -0.2979, -0.0789, 0.0056, -0.2647, 0.4159, -0.0418, 0.6227, 0.4040, 0.3636, \n-0.5264, -0.0963, 1.3062, -0.2342, 0.2348, -0.7170, -0.9199, -0.4551, 0.1270, 0.2857, -1.4278, \n-0.2762, 0.4388, -0.6362, -0.2597, -0.2475, -1.0338, -0.1308, -0.0719, 0.4898, 0.0274, 0.6681, \n-0.6961, -0.8782, -1.1522, 0.7324, 1.4559, -0.5088, 0.3230, 0.0724, -0.2616, -0.1929, -0.8039, \n0.3292, 0.6831, -0.9345, 0.0043, -1.1654, -0.0865, 0.2562, -0.0593, 1.2474, -1.3338, 0.0027, \n-0.3772, -0.7264, 0.8516, -1.9820, 0.1548, -0.0778, 0.7137, -0.6119, 1.2299, 0.0138, 0.5013, \n-0.7631, -0.9939, -0.6386, -0.3077, 0.1781, -0.0237, -0.3262, 0.2881, 0.1228, 0.0844, 0.1961, \n-0.8574, 0.4877, -0.5856, -0.8566, -0.0642, 0.3583, -0.1731, -0.0220, -0.2000, -0.1868, -1.0696, \n-1.5965, 0.4023, 0.5220, -0.6586, 0.4334, -1.0592, 0.2308, -0.2647, 0.8456, -0.1612, -0.9128, \n-1.2446, -0.1251, 0.2892, -0.5044, -0.3747, -0.3555, 0.5972, -0.1808, 0.2070, -0.6374, -0.6036, \n-1.3443, -2.0261, 1.2490, -0.0177, 0.3175, 0.2166, -0.5418, 0.9668, 0.6408, 0.3539, 0.1286, \n0.5480, -0.4669, -0.7592, 0.1993, -0.5903, 0.1730, 0.1197, -0.4827, 0.4653, -0.4525, -0.8513, \n-0.4576, 0.8194, 0.9134, 1.3234, 0.9791, 0.5079, 0.4611, 0.3363, -0.4372, 0.9258, -0.5428, \n0.7705, -0.2705, 0.7332, -0.1152, 0.1458, 0.7850, 0.6869, 0.0914, 0.1422, 0.8796, -0.2120, \n0.4945, 0.9192, 0.3583, -0.1265, 0.5735, 0.2788, 0.2601, -0.8112, -0.3187, 0.3663, 0.6416, \n-0.3823, 0.2522, 0.2696, -0.5346, 0.2838, -0.2619, -0.5507, -0.7322, 0.5860, -1.0451, -0.1326, \n-0.7068, 0.4106, 0.5367, -1.2288, 0.2050, 0.2645, -0.2115, -0.0111, -0.8958, -1.2505, 0.3066, \n1.4262, 0.4448, -0.0143, -0.0997, -0.8134, 0.6952, -1.7971, 0.7330, -0.5741, 0.6936, -0.6141, \n1.7770, 0.3935, 0.1708, -0.2148, -0.0437, 0.1934, 0.0524, -1.0573, 0.2667, 0.7637, -0.4432, \n0.5039, 1.1426, 0.2580, 0.5152, -1.2821, 0.9741, 0.1809, 0.1923, -1.0616, 0.7731, -0.4472, \n-0.2922, -0.0814, 0.8629, 0.1368, 0.4933, -0.8948, -0.2161, -0.8033, -0.1695, -0.4781, 0.7218, \n0.1313, 0.3117, 0.8950, -1.1923, -0.3072, 0.6421, 0.4300, -2.4470, 1.3093, -0.4241, -0.5472, \n0.4420, 0.3381, 1.6517, -1.8540, 0.8487, 0.8205, -0.0164, -0.9833, -0.2729, 0.2228, -0.5919, \n0.0830, 0.7659, -0.0579, 0.0444, 0.1895, -1.5587, -0.6519, -0.0190, -0.8966, 1.1691, -0.7786, \n-0.1883, 0.1409, 0.0896, 1.1640, 0.5104, -0.8119, 0.8620, -1.0101, -0.3579, -1.6250, 0.0481, \n-0.4517, -0.2207, -0.2543, 0.2868, -1.8291, -0.0428, -0.2019, -0.7567, -2.2016, -0.0463, 0.7084, \n-0.6590, 0.2548, -1.3411, 1.9429, -0.2899, -0.6012, -1.8306, -0.1281, -0.0534, 0.3422, -0.5059, \n0.2954, -1.0717, 0.2148, -0.2702, 0.6576, 0.3255, 0.5079, 1.0290, -0.0792, 1.2377, -1.0057, \n2.2866, -0.6935, 0.3854, -0.7936, 0.5195, -0.5747, 0.7711, -0.9002, 0.1013, 0.6881, 0.7099, \n-0.2997, 0.0446, -0.7431, -0.7670, 0.1127, -0.8658, 1.8997, -0.4320, -0.6225, -0.3152, -1.2941, \n-0.0790, -0.8243, -0.2412, -0.1087, 0.3323, 0.1274, -1.1266, 0.2729, -0.5817, 0.2157, 0.4869, \n0.0630, -0.2592, -0.6345, -0.2924, -2.2870, -0.3677, 0.0337, -1.2604, -0.6918, -0.0929, -0.7726, \n-0.3030, 1.0100, 0.1473, 0.4599, -1.3256, 0.8796, 1.5478, 0.6699, -0.6653, 0.1552, -0.0816, \n-0.4298, -0.5381, -0.0087, -1.6599, -0.4192, -0.4127, 0.0655, -0.6082, -1.3003, -0.3227, -0.3404, \n0.5386, -0.0505, -0.4408, -0.6571, 0.8695, 0.3474, -1.0971, -0.5846, 0.4892, 0.1851, 0.0245, \n0.4851, 0.9137, 0.5579, 0.1807, -0.3458, -1.1599, 0.1899, 0.4100, 0.0861, 0.6511, -0.1799, \n-0.6587, 0.2953, -0.2669, -1.5148, 0.6587, -0.5553, -0.1108, -0.0009, 0.2148, -0.0202, -0.4221, \n0.4103, -0.2589, 0.0890, 0.6213, 0.5491, 0.2326, 0.4956, -0.1025, 0.6397, 0.0741, 0.0642, \n0.7262, 0.5070, -0.2106, -0.2947, -0.6731, 0.5036, -0.3751, 0.1505, 0.2574, -0.1145, -0.5114, \n-1.3168, 0.0144, 0.3128, -0.1230, -0.0783, 0.5160, -0.3098, -1.2948, -0.2636, -0.9889, -0.1309, \n0.8780, 0.8369, 0.6396, -0.1321, 0.5048, 0.4279, -1.6269, 0.5765, 0.4810, 0.1615, -0.5022, \n-1.4363, -0.3429, -1.3899, 0.7932, -0.2422, -0.1044, -0.3836, -1.9323, 0.0427, -0.3404, 0.1114, \n0.5713, -0.9552, 0.5966, -1.5306, 0.3490, 0.7517, 0.7451, -0.8441, -0.1107, -0.4358, 0.5782, \n-1.0853, 0.1196, -0.9939, -0.4254, -0.8361, 0.3055, -1.2385, 1.1064, -0.2365, -1.0342, -0.7817, \n0.2120, -0.3241, 0.5504, -0.7827, -0.0637, -2.1733, 0.4534, -0.5688, 0.2945, 0.9055, 0.5326, \n-0.1585, 0.7324, -0.1533, -0.3894, -1.5642, 0.4856, 0.2225, -0.2227, -1.6340, -0.4287, -0.4354, \n0.1731, 0.6402, -0.0743, 0.1931, -0.7186, 0.6786, -1.2820, -0.2227, 0.7574, 0.6806, -0.4493, \n-1.3490, 0.3093, 0.0931, -0.4481, 0.9673, 0.1425, -0.3327, -0.1494, 1.1964, 0.4227, -0.4073, \n0.7025, 0.6498, 0.7884, -0.7188, 1.3858, 0.4515, -0.9979, 0.1908, 1.3719, 0.3361, -0.8257, \n1.1756, -0.1589, -0.2409, 1.3644, -0.0627, -0.3256, -0.3890, -1.4530, 0.0177, -0.5089, 0.1421, \n-0.4634, -0.2485, 0.1502, -0.6235, -0.6336, -0.4525, -1.0850, -0.8245, 1.0048, -0.4884, -1.1681, \n-0.1713, -0.7141, 0.2250, -0.0005, -0.4913, -0.1702, -0.2851, -0.4535, -0.0510, -0.3361, -0.3893, \n0.0279, -0.0161, -0.3197, 0.3363, 0.1706, 1.1265, -0.2793, -0.0831, -0.8223, -0.3736, 0.7576, \n-0.0416, 0.6002, -0.1643, -0.2261, 1.0334, 0.5014, -0.4965, -0.8434, -0.6047, -1.4453, 0.3919, \n0.4876, 0.6502, -0.3849, -0.9699, 0.8736, -0.4790, -0.6747, 0.1407, -0.0722, 0.3787, 0.6481, \n-1.9073, 1.1740, 1.1456, -0.2385, -0.6735, 0.0134, -0.0648, 0.2784, -0.2075, 0.2192, 0.7126, \n-0.2530, 1.0569, 0.4630, -0.4768, -1.5135, -0.0320, -0.5077, -0.4773, 0.2095, 0.0581, 0.2799, \n-0.0718, 0.1004, -0.8941, -0.7096, 0.9014, -0.8832, -0.5268, 0.1379, 0.0870, 0.3177, -0.1767, \n-0.8781, 0.8684, 0.9020, -1.3122, -0.9206, -2.0631, 0.5132, -0.1977, -0.7251, -0.0888, -1.4335, \n0.4184, 1.1666, -1.1485, 0.9747, 0.3180, 0.4200, 0.4472, -0.2513, -0.5234, -0.8721, -1.8589, \n1.0140, 0.9771, 0.4363, 0.3374, -0.6595, 0.2879, -1.0252, -0.1044, -1.1856, -0.4153, -0.6517, \n-1.0178, 1.0538, 1.4262, -0.1001, 0.4477, -1.3394, 0.1495, 0.0589, -0.7254, 0.0472, 0.3313, \n-0.2133, -0.2408, -1.0380, -0.7772, 0.5337, 0.0496, -0.0411, -0.1126, 1.0657, 0.3442, 0.6248, \n-0.8121, -2.1604, 0.6243, -1.1335, 0.6896, -0.7523, 0.1527, -0.4389, 0.4157, 0.5143, 0.1589, \n-0.5768, -0.6495, -0.4035, -0.2209, 0.5325, 1.1390, 0.8578, -0.4047, 0.8918, -0.6158, 0.1705, \n-0.5199, -0.4463, -0.3637, 0.2485, -0.1858, 0.4594, 0.0173, -0.3136, 0.1836, -0.1839, -1.7145, \n-0.6577, -0.3875, -0.0999, -0.4030, 0.7508, -1.0110, 1.0949, -0.4468, 0.6666, -0.0360, 0.6937, \n0.1490, 0.1237, 0.8602, -0.3471, -0.3891, -0.4182, 0.3821, -2.4090, -1.8317, -0.5282, 0.4636, \n-0.1941, -0.7429, -0.1168, 1.3070, -0.1820, 0.7605, 0.7031, 1.0166, -0.7771, 0.4137, -0.0704, \n0.1944, -0.6597, -0.4903, 0.0338, 0.5349, -0.9897, 0.7137, 0.6469, -0.2258, -0.2187, 1.4367, \n0.2616, -1.5112, -0.9768, 0.7649, 0.3928, -0.1063, -0.3380, -0.1430, 0.4605, 0.5874, 0.7531, \n0.4078, 0.4331, 0.3250, 0.7644, 0.0315, 0.1611, 0.3085, 0.5133, 0.0586, 0.8963, -0.3265, \n-0.1730, 0.9052, 0.8342, 0.3631, 0.4212, 0.8943, -0.3559, 0.9505, -0.0670, 0.6717, 0.5663, \n-0.2270, 0.4086, -0.7122, 1.0930, 0.7699, -0.3333, -0.5880, 0.7524, 0.0631, 0.3611, -0.3387, \n0.6447, 0.7071, 1.3717, -0.2330, -0.2985, 1.2664, -0.5824, 0.7442, 1.0204, -1.5572, 0.8220, \n-1.4747, -0.8639, -1.2992, -0.2264, -0.8866, -1.6053, -0.8595, 0.2685, -1.0495, 0.5109, 0.4357, \n1.0904 );\nconst float biases2[] = float [] (\n-0.3983, 0.3359, -0.5472, -1.6984, 0.3076, -1.7286, 0.0291, 0.6512, 0.2428, -1.0264, -1.2279, \n0.0813, -0.8784, -0.2904, -0.4996, -1.2489, -0.2931, -2.0596, -0.8206, 0.3727, 0.2160, -0.9081, \n-0.2880, 0.7337, -1.3150, 0.0215, -1.1154, -0.7393, -1.0523, -0.6643, -1.0442, -0.8873 );\nconst float weights3[] = float [] (\n0.0039, -0.0125, -0.0043, -0.0141, 0.0295, -0.0254, -0.0040, 0.0001, 0.0102, 0.0220, 0.0057, \n0.0083, 0.0034, -0.0209, 0.0099, -0.0179, 0.0273, -0.0214, -0.0182, -0.0184, -0.0151, 0.0035, \n0.0006, 0.0134, -0.0076, 0.0122, -0.0277, 0.0159, 0.0163, -0.0215, -0.0076, 0.0247, -0.0573, \n0.0042, -0.0070, 0.0176, -0.0016, -0.0391, -0.0207, 0.0092, 0.0048, 0.0027, -0.0193, -0.0200, \n-0.0116, -0.0191, -0.0188, -0.0113, 0.0145, -0.0147, -0.0643, 0.0319, -0.0372, 0.0457, -0.0813, \n0.0119, 0.0334, 0.0233, -0.0298, 0.0167, -0.0174, -0.0079, -0.0194, -0.0314, -0.1111, -0.4043, \n-0.3005, -0.0540, 0.2397, 0.1314, 0.5226, 0.3570, -0.2072, 0.3573, -0.1222, -0.2606, 0.1134, \n-0.9201, -0.0910, 0.0539, -0.0296, 0.3822, 0.0619, 0.2567, 0.0119, -0.1748, -0.3136, 0.0420, \n-0.7668, -0.1395, -0.1276, 0.1549, 0.0530, -0.1428, -0.5038, -0.1618, -0.0078, -0.0399, -0.0277, \n0.0161, -0.0002, 0.0375, 0.0123, 0.0098, -0.0168, 0.0047, -0.0314, -0.0369, -0.0288, -0.0001, \n0.0202, -0.0057, 0.0282, -0.0366, -0.0351, -0.0371, -0.0074, 0.0179, -0.0141, 0.0053, 0.0316, \n-0.0117, -0.0149, -0.0339, -0.0310, -0.0066, -0.0129, 0.0986, -0.0281, 0.0171, -0.0002, -0.0002, \n0.0148, -0.0127, 0.0257, 0.0075, 0.0048, 0.0153, 0.0002, 0.0001, -0.0169, -0.0171, 0.0140, \n0.0136, 0.0226, -0.0005, 0.0059, -0.0007, -0.0259, 0.0123, -0.0085, 0.0094, -0.0026, 0.0048, \n-0.0236, 0.0088, -0.0119, -0.0165, -0.0073, 0.0272, -0.3997, -0.0646, -0.4748, 0.0980, -0.3192, \n-1.1887, -0.9240, 0.0744, -0.2605, -0.5374, -0.3752, 0.2806, -0.1946, -0.3414, 0.1628, -0.1341, \n-0.2798, 0.1494, 0.2516, 0.5300, -0.2229, -0.5047, 0.1844, -0.4397, 0.0236, -0.1883, -0.1733, \n0.1306, 0.1889, -0.2573, 0.1055, -0.1112, -0.0160, 0.0029, -0.0109, -0.0230, 0.0353, -0.0024, \n-0.0014, -0.0047, -0.0029, 0.0099, -0.0130, -0.0001, -0.0226, -0.0128, -0.0027, 0.0012, 0.0278, \n0.0018, -0.0158, 0.0066, -0.0057, 0.0299, -0.0047, 0.0232, 0.0230, 0.0189, -0.0485, 0.0065, \n-0.0125, 0.0083, 0.0098, 0.0145, -0.2843, 0.1360, -0.1590, -0.4197, 0.3097, 0.0515, -0.6931, \n0.3596, 0.5024, 0.1935, -0.0888, -0.1666, -0.2825, 0.4931, 0.3587, -0.3015, 0.0184, -0.2614, \n-0.4572, -0.5801, 0.4817, 0.2702, -0.4570, -0.0898, -0.2800, -0.2925, -0.2057, 0.0188, -0.8359, \n-0.2937, -0.1204, -0.1620, -0.0137, 0.0063, -0.0105, 0.0006, 0.0204, 0.0009, 0.0087, -0.0036, \n-0.0110, -0.0180, -0.0115, 0.0036, -0.0113, -0.0075, 0.0060, 0.0223, 0.0412, -0.0003, -0.0281, \n-0.0050, 0.0061, 0.0303, -0.0209, 0.0178, 0.0027, 0.0172, -0.0498, 0.0068, -0.0062, -0.0305, \n0.0090, 0.0216, -0.0006, -0.0029, 0.0013, 0.0237, -0.0035, 0.0071, 0.0104, 0.0081, 0.0050, \n0.0189, -0.0105, 0.0018, 0.0116, -0.0086, 0.0344, 0.0156, 0.0615, -0.0353, -0.0261, -0.0090, \n0.0005, 0.0400, 0.0072, 0.0159, 0.0098, 0.0309, -0.0684, -0.0129, -0.0158, 0.0039, -0.0111, \n0.0307, -0.2694, -0.2972, 0.3293, 0.1010, 0.0258, -0.4605, 0.1234, 0.6190, -0.3782, -0.5331, \n-0.2268, 0.8190, -0.0987, -0.2132, -0.2056, 0.2425, 0.0692, 0.4386, 0.2301, 0.1515, 0.1529, \n-0.4747, -0.1200, 0.2879, 0.1043, -0.7773, 0.0930, -0.2048, -0.0649, -0.4823, -0.1379, 0.3543, \n-0.8462, -0.3350, 0.1005, 0.1871, -0.2445, -0.4884, -0.4541, 0.0385, 0.0287, -0.7943, -0.0401, \n-0.2635, -0.2452, 0.1825, -0.2038, -0.0420, 0.0692, -0.9232, 0.0637, -0.1567, -0.1699, -0.1991, \n-0.2292, -0.3626, -0.2872, 0.1459, 0.4003, 0.0828, -0.3624, -0.5574, -0.1634, 0.1962, 0.4666, \n0.3801, -0.5025, 0.1513, 0.5822, 0.8416, 0.3831, -0.2287, 0.5995, 0.7514, -0.1493, -0.1694, \n-0.2351, 0.3374, -1.4076, 0.0078, 0.9359, -0.3488, -0.1418, 0.2597, -0.7749, 0.2772, 0.0402, \n-0.3209, 0.7518, 0.1575, 0.3333, 0.0235, 0.7109, 0.6438, 0.0843, 0.1048, 0.4977, -0.0625, \n0.0505, -0.0920, -0.2169, -0.0431, 0.1763, -0.5736, 0.2029, 0.3672, -0.0139, 0.3500, -0.8895, \n1.0033, 0.3873, -0.3738, 0.4479, -0.5078, 0.0546, 0.7087, 0.1121, 0.1215, 0.1777, 0.0260, \n0.3595, -0.2566, -0.0152, -0.3105, -0.2985, 0.0721, -0.0404, 0.5817, 0.2341, -0.2425, -0.3886, \n-0.1910, 0.4061, 0.3619, -0.2446, 0.1320, 0.1558, 0.6732, -1.5964, -0.0488, -0.2317, 0.0393, \n-0.0701, -0.0063, -0.3830, 0.0739, 0.0492, -0.0761, 0.1364, 0.6627, -0.1083, 0.3674, -1.1465, \n0.1626, -0.5847, -0.2995, 0.0215, -0.0454, -0.7884, 0.0454, 0.4416, 0.0710, 0.1936, -0.3656, \n-0.0212, -0.8280, -0.1572, -0.3725, -0.2825, 0.0677, 0.0397, -0.0422, 0.5133, -0.1535, 0.6457, \n-0.2042, -0.4008, -0.8220, -0.1280, -0.4479, 0.0899, 0.4617, -0.1454, -0.2475, -0.0147, -0.0367, \n0.1473, -0.2201, -0.3553, -0.3234, -0.1235, -0.5960, 0.0164, 0.0113, 0.0133, 0.0052, 0.0105, \n0.0157, -0.0058, -0.0429, 0.0360, 0.0023, -0.0267, -0.0150, -0.0155, -0.0235, 0.0345, -0.0028, \n0.0009, 0.0071, -0.0264, -0.0017, -0.0103, 0.0352, -0.0145, 0.0120, 0.0246, -0.0033, -0.0272, \n-0.0161, -0.0001, 0.0312, -0.0222, 0.0025, -0.6540, -0.0966, -0.1522, -0.1767, 0.2894, 0.1715, \n-0.2085, -0.1053, 0.1221, -0.5922, -0.2623, -0.0463, 0.1301, 0.3376, -0.0646, -0.3653, -0.1716, \n-0.6340, -0.1533, -0.2490, 0.0071, 0.3125, -0.2388, 0.3027, 0.4351, -0.0169, -0.1282, -0.4638, \n0.3037, 0.5839, -0.1784, -0.1407, -0.6260, 0.2673, 0.1720, 0.2260, -0.6548, -0.7909, 0.2983, \n0.2197, 0.5014, 0.4145, 0.2490, 0.2199, -0.0351, 0.3555, -0.1216, -2.2854, -0.8020, 0.7741, \n0.1356, 0.1085, -0.3565, -0.4308, 0.6916, -0.3289, -0.4633, -0.4432, 1.0548, 0.6184, -0.3230, \n0.1334, -0.4709, -0.1090, 0.0035, 0.0105, -0.0000, 0.0038, 0.0056, 0.0268, 0.0081, 0.0142, \n-0.0066, 0.0001, 0.0055, -0.0072, -0.0080, -0.0229, -0.0043, 0.0192, -0.0032, -0.0111, -0.0069, \n-0.0176, 0.0148, -0.0005, -0.0348, 0.0147, -0.0182, 0.0095, -0.0253, -0.0037, 0.0018, 0.0060, \n-0.0067, 0.0085, -0.1380, -0.1516, -0.2576, -0.3296, 0.3229, 0.4967, -0.4356, -0.1980, -0.1747, \n-0.0475, -0.1013, 0.3357, -1.0082, -0.9079, -0.1032, 0.1784, 0.7716, -0.4379, 0.2831, -0.0838, \n0.5897, -0.6358, -0.3806, -0.0302, -0.5958, -0.6468, -0.3181, 0.0446, 0.2366, -0.2941, -0.2416, \n0.3141, 0.0396, -0.0012, -0.0119, 0.0222, 0.0196, 0.0286, -0.0118, 0.0153, -0.0275, 0.0010, \n-0.0164, -0.0009, 0.0140, 0.0048, 0.0252, 0.0050, 0.0488, -0.0736, -0.0620, -0.0518, -0.0072, \n0.0210, -0.0258, 0.0174, 0.0257, -0.0046, -0.0359, -0.0079, -0.0238, -0.0116, -0.0079, 0.0526, \n0.0240, -0.0111, -0.0065, -0.0040, -0.0093, -0.0018, 0.0152, -0.0121, 0.0243, -0.0106, -0.0329, \n0.0059, -0.0118, 0.0005, 0.0308, 0.0093, 0.0540, 0.0053, -0.0180, 0.0098, 0.0151, 0.0167, \n-0.0352, 0.0329, 0.0267, 0.0103, 0.0052, 0.0110, -0.0139, -0.0115, -0.0151, -0.0003, 0.0675, \n0.1134, 0.1652, 0.1434, -0.4194, -0.0200, 0.0211, 0.0908, 0.3174, -0.2141, 0.1839, -0.0337, \n0.0362, 0.0312, 0.0983, 0.2610, -0.4272, 0.3050, 0.1847, -0.4244, -0.2417, -0.4032, 0.1031, \n-0.2263, 0.0735, -0.0056, -0.2143, -0.0659, 0.0680, 0.2444, 0.1167, 0.1722, -0.0271, 0.0136, \n-0.0018, -0.0057, 0.0274, 0.0233, 0.0071, 0.0131, 0.0036, 0.0052, 0.0030, -0.0037, -0.0064, \n-0.0120, -0.0078, 0.0048, 0.0246, -0.0195, -0.0268, -0.0042, -0.0191, 0.0236, -0.0016, 0.0187, \n-0.0231, 0.0137, -0.0124, -0.0050, -0.0035, -0.0025, -0.0035, 0.0235, -0.0863, -0.2747, -0.0108, \n-0.4556, -0.0516, -0.2851, 0.0425, 0.2456, 0.7792, -0.0678, -0.4548, -0.1451, 0.5612, -0.7380, \n0.7055, -0.3787, -0.5319, 0.4520, 0.6840, -0.4663, 0.2353, -0.3937, 0.7171, -0.9562, -0.6100, \n-0.2000, -0.0853, -0.5535, 0.0812, 0.3153, 0.0399, 0.0400, 0.3203, 0.0844, 0.1427, -0.0923, \n0.0073, -0.9656, 0.3525, -0.7014, -0.4454, 0.3953, -0.1185, 0.0713, -0.0364, 0.0244, 0.3998, \n-0.2131, -0.1445, 0.5095, 0.3547, 0.2000, -0.1532, 0.0778, 0.4257, 0.1901, 0.3652, 0.1030, \n-0.7259, 0.3797, -0.1578, -0.0644, -0.0688, 0.4507, -0.6026, -0.1536, 0.2388, -0.0779, 0.3068, \n0.1368, -0.4007, 0.3972, 0.2675, -0.0625, 0.0690, 0.1439, -0.3966, -0.2462, -0.1170, -0.0926, \n-0.3835, -0.2570, -0.4213, -0.3192, 0.1116, 0.2803, -0.1931, -0.1979, 0.1102, -0.0158, 0.2984, \n0.1359, -0.2910, -0.0050, -0.1876, -0.2082, 0.0404, 0.2161, 0.2701, -0.5539, -0.1972, 0.1112, \n-0.1928, 0.0182, -0.4393, -0.3906, -0.2795, -0.0278, -0.2386, 0.0365, 0.5180, -0.1013, 0.5163, \n-0.4942, 0.0511, -0.4277, 0.0185, -0.2714, 0.2493, -0.3520, -0.0060, 0.2447, -0.1607, -0.0850, \n-0.1570, 0.7170, 0.3975, 0.1406, -0.2307, 0.4881, 0.0488, -0.3951, -0.6936, -0.2529, 0.6593, \n-0.6423, -1.0615, 0.4348, -0.2204, 0.2450, -0.0903, 0.7853, -0.3225, -0.1225, -0.1328, 0.5915, \n-0.4914, 0.0752, -0.3520, -0.3678, 0.1690, 0.1942, 0.8825, -0.1632, 0.7632, 0.5925, 0.3541, \n0.2782, -0.1885, -0.0432, 0.2861, -0.0589, 0.1883, 0.2731, -0.6020, -0.0076, 0.0987, -0.0667, \n-0.0753, 0.2087, -0.1074, 0.2055, -0.0564, 0.5432, -1.3425, 0.3430, -0.3974, -0.1266, 0.4371, \n0.3234, 0.6657, -0.4399, -0.1186, -0.0181, -0.0669, -1.0424, -0.6556, 0.2364, -0.5882, -0.8690, \n-0.1935, -0.3310, -0.3380, -0.1665, -0.1993, -0.4783, -0.0120, 0.1874, 0.6800, -0.0083, -0.0679, \n-0.1680, 0.0455, -0.5998, -0.8488, -0.8015, -0.6805, 0.1687, 0.0129, 0.9224, -0.1131, 0.2286, \n0.6124, 0.1647, 0.3206, 0.0309, 0.4401, -0.2839, -0.4262, 0.2693, -0.3816, 0.3205, -0.1236, \n0.2643 );\nconst float biases3[] = float [] (\n-0.0627, -0.0849, 0.0910, -0.0682, -0.0564, -0.3592, -0.0685, -0.3227, -0.0645, -0.0643, -0.5981, \n-0.4058, -0.7803, -0.3026, -0.7628, -0.1935, -0.0528, -0.1235, -0.2680, -0.0463, -0.7831, -0.0773, \n-0.0768, -0.1238, -0.0595, -0.1018, -0.3578, -0.1677, -0.5204, -0.2229, -0.3683, -0.6300 );\nconst float weights4[] = float [] (\n-0.0001, 0.0018, -0.0219, -0.0017, -0.0004, 0.0187, -0.0005, -0.0321, 0.0001, 0.0003, 0.0268, \n0.0244, 0.0195, -0.0241, -0.1098, -0.0181, 0.0017, -0.0229, 0.0258, 0.0002, -0.0449, -0.0002, \n0.0014, 0.0370, -0.0001, -0.0145, 0.0160, -0.0131, 0.0236, 0.0177, 0.0217, -0.0209 );\nconst float biases4[] = float [] (\n-0.0179 );\n\nfloat leakyReLU(float x)\n{\n\treturn max(0.0, x) + 0.1 * min(0.0, x);\n}\n\nconst int H = 32;\t// size of hidden layers\n\n// compute MLP network layer\n#define COMPUTE_LAYER(I, W, B, N, M, O, R) \\\n    for(int i=0; i<M; i++) { \\\n        float r = 0.0f; \\\n        for(int j=0; j<N; j++) { \\\n            r += I[j] * W[i*N+j]; \\\n        } \\\n        r += B[i]; \\\n        O[i] = R ? leakyReLU(r) : r; \\\n    }\n\n// evaluate network at position p\n// returns distance to nearest surface\nfloat network(vec3 p)\n{\n    // temp storage\n\tfloat _out[H];\n    float _out2[H];\n    \n    // input\n    _out2[0] = p.x;\n    _out2[1] = p.y;\n    _out2[2] = p.z;\n        \n    // layer 0 (input)\n    COMPUTE_LAYER(_out2, weights0, biases0, 3, H, _out, true);\n        \n    // layer 1\n    COMPUTE_LAYER(_out, weights1, biases1, H, H, _out2, true);\n    \n\t// layer 2\n    COMPUTE_LAYER(_out2, weights2, biases2, H, H, _out, true);\n    \n\t// layer 3\n    COMPUTE_LAYER(_out, weights3, biases3, H, H, _out2, true);\n    \n    // layer 4 (output)\n    COMPUTE_LAYER(_out2, weights4, biases4, H, 1, _out, true);\n    \n    return tanh(_out[0]);\n}\n\n\nconst int maxSteps = 32;\nconst float hitThreshold = 0.0005;\n\nfloat sphere(vec3 p, float r)\n{\n    return length(p) - r;\n}\n\n// cast ray using sphere tracing\nvec3 raycast(vec3 ro, vec3 rd, out bool hit)\n{\n    hit = false;\n    vec3 pos = ro;\n\n    for(int i=0; i<maxSteps; i++)\n    {\n        float d = network(pos);\n        //float d = sphere(pos, 0.5);\n        if (abs(d) < hitThreshold) {\n            hit = true;\n            break;\n        }\n        pos += d*rd;\n    }\n    return pos;\n}\n\nmat3 rotX(float a)\n{\n    float sa = sin(a);\n    float ca = cos(a);\n    return mat3(1.0, 0.0, 0.0, 0.0, ca, -sa, 0.0, sa, ca);\n}\n\nmat3 rotY(float a)\n{\n    float sa = sin(a);\n    float ca = cos(a);\n    return mat3(ca, 0.0, sa, 0.0, 1.0, 0.0, -sa, 0, ca);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 p = (fragCoord.xy / iResolution.xy)*2.0-1.0;\n    p.x *= iResolution.x / iResolution.y;\n    \n#if 0\n    // visualize slice\n    float z = (iMouse.y / iResolution.y)*2.0-1.0;\n    float d = network(vec3(p, z));\n    fragColor = vec4(vec3(d), 1.0);\n#else\n    // ray cast\n    float rx = 0.0;\n    float ry = 0.0;\n    if (iMouse.z > 0.0)\n    {\n    \trx = ((iMouse.y / iResolution.y)-0.5)*3.0;    \n        ry = ((iMouse.x / iResolution.x)-0.5)*6.0;\n    }\n\t\n    // camera\n    mat3 m = rotY(ry) * rotX(-rx);\n    vec3 ro = m * vec3(0.0, 0.0, 1.5);\n    vec3 rd = m * normalize(vec3(p, -2.0));\n            \n    bool hit=false;\n    vec3 hitPos = raycast(ro, rd, hit);\n    vec3 n = normalize(cross(dFdx(hitPos), dFdy(hitPos)));\n    \n    //fragColor = vec4(hit ? hitPos : vec3(0), 1.0);\n    fragColor = vec4(hit ? n*0.5+0.5 : vec3(0), 1.0);\n#endif    \n}\n","name":"Image","description":"","type":"image"}]}