{"ver":"0.1","info":{"id":"Ml3Szs","date":"1481147001","viewed":386,"name":"Reflection in a Circle","username":"trirop","description":"GLSL implementation of this tweet: https://twitter.com/shonk/status/637461597993070592\nYou can change the starting point with the mouse.","likes":18,"published":1,"flags":0,"usePreview":0,"tags":["2d","raytracing","reflection","circle"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define tau 6.28318530718\n\nfloat line(vec2 uv, vec2 p1, vec2 p2){\n    vec2 dir = normalize(p2-p1);\n    mat2 inv = mat2(dir.x,-dir.y,dir.y,dir.x);\n    uv=inv*(uv-p1);\n\tp2=inv*(p2-p1);\n    return float(abs(uv.y)<0.002&&0.<uv.x&&uv.x<p2.x);\n}\n\nvec2 ct(vec2 uv){return 2.*uv/iResolution.y-vec2(iResolution.x/iResolution.y,1);}\n\nfloat sph(vec2 ro,vec2 rd,float r)\n{\n\tfloat b = dot(ro,rd);\n    return -b+sqrt(b*b-dot(ro,ro)+r*r);\n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    fragColor=vec4(0);\n\tvec2 uv = ct(gl_FragCoord.xy);\n    for(float s = 0.;s<tau;s+=tau/40.){\n\t\tvec2 ro = mix(vec2(0,-0.4),ct(iMouse.xy),float(iMouse.xy!=vec2(0)));\n        if(length(ro)>0.8){ro=normalize(ro)*0.8;}\n        vec2 rd = vec2(cos(s),sin(s));\n        for(int i = 0;i<15;i++){\n            vec2 p = ro+rd*sph(ro,rd,0.8);\n            fragColor+= 0.15*vec4(line(uv,ro,p));\n            rd = reflect(rd,-normalize(p));\n            ro = p;\n        }\n    }\n    fragColor += vec4(length(uv)<0.803&&length(uv)>0.8)+0.2;\n}","name":"Image","description":"","type":"image"}]}