{"ver":"0.1","info":{"id":"wsdGz7","date":"1568136652","viewed":91,"name":"stump","username":"foran","description":"stump","likes":3,"published":1,"flags":0,"usePreview":0,"tags":["stump"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XdXGzr","filepath":"/media/a/8979352a182bde7c3c651ba2b2f4e0615de819585cc37b7175bcefbca15a6683.jpg","previewfilepath":"/media/ap/8979352a182bde7c3c651ba2b2f4e0615de819585cc37b7175bcefbca15a6683.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define time iTime\n#define PI 3.14159\n#define TAU (2.*PI)\nfloat smin(float a, float b, float k)\n{\nfloat h = clamp(0.5+0.5*(b-a)/k,0.,1.);\nreturn mix(b,a,h)-k*h*(1.-h);\n}\nvec2 moda (vec2 p, float per)\n{\nfloat angle = atan(p.y, p.x);\nfloat l = length(p);\nangle = mod(angle-per/2., per)-per/2.;\nreturn vec2(cos(angle),sin(angle))*l;\n}\n\nfloat sphe (vec3 p, float r)\n{\np.y-=2.42;//              высота сферы\nreturn length(p)-r;\n}\n\nfloat cylY (vec3 p, float r, float h)\n{\nreturn max(length(p.xz)-r, abs(p.y)-h); \n}\n\nfloat plane (vec3 p, vec2 uv)\n{\nvec4 text = texture(iChannel0, uv/2.);\np.y +=.5;\np.y+=text.x;\nreturn p.y;\n}\nfloat cylX (vec3 p, float r, float h)\n{\n\np.xz = moda(p.xz, 2.*3.14/5.);\np.x -= 0.8;\np.xy += p.z*sin(iTime);\np.y += .99;//  высота основания над поверхностью\nr-=p.x*0.2;\nreturn max(length(p.yz)-r, abs(p.x)-h); \n}\n\nfloat SDF(vec3 p, vec2 uv)\n{\nfloat body = smin(cylY(p,0.49,2.25), sphe(p,0.5), 0.14);//cylY(p,.53,1.95)//.53  толщина  1.95 высота цилиндра\nfloat all_body =  smin(body,cylX(p, 0.2, 1.), 0.5);\nreturn min(all_body, plane(p, uv));\n}\n//----------\nfloat rng(vec2 seed){return fract(sin(dot(seed*.1,vec2(123,165)))*121513.);}\n\nmat2 rot(float a){float c=cos(a),s=sin(a);return mat2(c,-s,s,c);}\n\nfloat amod(inout vec2 p,float count){\n  float an=TAU/count;\n  float a=atan(p.y,p.x)+an/2.;\n  float c=floor(a/an);\n  a=mod(a,an)-an/2.;\n  p=vec2(cos(a),sin(a))*length(p);\n  return c;\n}\n//---------\nvoid mainImage(out vec4 fragColor,in vec2 fragCoord)\n{\n  vec2 uv=vec2(fragCoord.x/iResolution.x,fragCoord.y/iResolution.y);\n  uv-=.5;\n  uv/=vec2(iResolution.y/iResolution.x,1);\n//----------\n  vec2 uvv=uv;\nfloat star=0.;\nfloat circle=0.;\nfor(float i=0.;i<100.;++i){\n  vec2 p=uv;\n  float a=rng(vec2(i))*TAU;\n  a+=time;\n  float radius=.1;\n  float r=mod(time*.1+i*.1,1.);\n  radius*=clamp(r,0.,1.);\n   p.xy+=vec2(cos(a),sin(a))*r;\n  p.x*=.8;\n  p.y+=-sin(abs(p.x*1.5))*.5;\n  float c=1.-smoothstep(radius*.99,radius,length(p));\n  c*=1.-clamp(length(p)*8.,0.,1.);\n  circle+=c;\n  a=rng(vec2(i+3.))*TAU;\n  r=i*.1;\n  p=uvv;\n  r=mod(time*.3+r,1.);\n  float thin=.01*r;\n  p.xy+=vec2(cos(a),sin(a))*r;\n  float x=thin/clamp(length(p.x),0.,1.);\n  float y=thin/clamp(length(p.y),0.,1.);\n  star+=x*y*(.01/clamp(length(p),0.,1.));\n  \n}\n//------------\nvec3 p = vec3 (0.01,0.01,-6.5);//-3\nvec3 dir = normalize(vec3(uv, 1.));\nfloat shad = 0.;\nfor (int i=0; i<60; i++)\n{\nfloat d = SDF(p, uv);\nif (d<0.01)\n{shad = float(i)/60.;\nbreak;}\np += d*dir;\n}\n//----------\nvec4 out_color=vec4(1.);\nvec4 colour=vec4(circle,0,0,1);\ncolour+=star;\nout_color=colour;\n//--------\n  vec4 color=vec4(1.);\n    color*=(1.-shad);\n    color+=vec4(mix(vec4(0.8588, 0.2039, 0.2039, 1.0),vec4 (colour),.5));\n  out_color=vec4(mix(vec4(0.8588, 0.2039, 0.2039, 1.0),vec4 (color),.65));\n  fragColor=vec4(out_color);\n}","name":"Image","description":"","type":"image"}]}