{"ver":"0.1","info":{"id":"wdfXRj","date":"1551651351","viewed":231,"name":"Rainbow Cave 1","username":"fabiovergani","description":"Rainbow Cave","likes":8,"published":1,"flags":0,"usePreview":0,"tags":["rainbow","cave"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"vec2 path(float z){\n\treturn vec2(\n\t\t.01*sin(z*40.),\n\t\t.03*cos(z*21.)+.5*sin(cos(z))\n\t);\n}\n\n\n\nfloat g(vec3 p){\n\n\tvec2 q=path(p.z);\n\tvec3 n=fract(p)-.5;\n\tfloat m,s=1.,a=.01,b=.001,t=max(abs(p.x+q.x),abs(p.y+q.y));\n\n\tfor(int i=1;i<9;++i){\n\t\tn/=m=dot(n,n)*.7;\n\t\tn.xy=fract(n.xy)-.5;\n\t\ts*=m;\n\t\tn.xyz=n.yzx;\n\t};\n\n\ts=min(9.,(length(n)-1.)*s);\n\n\tm=clamp(.3+.5*s/.05,a,1.);\n\n\tm=mix(-t,-s,m+t)+m*.05*sin(1.);\n\tp.xy+=path(p.z);\n\treturn min(\n\t\tmax(\n\t\t\tm,\n\t\t\ta-max(m=abs(p.x),abs(p.y))\n\t\t),\n\t\tmax(\n\t\t\tm-b,\n\t\t\tabs(p.y+=a)-b\n\t\t)\n\t);\n}\n\n\nvec3 f(float i){\n\ti+=iTime/20.;\n\treturn vec3(-path(i),i);\n}\n\n//fragColor,fragCoord\nvoid mainImage(out vec4 a,in vec2 b){\n\n\tfloat d,t=0.,n=.0001;\n\n\tvec2 q=2.*(b/iResolution.xy)-1.;\n\n\tvec3 c,p,o=f(t),\n\tw=normalize(f(.01)-o),\n\tr=cross(w,vec3(n,1.,t));\n\n\tr=mat3(\n\t\tr,\n\t\tnormalize(cross(r,w)),\n\t\tw\n\t)*normalize(\n\t\tvec3(q.xy,1.5)\n\t);\n\n\tvec4 K=vec4(1.,.7,.3,3.);\n\n\tfor(int i=0;i<128;++i){\n\t\td=g(p=o+r*t);\n\t\tif(d<n){break;};\n\t\tt+=d*.5;\n\t};\n\tq=vec2(.0,n);\n\n\td=max(n,dot(-r,normalize(\n\t\tvec3(\n\t\t\tg(p+(c=q.yxx))-g(p-c),\n\t\t\tg(p+(c=q.xyx))-g(p-c),\n\t\t\tg(p+(c=q.xxy))-g(p-c)\n\t\t)\n\t))*.5+.4);\n\n\n\n\tc=vec3(\n\t\t22.*mix(t=p.y,t,n),\n\t\tn,\n\t\tt\n\t);\n\n\ta=vec4(mix(\n\t\tmix(\n\t\t\tp=K.xyz*cos(t)*cos(p.y),\n\t\t\tclamp(\n\t\t\t\tabs(fract(c.xxx+p)*5.-3.)-p,\n\t\t\t\tt,\n\t\t\t\t1.\n\t\t\t),\n\t\t\t.5\n\t\t)*d,\n\t\tc,\n\t\tn\n\t),t);\n\n}","name":"Image","description":"","type":"image"}]}