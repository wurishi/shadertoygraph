{"ver":"0.1","info":{"id":"MdlGWM","date":"1595957846","viewed":138,"name":"Simplex Hills","username":"nikat","description":"Simple raymarching through simplex value noise terrain.","likes":3,"published":1,"flags":0,"usePreview":0,"tags":["3d","raymarching","terrain","simplexnoise","valuenoise"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[],"code":"/* Created by Nikita Miropolskiy, nikat/2013\n */\n\nfloat random(vec2 c) {\n\treturn fract(sin(dot(c, vec2(115., 363.)))*1024.0);\n}\n\nfloat simplexvalue2d(vec2 p) {\n\t\tp*=4.0;\n\t\tfloat h = sqrt(0.33333);\n\t\tfloat z = p.y*h;\n\t\tvec2 q = vec2(z+z, p.x - z);\n\t\tvec2 f = fract(q);\n\t \tvec2 i = floor(q);\n\t \tfloat d = f.x+f.y-1.0;\n\t\tfloat r;\n\t\t\n\t\tif (d > 0.0) {\n\t\t\tr =  random(i + vec2(-1.0, 1.0))*(1.0-f.x)\n\t\t\t       + random(i)*(1.0-f.y)\n\t\t\t       + random(i + vec2( 0.0, 1.0))*d;\n\t\t} else {\n\t\t\tr =  random(i)*f.x\n\t\t\t       + random(i + vec2(-1.0, 1.0))*f.y\n\t\t\t       - random(i + vec2(-1.0, 0.0))*d;\n\t\t}\n\t\t\n\t\t//r = sqrt(r);\n\t\t//r = (3.0 - 2.0*r)*r*r;\n\t\tr = (10.0 - r*(15.0 - 6.0*r))*r*r*r;\n\t\treturn  r;\n}\n\nfloat raymarche(vec3 origin, vec3 direction)\n{\n\tfloat delt = 0.01;\n    float mint = 0.001;\n    float maxt = 4.0;\n    for( float t = mint; t < maxt; t += delt )\n    {\n        vec3 p = origin + direction*t;\n        float h = 0.3*simplexvalue2d( p.xz );\n        if( p.y < h )\n        {\n            return 0.3+0.7*simplexvalue2d( p.xz );\n        }\n    }\n    return 0.0;\n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 pix = 2.0*fragCoord.xy - iResolution.xy;\n\tvec2 p = pix/iResolution.x;\n\tvec2 q = pix/iResolution.xy;\n\t\n\tfloat time = iTime*0.3;\n\t\n\tvec3 org = vec3(0.0,1.,-time);\n\tvec3 dir = (vec3(p.x*1.6+sin(time),-1.0+p.y,-1.5));\n\t\n\tfloat f = raymarche(org,dir);\n\n\tvec3 c;\n\tc = vec3(f);\n\t\n\tfloat vignet = sqrt(sqrt((q.x*q.x-1.0)*(q.y*q.y-1.0)));\n\tc *= vignet;\n\t\n\tfragColor = vec4(c, 1.0);\n}","name":"Image","description":"","type":"image"}]}