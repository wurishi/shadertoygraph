{"ver":"0.1","info":{"id":"ttdfDS","date":"1613400379","viewed":70,"name":"boolean 2 boxes","username":"kithy","description":"hollow box made from 2 boxes","likes":0,"published":1,"flags":0,"usePreview":0,"tags":["raymarching","box","boolean","distfunction"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define MAX_STEPS 32\n#define EPS 1e-4\n\nfloat cube(vec3 p,vec3 s){\n\tvec3 q=abs(p);\n\tvec3 m=max(s-q,0.0);\n\treturn length(max(q-s,0.0))-min(min(m.x,m.y),m.z);\n}\n\nfloat sd(vec3 p){\n\tp=mod(p,0.8)-0.4;\n\tfloat c1=cube(p,vec3(0.2));\n\tfloat c2=cube(p,vec3(0.1,0.1,0.4));\n\t//return min(c1,c2); //OR\n\t//return max(c1,c2); //AND\n\t//return max(-c1,c2);\n\treturn max(c1,-c2);\n}\n\n//generate normal\nvec3 genNormal(vec3 p){\n\treturn normalize(vec3(\n\t\tsd(p+vec3(EPS,0.0,0.0))-sd(p+vec3(-EPS,0.0,0.0)),\n\t\tsd(p+vec3(0.0,EPS,0.0))-sd(p+vec3(0.0,-EPS,0.0)),\n\t\tsd(p+vec3(0.0,0.0,EPS))-sd(p+vec3(0.0,0.0,-EPS))\n\t\t));\n}\n\n\nvoid mainImage(out vec4 fragColor,in vec2 fragCoord){\n\tvec2 p=(2.0*fragCoord.xy-iResolution.xy)/min(iResolution.x,iResolution.y);\n\t\n\t//rotate camera\n\t// float radius=0.1;\n\t// float phi=iTime*0.2;\n\t// vec3 ro=vec3(cos(phi)*radius,0.0,sin(phi)*radius);\t\n\t// vec3 target=vec3(0.0,0.0,1.0);\n\t// vec3 cdir=normalize(target-ro);\n\t// vec3 up=vec3(0.0,1.0,0.0);\n\t// vec3 side=cross(cdir,up);\n\t// float fov=0.6;\n\t// vec3 rd=normalize(p.x+side+p.y*up+cdir*fov);\n\n\tvec3 ro=vec3(0.0,0.0,iTime*0.3);\n\tvec3 rd=normalize(vec3(p,1.0));\n\n\tfloat d,t=0.0;\n\tvec3 n,rp;\n\t\n\tfor(int i=0;i<MAX_STEPS;i++){\n\t\trp=ro+rd*t;\n\t\td=sd(rp);\n\t\tif(d<EPS)break;\n\t\tn=genNormal(rp);\n\t\tt+=d;\n\t}\n\n\t\n\tfragColor=vec4(n,1.0);\n\n}","name":"Image","description":"","type":"image"}]}