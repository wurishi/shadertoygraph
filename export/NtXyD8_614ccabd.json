{"ver":"0.1","info":{"id":"NtXyD8","date":"1647874869","viewed":563,"name":"inverse ACES tonemapping","username":"izutionix","description":"tonemapped to linear and back\ncould for example be used to convert regular images to HDRIs to use for lighting\nmove your mouse vertically to change exposure","likes":5,"published":1,"flags":0,"usePreview":0,"tags":["linear","inverse","tonemap","aces","reverse","untonemap","retonemap"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4sX3Rn","filepath":"/media/a/c3a071ecf273428bc72fc72b2dd972671de8da420a2d4f917b75d20e1c24b34c.ogv","previewfilepath":"/media/ap/c3a071ecf273428bc72fc72b2dd972671de8da420a2d4f917b75d20e1c24b34c.ogv","type":"video","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// linear to tonemapped\nvec3 ACES(vec3 x) {\n    return x*(2.51*x + .03) / (x*(2.43*x + .59) + .14); // https://knarkowicz.wordpress.com/2016/01/06/aces-filmic-tone-mapping-curve/\n}\n\n// tonemapped to linear\nvec3 ACES_Inv(vec3 x) {\n    return (sqrt(-10127.*x*x + 13702.*x + 9.) + 59.*x - 3.) / (502. - 486.*x); // thanks to https://www.wolframalpha.com/input?i=2.51y%5E2%2B.03y%3Dx%282.43y%5E2%2B.59y%2B.14%29+solve+for+y\n}\n\nvec3 changeExposure(vec3 col, vec3 b) {\n    b *= col;\n    return b/(b-col+1.);\n}\n\nvec3 changeExposure(vec3 col, float b) {\n    return changeExposure(col, vec3(b));\n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord/iResolution.xy;\n    float t = 2.*iTime;\n    \n    vec2 mouse = iMouse.xy/iResolution.xy;\n    if(dot(iMouse.xy, vec2(1.))==0.) mouse = .5+.5*vec2(sin(t),cos(t)); // if no mouse is detected\n\n    vec3 col = texture(iChannel0, uv).xyz;\n    vec3 _col = col;\n    col = pow(col, vec3(2.2));\n    col = ACES_Inv(col); // to linear\n    \n    //col *= vec3(0.02, 0.25, 0.5); // moody effect\n    float e = 2.*(2.*mouse.y-1.); // exposure\n    col *= exp2(e); // you can now do linear operations on what used to be already tonemapped images!\n    \n    col = pow(ACES(col.rgb), vec3(1./2.2)); // tonemap again\n\n    fragColor = vec4(col, 1);\n}","name":"Image","description":"","type":"image"}]}