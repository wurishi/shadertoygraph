{"ver":"0.1","info":{"id":"mlSfzG","date":"1694499414","viewed":111,"name":"My Cat","username":"dccjohnny","description":"It's my cat - XiaoFuDang(小福蛋）","likes":18,"published":1,"flags":0,"usePreview":0,"tags":["2d","sdf","cat"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define PI 3.14159\n#define BASECOLOR vec3(.91,.91,.85)\n#define PINK vec3(1.,0.75,0.75)\n#define LidCol vec3(.36,.26,.25)\nmat2 Rot(float radian)\n{\n    float c=cos(radian);\n    float s=sin(radian);\n    return mat2(c,-s,s,c);\n}\n\nfloat sdEllipse( in vec2 p, in vec2 ab )\n{\n    p = abs(p); if( p.x > p.y ) {p=p.yx;ab=ab.yx;}\n    float l = ab.y*ab.y - ab.x*ab.x;\n    float m = ab.x*p.x/l;      float m2 = m*m; \n    float n = ab.y*p.y/l;      float n2 = n*n; \n    float c = (m2+n2-1.0)/3.0; float c3 = c*c*c;\n    float q = c3 + m2*n2*2.0;\n    float d = c3 + m2*n2;\n    float g = m + m*n2;\n    float co;\n    if (d<0.0 )\n    {\n        float h = acos(q/c3)/3.0;\n        float s = cos(h);\n        float t = sin(h)*sqrt(3.0);\n        float rx = sqrt( -c*(s + t + 2.0) + m2 );\n        float ry = sqrt( -c*(s - t + 2.0) + m2 );\n        co = (ry+sign(l)*rx+abs(g)/(rx*ry)- m)/2.0;\n    }\n    else\n    {\n        float h = 2.0*m*n*sqrt( d );\n        float s = sign(q+h)*pow(abs(q+h), 1.0/3.0);\n        float u = sign(q-h)*pow(abs(q-h), 1.0/3.0);\n        float rx = -s - u - c*4.0 + 2.0*m2;\n        float ry = (s - u)*sqrt(3.0);\n        float rm = sqrt( rx*rx + ry*ry );\n        co = (ry/sqrt(rm-rx)+2.0*g/rm-m)/2.0;\n    }\n    vec2 r = ab * vec2(co, sqrt(1.0-co*co));\n    return length(r-p) * sign(p.y-r.y);\n}\nfloat sdVesica(vec2 p, float r, float d)\n{\n    p = abs(p);\n    float b = sqrt(r*r-d*d);\n    return ((p.y-b)*d>p.x*b) ? length(p-vec2(0.0,b))\n                             : length(p-vec2(-d,0.0))-r;\n}\n\nfloat sdCircle(vec2 p,float r)\n{\n    return length(p)-r;\n}\n\nfloat sdEgg( in vec2 p, in float ra, in float rb )\n{\n    const float k = sqrt(3.0);\n    p.x = abs(p.x);\n    float r = ra - rb;\n    return ((p.y<0.0)       ? length(vec2(p.x,  p.y    )) - r :\n            (k*(p.x+r)<p.y) ? length(vec2(p.x,  p.y-k*r)) :\n                              length(vec2(p.x+r,p.y    )) - 2.0*r) - rb;\n}\n\nfloat sdMoon(vec2 p, float d, float ra, float rb )\n{\n    p.y = abs(p.y);\n    float a = (ra*ra - rb*rb + d*d)/(2.0*d);\n    float b = sqrt(max(ra*ra-a*a,0.0));\n    if( d*(p.x*b-p.y*a) > d*d*max(b-p.y,0.0) )\n          return length(p-vec2(a,b));\n    return max( (length(p          )-ra),\n               -(length(p-vec2(d,0))-rb));\n}\nfloat DrawSDF(float sdf)\n{\n    return smoothstep(0.0,-0.001,sdf);\n}\nfloat DrawMinusSDF(float sdf)\n{\n    return smoothstep(-0.001,0.0,sdf);\n}\nfloat whisker(vec2 p,vec2 trans ,float scale,float rotate,float bend)\n{\n    \n    p-=trans;    \n    p*=scale;\n    p*=Rot(rotate);\n    p*=Rot(bend*(p.y));\n   \n    \n    \n    float d1=length(p-vec2(0,clamp(p.y,-.2,.2)));\n    float r1=mix(-.02,.005,smoothstep(-.2,.2,p.y));   \n    float m1=smoothstep(.01,.005,d1-r1);\n    \n    float d2=length(p-vec2(0,clamp(p.y,.2,1.1)));\n    float r2=mix(.005,-.02,smoothstep(.2,1.1,p.y));\n    float m2=smoothstep(.01,.005,d2-r2);\n    float m=max(m1,m2);\n    \n    return m;\n}\n\nfloat Hash11(float t)\n{\n  \n    return fract(sin(t)*12561.1516);\n}\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    \n    vec2 uv = (fragCoord-.5*iResolution.xy)/iResolution.y;\n\n   \n    vec3 col =vec3(0.3);\n    \n    vec2 catUV=uv;\n   \n    //ears\n   \n    vec2 earUV=catUV-vec2(0.,0.);\n    float earUVside=sign(earUV.x);\n    earUV.x=abs(earUV.x);\n    earUV*=Rot(sin(iTime*2.)*0.03);\n    \n    vec2 auricleUV=earUV*vec2(1.1,0.5);\n    auricleUV-=vec2(0.21,0.1);\n    auricleUV*=Rot(PI*-.2);\n    float sdEar=sdEgg(auricleUV,.19,.35);\n    float ear=DrawSDF(sdEar);\n    col=mix(col,BASECOLOR,ear);\n    \n    \n    \n    float earMod=DrawMinusSDF(sdVesica(auricleUV-vec2(0.12,-0.02),.2,.05));\n    earMod=earUVside>0.?0.:earMod;\n    col=mix(col,vec3(0),earMod*ear);\n    \n    \n    vec2 earInnerUV=earUV*vec2(1.,0.9);\n    earInnerUV*=Rot(PI*.09);\n    earInnerUV-=vec2(0.195,0.25);\n    float sdEarOutline=sdVesica(earInnerUV,.285,.19);\n    float earInner=DrawSDF(sdEarOutline);\n    col=mix(col,PINK,earInner);\n    \n    vec2 earFurUV=earUV;\n    \n    float sdEarFur1=sdMoon((earFurUV*Rot(PI*.05)-vec2(.31,.16)),.18,.2,.35);\n    float sdEarFur2=sdMoon((earFurUV*Rot(PI*.1)-vec2(.23,.11)),.18,.2,.3);\n    float sdEarFur3=sdMoon((earFurUV*Rot(PI*.3)-vec2(.14,.22)),.18,.19,.35);\n    float earFur=max(max(DrawSDF(sdEarFur1),DrawSDF(sdEarFur2)),\n    DrawSDF(sdEarFur3));\n    col=mix(col,BASECOLOR,earFur);\n    \n     //head\n    vec2 headUV=catUV-vec2(0.,-.15);\n    headUV*=Rot(PI);\n    \n    float sdHead=sdEgg(headUV,.4,.6);\n    float head=DrawSDF(sdHead);\n    col=mix(col,BASECOLOR,head);\n    \n    float headBlack=DrawSDF(sdCircle(headUV*vec2(1.3,1.)-vec2(.25,-.48),.2));    \n    headBlack=head*headBlack;\n    col=mix(col,vec3(0),headBlack);\n    \n   \n    //eye\n    \n    vec2 eyeUV=catUV*1.05;\n    float eyeUVside=sign(eyeUV.x);\n    eyeUV.x=abs(eyeUV.x);\n    eyeUV-=vec2(.2,-.1);\n    float blinky=smoothstep(0.,1.,mix(-999.,1.,sin(iTime)*.5+.5));\n    eyeUV.y*=mix(1.,20.,blinky);\n    \n    \n    \n    float sdLid=sdCircle(eyeUV*vec2(.95,1.)-vec2(0.,.015),.09);\n    float lid=DrawSDF(sdLid);\n    col=mix(col,LidCol,lid);\n    \n    \n    float sdEye=sdVesica(eyeUV*Rot(PI*0.5),.1,.01);\n    float eye=DrawSDF(sdEye);\n    col=mix(col,vec3(0.99,0.98,0.6),eye);\n    \n    vec2 signEyeUV=eyeUV;\n    signEyeUV.x*=eyeUVside;\n    float T1=floor(iTime/5.);\n    float T2=floor((iTime+352.43)/2.);\n    float pupilMove=smoothstep(0.,1.,mix(-2000.,100.,sin(iTime*1.2)*.5+.5));\n    float to1=Hash11(T1)*2.-1.;\n    float to2=Hash11(T2)*2.-1.;\n    \n    \n    float pupil=DrawSDF(sdCircle(signEyeUV+\n    vec2(mix(0.,to1,pupilMove)*.018,mix(0.,to2,pupilMove)*.018),.075));\n    col=mix(col,vec3(0),pupil*eye);\n    \n    \n    float highLight=DrawSDF(sdCircle(signEyeUV-vec2(-0.05,0.03),.022));\n    highLight+=DrawSDF(sdCircle(signEyeUV-vec2(-0.06,-.007),.01));\n    col=mix(col,vec3(1),highLight);\n    \n    \n    //whisker\n    vec2 whiskerUV=catUV;\n    whiskerUV.x=abs(whiskerUV.x);\n    \n    float whiskers=whisker(whiskerUV,vec2(.3,-.2),3.,1.0,1.);\n    whiskers+=whisker(whiskerUV,vec2(.3,-.21),2.2,1.4,1.);\n    whiskers+=whisker(whiskerUV,vec2(.3,-.24),2.8,1.6,1.);\n    \n    col=mix(col,vec3(1),whiskers);\n    \n    //nose\n    \n    vec2 noseUV=catUV;\n    float noseUVSide=sign(noseUV.x);\n    noseUV.x=abs(noseUV.x);\n    \n    float blusher=DrawSDF(sdEllipse(noseUV-vec2(.2,-.22),vec2(.03,.01)));    \n    col=mix(col,PINK,blusher);\n    \n    float mouth=DrawSDF(sdMoon((noseUV-vec2(0.04,-.23))*Rot(PI*-0.4),.015,.04,.045));\n    col=mix(col,vec3(0),mouth);\n    \n    \n    float nose=DrawSDF(sdEgg(noseUV-vec2(0.,-.2),.031,.062));    \n    col=mix(col,vec3(0),nose);\n    \n    float highLightN=DrawSDF(sdEllipse(noseUV-vec2(.02,-.205),vec2(.01,.005)));\n    highLightN=noseUVSide>0.?0.:highLightN;\n    col=mix(col,vec3(1),highLightN);\n    \n    \n    //brows\n    \n    vec2 browsUV=catUV;\n    browsUV.x=abs(browsUV.x);\n    \n    float brows=DrawSDF(sdEllipse((browsUV-vec2(.2,.08))*Rot(.3),vec2(.04,.015)));\n    col=mix(col,vec3(1),brows);\n   \n    fragColor = vec4(col,1.0);\n    \n       \n}","name":"Image","description":"","type":"image"}]}