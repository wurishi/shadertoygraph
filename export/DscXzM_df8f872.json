{"ver":"0.1","info":{"id":"DscXzM","date":"1679516743","viewed":56,"name":"Koch star/flake","username":"ianertson","description":"Koch star/flake","likes":5,"published":1,"flags":0,"usePreview":0,"tags":["koch"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define R (iResolution.xy)\n#define T (iTime+3.79)\nfloat luma(vec3 color) { return dot(color, vec3(0.299, 0.587, 0.114)); }\nmat2 rot(in float a) { float c = cos(a); float s = sin(a); return mat2(c, s, -s, c); }\n\nvec3 koch(in vec2 uv, in float iterations) {\n    vec2 uu = uv;\n    vec2 dir = vec2(sin(2.0943951023931953), cos(2.0943951023931953));\n    uv.x += 0.5;\n    float div = 1.0;\n    float dd1 = 0.0;\n    float dd2 = 0.0;\n    for (float i = 0.0; i < iterations; i+=1.0) {\n        uv *= 3.; div *= 3.;\n        uv.x = abs(uv.x-1.5)-0.5;\n        uv -= dir*min(0., dot(uv, dir))*2.;     \n        float dp = dot(uv, dir);\n        float dist = distance(uv, uu+0.5);\n        dd1 += exp(atan(dp-0.5, dist)-0.5);\n        dd2 += abs(dp-0.5)/dist;\n    }\n    return clamp(\n        vec3(\n            vec2(dd1, dd2)/iterations,\n            smoothstep(3.0/R.y, 0.0, length(uv - vec2(clamp(uv.x, -1.0, 1.0), 0.0))/div)\n        ),\n        0.0,\n        1.0\n    );\n}\n\nvec3 kochStar(in vec2 uv, in float iterations) {\n    uv.x = abs(uv.x);\n    uv.y += -0.28867513459481287;\n    vec2 dir = vec2(sin(2.6179938779914944), cos(2.6179938779914944));    \n    return koch(uv-dir*max(0.0, dot(uv-vec2(0.5, 0.), dir))*2.0, iterations);\n}\n\nvoid mainImage( out vec4 O, in vec2 fc )\n{\n    vec3 col = vec3(0.0);\n    vec2 uv = (fc-0.5*R.xy)/R.y;\n    vec2 m = iMouse.xy/R.xy;\n    uv *= mix(1.0, 2.0, (0.5+sin(T)*0.5));\n    uv *= 1.5;\n    uv *= rot(T*0.4);\n    vec3 star = kochStar(uv, 4.);\n    col = mix(star, vec3(star.x), 0.5+sin(T)*0.5);\n    col += col*col*luma(col);\n    col /= 1.0 + max(col-0.5, 0.0);\n    O = vec4(pow(col, vec3(1.0 / 2.2)), 1.0);\n}","name":"Image","description":"","type":"image"}]}