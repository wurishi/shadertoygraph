{"ver":"0.1","info":{"id":"4sySWD","date":"1464288955","viewed":318,"name":"Grain bg","username":"gigatron","description":"from Razor 1911 Amiga Voyage demo\nthx to erwin94 --&amp;gt; green key color replaced by grain !","likes":5,"published":1,"flags":0,"usePreview":0,"tags":["tv","grain","bg"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"Xdf3Rn","filepath":"/media/a/e81e818ac76a8983d746784b423178ee9f6cdcdf7f8e8d719341a6fe2d2ab303.webm","previewfilepath":"/media/ap/e81e818ac76a8983d746784b423178ee9f6cdcdf7f8e8d719341a6fe2d2ab303.webm","type":"video","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"false","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"//Uploaded by erwin94 \n\nfloat saturation(vec4 col, float rw, float bw)\n{\n    return col.g - (col.r*rw+col.b*bw);\n}\n\nvec4 key_green(vec4 color, vec4 reference_color, float red_weight, float blue_weight)\n{\n    float col_sat = saturation(color, red_weight, blue_weight);\n    float ref_sat = saturation(reference_color, red_weight, blue_weight);\n    float key = (1.0-clamp(col_sat / ref_sat, 0.0, 1.0))*color.a;\n    // subtract green\n    vec4 result = clamp(color-reference_color*(1.0-key), 0.0, 1.0);\n    result.a = key;\n    // despill\n    result.g = min(result.g, 0.5*result.r+0.5*result.b);\n    return result;\n}\n\nvec4 over(vec4 bg, vec4 fg)\n{\n    return fg + bg * (1.0-fg.a);\n}\n\nfloat clamp_uv(vec2 uv)\n{\n    return float((uv.x > 0.0 && uv.x < 1.0) && (uv.y > 0.0 && uv.y < 1.0));\n}\n\nvec4 hue_shift(vec4 col)\n{\n    float t = 0.5+0.5*sin(5.0*iTime);\n    float r = col.r;\n    col.r = t*col.b;\n    col.b = (1.-t)*r;\n    return col;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 uv = fragCoord.xy / iResolution.xy;\n    vec2 uv2 =uv;\n    uv.y =1.-uv.y; \n \n    vec4 in1 = texture(iChannel0, uv);\n    in1 = key_green(in1, vec4(0.25,.55,.15,1), 0.6, 0.6);\n\n    float strength = 500.0; \n    float x = (uv.x + 4.0 ) * (uv.y + 4.0 ) * (iTime * 2.0);\n\tvec4 grain = vec4(mod((mod(x, 13.0) + 1.0) * (mod(x, 123.0) + 1.0), 0.01)-0.005) * strength;\n  \n    if( uv2.x < 1.0 && in1.r<0.01   ){\n   \n      fragColor = vec4(over(over(in1, in1), in1))+grain;\n    }\n\telse\n   fragColor = vec4(over(in1,in1));// mac\n}","name":"Image","description":"","type":"image"}]}