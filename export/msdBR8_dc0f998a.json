{"ver":"0.1","info":{"id":"msdBR8","date":"1696950780","viewed":249,"name":"Tiny Lighthouse","username":"Lewie4","description":"A little scene lighthouse inspired by Just Passing Icon - Jonathan Quintin\nhttps://www.behance.net/gallery/11242115/The-Big-Wide-World","likes":30,"published":3,"flags":0,"usePreview":0,"tags":["2d","sea","sdf","water","loop","boat","reproduction"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// SDFs: https://iquilezles.org/articles/distfunctions2d/\n// Inspiration: Just Passing Icon - Jonathan Quintin\n#define PI 3.14159265359\n\nfloat sdCircle(vec2 p, float r)\n{\n    return (length(p) - r);\n}\n\nfloat sdBox(vec2 p, vec2 b )\n{\n    vec2 d = abs(p)-b;\n    return length(max(d,0.0)) + min(max(d.x,d.y),0.0);\n}\n\nfloat sdTrapezoid( in vec2 p, in float ra, float rb, float he)\n{\n    float sy = (p.y<0.0)?-1.0:1.0;\n\n    p.x = abs(p.x);\n\n    vec4 res;\n    \n    // bottom and top edges\n    {\n        float h = min(p.x,(p.y<0.0)?ra:rb);\n        vec2  c = vec2(h,sy*he);\n        vec2  q = p - c;\n        float d = dot(q,q);\n        float s = abs(p.y) - he;\n        res = vec4(d,q,s);\n    }\n    \n    // side edge\n    {\n        vec2  k = vec2(rb-ra,2.0*he);\n        vec2  w = p - vec2(ra, -he);\n        float h = clamp(dot(w,k)/dot(k,k),0.0,1.0);\n        vec2  c = vec2(ra,-he) + h*k;\n        vec2  q = p - c;\n        float d = dot(q,q);\n        float s = w.x*k.y - w.y*k.x;\n        if( d<res.x ) { res.xyz = vec3(d,q); }\n        if( s>res.w ) { res.w = s; }\n    }\n   \n    // distance and sign\n    float d = sqrt(res.x)*sign(res.w);\n    \n    return d;\n}\n\nfloat sdTriangle( in vec2 p, in vec2 p0, in vec2 p1, in vec2 p2 )\n{\n    vec2 e0 = p1-p0, e1 = p2-p1, e2 = p0-p2;\n    vec2 v0 = p -p0, v1 = p -p1, v2 = p -p2;\n    vec2 pq0 = v0 - e0*clamp( dot(v0,e0)/dot(e0,e0), 0.0, 1.0 );\n    vec2 pq1 = v1 - e1*clamp( dot(v1,e1)/dot(e1,e1), 0.0, 1.0 );\n    vec2 pq2 = v2 - e2*clamp( dot(v2,e2)/dot(e2,e2), 0.0, 1.0 );\n    float s = sign( e0.x*e2.y - e0.y*e2.x );\n    vec2 d = min(min(vec2(dot(pq0,pq0), s*(v0.x*e0.y-v0.y*e0.x)),\n                     vec2(dot(pq1,pq1), s*(v1.x*e1.y-v1.y*e1.x))),\n                     vec2(dot(pq2,pq2), s*(v2.x*e2.y-v2.y*e2.x)));\n    return -sqrt(d.x)*sign(d.y);\n}\n\nfloat sdSegment( in vec2 p, in vec2 a, in vec2 b )\n{\n    vec2 pa = p-a, ba = b-a;\n    float h = clamp( dot(pa,ba)/dot(ba,ba), 0.0, 1.0 );\n    return length( pa - ba*h );\n}\n\nvec4 lighthouse(vec2 p)\n{\n    vec3 red = vec3(.839,.318,.188);\n    vec3 dred = vec3(.45,.133,.1);\n    \n    float shape = sdTrapezoid(p+vec2(0.,.1), .25, .15, .4);    \n    shape = smoothstep(.02,.0, shape);\n    vec4 col = vec4(shape * mix(red, vec3(1.), smoothstep(-.01, .01,fract((p.y+.1)* 2.4)*2.-1.)), shape);\n\n    shape = sdBox(p+vec2(0.,-.42), vec2(.15,.1));\n    shape = smoothstep(.01,.0, shape);\n    col = vec4(mix(col.xyz, vec3(.4,.77,.82), shape), max(col.w, shape * .5));\n\n    shape = abs(sdBox(p+vec2(0.,-.42), vec2(.15,.1)));\n    shape = min(shape,sdBox(p+vec2(0.,-.31), vec2(.225,.01)));\n    shape = min(shape,sdBox(p+vec2(0.,-.42), vec2(.15,.001)));\n    shape = min(shape,sdBox(p+vec2(.05,-.42), vec2(.001,.1)));\n    shape = min(shape,sdBox(p+vec2(-.05,-.42), vec2(.001,.1)));\n    shape = min(shape,sdTriangle(p+vec2(.0,-.52), vec2(0.,.2), vec2(.2,0.),vec2(-.2,0.)));\n    shape = smoothstep(.01, .0, shape);\n    col = vec4(mix(col.xyz, red, shape), max(col.w, shape));\n\n    shape = sdBox(p+vec2(0.,-.29), vec2(.225,.005));\n    shape = min(shape, sdCircle(p + vec2(0.,.1), .04));\n    shape = min(shape, sdCircle(p + vec2(0.,-.1), .04));\n    shape = min(shape, sdCircle(p + vec2(0.,.35), .08));\n    shape = min(shape, sdBox(p+vec2(0.,.435), vec2(.08,.07)));    \n    shape = smoothstep(.01, .0, shape);    \n    col = vec4(mix(col.xyz, dred, shape), max(col.w, shape));\n\n    col.xyz = col.xyz - smoothstep(-.01, .01, p.x) *.2;        // Shadow    \n    return col;\n}\n\nvec4 ice1(vec2 p)\n{\n    vec3 ice = vec3(.871,.871,.906);\n    vec3 dice = vec3(.686,.784,.847);\n    \n    float shape = sdTriangle(p + vec2(.18,.0), vec2(0.,.2), vec2(.15,0.), vec2(-.15,0.));\n    shape = min(shape,sdTriangle(p + vec2(.0,.0), vec2(0.,.25), vec2(.15,0.), vec2(-.3,0.)));\n    shape = min(shape,sdTriangle(p + vec2(-.14,.0), vec2(0.,.2), vec2(.15,0.), vec2(-.15,0.)));\n    shape = smoothstep(.01, .0, shape);\n    \n    vec4 col = vec4(mix(vec3(1.), ice, shape), shape);\n\n    shape = sdTriangle(p + vec2(.18,.0), vec2(.0,.2), vec2(.15,0.), vec2(-.02,0.));\n    shape = min(shape,sdTriangle(p + vec2(.18,.0), vec2(0.,.1), vec2(.35,0.), vec2(-.0,0.)));\n    shape = min(shape,sdTriangle(p + vec2(.0,.0), vec2(0.,.25), vec2(.15,0.), vec2(-.0,0.)));\n    shape = min(shape,sdTriangle(p + vec2(-.14,.0), vec2(0.,.2), vec2(.15,0.), vec2(-.0,0.)));    \n    shape = smoothstep(.01, .0, shape);\n\n    col = vec4(mix(col.xyz, dice, shape), max(col.w,shape));\n\n    return col;\n}\n\nvec4 ice2(vec2 p)\n{\n    vec3 ice = vec3(.871,.871,.906);\n    vec3 dice = vec3(.686,.784,.847);\n    \n    float shape = sdTriangle(p + vec2(-.04,.0), vec2(0.,.12), vec2(.06,0.), vec2(-.1,0.));\n    shape = min(shape,sdTriangle(p + vec2(.05,.0), vec2(0.,.09), vec2(.1,0.), vec2(-.05,0.)));\n    shape = smoothstep(.01, .0, shape);\n    \n    vec4 col = vec4(mix(vec3(1.), ice, shape), shape);\n\n    shape = sdTriangle(p + vec2(-.04,.0), vec2(.0,.12), vec2(.06,0.), vec2(-.0,0.));\n    shape = min(shape,sdTriangle(p + vec2(.05,.0), vec2(0.,.09), vec2(.1,0.), vec2(-.0,0.)));\n    shape = smoothstep(.01, .0, shape);\n\n    col = vec4(mix(col.xyz, dice, shape), max(col.w,shape));\n\n    return col;\n}\n\nvec4 ice3(vec2 p)\n{\n    vec3 ice = vec3(.871,.871,.906);\n    vec3 dice = vec3(.686,.784,.847);\n    \n    float shape = sdTriangle(p + vec2(-.02,.0), vec2(0.,.08), vec2(.05,0.), vec2(-.05,0.));\n    shape = min(shape,sdTriangle(p + vec2(.02,.0), vec2(0.,.05), vec2(.03,0.), vec2(-.03,0.)));\n    shape = smoothstep(.01, .0, shape);\n    \n    vec4 col = vec4(mix(vec3(1.), ice, shape), shape);\n\n    shape = sdTriangle(p + vec2(-.02,.0), vec2(.0,.08), vec2(.05,0.), vec2(-.0,0.));\n    shape = min(shape,sdTriangle(p + vec2(.02,.0), vec2(0.,.05), vec2(.03,0.), vec2(-.0,0.)));\n    shape = smoothstep(.01, .0, shape);\n\n    col = vec4(mix(col.xyz, dice, shape), max(col.w,shape));\n\n    return col;\n}\n\nvec4 boat(vec2 p)\n{\n    vec3 white = vec3(.98,.98,.945);\n    vec3 dwhite = vec3(.929,.902,.859);\n    vec3 yel = vec3(1.,.725,.063);\n    vec3 dyel = vec3(.871,.529,.075);\n    vec3 brown = vec3(.278, .165, .122);\n\n    float shape = sdTriangle(p + vec2(.05,.05), vec2(0.,.15), vec2(.14,.02), vec2(-.14,.02));\n    shape = min(shape,sdBox(p + vec2(.0,-.05), vec2(.05,.05)));\n    shape = smoothstep(.01, .0, shape);\n    \n    vec4 col = vec4(mix(vec3(.5), white, shape), shape);\n    \n    shape = sdBox(p + vec2(-.045,-.02), vec2(.03,.08));\n    shape = min(shape,sdBox(p + vec2(-.11,.005), vec2(.08,.035)));\n    shape = smoothstep(.01, .0, shape);\n    \n    col = vec4(mix(col.xyz, dwhite, shape), max(col.w,shape));\n\n    shape = sdTriangle(p + vec2(.18,.0), vec2(0.,-.15), vec2(.14,.02), vec2(-.14,.02));\n    shape = min(shape,sdTriangle(p + vec2(.04,.0), vec2(0.,.02), vec2(.14,-.15), vec2(-.14,-.15)));\n    shape = min(shape,sdBox(p + vec2(-.121,-.076), vec2(.022,.075)));\n    shape = smoothstep(.01, .0, shape);\n    \n    col = vec4(mix(col.xyz, yel, shape), max(col.w,shape));\n\n    shape = sdTriangle(p + vec2(.18,.0), vec2(0.,-.155), vec2(.14,-.05), vec2(-.085,-.05));\n    shape = min(shape,sdTriangle(p + vec2(-.23,.0), vec2(0.,-.155), vec2(.03,-.05), vec2(-.13,-.05)));\n    shape = min(shape,sdBox(p + vec2(-.025,.1025), vec2(.2,.053)));\n    shape = smoothstep(.01, .0, shape);\n    \n    col = vec4(mix(col.xyz, dyel, shape), max(col.w,shape));\n\n    shape = sdSegment(p, vec2(-.055,.105), vec2(.08,.105));\n    shape = min(shape,sdSegment(p, vec2(.095,.085), vec2(.146,.085)));\n    shape = min(shape,sdSegment(p, vec2(.095,.075), vec2(.146,.075)));\n    shape = min(shape,sdBox(p + vec2(.025,-.06), vec2(.012,.025)));\n    shape = min(shape,sdBox(p + vec2(-.015,-.06), vec2(.012,.025)));\n    shape = min(shape,sdBox(p + vec2(-.055,-.06), vec2(.012,.025)));\n    shape = min(shape,sdSegment(p, vec2(.015,-.04), vec2(.075,-.04)) - .005);\n    shape = min(shape,sdSegment(p, vec2(.105,-.04), vec2(.165,-.04)) - .005);\n    shape = min(shape,sdSegment(p, vec2(.195,-.04), vec2(.255,-.04)) - .005);\n    shape = min(shape,sdSegment(p, vec2(-.24,-.085), vec2(.125,-.085)) - .002);\n    shape = min(shape,sdCircle(p+ vec2(.1,.02), .005)); \n    shape = min(shape,abs(sdCircle(p+ vec2(.1,.04), .02) - .003));\n    shape = min(shape,sdCircle(p+ vec2(.21,.02), .005)); \n    shape = min(shape,abs(sdCircle(p+ vec2(.21,.04), .02) - .003));  \n    shape = smoothstep(.01, .0, shape);    \n    col = vec4(mix(col.xyz, brown, shape), max(col.w,shape));\n    \n    return col;\n}\n\nvec4 cloud(vec2 p)\n{\n    vec3 cloud = vec3(.718,.863,.906);\n\n    p *= vec2(1., 1.5);\n    \n    float shape = sdCircle(p+ vec2(.1,.0), .4);\n    shape = min(shape,sdCircle(p + vec2(.4,.1), .3));\n    shape = min(shape,sdCircle(p + vec2(-.2,.05), .35));\n    shape = min(shape,sdCircle(p + vec2(-.4,.1), .3));\n    shape = smoothstep(.2, .0, shape);\n    \n    vec4 col = vec4(mix(vec3(0.9), cloud, shape), shape);\n    return col;\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord)\n{\n    fragColor -= fragColor;\n    fragCoord = (fragCoord+fragCoord-iResolution.xy)/iResolution.y;\n    float duration = .1;\n    float time = iTime + 5.;\n    \n    float center = smoothstep(-.001, .001, fragCoord.y);\n    vec4 sky = mix(vec4(.969, 1., .969,1.), vec4(.737, .804,.8,1.), length(fragCoord));\n    vec4 water = mix(vec4(.094,.286,.286,1.), vec4(.063,.063,.125,1.), pow(length(fragCoord + vec2(.3,0.)), .5));\n    vec4 image = mix(water, sky, center);    \n    \n    float prog = fract(time * duration);\n    vec4 item = cloud((fragCoord + vec2(mix(.2, -.2, prog),-.2)) * 10.);\n    image = mix(image, item, item.w);\n\n    item = cloud((fragCoord + vec2(mix(.6, .2, prog),-.4)) * 10.);\n    image = mix(image, item, item.w);\n\n    item = cloud((fragCoord + vec2(mix(-.2, -.6, prog),-.5)) * 10.);\n    image = mix(image, item, item.w);\n\n    item = ice1(fragCoord + vec2(-.28,-.002));\n    image = mix(image, item, item.w * center);\n\n    item = ice2(fragCoord + vec2(.6,.01));\n    image = mix(image, item, item.w);\n    \n    vec2 lhuv = (fragCoord + vec2(.3,-.169)) * 3.;\n    item = lighthouse(lhuv);\n    image = mix(image, item, item.w * center);\n    \n    item = ice3(fragCoord + vec2(.2,.03));\n    image = mix(image, item, item.w);\n\n    prog = smoothstep(0.,1.,fract(time*duration));\n    vec2 boatuv = mix(fragCoord + vec2(-1.1,.0), fragCoord + vec2(1.1,.0), prog);\n    boatuv.y += sin(time*4.) * .01;\n    vec2 wuv = (fragCoord+vec2(-time*.2,.15)) * 4.;\n    wuv.y *= 2.;\n    float wave = wuv.y - pow(2.*abs(wuv.x-(floor(wuv.x+.5))),2.) * .5;\n    item = boat(boatuv);\n    image = mix(image, item, item.w * smoothstep(0.,.05, wave));\n\n    prog = smoothstep(0.,1.,abs(sin(time*PI*.1)) * 2.);\n    float mask = smoothstep(.01, .0,sdCircle(fragCoord, .75*prog));\n    float shadow = smoothstep(.05, .0,sdCircle(fragCoord+vec2(-.05,.05), .75*prog));\n    fragColor = vec4(.941,.945,.933,1.);\n    fragColor = mix(fragColor, image, mask);\n    fragColor -= (shadow - mask) * .25;    \n}","name":"Image","description":"","type":"image"}]}