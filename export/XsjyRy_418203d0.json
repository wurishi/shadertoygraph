{"ver":"0.1","info":{"id":"XsjyRy","date":"1492590978","viewed":385,"name":"line AO","username":"snake5","description":"renders fake non-sampled ambient occlusion with basic 2D line input","likes":5,"published":1,"flags":0,"usePreview":0,"tags":["2d","lines","ao"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\nconst float bidpScale = 0.25;\nconst float falloffDist = 100.0;\nconst float falloffCurve = 0.4;\n\nfloat lineAO( vec2 pos, vec2 line0, vec2 line1 )\n{\n\tvec2 dir = normalize( line1 - line0 );\n\tvec2 rt = vec2(-dir.y,dir.x);\n\tfloat dp0 = dot( dir, line0 );\n\tfloat dp1 = dot( dir, line1 );\n\tfloat dpx = dot( dir, pos );\n\tfloat tp0 = dot( rt, line0 );\n\tfloat tpx = dot( rt, pos );\n\tfloat bidp = mix( 1.0, dot( normalize( line0 - pos ), normalize( line1 - pos ) ), bidpScale );\n\tfloat dist = clamp( length( vec2( tp0 - tpx, dpx - clamp( dpx, dp0, dp1 ) ) ) / falloffDist, 0.0, 1.0 );\n\treturn 1.0-(1.0-bidp)*(1.0-pow(dist,falloffCurve));\n}\n\nfloat lineAOv2( vec2 pos, vec2 line0, vec2 line1 )\n{\n\tvec2 dir = normalize( line1 - line0 );\n\tvec2 rt = vec2(-dir.y,dir.x);\n\tfloat tp0 = dot( rt, line0 );\n\tfloat tpx = dot( rt, pos );\n\tfloat bidp = mix( 1.0, dot( normalize( line0 - pos ), normalize( line1 - pos ) ), bidpScale );\n\tfloat distf = clamp( abs( tp0 - tpx ) / falloffDist, 0.0, 1.0 );\n\treturn 1.0-(1.0-bidp)*(1.0-pow(distf,falloffCurve));\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tfloat q = 0.9;\n\tq *= lineAOv2( fragCoord, vec2(480,80), vec2(480,90) );\n\tq *= lineAOv2( fragCoord, vec2(480,80), vec2(500,80) );\n\tq *= lineAOv2( fragCoord, vec2(500,100), vec2(500,80) );\n\tq *= lineAOv2( fragCoord, vec2(400,100), vec2(500,100) );\n\tq *= lineAOv2( fragCoord, vec2(300,100), vec2(400,100) );\n\tq *= lineAOv2( fragCoord, vec2(300,100), vec2(300,0) );\n\tq *= lineAOv2( fragCoord, vec2(100,0), vec2(300,0) );\n\tq *= lineAOv2( fragCoord, vec2(100,0), vec2(100,100) );\n\tq *= lineAOv2( fragCoord, vec2(100,100), vec2(300,200) );\n\tq *= lineAOv2( fragCoord, vec2(300-100,200+200), vec2(300,200) );\n\tfragColor = vec4(q,q,q,1);\n}\n","name":"Image","description":"","type":"image"}]}