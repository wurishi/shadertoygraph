{"ver":"0.1","info":{"id":"l3BSDh","date":"1710541693","viewed":81,"name":"Contrapunctus IV","username":"diabolix17","description":"Bach's Contrapunctus IV from the Art of the Fugue visualized on a circular staff. You may have to rewind first (on my machine at least) to hear it. If you have ideas for other \"instruments\" (waveforms) or visualizations, I'd love to hear them.","likes":3,"published":1,"flags":8,"usePreview":0,"tags":["music","bach","fugue"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"float pointsize = 0.01;\nfloat tau = 6.283185307;\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\n    fragColor = vec4(1.0);\n    vec2 coord = fragCoord / iResolution.y;\n    vec2 center = vec2(iResolution.x / (2.0 * iResolution.y), 0.5);    \n    float time = iTime;\n    \n    // dilate the time when the time for dilating has come\n    float slowdown_time = 60.0*slowdown_point/tempo;  \n    if(time >= slowdown_time){\n        float t_since = time - slowdown_time;\n        time = slowdown_time + slowdown_rate*t_since/(t_since + slowdown_rate);\n    }\n    \n    // draw the staff\n    float d = length(coord-center);\n    if(d < 0.49){\n        d *= 60.0;\n        float dist = abs(round(d) - d) / 60.0;\n        fragColor = vec4(vec3(smoothstep(0.0, 0.0025, dist)),1.0);\n    }\n\n    // draw the dots\n    int i1, i2, i3, i4;\n    float t1, t2, t3, t4;\n    voice1(time,i1,t1);\n    voice2(time,i2,t2);\n    voice3(time,i3,t3);\n    voice4(time,i4,t4);\n    \n    vec2 p1 = center + 0.25*(float(voice1_notes[i1]+40)/30.0)*vec2(sin(time),cos(time));\n    if(voice1_notes[i1] != -1 && length(p1-coord) < pointsize){\n        fragColor = vec4(1.0, 0.0, 0.0, 1.0);\n    }\n    \n    vec2 p2 = center + 0.25*(float(voice2_notes[i2]+40)/30.0)*vec2(sin(time + tau/4.0),cos(time + tau/4.0));\n    if(voice2_notes[i2] != -1 && length(p2-coord) < pointsize){\n        fragColor = vec4(0.0, 1.0, 0.0, 1.0);\n    }\n    \n    vec2 p3 = center + 0.25*(float(voice3_notes[i3]+40)/30.0)*vec2(sin(time + tau/2.0),cos(time + tau/2.0));\n    if(voice3_notes[i3] != -1 && length(p3-coord) < pointsize){\n        fragColor = vec4(0.0, 0.3, 1.0, 1.0);\n    }\n    \n    vec2 p4 = center + 0.25*(float(voice4_notes[i4]+40)/30.0)*vec2(sin(time + 3.0*tau/4.0),cos(time + 3.0*tau/4.0));\n    if(voice4_notes[i4] != -1 && length(p4-coord) < pointsize){\n        fragColor = vec4(0.0, 0.0, 0.0, 1.0);\n    }\n}","name":"Image","description":"","type":"image"},{"inputs":[],"outputs":[],"code":"// The frequency of C5 in Hz in standard modern tuning. Changing this is fun. The most commonly used baroque pitch is 493.52 Hz.\nfloat base_pitch = 523.25113;\n\n// The tempo in quarter notes per minute. If I make this a bit slower, the piece stops prematurely for some reason, not sure why.\nfloat tempo = 200.0;\n\n// The performance slows down at the end to make it sound nicer. This is the point where the slowdown starts, in quarter notes.\nfloat slowdown_point = 538.0;\n\n// How fast the performance slows down at the end.\nfloat slowdown_rate = 12.0;\n\n// The pitches are given as offsets from C5, 9999 is reserved for rests. The durations are given in sixteenth notes.\n// They were extracted from a LilyPond file found on Mutopia.\n\nint voice1_len = 458;\nint voice1_notes[] = int[](-3,-10,-7,-3,-2,-3,-5,-7,-8,-7,-5,-3,-2,-3,-4,-3,-2,-3,-4,-3,2,-5,-2,-8,-3,-5,-7,-2,-3,2,0,-2,-3,-5,-7,5,4,2,4,5,7,4,9,9999,-3,-7,-8,4,0,0,-1,-3,-1,1,2,4,1,2,4,-3,2,-2,0,-3,-2,-5,-3,-7,9999,9999,0,-7,-3,0,2,0,-2,-3,-5,-3,-1,0,9999,9999,4,0,-1,0,2,-5,-3,-1,0,2,-2,9999,2,-2,10,9,7,9,7,6,9,2,9999,2,-2,-2,-3,9999,9,5,9999,7,1,2,4,-3,-1,1,2,-1,0,2,4,7,5,4,2,5,4,2,0,4,2,0,-1,-3,-4,-1,-3,-1,0,-1,-3,0,-1,0,2,0,-1,2,0,2,4,2,1,4,2,4,5,4,2,0,9,8,9,4,0,9999,0,-3,9999,9,5,9999,5,2,9999,12,10,9,7,5,4,2,0,2,-2,7,4,9,7,5,4,2,0,-2,-3,5,4,3,4,5,4,3,4,7,6,4,6,7,9,2,2,-2,3,2,1,2,3,2,1,2,9999,9999,4,-3,0,4,7,6,4,3,-1,1,3,4,5,7,4,5,4,2,4,5,2,4,2,0,2,3,0,2,0,-1,0,2,-1,0,-1,0,9999,0,-3,9999,9,5,9999,2,-1,9999,2,7,7,5,4,5,9999,7,9,10,12,5,3,2,3,2,9999,4,6,7,9,2,0,-2,0,-2,0,3,2,0,2,3,2,3,5,3,5,7,5,7,9,2,7,6,7,9999,9999,7,4,9999,5,4,2,0,9999,0,-3,9999,7,5,4,2,3,2,1,2,3,2,1,2,3,2,1,2,4,5,9,5,9999,2,-3,0,4,5,4,2,1,-3,-1,1,2,9999,2,-2,9999,9999,-2,0,2,0,-2,-3,-5,-3,-5,0,-3,2,-1,4,5,7,2,1,10,9,7,5,4,2,4,2,1,2,0,-2,0,-2,0,-3,-2,2,3,0,2,7,2,0,-2,2,3,2,0,-2,-3,-5,-6,-5,9999,-3,-4,-3,9999,9999,9999,9,7,4,5,9,2,1,2,5,4,2,1,2,-1,1,2,1,2,1,2,3,-3,9999,9999,2,4,7,1,2);\nint voice1_durations[] = int[](8,8,8,8,8,4,4,10,2,2,2,10,2,2,2,10,2,2,2,4,4,4,8,4,4,8,4,12,4,12,4,12,2,2,10,2,2,2,2,2,2,2,8,4,4,16,4,4,10,2,2,2,2,2,4,10,2,2,2,12,4,12,4,12,4,12,4,8,8,48,8,8,8,8,8,4,4,10,2,2,2,8,8,4,4,12,2,2,10,2,2,2,12,4,8,4,4,4,8,2,2,2,2,2,2,8,4,4,6,2,8,4,4,8,4,4,2,2,6,2,2,2,10,2,2,2,10,2,2,2,10,2,2,2,10,2,2,2,10,2,2,2,2,2,6,2,2,2,2,2,6,2,2,2,2,2,6,2,2,2,2,2,8,8,4,4,8,4,4,4,8,4,4,8,4,4,8,4,4,8,2,2,2,2,2,2,2,2,4,4,12,4,10,2,2,2,2,2,2,2,2,2,2,2,10,2,2,2,10,2,2,2,2,2,4,12,4,10,2,2,2,10,2,2,2,8,8,144,8,8,8,8,8,4,4,10,2,2,2,10,2,2,2,2,2,6,2,2,2,2,2,6,2,2,2,2,2,6,2,2,2,24,8,8,4,4,8,4,4,8,4,4,8,4,4,26,2,2,2,8,2,2,2,2,2,2,2,2,12,4,2,2,2,2,2,2,2,2,10,2,2,2,12,2,2,12,2,2,12,2,2,12,2,2,10,2,8,4,4,4,4,4,8,2,2,2,2,8,4,4,8,2,2,2,2,2,2,2,2,10,2,2,2,10,2,2,2,6,2,4,4,4,4,4,8,8,8,8,8,8,6,2,2,2,8,4,4,8,8,2,2,2,2,2,2,2,2,20,4,12,4,12,4,10,2,2,2,2,2,2,2,20,2,2,12,2,2,12,2,2,18,2,2,2,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,2,2,4,4,4,8,4,4,8,2,2,2,2,2,2,2,2,10,2,2,2,2,2,2,2,6,2,6,2,6,2,4,4,2,2,2,2,8,16);\n\nint voice2_len = 555;\nint voice2_notes[] = int[](9999,-10,-15,-12,-8,-7,-8,-10,-11,-15,-13,-11,-10,-12,-10,-8,-7,-8,-7,-5,-3,-5,-7,-8,-10,-8,-10,-11,-10,-5,-11,-8,-15,-10,-9,-10,-11,-10,2,0,-1,-3,-5,-7,-8,-10,-5,-3,-5,-7,-5,-3,-2,-5,-8,-10,-8,-7,-5,-8,-7,-10,-8,-11,-10,9999,0,-2,-3,-5,2,0,-2,-3,3,2,0,-2,-2,-3,-5,-7,-9,-10,-12,-6,-7,-8,-7,0,-2,-3,-5,-3,-5,-7,-8,-10,-8,-10,9999,-5,-12,-8,-5,-3,-5,-7,-8,-10,-8,-6,-5,-4,-5,-6,-5,-4,-5,-6,-5,0,-6,-3,-4,-5,-6,-5,-6,-5,-5,-7,-8,-10,9999,9999,-3,-7,-2,-8,-2,-3,-5,-7,-5,-3,-4,-3,9999,-8,-7,-5,-3,9999,-10,-8,-7,-5,9999,-12,-10,-8,-7,-8,-10,-7,-8,-3,-7,-3,-1,-4,-1,0,-3,-4,-3,-1,2,-4,-1,-3,0,9999,5,4,2,2,0,-1,-3,9999,-2,-3,-5,-7,9999,7,5,4,2,9999,3,2,0,-2,9999,9999,-2,-5,-3,-5,-7,-8,0,-2,-3,-5,-2,-3,2,0,-8,-12,-4,-5,1,0,-1,0,1,0,-1,0,0,-2,-3,-5,-3,-4,-5,-6,-5,-4,-5,-6,-5,-4,-3,-4,-3,-1,-2,-5,-8,-3,-10,-2,-12,-3,-2,-5,-2,-3,-5,-3,-10,-7,-3,0,-1,-3,-4,-8,-6,-4,-3,-2,-3,-4,-3,2,0,-1,-3,-2,-3,-4,-3,2,0,-1,-2,6,4,2,1,-1,-2,1,-6,-5,-6,-5,-3,-6,-8,-1,-3,-4,-6,-3,-4,-3,-1,-3,-4,-3,-5,-6,-5,9999,9999,-6,-5,-3,-6,-5,-7,-4,-5,-7,-8,-10,-8,-5,-8,-5,-5,-7,-8,-7,9999,9999,-3,-7,-3,-3,-5,-6,-5,9999,4,1,2,-1,1,2,4,4,2,1,2,9999,9999,-2,-3,-5,-7,0,-2,-3,-2,9999,9999,9999,-5,-6,-8,-10,9999,9999,-5,-3,-2,-9,9999,9999,-3,-2,0,-6,9999,9999,-2,2,-4,-5,9999,9999,-3,-2,-5,-3,9999,9999,9999,9999,3,2,0,-2,9999,9999,0,-2,-3,-5,9999,-5,-8,9999,-2,-3,-5,-7,9999,-3,-7,-5,-7,-8,-10,-7,-5,-7,-8,-10,-8,-7,-3,-1,1,2,5,2,-3,-7,-12,-8,-4,-3,-5,-7,-8,-11,-10,-8,-15,-3,-6,9999,-6,-5,-3,-5,-7,-8,-10,-12,9999,9999,9999,-8,-7,-5,-7,-9,-10,-11,-10,9999,9999,-8,-12,9999,9999,-6,-10,9999,9999,-4,-8,9999,9999,9999,2,1,4,2,0,-2,-3,-2,-3,-5,-3,-2,-5,-3,-5,-7,-5,-3,-7,-5,-7,-9,-6,-5,-8,-6,-5,-3,-10,9999,9999,9999,-15,-14,-12,-10,9999,-15,-13,9999,-7,-8,9999,-3,-10,-7,-3,-2,-3,-5,-6,-10,-8,-6,-5,-6,-5,-8,-6);\nint voice2_durations[] = int[](64,8,8,8,8,8,4,4,10,2,2,2,10,2,2,2,10,2,2,2,10,2,2,2,10,2,2,2,4,4,4,8,4,10,2,2,2,4,8,2,2,2,2,2,2,4,6,2,2,2,2,2,2,2,12,2,2,12,4,12,4,12,4,8,8,2,2,2,2,10,2,2,2,10,2,2,2,10,2,2,2,4,4,8,2,2,2,2,10,2,2,2,2,2,2,2,2,2,4,4,4,8,8,8,8,8,4,4,10,2,2,2,10,2,2,2,10,2,2,2,4,4,4,6,2,2,2,10,2,6,2,2,2,4,4,4,4,4,4,6,2,2,2,2,2,10,2,4,2,2,2,2,8,2,2,2,2,8,2,2,2,2,10,2,2,2,14,2,4,10,2,4,10,2,12,2,2,4,4,4,6,2,4,2,2,2,4,2,2,2,8,2,2,2,2,8,2,2,2,2,8,2,2,2,2,8,8,4,4,10,2,2,2,2,2,2,2,2,2,2,2,4,4,12,4,2,2,2,2,10,2,2,2,14,4,2,2,2,10,2,2,2,10,2,2,2,4,6,2,2,2,12,4,4,4,12,4,12,4,12,4,10,2,2,2,8,8,8,8,8,4,4,10,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,4,4,4,10,2,2,2,4,4,4,2,2,12,2,2,4,4,4,6,2,2,2,4,2,2,2,2,2,2,4,4,4,6,2,2,2,4,4,4,4,4,6,2,2,2,8,4,4,4,6,2,2,2,10,2,2,2,8,8,2,2,2,2,2,2,2,2,4,4,8,2,2,2,2,4,4,2,2,2,2,4,4,2,2,2,2,4,4,2,2,2,2,4,4,2,2,2,2,4,4,8,8,2,2,2,2,4,4,2,2,2,2,8,4,4,8,2,2,2,2,8,4,4,10,2,2,2,4,6,2,2,2,4,4,2,2,2,2,4,4,4,4,8,8,8,8,8,4,4,10,2,2,2,4,4,8,2,2,2,2,2,2,2,2,4,4,8,2,2,2,2,2,2,2,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,2,2,2,2,2,2,2,2,2,2,6,2,2,2,2,2,6,2,2,2,2,2,6,2,2,2,2,2,4,4,4,16,4,4,4,4,8,4,4,8,4,8,4,8,8,8,8,8,8,4,4,10,2,2,2,10,2,2,2,16);\n\nint voice3_len = 506;\nint voice3_notes[] = int[](9999,-15,-22,-19,-15,-14,-15,-17,-19,-20,-19,-17,-15,-14,-15,-16,-15,-14,-15,-16,-15,-10,-17,-14,-20,-15,-17,-19,-20,-19,-17,-15,9999,9999,-22,-20,-19,-17,9999,9999,-23,-22,-20,-19,9999,9999,-25,-23,-22,-20,9999,9999,-15,-14,-12,-10,-13,-12,-10,-8,-11,-10,-8,-7,-7,-8,-10,-12,-14,-15,-12,-15,-15,-17,-19,-20,-22,-20,-15,-17,-19,-20,-19,-20,-22,-20,-19,-17,-15,-14,-15,-17,-19,9999,9999,-10,-17,-14,-10,-9,-10,-12,-14,-15,-14,-12,-10,-9,-10,-11,-10,-20,-19,-17,-15,-22,-10,-9,-10,-11,-10,-7,-8,-10,-3,-11,-10,-8,-7,-8,-12,-10,-13,-12,-15,-13,-16,-20,-15,-19,-22,-13,-16,-16,-15,-8,-15,-10,-12,-13,-10,-12,-13,-15,-16,-15,-13,-13,-15,9999,-10,-12,-14,-15,9999,-14,-15,-17,-19,9999,-5,-7,-8,-10,9999,-9,-10,-12,-14,-5,-8,9999,-12,-14,-15,-17,9999,-10,-12,-14,-15,9999,-14,-15,-17,-15,-13,-12,-8,-12,9999,-8,-12,9999,-9,-15,9999,-10,-17,-14,-10,-7,-8,-10,-11,-15,-13,-11,-10,-15,-7,-17,-8,-7,-10,-7,-8,-10,-11,-9,-10,-11,-10,-5,-7,-8,-10,-9,-10,-11,-10,-5,-7,-8,-9,-8,-9,-8,-6,-8,-6,-9,-13,-12,-13,-12,-10,-13,-15,-8,-12,9999,9999,-8,-12,-8,-14,9999,-18,-17,-15,9999,-13,-12,-10,-13,-12,-11,-10,-12,-13,-8,-12,-13,-12,-15,-10,-9,-7,-13,-12,-10,-9,-10,-17,-17,-15,-13,-12,9999,9999,-12,-15,9999,-15,-13,-11,-10,9999,9999,-10,-13,9999,-13,-11,-10,-8,-2,-8,-10,-8,-11,9999,-15,-19,9999,-12,-15,-12,9999,-19,-22,9999,-15,-18,-15,-17,-18,-17,-18,-17,-14,-15,-17,-15,-12,-14,-15,-14,-10,-12,-14,-12,-9,-10,-12,-14,-15,-14,-12,-15,-17,-9,-10,-12,-14,9999,-12,-14,-15,-17,9999,-10,-12,-14,-15,9999,-14,-15,-17,-19,-15,-22,-19,-15,-14,-15,-17,-19,-20,-19,-17,-15,-14,-15,-16,-15,-15,-17,-19,-20,-22,-20,-22,-23,-22,-20,-19,-17,-15,9999,9999,9999,9999,-12,-10,-9,-10,-12,-14,-15,-17,-10,-14,-17,-15,-14,-15,-17,-19,-20,-19,-19,-20,-22,-20,-17,-18,-20,-18,-15,-16,-18,-16,-13,-14,-15,-17,-15,-10,-14,-17,-20,9999,-15,-19,-22,9999,-17,-21,-24,-22,-22,-20,-18,-17,9999,9999,-10,-17,-14,-10,-7,-8,-10,-11,-15,-13,-11,-10,-15,-14,-15,-16,-15,-25,-23,-22,-20,-19,-17,-20,-18,-15,-17,-18,-14,-15,-12,-13,-15,-13,-14,-15,-17,-15);\nint voice3_durations[] = int[](160,8,8,8,8,8,4,4,10,2,2,2,10,2,2,2,10,2,2,2,4,4,4,8,4,4,4,2,2,2,2,4,4,2,2,2,2,4,4,2,2,2,2,4,4,2,2,2,2,4,4,2,2,2,2,10,2,2,2,10,2,2,2,10,2,2,2,20,4,4,4,10,2,2,2,2,2,8,2,2,2,2,8,2,2,2,2,6,2,8,2,2,8,8,16,8,8,8,8,8,4,4,10,2,2,2,2,2,2,2,2,2,2,2,2,2,6,2,2,2,2,2,2,2,4,8,2,2,12,4,12,4,12,4,12,4,12,8,8,8,4,4,8,4,4,4,4,6,2,2,2,2,2,2,2,6,2,8,8,2,2,2,2,8,2,2,2,2,8,2,2,2,2,8,2,2,2,2,4,4,8,2,2,2,2,16,2,2,2,2,8,2,2,2,2,4,4,4,4,8,4,4,8,4,4,8,8,8,8,8,8,8,4,4,10,2,2,2,4,4,12,4,12,4,10,2,2,2,10,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,4,4,4,4,4,4,4,4,8,4,4,2,2,8,4,6,2,2,2,4,4,12,4,4,4,2,2,4,4,4,4,6,2,2,2,10,10,6,2,2,2,4,4,4,4,8,2,2,2,2,4,4,4,4,8,2,2,2,2,4,4,2,2,4,8,4,4,8,4,4,4,4,4,4,8,4,4,4,8,2,2,10,2,2,2,10,2,2,2,10,2,2,2,10,2,2,2,2,2,2,2,6,2,8,2,2,2,2,8,2,2,2,2,8,2,2,2,2,8,2,2,2,2,8,8,8,8,8,8,4,4,10,2,2,2,2,2,2,2,10,2,2,2,4,6,2,2,2,2,2,2,2,2,2,4,8,2,2,2,2,2,2,2,2,4,4,10,2,2,2,2,2,2,2,18,2,2,2,4,8,2,2,4,8,2,2,4,8,4,12,4,4,8,4,4,4,4,4,4,4,4,4,4,4,10,2,2,2,4,4,8,8,8,8,8,8,4,4,10,2,2,2,4,6,2,2,2,2,2,2,2,2,2,2,2,2,2,6,2,6,2,8,2,2,4,8,2,2,16);\n\nint voice4_len = 471;\nint voice4_notes[] = int[](9999,-22,-27,-24,-20,-19,-20,-22,-23,-27,-25,-23,-22,-24,-26,-27,-29,-26,-27,-29,-31,-27,-29,-31,-32,-29,-31,-32,-34,-22,-26,-29,-32,-20,-24,-27,-31,-19,-22,-26,-29,-17,-20,-24,-27,-31,-29,-27,-26,-24,-22,-20,-19,-21,-22,-24,-26,-24,-23,-22,-24,9999,-20,-24,-17,-19,-20,-22,-21,-21,-22,-24,-25,-29,-27,-25,-24,-26,-27,-29,-27,-26,-22,-17,9999,9999,-17,-22,-19,-15,-14,-15,-17,-19,-20,-19,-17,-15,9999,-15,-19,9999,-17,-20,9999,-19,-22,-24,-25,-22,-24,-25,-24,-27,-22,-24,-22,-25,-20,-22,-20,-24,-19,-20,-19,-22,-16,9999,-20,-15,-19,-22,-20,-27,9999,-15,-19,9999,-19,-22,9999,-10,-14,9999,-14,-17,9999,-15,-17,-19,-20,9999,-19,-20,-22,-24,9999,9999,-19,-24,-20,-17,-14,-15,-17,-18,-22,-20,-18,-17,-22,-26,9999,-22,-26,9999,-24,-25,-27,-28,-32,-30,-28,-27,-15,-17,-19,-20,-19,-17,-20,-19,-17,-19,-20,-22,-24,-26,-27,-29,-27,-26,-29,-24,-22,-20,-24,-19,-17,-15,-19,-14,-15,-17,-19,-20,-22,-23,-25,-27,-29,-31,-32,-34,-15,-19,-22,9999,-27,-31,-34,9999,-17,-18,-20,-21,-23,-21,-25,-20,-32,-25,-22,-24,9999,9999,-15,-18,9999,-15,-18,-23,-26,-30,9999,-25,-18,-15,-16,-15,-13,-12,-15,-13,-15,-16,-20,-19,-18,-17,-16,-15,-17,-18,-15,-17,-29,-24,9999,-24,-22,-20,-19,9999,-17,-19,-20,-22,9999,-22,-20,-19,-17,9999,-15,-17,-19,-20,9999,-20,-19,-17,-15,9999,-15,-22,9999,-22,-24,-26,-27,9999,9999,-19,-26,9999,-26,-27,-29,-30,9999,9999,-22,-29,-27,-26,-29,-24,-21,-24,-27,-22,-18,-22,-26,-21,-17,-20,-24,-19,-15,-18,-22,-17,-21,-24,-22,-17,-14,-17,9999,-17,-20,9999,-15,-19,9999,-19,-22,-19,-26,-22,-19,-17,-19,-20,-22,-23,-22,-20,-19,-19,-20,-22,-24,-25,-26,-27,-17,-15,-14,-15,-17,-19,-20,-18,9999,-22,-29,9999,9999,-17,-20,9999,-24,-19,-24,-27,-31,-26,-27,-29,-26,-27,-25,-24,-25,-27,-24,-25,-23,-22,-23,-25,-22,-23,-22,-20,-22,-23,-20,-22,-20,-19,-22,-17,9999,-24,-19,9999,-31,-26,-27,-26,-29,-26,-27,-29,-30,-29,-30,-29,-27,-26,-29,-26,-22,-17,-22,-24,-27,-26,-22,-29,-31,-32,-20,-22,-25,-24,-20,-27,-28,-27,-15,-17,-20,-19,-26,-27,-22);\nint voice4_durations[] = int[](224,8,8,8,8,8,4,4,10,2,2,2,10,2,2,2,10,2,2,2,10,2,2,2,10,2,2,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,2,2,2,2,2,2,2,2,10,2,2,2,8,8,8,8,8,4,4,4,2,2,2,2,6,2,2,2,2,2,2,2,4,4,8,2,2,2,2,4,4,48,8,8,8,8,8,4,4,10,2,2,2,8,4,4,8,4,4,8,4,4,10,2,2,2,6,2,4,4,6,2,4,4,6,2,4,4,6,2,4,4,8,4,4,4,4,4,4,8,4,4,8,4,4,8,4,4,8,4,4,8,2,2,2,2,8,2,2,2,2,8,8,16,8,8,8,8,8,4,4,10,2,2,2,4,4,8,4,4,8,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,4,4,4,4,4,4,4,2,2,2,2,2,2,2,2,4,4,4,4,4,4,4,4,8,4,4,4,4,4,4,4,4,4,8,4,10,2,2,2,4,4,4,4,4,8,8,8,6,2,2,2,8,8,8,2,2,2,2,8,2,2,2,2,8,2,2,2,2,8,2,2,2,2,8,2,2,2,2,8,4,4,8,2,2,2,2,4,4,4,4,8,2,2,2,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,4,4,8,4,4,8,4,4,12,8,8,8,8,6,4,2,10,2,2,2,10,2,2,2,10,4,2,18,2,2,2,2,2,2,2,8,4,4,4,4,4,4,8,4,4,4,4,4,4,10,2,2,2,2,2,6,2,2,2,2,2,6,2,2,2,2,2,6,2,2,2,4,4,4,4,8,4,4,8,4,4,10,2,2,2,2,2,2,2,10,2,2,2,2,2,2,2,18,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,16,8,16,64);\n\n// These functions give the index of the current note (i) and the time it began (t).\nvoid voice1(float time, out int i, out float t){\n    i = 0;\n    t = 0.0;\n    while(t < time && i < voice1_len){\n        t += float(voice1_durations[i]) * 15.0 / tempo;            \n        i++;\n    }\n    i--;\n    t -= float(voice1_durations[i]) * 15.0/tempo;\n}\n\nvoid voice2(float time, out int i, out float t){\n    i = 0;\n    t = 0.0;\n    while(t < time && i < voice2_len){\n        t += float(voice2_durations[i]) * 15.0 / tempo;\n        i++;\n    }\n    i--;\n    t -= float(voice2_durations[i]) * 15.0/tempo;\n}\n\nvoid voice3(float time, out int i, out float t){\n    i = 0;\n    t = 0.0;\n    while(t < time && i < voice3_len){\n        t += float(voice3_durations[i]) * 15.0 / tempo;\n        i++;\n    }\n    i--;\n    t -= float(voice3_durations[i]) * 15.0/tempo;\n}\n\nvoid voice4(float time, out int i, out float t){\n    i = 0;\n    t = 0.0;\n    while(t < time && i < voice4_len){\n        t += float(voice4_durations[i]) * 15.0 / tempo;\n        i++;\n    }\n    i--;\n    t -= float(voice4_durations[i]) * 15.0/tempo;\n}","name":"Common","description":"","type":"common"},{"inputs":[],"outputs":[],"code":"float i1[5] = float[](1.0, 3.0, 1.3, 0.1, 0.3);\nfloat i2[5] = float[](2.0, 1.8, 1.6, 1.4, 1.2);\nfloat i3[5] = float[](1.0, 2.8, 0.2, 1.8, 0.9);\nfloat i4[5] = float[](2.0, 1.0, 1.0, 1.0, 1.0);\n\nfloat inst(float freq, float t, float[5] fourier){\n\n    float sum = 0.0;\n    for(int i = 1; i <= 5; i++){\n        sum += fourier[i-1] * sin(6.2831*freq * t * float(i));\n    }\n    return sum;\n}\n\nfloat voice1_amplitude(float time, float real_time){\n    int i;\n    float t;\n    voice1(time, i, t);\n    if(voice1_notes[i] == 9999){\n        return 0.0;\n    }\n    float pitch = base_pitch * pow(2.0, float(voice1_notes[i]) / 12.0);\n    float fac = 1.0;\n    if(time-t < 0.03){\n        fac = (exp(time-t)-1.0)/(exp(0.03)-1.0);\n    } else {\n        fac = exp(-6.0*(time-t));\n    }\n    return inst(pitch, real_time, i1) * fac;\n}\n\nfloat voice2_amplitude(float time, float real_time){\n    int i;\n    float t;\n    voice2(time, i, t);\n    if(voice2_notes[i] == 9999){\n        return 0.0;\n    }\n    float pitch = base_pitch * pow(2.0, float(voice2_notes[i]) / 12.0);\n    float fac;\n    if(time-t < 0.03){\n        fac = (exp(time-t)-1.0)/(exp(0.03)-1.0);\n    } else {\n        fac = exp(-6.0*(time-t));\n    }\n    return inst(pitch, real_time, i2) * fac;\n}\n\nfloat voice3_amplitude(float time, float real_time){\n    int i;\n    float t;\n    voice3(time, i, t);\n    if(voice3_notes[i] == 9999){\n        return 0.0;\n    }\n    float pitch = base_pitch * pow(2.0, float(voice3_notes[i]) / 12.0);\n    float fac;\n    if(time-t < 0.03){\n        fac = (exp(time-t)-1.0)/(exp(0.03)-1.0);\n    } else {\n        fac = exp(-6.0*(time-t));\n    }\n    return inst(pitch, real_time, i3) * fac;\n}\n\nfloat voice4_amplitude(float time, float real_time){\n    int i;\n    float t;\n    voice4(time, i, t);\n    if(voice4_notes[i] == 9999){\n        return 0.0;\n    }\n    float pitch = base_pitch * pow(2.0, float(voice4_notes[i]) / 12.0);\n    float fac;\n    if(time-t < 0.03){\n        fac = (exp(time-t)-1.0)/(exp(0.03)-1.0);\n    } else {\n        fac = exp(-6.0*(time-t));\n    }\n    return inst(pitch, real_time, i4) * fac;\n}\n\nvec2 mainSound( int samp, float time )\n{\n\n    float music_time = time;\n    \n    float slowdown_time = 60.0*slowdown_point/tempo;\n    \n    if(music_time >= slowdown_time){\n        float t_since = music_time - slowdown_time;\n        music_time = slowdown_time + slowdown_rate*t_since/(t_since + slowdown_rate);\n    }\n\n    return vec2(voice1_amplitude(music_time, time) + voice2_amplitude(music_time, time) + voice3_amplitude(music_time, time) + voice4_amplitude(music_time, time))/14.0;\n}","name":"Sound","description":"","type":"sound"}]}