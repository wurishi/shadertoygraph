{"ver":"0.1","info":{"id":"ddBfR3","date":"1689940966","viewed":68,"name":"程安絮2D基础教学_线段_宽度","username":"Leslie","description":"没想到画直线才是最难的，比画圆还要难得多。","likes":1,"published":1,"flags":0,"usePreview":0,"tags":["2d"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec3 cFront=vec3(1.,0.,0.);\n    vec3 cBack=vec3(0.,0.,1.);\n    \n    vec2 ptStart=vec2(40.,350.);\n    vec2 ptEnd=vec2(600.,10.);\n    vec2 pt1=ptEnd-ptStart;\n\n    float halfWidth=5.;\n    float minX=min(ptStart.x,ptEnd.x);\n    float minY=min(ptStart.y,ptEnd.y);\n    float maxX=max(ptStart.x,ptEnd.x);\n    float maxY=max(ptStart.y,ptEnd.y);\n    \n    \n    if(pt1.x==0.&&pt1.y==0.) return;\n\n    if(pt1.x==0.){\n        if(fragCoord.y>=minY&&fragCoord.y<=maxY&&ptEnd.x-fragCoord.x<=halfWidth&&fragCoord.x-ptEnd.x<halfWidth) fragColor=vec4(cFront,1.); else fragColor=vec4(cBack,1.);\n    }else if(pt1.y==0.){\n        if(fragCoord.x>=minX&&fragCoord.x<=maxX&&ptEnd.y-fragCoord.y<=halfWidth&&fragCoord.y-ptEnd.y<halfWidth) fragColor=vec4(cFront,1.); else fragColor=vec4(cBack,1.);\n    }else{\n        vec2 pt2=vec2(-pt1.y,pt1.x);\n        if(pt1.x<=pt1.y){\n            float k1=pt1.x/pt1.y;\n            float b1=ptEnd.x-ptEnd.y*k1;\n            float k2=-k1;\n            float b2=fragCoord.y-fragCoord.x*k2;\n\n            float x1=fragCoord.y*k1+b1;\n\n            vec2 ptCross=vec2((k1*b2+b1)/(1.-k1*k2),(k2*b1+b2)/(1.-k1*k2));\n\n            if(ptCross.y>=minY&&ptCross.y<=maxY&&distance(fragCoord,ptCross)<halfWidth) fragColor=vec4(cFront,1.); else fragColor=vec4(cBack,1.);\n        }else{\n            float k1=pt1.y/pt1.x;\n            float b1=ptEnd.y-ptEnd.x*k1;\n            float k2=-k1;\n            float b2=fragCoord.x-fragCoord.y*k2;\n\n            float y1=fragCoord.x*k1+b1;\n\n            vec2 ptCross=vec2((k2*b1+b2)/(1.-k2*k1),(k1*b2+b1)/(1.-k2*k1));\n\n            if(ptCross.x>=minX&&ptCross.x<=maxX&&distance(fragCoord,ptCross)<halfWidth) fragColor=vec4(cFront,1.); else fragColor=vec4(cBack,1.);\n        }\n    }\n}\n","name":"Image","description":"","type":"image"}]}