{"ver":"0.1","info":{"id":"Ns23DW","date":"1617427513","viewed":91,"name":"grid beat","username":"ligaobo","description":"跳动的网格","likes":4,"published":1,"flags":0,"usePreview":0,"tags":["noise","move","gird"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"highp float aa;\n\nhighp float hash(float x) {\n    return fract(sin(x)*43758.5453);\n}\nhighp float rand(vec2 co) {\n    return fract(sin(mod(dot(co.xy ,vec2(12.9898,78.233)),3.14))*43758.5453);\n}\n\nfloat dis2Integer(float x)\n{\n    return 0.5 - abs(fract(x) - 0.5);\n}\n\n//------------------------------------------------------------\n/*行列网格数，注意是从零开始，所以总的网格数为(rmax + 1.0) * (cmax + 1.0)*/\nconst float rmax = 4.0f;\nconst float cmax = rmax;\nvec2 gridIndex[int((rmax + 1.0) * (cmax + 1.0))];\nint iter = 0;\n\nvec2 leftTop(float r, float c)\n{\n    int biter = iter;\n    for (float cc = c; cc < cmax - c; ++cc)\n    {\n        gridIndex[iter++] = vec2(r, cc);\n    }\n\n    for (float cr = r; cr < rmax - r; ++cr)\n    {\n        gridIndex[iter++] = vec2(cr, cmax - c);\n    }\n    if(biter == iter)\n        gridIndex[iter++] = vec2(r, c);\n    return vec2(cmax - c, rmax - r);\n}\n\nvec2 rightBottom(float r, float c)\n{\n    for (float cc = c; cc > cmax - c; --cc)\n    {\n        gridIndex[iter++] = vec2(r, cc);\n    }\n\n    for (float cr = r; cr > rmax - r; --cr)\n    {\n        gridIndex[iter++] = vec2(cr, cmax - c);\n    }\n    return vec2(cmax - c + 1.0, rmax - r + 1.0);\n}\n\n//------------------------------------------------------------\n\nvoid mainImage( out vec4 o, in vec2 fragCoord )\n{\n    // 水平网格数\n    float rnum = rmax + 1.0;\n    float cnum = cmax + 1.0;\n    \n    aa = rnum / min(iResolution.x, iResolution.y);\n    vec2 uv = fragCoord * aa;\n    \n    float col = 0.0;\n    col = smoothstep(aa, 0.0, dis2Integer(uv.x)) * 0.5;\n    col += smoothstep(aa, 0.0, dis2Integer(uv.y)) * 0.5;\n\n    if(uv.x > rnum || uv.y > cnum)\n     col = 0.0f;\n     \n    float stepSpeed = iTime * 2.0;\n\n    float r = 0.0;\n    float c = 0.0;\n    {\n        float imax = rmax * 0.5;\n        imax = mod(rmax, 2.0) == 0.0 ? imax + 1.0 :  imax;  \n        for(float i = 0.0f; i < imax; ++i)\n        {\n            vec2 rbstart = leftTop(r, c);\n\t        vec2 ltstart = rightBottom(rbstart.x, rbstart.y);\n            r = ltstart.x;\n            c = ltstart.y;\n        }\n\n        int index = int(mod(stepSpeed,  float(iter)));\n        vec2 iv = gridIndex[index];\n        r = iv.x;\n        c = iv.y;\n    }\n    vec2 luv = uv - vec2(r, c);\n    if(luv.x < 1.0 && luv.y < 1.0 && luv.x > 0.0 && luv.y > 0.0)\n        col += (1.0 - fract(stepSpeed)) * rand(uv*iTime);\n\n    o = vec4(0.0, col, 0.0, col); \n}","name":"Image","description":"","type":"image"}]}