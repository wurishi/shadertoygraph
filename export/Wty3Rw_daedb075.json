{"ver":"0.1","info":{"id":"Wty3Rw","date":"1578626504","viewed":131,"name":"Colorful gears","username":"jschipper","description":"Rotating gears.","likes":7,"published":1,"flags":0,"usePreview":0,"tags":["gears","beginner"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define S(a,b,c) smoothstep(a,b,c)\n#define M_PI 3.1415926535897932384626433832795\n\nvec2 rot(vec2 xy, float phi) {\n    return vec2(xy.x*cos(phi) - xy.y*sin(phi), xy.y*cos(phi) + xy.x*sin(phi));\n}\n\nfloat gear(vec2 uv, float t) {\n    uv -= 0.5;\n\tfloat phi = atan(uv.y,uv.x) + t;\n    float d = length(uv);\n    \n    float od = 0.495;\n    \n    uv = rot(uv,t);\n    \n    float g = 0.;\n    g -= S(0.17,0.165,length(uv - vec2(0.,0.25)));\n    g -= S(0.17,0.165,length(uv - vec2(0.25,0.)));\n    g -= S(0.17,0.165,length(uv + vec2(0.,0.25)));\n    g -= S(0.17,0.165,length(uv + vec2(0.25,0.)));\n    g += S(od+0.005,od,d + atan(sin(20.*phi)*4.)/40.);\n    \n    g = min(g,1.);\n    \n    return g;\n}\n\nfloat layer(vec2 uv, float t) {\n    float l = 0.;\n    vec2 id = floor(uv);\n    uv = fract(uv);\n    \n    for (float i = -1.; i <= 1.; i++)\n        for (float j = -1.; j <= 1.; j++) {\n    \t\tvec2 sn = mod(id + vec2(i,j),2.)*2. - 1.;\n\t\t\tl = mix(l, 1., gear(uv + vec2(i,j), sn.x*sn.y*t));\n        }\n    return l;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // Normalized pixel coordinates (from 0 to 1)\n    vec2 uv = (fragCoord - iResolution.xy/2.0)/iResolution.y;\n    uv*=.5;\n\n    float t = iTime/2.;\n    \n    float zoom_pow = 2.;\n    float z = pow(zoom_pow,fract(t));\n    uv/=z;\n    \n    uv = rot(uv,t/2.);\n    \n    vec4 col = vec4(0);\n    \n    float fade = 0.6;\n    float N = 5.;\n    \n    uv*=pow(zoom_pow,N);\n    for (float i = floor(t)+N; i > floor(t); i--) {\n        uv/=zoom_pow;\n        vec2 luv = rot(uv + .2*i, i);\n        float l = layer(luv, t);\n        \n        if (i == floor(t)+1.)\n            l *= 1. - fract(t);\n        \n        if (i == floor(t)+N)\n            l *= fract(t);\n        col = mix(col*fade, vec4(sin(i*5.3)/2. + 0.5,sin(i*8.3)/2. + 0.5,sin(i*2.3)/2. + 0.5,1.), l);\n    }\n    \n    col *= mix(fade, 1., fract(t))/fade;\n\n    // Output to screen\n    fragColor = col;\n}","name":"Image","description":"","type":"image"}]}