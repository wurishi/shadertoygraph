{"ver":"0.1","info":{"id":"MsycWV","date":"1523368178","viewed":236,"name":"Palette From Texture  ","username":"gigatron","description":"Credit :Coldberg from NES-iFY\nTRY to replace palette with iChannel1->iChannel0\nJ ai certainement commis des erreurs .... !!","likes":3,"published":1,"flags":0,"usePreview":1,"tags":["color","palette"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"Xdf3Rn","filepath":"/media/a/e81e818ac76a8983d746784b423178ee9f6cdcdf7f8e8d719341a6fe2d2ab303.webm","previewfilepath":"/media/ap/e81e818ac76a8983d746784b423178ee9f6cdcdf7f8e8d719341a6fe2d2ab303.webm","type":"video","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"Xsf3zn","filepath":"/media/a/f735bee5b64ef98879dc618b016ecf7939a5756040c2cde21ccb15e69a6e1cfb.png","previewfilepath":"/media/ap/f735bee5b64ef98879dc618b016ecf7939a5756040c2cde21ccb15e69a6e1cfb.png","type":"texture","channel":1,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define BRIGHTNESS 1.0\n#define tx iChannel1\n\nvec3 find_closest (vec3 ref) {\t\n\tvec3 old = vec3 (0.0);\t\t\n\t#define TRY_COLOR(new) old = mix (new, old, step (length (old-ref), length (new-ref)));\t\n \t\n    float x=0.0;    \n    \n    for (float i=0.0;i<=255.0;i++) { \n        \n        x <1.0 ? x+=(1./255.0) : x=0.0; //step 1./width\n            \n        vec3 cc = vec3 (0.0);\t\n       // palette\n        cc = TRY_COLOR (vec3(texture(tx,vec2(x,1.0)))); // step ;\n       // cc-\n        old = cc*0.01*255.0; \n    \n     // night---mare \n    }\n    \n    //TRY_COLOR (vec3 (156.0, 189.0, 015.0));\n\t//TRY_COLOR (vec3 (140.0, 173.0, 015.0));\n\t//TRY_COLOR (vec3 (048.0, 098.0, 048.0));\n\t//TRY_COLOR (vec3 (015.0, 056.0, 015.0));\n\t\n return old ;\n\t\n}\n\n\nfloat dither_matrix (float x, float y) {\n\treturn mix(mix(mix(mix(mix(mix(0.0,32.0,step(1.0,y)),mix(8.0,40.0,step(3.0,y)),step(2.0,y)),mix(mix(2.0,34.0,step(5.0,y)),mix(10.0,42.0,step(7.0,y)),step(6.0,y)),step(4.0,y)),mix(mix(mix(48.0,16.0,step(1.0,y)),mix(56.0,24.0,step(3.0,y)),step(2.0,y)),mix(mix(50.0,18.0,step(5.0,y)),mix(58.0,26.0,step(7.0,y)),step(6.0,y)),step(4.0,y)),step(1.0,x)),mix(mix(mix(mix(12.0,44.0,step(1.0,y)),mix(4.0,36.0,step(3.0,y)),step(2.0,y)),mix(mix(14.0,46.0,step(5.0,y)),mix(6.0,38.0,step(7.0,y)),step(6.0,y)),step(4.0,y)),mix(mix(mix(60.0,28.0,step(1.0,y)),mix(52.0,20.0,step(3.0,y)),step(2.0,y)),mix(mix(62.0,30.0,step(5.0,y)),mix(54.0,22.0,step(7.0,y)),step(6.0,y)),step(4.0,y)),step(3.0,x)),step(2.0,x)),mix(mix(mix(mix(mix(3.0,35.0,step(1.0,y)),mix(11.0,43.0,step(3.0,y)),step(2.0,y)),mix(mix(1.0,33.0,step(5.0,y)),mix(9.0,41.0,step(7.0,y)),step(6.0,y)),step(4.0,y)),mix(mix(mix(51.0,19.0,step(1.0,y)),mix(59.0,27.0,step(3.0,y)),step(2.0,y)),mix(mix(49.0,17.0,step(5.0,y)),mix(57.0,25.0,step(7.0,y)),step(6.0,y)),step(4.0,y)),step(5.0,x)),mix(mix(mix(mix(15.0,47.0,step(1.0,y)),mix(7.0,39.0,step(3.0,y)),step(2.0,y)),mix(mix(13.0,45.0,step(5.0,y)),mix(5.0,37.0,step(7.0,y)),step(6.0,y)),step(4.0,y)),mix(mix(mix(63.0,31.0,step(1.0,y)),mix(55.0,23.0,step(3.0,y)),step(2.0,y)),mix(mix(61.0,29.0,step(5.0,y)),mix(53.0,21.0,step(7.0,y)),step(6.0,y)),step(4.0,y)),step(7.0,x)),step(6.0,x)),step(4.0,x));\n}\n\nvec3 dither (vec3 color, vec2 uv) {\t\n\tcolor *= 255.0 * BRIGHTNESS;\t\n\tcolor += dither_matrix (mod (uv.x, 8.0), mod (uv.y, 8.0)) ;\n\tcolor = find_closest (clamp (color, 0.0, 255.0));\n\treturn color /255.0;\n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 uv = fragCoord.xy / iResolution.xy;\n\tvec3 tc = texture(iChannel0, uv).xyz;\n\tfragColor =  vec4 (dither (tc, fragCoord.xy),1.0);\t\t\n}","name":"Image","description":"","type":"image"}]}