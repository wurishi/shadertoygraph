{"ver":"0.1","info":{"id":"WtSGDc","date":"1563699130","viewed":580,"name":"Content Aware Scale (Attempt)","username":"slerpy","description":"An attempt to recreate the content aware scale filter only using fragment shaders.\n\n(iMouse.x controls the intensity of the filter)","likes":14,"published":1,"flags":32,"usePreview":0,"tags":["video","post","scale","processing","aware","content"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"mipmap","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4sXGR8","filepath":"/media/previz/buffer02.png","previewfilepath":"/media/previz/buffer02.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4sXGR8","filepath":"/media/previz/buffer02.png","previewfilepath":"/media/previz/buffer02.png","type":"buffer","channel":2,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XdfGR8","filepath":"/media/previz/buffer03.png","previewfilepath":"/media/previz/buffer03.png","type":"buffer","channel":3,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord / iResolution.xy;\n    \n    #if(0)\n    fragColor = 100.*texture(iChannel3, uv);\n    return;\n    #endif\n    \n    float strength = (2.0 * iMouse.x - iResolution.x) / 5.0;\n    \n    const float r = 2.0;\n    vec2 pix = r / iResolution.xy;\n    \n    float f0 = texture(iChannel3, uv + pix * vec2( 1, 0)).x;\n    float f1 = texture(iChannel3, uv + pix * vec2( 0, 1)).x;\n    float f2 = texture(iChannel3, uv + pix * vec2(-1, 0)).x;\n    float f3 = texture(iChannel3, uv + pix * vec2( 0,-1)).x;\n    \n    vec2 gradient = (vec2(f2, f3) - vec2(f0, f1)) / r;\n    \n    fragColor = texture(iChannel0, uv + strength*gradient);\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"Xdf3Rn","filepath":"/media/a/e81e818ac76a8983d746784b423178ee9f6cdcdf7f8e8d719341a6fe2d2ab303.webm","previewfilepath":"/media/ap/e81e818ac76a8983d746784b423178ee9f6cdcdf7f8e8d719341a6fe2d2ab303.webm","type":"video","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord / iResolution.xy;\n    fragColor = texture(iChannel0, uv);\n}","name":"Buffer A","description":"","type":"buffer"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"mipmap","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"XsXGR8","channel":0}],"code":"const float pi = acos(-1.0);\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord / iResolution.xy;\n    \n    vec2 pix = 2.0 / iResolution.xy;\n    \n    const int iter = 5;\n    vec4 acc = vec4(0);\n    \n    for(int i=0; i<iter; i++)\n    {\n        float a = pi * float(i) / float(iter);\n        vec2 off = pix * vec2(cos(a), sin(a));\n        \n        vec4 t0 = texture(iChannel0, uv+off);\n        vec4 t1 = texture(iChannel0, uv-off);\n        vec4 td = t0 - t1;\n        \n        acc += td * td;\n    }\n    \n    float gray = dot(acc / float(iter), vec4(0.2989, 0.5870, 0.1140, 0));\n    \n    fragColor = vec4(gray);\n}","name":"Buffer B","description":"","type":"buffer"},{"inputs":[{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":1,"sampler":{"filter":"mipmap","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4sXGR8","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord / iResolution.xy;\n    \n    const int iter = 100;\n    float d = 0.2;\n    \n    vec4 acc = vec4(0);\n    \n    for(int i=0; i<iter; i++)\n    {\n        float off = float(i - iter/2) / float(iter);\n        acc += exp(-pow(off/d, 2.)) * texture(iChannel1, uv + off * vec2(0, d));\n    }\n    \n    fragColor = 2. * acc / float(iter);\n}","name":"Buffer C","description":"","type":"buffer"},{"inputs":[{"id":"4sXGR8","filepath":"/media/previz/buffer02.png","previewfilepath":"/media/previz/buffer02.png","type":"buffer","channel":2,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"XdfGR8","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord / iResolution.xy;\n    \n    const int iter = 100;\n    float d = 0.2;\n    \n    vec4 acc = vec4(0);\n    \n    for(int i=0; i<iter; i++)\n    {\n        float off = float(i - iter/2) / float(iter);\n        acc += exp(-pow(off/d, 2.)) * texture(iChannel2, uv + off * vec2(d, 0));\n    }\n    \n    fragColor = 2. * acc / float(iter);\n}","name":"Buffer D","description":"","type":"buffer"}]}