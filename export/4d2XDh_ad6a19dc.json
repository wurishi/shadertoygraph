{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[],"code":"#define PI 3.1415926535897932384626433832795\n\nfloat map( in vec3 p) {\n    vec3 firstSpherePosition =  vec3(0.0, 0.0, 2.0);\n    vec3 q = p;\n    q.xz = mod(p.xz + firstSpherePosition.xz + 2.0, 4.0) - 2.0;\n    float dSphere = length( q ) - 1.0 + cos(iTime) * .15;\n    \n    float dPlane = p.y + 1.0;\n    \n    float blendingRatio = 1.;\n    float ratio = clamp(.5 + .5 * (dSphere - dPlane) / blendingRatio, 0., 1.);\n    \n    float dist = mix(dSphere, dPlane, ratio) - blendingRatio * ratio * (1. - ratio);\n    \n    return dist;\n}\n\nvec3 calcNormal (in vec3 p) {\n\tvec2 e = vec2(0.0001, 0.0);\n    return normalize(vec3( \tmap(p + e.xyy) - map(p - e.xyy),\n                            map(p + e.yxy) - map(p - e.yxy),\n                          \tmap(p + e.yyx) - map(p - e.yyx)));\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 uv = fragCoord.xy / iResolution.xy;\n    vec2 p = -1.0 + 2.0 * uv;\n    p.x *= iResolution.x/iResolution.y;\n    \n    vec3 ro = vec3(0.0, 0.0, 0.0);\n    vec3 rd = normalize( vec3( p, 1.0 ));\n    float rotation = (1.0 - (iMouse.x / iResolution.x) * 2.0) * PI;\n    vec3 direction = vec3(cos(rotation + PI * .5), 0.0, sin(rotation + PI * .5));\n    rd = normalize(direction + vec3( cos(rotation) * p.x, p.y, sin(rotation) * p.x ));\n\n    vec3 col = vec3(.8);\n    \n    float tmax = 100.0;\n    float h = 1.0;\n    float t = 0.0;\n    \n    for(int i = 0; i < 100; i++) {\n        if (h < 0.00001 || h > tmax) break;\n        h = map( ro + rd * t);\n        t += h;\n    }\n    \n    if (t < tmax) {\n        col = calcNormal(ro + rd * t);\n    }\n    \n\tfragColor = vec4(col, 1.0);\n}","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"4d2XDh","date":"1414058631","viewed":165,"name":"Basic ray marching","username":"dmmn","description":"Basic Ray Marching","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["raymarching"],"hasliked":0,"parentid":"","parentname":""}}