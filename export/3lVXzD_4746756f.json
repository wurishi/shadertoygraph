{"ver":"0.1","info":{"id":"3lVXzD","date":"1582306660","viewed":96,"name":"//by evvvvil_","username":"foran","description":"//by evvvvil_","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["byevvvvil"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4sf3Rn","filepath":"/media/a/0a40562379b63dfb89227e6d172f39fdce9022cba76623f1054a2c83d6c0ba5d.png","previewfilepath":"/media/ap/0a40562379b63dfb89227e6d172f39fdce9022cba76623f1054a2c83d6c0ba5d.png","type":"texture","channel":1,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"//by evvvvil_\nvec2 z,v,e=vec2(.0035,0035);\nfloat t,tt,bb,g,g2,td,noise,texNoi;\nvec3 np,bp,pp,po,no,ld,al;\nvec4 c=vec4(3.14,17.,19.,.51);\nfloat smin(float a,float b,float h){\nfloat k=clamp((a-b)/h*.5+.5,0.,1.);\nreturn mix(a,b,k)-k*(1.-k)*h;}\nfloat smax(float d1,float d2,float k){\nfloat h=clamp(.5-.5*(d2+d1)/k,0.,1.);\nreturn mix(d2,-d1,h)+k*h*(1.-h);}\nfloat bo(vec3 p,vec3 r){\np=abs(p)-r;\nreturn max(max(p.x,p.y),p.z);}\nmat2 r2(float r){\nreturn mat2(cos(r),sin(r),-sin(r),cos(r));}    \n\nfloat hash1(vec2 p)\n{\n    p=50.*fract(p*.3183099);\n    return fract(p.x*p.y*(p.x+p.y));\n}\nfloat hash1(float n)\n{\n    return fract(n*17.*fract(n*.3183099));\n}\n\nfloat noi(in vec3 x)\n{\n    vec3 p=floor(x);\n    vec3 w=fract(x);\n    vec3 u=w*w*w*(w*(w*6.-15.)+10.);\n    float n=p.x+317.*p.y+157.*p.z;\n    float a=hash1(n+0.);\n    float b=hash1(n+1.);\n    float c=hash1(n+317.);\n    float d=hash1(n+318.);\n    float e=hash1(n+157.);\n    float f=hash1(n+158.);\n    float g=hash1(n+474.);\n    float h=hash1(n+475.);\n    float k0=a;\n    float k1=b-a;\n    float k2=c-a;\n    float k3=e-a;\n    float k4=a-b-c+d;\n    float k5=a-c-e+g;\n    float k6=a-b-e+f;\n    float k7=-a+b+c-d+e-f-g+h;\n    return-1.+2.*(k0+k1*u.x+k2*u.y+k3*u.z+k4*u.x*u.y+k5*u.y*u.z+k6*u.z*u.x+k7*u.x*u.y*u.z);\n}\n\nfloat gn(vec3 m)\n{float fi,n=0.;\nfor(int i=2;i<5;i++)\nfi=float(i),n+=1./fi*noi(m*fi);\nreturn n;}\n//-------------\nvec2 column( vec3 p ){\npp=abs(p+vec3(0,-16.,0))-vec3(0,6.,0);\nvec2 h,t=vec2(length(pp)-2.2,.6); \nt.x=abs(t.x)-.3;\nt.x=max(t.x,-pp.y);\nh=vec2(length(pp)-2.2,3.);\nh.x=abs(h.x)-.1;\nh.x=max(h.x,-pp.y-.5);\npp.xz*=r2(1.2+sin(p.y)*.5);\nh.x=min(h.x,bo(abs(abs(pp)-vec3(.5,0.,.6))-vec3(1,0,.3),vec3(.2,10.,.15)));\nt=t.x<h.x?t:h;\n//----------\nh=vec2(bo(abs(abs(pp)-vec3(.5,0.,.6))-vec3(1.,0.,.3),vec3(.3,10.,.01)),6.);g+=.1/(.1+h.x*h.x*(500.-sin(p.y*.5+tt*2.)*499.));\nt=t.x<h.x?t:h;\nh=vec2(length(p.xz+texNoi*2.5+noi(p*.2+vec3(0.,tt*2.,0.)))-.5,5.);\ng2+=.1/(.1+h.x*h.x*(.5-sin(p.y*.5+tt*2.)*.4));\nt=t.x<h.x?t:h;\nt.x*=.85;\nreturn t;}\n    vec2 mp( vec3 p )\n    {\n        float texNoi=texture(iChannel1,.5*vec2(p.y,dot(p.xz,vec2(.7)))).r*.0002;\n        td=noi(p*.2+1.5)*3.-noi(p*2.-.5)*.1-noi(p*.05)*2.+\n        noi(p*.03)*5.-noi(p*.5)+texNoi;\n        float ripple=sin(length(sin(p.x*.2))-1.+tt*10.)*5.;\n        pp=p+td;\n        bb=sin(p.x*.1)*1.5-sin(p.x*30.)*.01;\n        pp.y-=bb;\n        vec2 h,t=vec2(pp.y+5.,5.);\n                \nt.x=smin(t.x,length(abs(pp.xz+noi(p*1.5)*.2)-vec2(6.,6.))\n-(1.1-sin(p.y*.2)+sin(p.y*30.)*.052),3.);\nt.x=smin(t.x,length(abs(pp.xy+noi(p*1.5)*.2-vec2(0.,3.))-vec2(12.,0.))\n-(1.1-sin(p.z*.2)),13.);\n        t.x*=.55;\n        h=column(p+vec3(-3.-1.,5.,-4));\n        t=t.x<h.x?t:h;\n        return t;\n    }\n    \nvec2 tr(vec3 ro,vec3 rd)\n{\nvec2 h,t=vec2(.1);\nfor(int i=0;i<128;i++){\nh=mp(ro+rd*t.x);\nif(h.x<.0001||t.x>90.)break;\nt.x+=h.x;\nt.y=h.y;\n}\nif(t.x>90.)t.y=-.5;\nreturn t;\n}\n\n#define a(d)clamp(mp(po*no*d).x/d,0.,1.)\n#define s(d)smoothstep(0.,1.,mp(po+ld*d).x/d)\nvoid mainImage(out vec4 fragColor,in vec2 fragCoord)\n{\n    vec2 uv=vec2(fragCoord.x/iResolution.x,fragCoord.y/iResolution.y);\n    uv-=.5;\n    uv/=vec2(iResolution.y/iResolution.x,1);\n    tt=mod(iTime*.2,62.83);\n    vec3 ro=vec3(cos(c.x*tt*c.w)*c.z, c.y, sin(c.x*tt*c.w)*c.z);\n    vec3 cw=normalize(vec3(0)-ro);\n    vec3 cu=normalize(cross(cw,vec3(0,1,0)));\n    vec3 cv=normalize(cross(cu,cw));\n    vec3 rd=mat3(cu,cv,cw)*normalize(vec3(uv,.5)),co,fo;\n    co=fo=vec3(.091)-length(uv)*.09;\n    ld=vec3(.2,.3,-.4);\n    z=tr(ro,rd);\n    t=z.x;\n    if(z.y>-.10){//WE HIT SOMETHING \n        po=ro+rd*t;\n        no=normalize(e.xyy*mp(po+e.xyy).x+\n        e.yyx*mp(po+e.yyx).x+\n        e.yxy*mp(po+e.yxy).x+\n        e.xxx*mp(po+e.xxx).x);\n        al=mix(vec3(1.),vec3(.1,.3,.4),.5+.5*sin(td*10.)-bb);\n        if(z.y>5.)al=vec3(1.);\n        float dif=max(2.,dot(no,ld));\n        float fr=pow(1.+dot(no,rd),4.);\n        float sp=pow(max(dot(reflect(-ld,no),-rd),0.),20.);\n        co=mix(sp+al*(a(.1)*a(.3)+.2)*(dif*s(2.)),fo,min(fr,.4));\n        co=mix(fo,co,exp(-.0001*t*t*t));\n    }\n    fragColor=vec4(pow(co+g*.1+g2*.2*vec3(0.,.2,.3),vec3(.45)),1);\n    }","name":"Image","description":"","type":"image"}]}