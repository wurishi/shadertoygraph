{"ver":"0.1","info":{"id":"7dlSWn","date":"1618500111","viewed":102,"name":"Apollonian 3D","username":"kithy","description":"apollonian,fractal,raymarching","likes":6,"published":1,"flags":0,"usePreview":0,"tags":["raymarching","fractal","apollonian"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define EPS 0.001\n#define MAX_STEPS 32\n#define ITR 8\n\nmat2 rot(float a){\n\tfloat s=sin(a);\n\tfloat c=cos(a);\n\treturn mat2(c,s,-s,c);\n}\n\n\n\nfloat scale;\n\nfloat map(vec3 p){\n\tp+=vec3(1.0,1.0,iTime*0.2);\n\tp.xy*=rot(iTime*0.05);\n\tp.yz*=rot(iTime*0.05);\n\tfloat s=3.0;\n\tfor(int i=0;i<ITR;i++){\n\t\tp=mod(p-1.0,2.0)-1.0;\n\t\tfloat r=1.53/dot(p,p);\n\t\tp*=r;\n\t\ts*=r;\n\t}\n\tscale=s;\n\treturn dot(abs(p),normalize(vec3(0.0,1.0,1.0)))/s;\n}\n\nvec3 GetNormal(vec3 p){\n\tfloat d=map(p);\n\tvec2 e=vec2(EPS,0.0);\n\n\tvec3 n=d-vec3(\n\t\tmap(p-e.xyy),\n\t\tmap(p-e.yxy),\n\t\tmap(p-e.yyx));\n\treturn normalize(n);\n}\n\n\n\nvoid mainImage(out vec4 fragColor,in vec2 fragCoord){\n\tvec2 uv=(2.0*fragCoord.xy-iResolution.xy)/iResolution.y;\n\n\tvec3 col=vec3(0.0);\n\n\tvec3 rd=normalize(vec3(uv,1.0));\n\tvec3 p=vec3(0.0,0.0,iTime*0.05);\n\t\n\tfloat d;\n\t\n\t//vec3 normal;\n\n\tfloat emission=0.0;\n\n\tfor(int i=0;i<MAX_STEPS;i++){\n\t\td=map(p);\n\t\tp+=rd*d;\n\t\t//normal=GetNormal(p);\n\t\temission+=exp(d*-0.4);\n\t\tif(d<EPS)break;\n\t}\n\n\tvec4 color=0.02*emission*vec4(sin(iTime),1.0,sin(iTime),1.0);\n\tfragColor=color;\n\t//fragColor=vec4(normal*0.5+0.5,1.0);\n}\n","name":"Image","description":"","type":"image"}]}