{"ver":"0.1","info":{"id":"ltlSW2","date":"1439934983","viewed":406,"name":"Karplus-Strong Physical Model","username":"metabog","description":"Karplus strong in a god damned fragment shader, my life is complete. What else do you need?!\n\nRhythm by @krighxz ","likes":7,"published":1,"flags":8,"usePreview":0,"tags":["audio","synth","karplusstrong","physicalmodeling"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[],"code":"\nfloat message(vec2 uv) { // to alter in the icon\n    uv-=vec2(1.,10.); if ((uv.x<0.)||(uv.x>=32.)||(uv.y<0.)||(uv.y>=3.)) return -1.; \n    int i=1, bit=int(pow(2.,floor(32.-uv.x)));\n    if (int(uv.y)==2) i=  928473456/bit; // 00110111 01010111 01100001 01110000\n    if (int(uv.y)==1) i=  626348112/bit; // 00100101 01010101 01010000 01010000\n    if (int(uv.y)==0) i= 1735745872/bit; // 01100111 01110101 01100001 01010000\n \treturn float(i-2*(i/2));\n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n    //  if (iResolution.y<200.) to display only in the icon \n    if (iResolution.y<2000.) {float c=message(fragCoord.xy/8.);if(c>=0.){fragColor=vec4(c);return;}}\n\n    \n    vec2 uv = fragCoord.xy / iResolution.xy;\n\tfragColor = vec4(uv,0.5+0.5*sin(iTime),1.0);\n\n}","name":"","description":"","type":"image"},{"inputs":[],"outputs":[],"code":"//Random hack with @krighxz\n\n//Shitty karplus\n\nfloat rand(vec2 co){\n    return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\n//What a weird way to do it\nfloat evaluate(float t, float k)\n{\n    \n    float noiseBurst = rand(vec2(t*k,t*k)) * exp(-64.0* (mod(t*k,50.0)));\n\treturn noiseBurst;\n}\n\nvec2 mainSound( in int samp,float time)\n{\n    //u mad bro\n    float nb = 0.0;\n    for(int k=0;k<60;k++)\t{\n   \t\t for(int i=1; i <90; i++)\t{\n             float freq = float(k+1)*50.0;\n             nb+= evaluate(time-float(i)/freq,float(k+1))/(float(i)/6.0);\n       \t }\n   \t}\n    \n    return vec2(nb);\n}","name":"","description":"","type":"sound"}]}