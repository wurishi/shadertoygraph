{"ver":"0.1","renderpass":[{"outputs":[{"channel":0,"id":"4dfGRr"}],"inputs":[{"channel":0,"type":"texture","id":"4sf3Rn","filepath":"/media/a/0a40562379b63dfb89227e6d172f39fdce9022cba76623f1054a2c83d6c0ba5d.png","sampler":{"filter":"linear","wrap":"repeat","vflip":"false","srgb":"false","internal":"byte"}}],"code":"\n// Use mouse to control the camera & time.\n\n\nfloat time = 0.0;\n\t \nvec3 rotate(vec3 r, float v){ return vec3(r.x*cos(v)+r.z*sin(v),r.y,r.z*cos(v)-r.x*sin(v));}\n\nfloat noise( in vec3 x )\n{\n\tfloat  z = x.z*64.0;\n\tvec2 offz = vec2(0.317,0.123);\n\tvec2 uv1 = x.xy + offz*floor(z); \n\tvec2 uv2 = uv1  + offz;\n\treturn mix(textureLod( iChannel0, uv1 ,0.0).x,textureLod( iChannel0, uv2 ,0.0).x,fract(z))-0.5;\n}\n\nfloat noises( in vec3 p){\n\tfloat a = 0.0;\n\tfor(float i=1.0;i<6.0;i++){\n\t\ta += noise(p)/i;\n\t\tp = p*2.0 + vec3(0.0,a*0.001/i,a*0.0001/i);\n\t}\n\treturn a;\n}\n\nfloat base( in vec3 p){\n\treturn noise(p*0.00002)*1200.0;\n}\n\nfloat ground( in vec3 p){\n\treturn base(p)+noises(p.zxy*0.00005+10.0)*40.0*(0.0-p.y*0.01)+p.y;\n}\n\nfloat clouds( in vec3 p){\n\tfloat b = base(p);\n\tp.y += b*0.5/abs(p.y) + 100.0;\n\treturn noises(vec3(p.x*0.3+((time+iMouse.y)*30.0),p.y,p.z)*0.00002)-max(p.y,0.0)*0.00009;\n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\t\n    time        = iTime*5.0+floor(iTime*0.1)*150.0;\n    vec2 uv     = fragCoord.xy/(iResolution.xx*0.5)-vec2(1.0,iResolution.y/iResolution.x);\n    vec3 campos   = vec3(30.0,500.0,time*8.0);\n\t\t campos.y = 500.0-base(campos);\n    vec3 ray   = rotate(normalize(vec3(uv.x,uv.y-sin(time*0.05)*0.2-0.1,1.0).xyz),time*0.01+iMouse.x*0.009);\n    vec3 pos    = campos+ray;\n    vec3 sun    = vec3(0.0,0.6,-0.4);    \t\n\t\n    // raymarch\n    float test  = 0.0;\n    float fog   = 0.0;\n\tfloat dist  = 0.0;\n\n\tvec3  p1 = pos;\t\n\tfor(float i=1.0;i<50.0;i++){\n        test  = ground(p1); \n\t\tfog  += max(test*clouds(p1),fog*0.02);\n\t\tp1   += ray*min(test,i*i*0.5);\n\t\tdist += test;\n\t\tif(abs(test)<10.0||dist>40000.0) break;\n\t}\n\n\tfloat l     = sin(dot(ray,sun));\n\tvec3  light = vec3(l,0.0,-l)+ray.y*0.2;\n    \n\tfloat amb = smoothstep(-100.0,100.0,ground(p1+vec3(0.0,30.0,0.0)+sun*10.0))-smoothstep(1000.0,-0.0,p1.y)*0.7;\n\tvec3  ground = vec3(0.30,0.30,0.25)+sin(p1*0.001)*0.01+noise(vec3(p1*0.002))*0.1+amb*0.7+light*0.01;\n\t\t\n\tfloat f = smoothstep(0.0,800.0,fog);\n\tvec3  cloud = vec3(0.70,0.72,0.70)+light*0.05+sin(fog*0.0002)*0.2+noise(p1)*0.05;\n\n\tfloat h = smoothstep(10000.,40000.0,dist);\n\tvec3  sky = cloud+ray.y*0.1-0.02;\t\n\t\n\tfragColor = vec4(sqrt(smoothstep(0.2,1.0,mix(mix(ground,sky,h),cloud,f)-dot(uv,uv)*0.1)),1.0);\n\t\n\n}","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"Msf3zX","date":"1376174419","viewed":9788,"name":"Foggy Mountains 2","username":"ztri","description":"Moutains with timelapse style clouds and fog. Use mouse to control the clouds & camera.","likes":135,"published":1,"flags":0,"usePreview":0,"tags":["raycasting","3dnoise"],"hasliked":0,"parentid":"","parentname":""}}