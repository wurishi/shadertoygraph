{"ver":"0.1","info":{"id":"Ml2fRt","date":"1516900976","viewed":95,"name":"sdf orchid 2","username":"edapx","description":"sdf, 2d, orchids, flowers","likes":1,"published":1,"flags":0,"usePreview":0,"tags":["2d","sdf","flowers","orchids"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define TWO_PI 6.28318530718\n\n// bool ops\nfloat merge(float d1, float d2){\n\treturn min(d1, d2);\n}\n\nfloat smoothMerge(float d1, float d2, float k){\n    float h = clamp(0.5 + 0.5*(d2 - d1)/k, 0.0, 1.0);\n    return mix(d2, d1, h) - k * h * (1.0-h);\n}\n\nfloat substract(float d1, float d2){\n\treturn max(-d1, d2);\n}\n\nfloat ellipseDist(vec2 p, float radius, vec2 dim){\n  vec2 pos = p;\n  pos.x = p.x / dim.x;\n  pos.y = p.y / dim.y;\n  return length(pos) - radius;\n}\n\n\nfloat fill(float sdfVal, float w){\n  return step(w, sdfVal);\n}\n\nmat2 rotate2d(float _angle){\n    return mat2(cos(_angle),-sin(_angle),\n                sin(_angle),cos(_angle));\n}\n\nfloat orcSepals(vec2 toCenter, float resize, float defX, float defY, \n    float grow, float nPetals, float smoothness){\n    \n    float angle = atan(toCenter.y,toCenter.x) + 0.5;\n    float deformOnY = toCenter.y * defY;\n    float deformOnX = abs(toCenter.x) * defX;\n    float radius = length(toCenter)*resize * (grow+deformOnY+deformOnX);\n\n    float f = cos(angle*nPetals);\n    return smoothstep(f, f+smoothness,radius);\n}\n\n\nfloat lip(vec2 pos, vec2 oval, vec2 ovalSub,float radius, float offset){\n  float A = ellipseDist(pos, radius, oval);\n  vec2 posB = pos;\n  posB.y += offset;\n  float B = ellipseDist(posB, radius, ovalSub);\n  float p = smoothMerge(B, A, 0.4);\n  return p;\n}\n\nfloat orcColumn(vec2 pos, vec2 oval, vec2 ovalSub,float radius, float offset){\n  float A = ellipseDist(pos, radius, ovalSub);\n  vec2 posB = pos;\n  posB.y -= offset;\n  float B = ellipseDist(posB, radius, oval);\n  float p = substract(B,A);\n  posB.y += 0.035;\n  float cone = ellipseDist(posB, radius, vec2(0.08, 0.55));\n  p = smoothMerge(cone,p, 0.3);\n  return p;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ){\n  vec2 st =  fragCoord.xy / iResolution.xy;\n  vec2 uv = fragCoord.xy / iResolution.xy;\n  st.x *= iResolution.x /iResolution.y;\n  // general parameters\n  float smoothness = 0.02;\n  float addSmoothnessToSetals = 2.9;\n  st *= 1.;\n  st = fract(st);\n  st+=vec2(-0.5, -0.5);\n  //column parameters\n  float colResize = 0.55;\n  vec2 posCol = st;\n  posCol.y += 0.07;\n  float colYoffset = -0.04;\n  float powerCol = 2.;\n  vec2 colRatio = vec2(0.4*colResize, 0.4*colResize);\n  vec2 colSubRatio = vec2(0.9*colResize, 0.9*colResize);\n  float colRadius = 0.52*colResize;\n  // sepals parameters\n  float deformX = 0.;\n  float deformY = 0.;\n  float resizePetals = 11.9;\n  float powerSepals = 2.0;\n  float nPetals = 3.;\n  //float growSepals = pow(length(st), 2.0);\n  // try out different functions for different shapes\n  //float growSepals = exp(length(st)) * 0.15;\n  float growSepals = exp2(length(st)) * 0.19;\n  //float growSepals = sqrt(length(st)) * 0.35;\n  //float growSepals = sin(length(st)) * 0.58;\n  // lateral petals parameter\n  float nPetalsLat = 2.;\n  float deformXLat = 0.0;\n  float deformYLat = -0.0;\n  float resizePetalsLat = 21.9;\n  float powerLat = 2.3;\n  vec2 latPos = st*rotate2d(TWO_PI/2.4);\n  float growLaterals = pow(length(st), powerLat);\n  // lip parameter\n  vec2 posLip = st;\n  posLip.y += 0.18;\n  float lipResize = 0.6;\n  float lipYoffset = 0.05;\n  vec2 lipRatio = vec2(0.19*lipResize, 0.35*lipResize);\n  vec2 smallLipRatio = vec2(0.32*lipResize, 0.15*lipResize);\n  float lipRadius = 1.*lipResize;\n\n  float column = orcColumn(posCol*rotate2d(TWO_PI/2.),\n                        colRatio,\n                        colSubRatio,\n                        colRadius, colYoffset);\n  float sepals = orcSepals(st,\n                        resizePetals,\n                        deformX,\n                        deformY, growSepals, nPetals,\n                        smoothness+addSmoothnessToSetals);\n  float latPetals = orcSepals(latPos,\n                        resizePetalsLat,\n                        deformXLat,\n                        deformYLat, growLaterals, nPetalsLat,\n                        smoothness+addSmoothnessToSetals);\n  float lip = lip(posLip,\n                      lipRatio,\n                      smallLipRatio,\n                      lipRadius, lipYoffset);\n\n  float orchids = merge(latPetals, sepals);\n\n  orchids = merge(orchids, lip);\n  orchids = substract(column, orchids);\n  // add smoothness\n  orchids = smoothstep(orchids,orchids+smoothness,0.09);\n  fragColor = vec4(vec3(orchids), 1.);\n}\n","name":"Image","description":"","type":"image"}]}