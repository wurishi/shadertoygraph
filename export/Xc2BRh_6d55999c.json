{"ver":"0.1","info":{"id":"Xc2BRh","date":"1724737747","viewed":32,"name":"evankh_Curtains","username":"evankh","description":"Creates a set of red velvet curtains for a stage.","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["phong"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// Constants\nconst float n_bumps = 10.0;\nfloat bump_height = 0.075;\nfloat noise_size = 0.25;\nfloat tau = 6.28318;\nvec3 light_pos = vec3(n_bumps / 2., -2.0, 1.5);\nvec3 view_pos = vec3(n_bumps / 2., -3.0, 0.5);\nvec3 curtain_color = vec3(0.5, 0.1, 0.08);\nvec3 shine_color = vec3(1.0, 0.6, 0.2);\n\n// PRNG\nuint state[2];\nuint rot(uint x, int k) {\n    return (x << k) | (x >> (32 - k));\n}\nfloat noise() {\n    uint s0 = state[0];\n    uint s1 = state[1];\n    uint result = rot(s0 * 0x9e3779bbu, 5) * 5u;\n    s1 ^= s0;\n    state[0] = rot(s0, 26) ^ s1 ^ (s1 << 9);\n    state[1] = rot(s1, 13);\n    return float(result) / float(0xffffffffu);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord/iResolution.xy;\n    state[0] = floatBitsToUint(uv.x);\n    state[1] = floatBitsToUint(uv.y);\n    noise();\n    vec3 random_normal = vec3(noise(), noise(), noise()) * 2. - 1.;\n    \n    vec3 pos = vec3(uv.x * n_bumps,\n                    cos(uv.x * n_bumps * tau) * bump_height,\n                    uv.y);\n    //vec3 norm = vec3(sin(uv.x * n_bumps * tau),\n    //                 -cos(uv.x * n_bumps * tau),\n    //                 0.) + noise_size * random_normal;\n    vec3 norm = normalize(vec3(-bump_height*n_bumps*tau*sin(uv.x*n_bumps*tau),\n                               -n_bumps, 0.));\n    norm = normalize(norm + noise_size * random_normal);\n    //lightPos.y = -iTime;\n    \n    vec3 light_dir = normalize(light_pos - pos);\n    float diff = max(-0.0, dot(light_dir, norm));\n    float spec = pow(max(0., dot(reflect(-light_dir, norm), normalize(view_pos - pos))), 16.);\n    vec3 col = (diff+0.25) * curtain_color + (0.5*spec)*shine_color;\n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}