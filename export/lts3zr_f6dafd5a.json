{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[],"code":"//Fur Trees by eiffie\n//attempting some distance estimated fur and shading with one extra DE calc\n#define AUTO_OVERSTEP\n\n#define time iTime\n#define size iResolution\n\n#define TAO 6.283\nvec2 rotate(vec2 v, float angle) {return cos(angle)*v+sin(angle)*vec2(v.y,-v.x);}\nvec2 kaleido(vec2 v, float power){return rotate(v,floor(.5+atan(v.x,-v.y)*power/TAO)*TAO/power);}\n\nvec2 kaleido6(vec2 v){return rotate(v,floor(0.5+atan(v.x,-v.y)*0.95493)*1.0472);}\nvec2 kaleido12(vec2 v){return rotate(v,floor(0.5+atan(v.x,-v.y)*1.90986)*0.5236);}\n\nvec3 mcol;//material color\nmat2 r45=mat2(0.7071,0.7071,-0.7071,0.7071);\nmat2 r30=mat2(0.866,0.5,-0.5,0.866);\nmat2 rtrn=mat2(0.9689,-0.2474,0.2474,0.9689);\n\nfloat DE(in vec3 z0){\n\t//mcol=vec3(0.5);\n\t//return length(z0)-1.0;\n\tif(z0.y>0.1)return z0.y+0.2;\n\tz0.xz=mod(z0.xz,2.0)-vec2(1.0);//+0.125*cos(floor(z0.zx*0.5)*2.0);\n\tfloat cyl=length(z0.xz);\n\tfloat d=100.0,dt=cyl+z0.y*0.025;\n\tfor(int i=0;i<2;i++){\n\t\tvec3 z=z0;\n\t\tz.y-=float(i)*0.125;\n\t\tfloat c=floor(z.y*4.0);\n\t\t//z.yz=rotate(z.yz,-z.z*0.79*(1.0+c*0.1));\n\t\tfloat bm=-z.y-2.0+cyl*0.01;\n\t\tz.y=mod(z.y,0.25)-0.05;\n\t\tif(i==1)z.xz=z.xz*rtrn;\n\t\tz.xz=kaleido(z.xz,2.0-c);\n\t\tz.yz=rtrn*z.yz;\n\t\tbm=max(bm,-z.z+c*0.086);//0.065);\n\t\tdt=min(dt,max(max(abs(z.x),abs(z.y)),bm))-0.001-z.z*0.003;\n\t\tfloat c2=floor(z.z*16.0);\n\t\tz.z=mod(z.z,0.0625)-0.049;\n\t\tz.xy=rotate(z.xy,c2*0.25);\n\t\tz.xy=kaleido12(z.xy);\n\t\tz.yz=z.yz*r30;\n\t\td=min(d,max(max(max(abs(z.x),abs(z.z)),-z.y-0.05+c*0.005),bm));\n\t}\n\tif(dt<d){\n\t\td=dt;\n\t\tmcol=vec3(0.5,0.1,0.0);\n\t}else{\n\t\tmcol=vec3(0.5,0.6,0.2);\n\t\tmcol*=1.0+(-z0.y*0.75)*(z0.x+z0.z)/cyl;\n\t}\n    mcol*=cyl + 0.5 + z0.y*0.5;//kind of what iq suggested\n\treturn max(0.0,max(d,max(z0.y,-z0.y-2.0)));\n}\n\nfloat rndStart(vec2 co){return 0.1+0.9*fract(sin(dot(co,vec2(123.42,117.853)))*412.453);}\n\nmat3 lookat(vec3 fw,vec3 up){\n\tfw=normalize(fw);vec3 rt=normalize(cross(fw,up));return mat3(rt,cross(rt,fw),fw);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ){\n\tfloat zoom=2.0,px=2.0/(size.y*zoom);//find the pixel size\n\tfloat tim=time*0.3;\n\t\n\t//position camera\n\tvec3 ro=vec3(0.5*sin(tim*0.43),-1.0,tim);\n\tvec3 rd=normalize(vec3((2.0*fragCoord.xy-size.xy)/size.y,zoom));\n\trd=lookat(vec3(-1.15+0.75*sin(tim),-1.0,tim+2.0)-ro,vec3(0.0,1.0,0.0))*rd;\n\t//ro=eye;rd=normalize(dir);\n\tvec3 ld=normalize(vec3(0.4,0.75,0.4));//direction to light\n\tvec3 bcol=clamp(vec3(1.0-rd.y,1.0-rd.y-0.1*exp(-abs(rd.y*15.0)),1.0-0.5*exp(-abs(rd.y*5.0))),0.0,1.0);//backcolor\n\t//march\n\t\n\tfloat tG=abs((-2.0-ro.y)/rd.y),d,pd=10.0,os=0.0,step=0.0;\n\tvec2 g=ro.xz+rd.xz*tG;\n\tfloat t=DE(ro)*rndStart(fragCoord.xy);\n\tfloat MIN_DIST=px*0.1;\n\tvec4 col=vec4(0.0);//color accumulator\n\tfor(int i=0;i<78;i++){\n\t\td=DE(ro+rd*t);\n\t\tfloat d1=max(d,px*t*0.5);\n#ifdef AUTO_OVERSTEP\n\t\tif(d1>os){\t\t//we have NOT stepped over anything\n\t\t\tif(t>tG)break;\n\t\t\tos=0.28*d1*d1/pd;//calc overstep based on ratio of this step to last\n\t\t\tstep=d1+os;\t//add in the overstep\n\t\t\tpd=d1;\t//save this step length for next calc\n\t\t}else{\n\t\t\tstep=-os;d1=1.0;pd=10.0;os=0.0;//remove ALL of overstep\n\t\t}\n#else\n\t\t\tstep=d1;\n#endif\n\t\tif(d1<px*t){\n\t\t\tvec3 scol=mix(mcol,bcol,min(t*0.05,1.0));\n\t\t\tfloat d2=DE(ro+rd*t+ld*px*t);\n\t\t\tfloat shad=0.5*abs(d2/d);\n\t\t\tscol=scol*shad+vec3(0.2,0.05,-0.25)*(shad-0.5);\n\t\t\tfloat alpha=(1.0-col.w)*clamp(1.0-d1/(px*t),0.0,1.0);\n\t\t\tcol+=vec4(clamp(scol,0.0,1.0),1.0)*alpha;\n\t\t\tif(col.w>0.9)break;\n\t\t}\n\t\tt+=step;\n\t}\n\n\t//color the ground \n\tif(rd.y<0.0){\n\t\tro+=rd*tG;\n\t\tfloat s=1.0,dst=0.1;\n\t\tt=DE(ro)*rndStart(fragCoord.xy);\n\t\tfor(int i=0;i<4;i++){\n\t\t\tfloat d=max(0.0,DE(ro+ld*t)*1.5)+0.05;\n\t\t\ts=min(s,3.0*d/t);\n\t\t\tt+=dst;dst*=2.0;\n\t\t}\n\t\tbcol*=0.8+0.2*s;\n\t}\n\tcol.rgb+=bcol*(1.0-clamp(col.w,0.0,1.0));\n\n\tfragColor=vec4(col.rgb,1.0);\n} ","name":"Image","description":"","type":"image"},{"outputs":[],"inputs":[],"code":"//fractal music?? by eiffie\n#define bps 8.0\n\n// note number to frequency  from https://www.shadertoy.com/view/ldfSW2\nfloat ntof(float n){return 440.0 * pow(2.0, (n - 67.0) / 12.0);}\n\nfloat nofs(float n){//the song's \"random\" ring\n    n=mod(n,8.0);\n    if(n<1.0)return 0.0;\n    if(n<2.0)return 2.0;\n    if(n<3.0)return -1.0;\n    if(n<4.0)return 5.0;\n    if(n<5.0)return 7.0;\n    if(n<6.0)return -3.0;\n    if(n<7.0)return 4.0;\n    return -1.0;\n}\nfloat scale(float note){//throws out dissonant tones\n    float n2=mod(note,12.0);\n    if((n2==1.0)||(n2==3.0)||(n2==6.0)||(n2==8.0)||(n2==10.0))note=-100.0;\n    return note;\n}\nfloat saw(float t){return abs(fract(t)-0.5)-0.25;}\nfloat rand(float t){return fract(sin(t*341.545234)*1531.2341);}\n\n#define TAO 6.2831\nvec2 mainSound( in int samp,float time)\n{\n    float tim=time*bps;\n    float b=floor(tim);\n    float t=fract(tim);\n    float t1=mod(tim,2.0)*0.5;\n    float t2=mod(tim,4.0)*0.25;\n    float t3=mod(tim,8.0)*0.125;\n    float t4=mod(tim,16.0)*0.0625;\n    float n0=0.0,n1=0.0,n2=0.0,n3=0.0,n4=0.0;\n    \n  \tn4=nofs(b*0.0625);\n    n3=n4+nofs(b*0.125);\n    n2=n3+nofs(b*0.25);\n    n1=n2+nofs(b*0.5);\n    n0+=n1+nofs(b);//fractal buildup of notes like a landscape\n    \n    if(mod(b,8.0)<1.0){b=rand(time)-0.5;b*=t*0.2;}\n    else b=0.0;\n    \n    float f0=ntof(scale(n0+72.0))*time;\n    float f1=ntof(scale(n1+60.0))*time;\n    float f1h=ntof(scale(n1+65.0))*time*1.01;\n    float f2=ntof(scale(n2+48.0))*time;\n    float f2h=ntof(scale(n2+55.0))*time*0.99;\n    return vec2( b+saw(f0)*exp(-2.0*t)+(saw(f1)+saw(f1h))*exp(-2.0*t1)+(saw(f2)+saw(f2h))*exp(-2.0*t2) );\n}","name":"Sound","description":"","type":"sound"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":true,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"lts3zr","date":"1418232922","viewed":1155,"name":"Fur Trees","username":"eiffie","description":"I started a stand of fake trees for people who like to cut their own without dealing with the messy sap. Unless that's your thing... then the sap is extra.","likes":15,"published":1,"flags":0,"usePreview":0,"tags":["fur","de","defur"],"hasliked":0,"parentid":"","parentname":""}}