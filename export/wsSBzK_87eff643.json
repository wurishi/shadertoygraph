{"ver":"0.1","info":{"id":"wsSBzK","date":"1591115686","viewed":281,"name":"boule sphere","username":"louis_C","description":"doodeling ","likes":29,"published":1,"flags":40,"usePreview":0,"tags":["raymarching","sound"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\nfloat rd(float uv){return fract(sin(dot(floor(uv),94.236))*7845.166+iTime*6.);}\nfloat no(float t){return mix(rd(t),rd(t+1.),smoothstep(0.,1.,fract(t)));}\nfloat it (float uv ){float r=0.;float amp =0.5;for(int i=0; i< 3; i ++){\n  r+=no(uv/amp)*amp;amp*=0.5;}return r;}\nvec3 bl(vec2 uv){   \n    vec3 col = vec3(0.);\n    float bound = sqrt(32.);\n    float m = texture(iChannel0,uv).a;\n    float v = mix(0.0003,0.0025*(0.5+no(iTime*100.)*1.5),m);\n        for(float i = -.5*bound; i<=.5*bound; i++)\n        for(float j=-.5*bound; j<=.5*bound; j++)\n        {\n            col += texture(iChannel0,uv+vec2(i,j)*v).xyz;\n        }\n    col /= 32.;\nreturn col;\n}\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n   \n    vec2 uv = fragCoord/iResolution.xy;\n\tfloat time = iTime;\n\n    vec3 t = bl(uv);\n \n    fragColor = vec4(mix(t,vec3(mix(t.z,1.-t.z,pow(rd(time*24.),15.))),pow(rd(time*12.),5.)),1.);\n}","name":"Image","description":"","type":"image"},{"inputs":[],"outputs":[{"id":"4dXGR8","channel":0}],"code":"float r1 (vec2 uv){return fract(sin(dot(uv,vec2(12.236*cos(iTime),39.236*sin(iTime))))*4587.326);}\nfloat hs (vec2 uv){return fract(sin(dot((uv),vec2(95.236,48.241)))*7845.166+iTime*5.);}\nfloat ov(float a, float b){ return mix(2.*a*b,1.-2.*(1.-a)*(1.-b),step(0.5,a));}\nvec3 ov(vec3 a, vec3 b){ return mix(2.*a*b,1.-2.*(1.-a)*(1.-b),step(0.5,a));}\nmat2 rot( float t) { float c = cos(t);float s = sin(t);return mat2(c,-s,s,c);}\nfloat rd(vec2 uv){return fract(sin(dot(floor(uv),vec2(95.236,48.241)))*7845.166);}\nfloat rd(float uv){return fract(sin(dot(floor(uv),94.236))*7845.166);}\nfloat no(float t){return mix(rd(t),rd(t+1.),smoothstep(0.,1.,fract(t)));}\nfloat it (float uv ){float r=0.;float amp =0.5;for(int i=0; i< 5; i ++){\n  r+=no(uv/amp)*amp;amp*=0.5;}return r;}\nfloat rd2(float uv){return fract(sin(dot(floor(uv),94.236))*7845.166+iTime*6.);}\nfloat no2(float t){return mix(rd2(t),rd2(t+1.),smoothstep(0.,1.,fract(t)));}\nfloat it2 (float uv ){float r=0.;float amp =0.5;for(int i=0; i< 3; i ++){\n  r+=no2(uv/amp)*amp;amp*=0.5;}return r;}\nfloat no(vec2 uv){vec2 e=vec2(1.,0.);float a=rd(uv);\n  float b= rd(uv+e.xy);float c=rd(uv+e.yx);float d=rd(uv+e.xx);\n  vec2 h = smoothstep(0.4,0.5,fract(uv));\n  return mix(mix(a,b,h.x),mix(c,d,h.x),h.y);}\n  float no2(vec2 uv){vec2 e=vec2(1.,0.);float a=rd(uv);\n  float b= rd(uv+e.xy);float c=rd(uv+e.yx);float d=rd(uv+e.xx);\n  vec2 h = smoothstep(0.,1.,fract(uv));\n  return mix(mix(a,b,h.x),mix(c,d,h.x),h.y);}\nfloat it (vec2 uv ){float r=0.;float amp =0.5;for(int i=0; i< 5; i ++){\n  r+=no2(uv/amp)*amp;amp*=0.5;}return r;}\n  float it2 (vec2 uv ){float r=0.;float amp =0.5;for(int i=0; i< 5; i ++){\n  r+=no2(uv/amp)*amp;amp*=0.5;}return smoothstep(0.,0.6,r);}\n  float ce = 0.;\n  float sc = 0.;\nfloat map (vec3 p ) {\n   \n  float c = length(p)-10.;\n  float bf = no(vec2(atan(p.x,p.z)*3.,0.))*0.8+no(vec2(atan(p.x,p.z)*6.,0.))*0.2;\n  float bt = pow(smoothstep(25.,0.,length(p.xz)),3.)*8.*mix(0.5,1.,bf);\n  float rt = smoothstep(0.9,1.,no2(p.xz))*0.3;\n  float s = dot(p,vec3(0.,1.,0.))+5.-bt-rt;\n  float s2 = length(p+vec3(0.,2.5,0.))-10.+bf*0.5;\n  float s3 = max(-s2,s);\n  float f1 = min(c,s3);\n  ce = c;\n  sc =c;\n  //if(s3>c){ce=1.;}\n  return f1;}\n  vec3 nor (vec3 p ){vec2 e =vec2(0.01,0.);return normalize(map(p)-vec3(map(p-e.xyy),map(p-e.yxy),map(p-e.yyx)));}\n  float sha (vec3 pos, vec3 at, float k) {\n    vec3 dir = normalize(at - pos);\n    float maxt = length(at - pos);\n    float f = 1.;\n    float t = .01*10.;\n    for (float i = 0.; i <= 1.; i += 1./30.) {\n        float dist = map(pos + dir * t);\n        if (dist < .01) return 0.;\n        f = min(f, k * dist / t);\n        t += dist;\n        if (t >= maxt) break;\n    }\n    return f;\n}\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    float time = iTime;\n    vec2 uv = fragCoord/iResolution.xy;\n    uv -=0.5;\n    uv *=2.;\n    uv.x*=iResolution.x/iResolution.y;\n     vec3 e = vec3(0.,5.5,-35.);\n  vec3 r = normalize(vec3(uv,it(time*0.8)*1.5+1.));\n  \n  r.zy *=  rot(-0.4);\n  float t= it(time);\n  e.xz *=rot(t);\n  r.xz *= rot(t);\n  \n  vec3 p = e;\n  float dd = 0.;\n  vec3 col = vec3(0.);\n  vec3 n = vec3(0.);\n  float tr = 1.;\n  float tt = 1.;\n  float tt2 = 1.;\n  vec3 n3 = vec3(0.);\n  float fres= 0.;\n  for(int i = 0;i<64;i++){\n  float d = map(p);\n      \n  if(dd>64.){break;dd=64.;}\n  if(d<0.01){\n     \n     vec2 en = vec2(0.01,0.);\n  float rep = 0.5;\n    float fb = smoothstep(0.1,0.,ce);\n     vec2 t1 = vec2( it2(p.xy*rep+en.xy)-it2(p.xy*rep-en.xy),it2(p.xy*rep+en.yx)-it2(p.xy*rep-en.yx));\n     vec2 t2 = vec2( it2(p.zy*rep+en.xy)-it2(p.zy*rep-en.xy),it2(p.zy*rep+en.yx)-it2(p.zy*rep-en.yx));\n    vec2 t3 = mix(t1,t2,smoothstep(10.,0.,length(p.z)));\n    vec3 n2 = vec3(t3.x,t3.y,t3.x); \n    vec2 tex = vec2( it(p.xz*rep+en.xy)-it(p.xz*rep-en.xy),it(p.xz*rep+en.yx)-it(p.xz*rep-en.yx));\n    n3 = normalize(vec3(tex.x,0.5,tex.y));\n    n = normalize(nor(p)-mix(-n3,n2*2.,fb));\n     tt2 = 1.-fb;\n    tr *=fb;\n    if(tr<0.01){break;}\n      \n    fres = smoothstep (0.5,-0.8,dot(n,-r));\n    tt = 1.-smoothstep(0.1,0.,ce)*0.5;\n    r = reflect(r,n);\n    d =0.1;\n    \n    \n   }\n  p+=r*d;\n  dd +=d;\n  }\n  float di = dot(r,normalize(vec3(0.,0.1,0.5)));\n  vec2 tn = vec2(4.,8.);\n \n  float nn =mix(it(r.zy*tn+vec2(time*1.,0.)),it(r.xy*tn+vec2(time*1.,0.)),pow(abs(r.z),3.));\n  float ls = ov(smoothstep(-0.3,0.1,r.y),mix(0.,1.,nn));\n  vec3 sky = mix(vec3(0.6),mix(vec3(0.7),vec3(0.1,0.08,0.05),smoothstep(-0.8,0.6,r.y)),ls);\n  //float bvi = it(time*0.3);\n  sky += ov(mix(0.4,0.6,nn),pow(it(time*4.),0.5)*smoothstep(0.4,1.,dot(vec3(0.,0.,1.),r)));\n  vec3 sky2 = mix(3.*abs(1.-2.*fract(sky*0.5+0.3+vec3(0.,-1./3.,1./3.)))-1.,sky,0.95)*max(vec3(0.5),sky);\n  float rep = 0.3;\n  float tex = it(p.xz*rep+vec2(45.236));\n  float spp = dot(n+n3,-r);\n  float dsp = dot(n,normalize(r+vec3(0.,-0.5,0.)));\n  float spec = smoothstep(0.999,1.,dsp)*0.3+smoothstep(0.9,1.8,dsp);\n   //float ao = smoothstep(0.,1.,map(p+n*0.5));\n  float obc = smoothstep(1.,0.6,spp);\n  vec3 sol = vec3(smoothstep(0.8,1.,spp))*2.*tex*obc*hs(p.xz);\n  float bmc = dot(n,r);\n  vec3 hu = mix(3.*abs(1.-2.*fract(bmc*1.5+0.2+vec3(0.,-1./3.,1./3.)))-1.,vec3(0.),0.62);\n \n  col = ov(mix(sky2*max(obc,smoothstep(10.,55.,dd)),sol,smoothstep(64.,20.,dd)) ,mix(vec3(0.4),vec3(0.5),sha (p,vec3(0.,30.,50.),64.))) ;\n  //vec3 n = nor(p);\n \n  float ao2 = smoothstep(-0.6,0.,map(p+n));\n  //float li2 = smoothstep(0.,0.5,dot(n,vec3(0.,0.,1.)));\n  col *= max(hu,tt);\n  col += spec;\n  col += fres;\n  //col += li2*0.15*bvi;\n  col *=ao2;\n  vec3 ff =3.*abs(1.-2.*fract(smoothstep(64.,20.,dd)*0.5+vec3(0.,-1./3.,1./3.)))-1.;\n  col =col+ff*0.0;\n    float bff = smoothstep(1.,25.,distance(dd,30.))*pow(tt,6.);\n  vec3 colf = ov(col,mix(vec3(0.5),vec3(hs(uv),hs(uv+95.265),hs(uv+47.125)),mix(0.2,1.,bff)));\n      \tfloat f1 = r1(uv+iTime);\n    \n    float f3 =smoothstep(0.,no2(uv.x*14.)*0.2, no2(uv.x*6.)*no2(uv.x*12.));\n    float f4 =smoothstep(0.,no2(uv.x*8.)*2., no2(uv.x*7.)\n                         *no2(uv.x*15.));\n    float f5 = smoothstep(0.8,1.,no2(uv.y*10.));\n    float f2 = smoothstep(mix(f4,0.,f5),mix(f3,0.8,f5),no2(uv.y*200.+f1))*mix(f3*(smoothstep(0.,0.5,f4)),1.,f5);\n    float ff2 = (f2+2.5*smoothstep(0.7,1.,it(uv*10.+rd(time*12.)*100.)));\n    float vv2 = it2(time*4.)*-0.5;\n    float vv3 = it2(time*3.5)*0.5+0.5;\n    vec3  v1 = vec3(-0.15,it2(time*3.)*-0.2,-0.08);\n    vec3 v2 = vec3(-0.2,vv2,vv2);\n    vec3 v3 = vec3(vv3);\n    vec3 v4 = vec3(1.);\n    vec3 colff =smoothstep(mix(v1,v2,ff2),mix(v3,v4,ff2),colf);\n  fragColor = vec4(colff,bff);\n}","name":"Buffer A","description":"","type":"buffer"},{"inputs":[],"outputs":[],"code":"float hs(float uv){return fract(sin(dot((uv),94.236))*7845.166);}\nfloat rd(float uv){return fract(sin(dot(floor(uv),94.236))*7845.166);}\nfloat no(float t){return mix(rd(t),rd(t+1.),smoothstep(0.,1.,fract(t)));}\nfloat it (float uv ){float r=0.;float amp =0.5;for(int i=0; i< 3; i ++){\n  r+=no(uv/amp)*amp;amp*=0.5;}return r;}\nvec2 mainSound( in int samp, float time )\n{\n    float bm = it(time);  \n    vec2 b1 = no(time*100.)*mix(vec2(0.2,0.4),vec2(0.4,.2),distance(0.5,bm));\n    float b2 = (pow(rd(time*12.),10.)*0.1+pow(rd(time*24.),10.)*0.05)*0.5;\n    float b3 = (pow(fract(time*450.+rd(time*100.)*100.),0.01))*0.5*distance(0.5,it(time*0.8));\n    float vb4 = pow(it(time*4.),0.5);\n    vec2 b4 = sin(vb4*100.)*0.8+(it(vb4*100.)-0.5)*0.05*vec2(1.-bm*0.4,1.+bm*0.2);\n    float vb5 = it(time*10.+rd(time*12.)*100.);\n    vec2 b5 = hs(time)*mix(vec2(0.005,0.),vec2(0.,0.005),vb5);\n    return vec2(b1+b2+b3+b4+b5);\n}","name":"Sound","description":"","type":"sound"}]}