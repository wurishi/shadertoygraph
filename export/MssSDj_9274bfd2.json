{"ver":"0.1","renderpass":[{"outputs":[{"channel":0,"id":"4dfGRr"}],"inputs":[],"code":"// Created by Ashwin Sudhir - thallippoli/2014\n// ray marched field of hearts\n// License Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License.\n\nconst float max_iterations = 150.0;\nconst float stop_threshold = 0.0001;\nconst float grad_step = 0.1;\nconst float clip_far = 90.0;\n\n// thanks to IQ for smin, path, and hash ===============================================\n\n// polynomial smooth min (k = 0.1);\nfloat smin( float a, float b, float k )\n{\n    float h = clamp( 0.5+0.5*(b-a)/k, 0.0, 1.0 );\n    return mix( b, a, h ) - k*h*(1.0-h);\n}\n\nvec3 path( float t )\n{\n    vec2 p  = 100.0*sin( 0.02*t*vec2(1.0,1.2) + vec2(0.1,0.9) );\n\t     p +=  50.0*sin( 0.04*t*vec2(1.3,1.0) + vec2(1.0,4.5) );\n\t\n\treturn vec3( p.x, 10. + 4.0*sin(0.05*t), p.y );   \n}\n\nfloat hash( vec2 p )\n{\n    float h = dot(p,vec2(127.1,311.7));\n    \n    return -1.0 + 2.0*fract(sin(h)*43758.5453123);\n}\n// =====================================================================================\n\nfloat heart( vec3 pos, vec3 origin, float r ) \n{\n    mat4 m = mat4( 1.0 );\n    m[ 3 ] = vec4( 1.0, 1., 2. * hash( origin.zy ) * ( sin( 25.0 * iTime ) * 0.5 + 0.5 ) , 1.0 );\n    vec3 c = vec3( 15, 20, 20 );\n\tpos = mod( pos, c ) - 0.5 * c;\n    pos = ( m * vec4( pos, 1. ) ).xyz;\n    \n    float oval = length( pos - origin + vec3( 0, 7. * r / 3., 0 ) ) - 4. * r / 3. - pos.y / 2.8;\n    float sphereLeft = length( pos - origin + vec3( r, r/3., 0 ) ) - r;\n    float sphereRight = length( pos - origin + vec3( -r , r/3., 0 ) ) - r;\n    \n    return smin( min( sphereLeft, sphereRight ), oval, 1.8 ); \n}\n\nfloat dist_field( vec3 pos ) \n{\n\tfloat d0 = heart( pos, vec3( 0.0, 1.5, 10.0 ), 1. );\n\n    return d0;\n}\n\nvec2 rayMarch( vec3 origin, vec3 dir, float end ) \n{\n\tfloat depth = 0.0;\n\tfor ( float i = 0.0; i < max_iterations; i++ ) \n\t{\n\t\tfloat dist = dist_field( origin + dir * depth );\n\t\tif ( dist < stop_threshold )\n\t\t\treturn vec2( depth, i / max_iterations );\n\t\tdepth += dist;\n\t\tif ( depth >= end)\n\t\t\treturn vec2( end, i / max_iterations );\n\t}\n\treturn vec2( end, 1.0 );\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec3 eye = vec3( path( iTime * 10. ).xy, iTime * 25.);\n\t\t\n\tfloat ar = iResolution.x / iResolution.y;\n\t\n\tvec2 ndcPoint = vec2( ( fragCoord.x / iResolution.x - 0.5) * ar, fragCoord.y / iResolution.y - 0.5 );\n\tvec3 dir = normalize( vec3( ndcPoint, 1.) );\n    \t\n\tvec2 result = rayMarch( eye, dir, clip_far );\n    float s = 1.0 - result.x / clip_far;\n    float o = result.y;\n    fragColor = vec4( o * 2.5 + s, 0, 0, 1. );\n}","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"MssSDj","date":"1416687184","viewed":1073,"name":"heart.throb","username":"thallippoli","description":"There's enough love in this world for everyone.","likes":5,"published":1,"flags":0,"usePreview":0,"tags":["raymarching","distancefield","heart"],"hasliked":0,"parentid":"","parentname":""}}