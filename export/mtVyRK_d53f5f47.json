{"ver":"0.1","info":{"id":"mtVyRK","date":"1700465268","viewed":35,"name":"overthemoon study wangqy 1","username":"wangqiuyan","description":"https://www.youtube.com/watch?v=LLZPnh_LK8c&list=PLGmrMu-IwbguU_nY2egTFmlg691DN7uE5&index=30","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["study"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define S smoothstep\nfloat TaperBox(vec2 p, float wb,float wt,float yb,float yt,float blur)\n{\n    float c=(yt+yb)/2.;\n    float s=yt-c; \n    float d=S(s+blur,s,abs(p.y-c));\n    \n    float w=mix(wb/2.,wt/2.,(p.y-yb)/(yt-yb));\n    d*=S(w+blur,w,abs(p.x)-w);\n    return d;\n}\n\nvec4 Tree(vec2 uv,vec3 col,float blur){\n   \n    float m=TaperBox(uv,0.03,0.03,-0.05,0.25,blur);//树干 trunk\n    m+=TaperBox(uv,0.2,0.1,0.25,0.5,blur);//树冠 canopy\n    m+=TaperBox(uv,0.15,0.05,0.5,0.75,blur);//树冠 canopy\n    m+=TaperBox(uv,0.1,0.0,0.75,1.,blur);//树冠 canopy\n    \n    float shadow=TaperBox(uv-vec2(0.2,0.),0.1,0.5,0.15,0.25,blur);\n    shadow+=TaperBox(uv+vec2(0.25,0.),0.1,0.5,0.45,0.5,blur);\n    shadow+=TaperBox(uv-vec2(0.25,0.),0.1,0.5,0.7,0.75,blur);\n    col-=shadow*0.8;\n    \n    return vec4(col,m);\n}\nfloat GetHeight(float x)\n{\n    float height=sin(x*.421)*.3+sin(x*1.2)*.1;\n    return height;\n}\nvec4 Layer(vec2 uv,vec3 color,float blur,float scale)\n{\n    vec4 col =vec4(0.0);\n    uv*=scale;\n    float id=floor(uv.x);\n    float n=fract(sin(id*234.12)*5621.876)*2.-1.;\n    float height=GetHeight(uv.x);\n    float x=n*.3;\n    float y=height;\n    col+=S(blur,-blur,uv.y+height);//ground\n    uv.x=fract(uv.x)-0.5;\n     \n    y=GetHeight(id+.5-x);;\n    //col.rg=uv;\n   \n    vec4 tree=Tree((uv+vec2(x,y))*vec2(1.,1.+n*.2),color,blur);\n    col=mix(col,tree,tree.a);\n    col.rgb*=color;\n    \n    return col;\n}\nvec4 Moon(vec2 uv)\n{\n    float d=length(uv-vec2(0.42,0.36));\n    //d=S(0.12,0.116,d);\n    float r=0.12;\n    float dis=max(d-r,0.);\n    return vec4(vec3(S(r,r-0.004,d)+pow(0.3,dis)),d);\n    //return vec4(vec3(S(r,r-0.004,d)+pow(0.53,(d-r)*(d-r)*6.3)),d);\n}\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n   \n    vec2 uv = (fragCoord-.5*iResolution.xy)/iResolution.y;\n\n    vec4 moon=Moon(uv);\n    uv.x+=iTime*.2;\n    float blur=0.005;\n    vec4 col =vec4(0.0);\n    \n    vec3 basecolour=vec3(0.4,0.5,0.6);\n    col=Layer(uv+vec2(0.,0.34),basecolour*0.7,blur,2.8);\n    vec4 col2=Layer(uv+vec2(0.,0.12),basecolour*0.8,blur,4.8);\n    col=mix(col2,col,col.a>=col2.a?1.:0.);\n    col2=Layer(uv+vec2(0.,0.0),basecolour*1.0,blur,7.8);\n    col=mix(col2,col,col.a>=col2.a?1.:0.);\n    col2=Layer(uv+vec2(0.,-0.08),basecolour*1.1,blur,8.2);\n    col=mix(col2,col,col.a>=col2.a?1.:0.);\n    col2=Layer(uv+vec2(0.,-0.1),basecolour*1.2,blur,9.4);\n    col=mix(col2,col,col.a>=col2.a?1.:0.);\n \n   \n    col.rgb+=col.a>=1.?moon.rgb*.02:moon.rgb*.8;\n    \n  \n    \n    // Output to screen\n    fragColor = col;\n}","name":"Image","description":"","type":"image"}]}