{"ver":"0.1","info":{"id":"tdyfzG","date":"1607382559","viewed":88,"name":"semmais test sound","username":"semmais","description":"testing sound channel","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["sound"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4df3Rn","filepath":"/media/a/3c33c415862bb7964d256f4749408247da6596f2167dca2c86cc38f83c244aa6.mp3","previewfilepath":"/media/ap/3c33c415862bb7964d256f4749408247da6596f2167dca2c86cc38f83c244aa6.mp3","type":"music","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\n#define PI 3.14159265358979323846264338327950288\n\n\nfloat udSegment( in vec2 p, in vec2 a, in vec2 b )\n{\n    vec2 ba = b-a;\n    vec2 pa = p-a;\n    float h =clamp( dot(pa,ba)/dot(ba,ba), 0.0, 1.0 );\n    return length(pa-h*ba);\n}\n\n\nvec2 rotate(vec2 v, float a) {\n\tfloat s = sin(a);\n\tfloat c = cos(a);\n\tmat2 m = mat2(c, -s, s, c);\n\treturn m * v;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // Normalized pixel coordinates (from 0 to 1)\n    vec2 uv = fragCoord/iResolution.xy;\n\n    uv-=.5;\n    uv.x *= iResolution.x/iResolution.y;\n    \n    \n\tfloat rot=iTime*.3-length(uv)*PI*.6;\n    vec2 vDest= rotate(uv,rot);\n    \n    float angle =   (abs(atan(vDest.y,vDest.x) )) ;\n    float mapAngle=angle/ (PI);\n   \n    int tx = int((mapAngle)*512.0);\n    \n\tfloat fft  = texelFetch( iChannel0, ivec2(tx,0), 0 ).x; //texture(iChannel0, vec2(mapAngle,.0)).x\n    float fft1  = texelFetch( iChannel0, ivec2(tx,1), 0 ).x; //texture(iChannel0, vec2(mapAngle,.1)).x\n    \n    float a=fft*PI*2.;\n\n    vec2 dest=vec2(sin(a)*fft,cos(a)*fft);\n\n    float line=udSegment(uv,vec2(0.,0.),dest);\n    line=smoothstep(0.,0.002+fft,line);\n    //line=clamp(line, 0.,1.0);\n                         \n    vec3 col =vec3( 1.-line );\n    vec3 fCol=vec3(1.,0.,fft*fft1);\n    col=fCol*col;\n    \n    float beat = texelFetch( iChannel0, ivec2(256,0), 0 ).x;//texture(iChannel0, vec2(.5,.25)).x;\n    vec3 vig=vec3(smoothstep(1.,beat,length(uv * vec2(.6,1.)) ))   * fCol*beat;\n  \n    col=max(vig,col);\n\n\n    // Output to screen\n    fragColor = vec4(vec3(col),1.0);\n    \n}","name":"Image","description":"","type":"image"}]}