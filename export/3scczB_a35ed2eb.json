{"ver":"0.1","info":{"id":"3scczB","date":"1601130033","viewed":86,"name":"test 2D ray","username":"MallSerg","description":"test 2D ray","likes":3,"published":1,"flags":0,"usePreview":0,"tags":["2dray"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"float sdCircle(vec2 p, float r)\n{\n\treturn length(p) - r;\n}\n\nfloat border(vec2 p)\n{\n    vec2 R = iResolution.xy;\n\treturn min(p.x,min(p.y,min(R.x-p.x,R.y-p.y)));\n}\n\nfloat map(vec2 p)\n{\n\t// карта препятствий вектор на ближайший\n    return min(\n               min(\n                   sdCircle(( iResolution.xy/2.) + vec2(200.,150.)   - p,50.0), border(p)\n                  ),\n        \t   sdCircle(( iResolution.xy/2.) + vec2(-150.,-100.) - p,40.0)\n              );\n\t\t\t\n    \n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 sp = fragCoord;\n\tvec3 col = vec3(0.0);\n\t\n    vec2 ro = iResolution.xy/2.;\n    \n    vec2 rd = vec2(cos(iTime * .1),sin(iTime * .1));\n    // mouse input\n    rd = iMouse.z < .001 ? rd : normalize(iMouse.xy - ro);\n    \n    // position on the ray\n    vec2 pos = ro;\n    \n    float t = 5.0;\n    \n    int i;\n    for(i=0; i < 60 && t > 0.1;i++)\n    {\n    \tvec2 pPos = pos;\n        float pT = t;\n        \n        pos = pos + t*rd;\n        \n        t = map(pos);\n        \n        // тут рисуются серые кружки ------------------\n        float rcd = sdCircle(sp-pPos,pT);\n        col = mix(vec3(0.2),col,smoothstep(rcd,0.,0.5));\n        col = mix(vec3(0.2),col,smoothstep(-rcd,-0.5,0.));\n        \n        // тут рисуются красные кружки =) -----------------\n        float dist = sdCircle(sp-pPos,5.0);\n        col = mix(vec3(0.0,1.,1.),col,smoothstep(dist,0.,1.0));\n        col = mix(vec3(0.0,1.,1.),col,smoothstep(-dist,-1.0,0.));\n        //col = round(col);\n    }\n    \n    \n    // \n    col = mix(vec3(1.,1.,1.),col,smoothstep(map(sp),0.0,1.0));\n    \n    col = mix(vec3(1.,1.,1.),col,smoothstep(-map(sp),-1.,200.));\n\n    fragColor = vec4(1.-col,2.0);\n}","name":"Image","description":"","type":"image"}]}