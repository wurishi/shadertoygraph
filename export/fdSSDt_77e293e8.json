{"ver":"0.1","info":{"id":"fdSSDt","date":"1621226768","viewed":278,"name":"Metagouts","username":"Kali","description":"2D metaball thingy with 3D lighting based on heightmap.","likes":15,"published":1,"flags":0,"usePreview":0,"tags":["2d","3d","fake"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\nfloat ds;\n\nvec2 hash(vec2 p)\n{\n    vec3 p3 = fract(p.xyx * vec3(.1031, .1030, .0973));\n    p3 += dot(p3, p3.yxz+33.33);\n    return fract((p3.xxy+p3.yzz)*p3.zyx).xy;\n}\n\nvec2 noise( in vec2 p )\n{\n    vec2 i = floor( p );\n    vec2 f = fract( p );\n    \n    vec2 u = f*f*(3.0-2.0*f);\n\n    return mix( mix( hash( i + vec2(0.0,0.0) ), \n                     hash( i + vec2(1.0,0.0) ), u.x),\n                mix( hash( i + vec2(0.0,1.0) ), \n                     hash( i + vec2(1.0,1.0) ), u.x), u.y);\n}\n\nmat2 rot(float a){\n    float s=sin(a),c=cos(a);\n    return mat2(c,s,-s,c);\n}\n\n\nfloat smin( float a, float b, float k )\n{\n    float h = clamp( 0.5+0.5*(b-a)/k, 0.0, 1.0 );\n    return mix( b, a, h ) - k*h*(1.0-h);\n}\n\n\nfloat map(vec2 p)\n{\n    float d=1000.;\n    for (int i=0; i<50; i++)\n    {\n        vec2 pr=noise(vec2(float(i)*.7+iTime*.05)).xy-.5;\n        pr.x*=1.7;\n        d=smin(d,pow(length(p+pr),2.)-.001,.01);\n    }\n    ds=d;\n    return d;\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 p=(fragCoord-iResolution.xy*.5)/iResolution.y;\n    vec3 col1=vec3(1.,.6,.3);\n    vec3 col2=vec3(.4,.7,1.);\n//    float d=map(p);\n    vec3 ldir=normalize(vec3(1.,2.,.7));\n    vec3 amb=col1*.8;\n    vec2 eps=vec2(0.,.01);\n    vec3 n=normalize(vec3(map(p+eps.yx),map(p+eps.xy),eps.y*.3)-map(p));\n    float dif=smoothstep(.0,1.,max(0.,dot(ldir,n)));\n    float dr=smoothstep(.001,0.,ds);\n    col1-=smoothstep(.5,.6,fract(p.y*20.))*.2;\n    fragColor=vec4(mix(mix(col1,col2,smoothstep(-.5,.3,p.y))*.7,amb+dif,dr),1.);\n}\n\n\n","name":"Image","description":"","type":"image"}]}