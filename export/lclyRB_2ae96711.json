{"ver":"0.1","info":{"id":"lclyRB","date":"1721274084","viewed":53,"name":"环状花纹","username":"langzai","description":"环形的绘制，与花纹的遮盖关系","likes":5,"published":1,"flags":0,"usePreview":0,"tags":["ring"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"vec2 CenterUV(vec2 fragCoord )//uv的居中与反拉伸https://www.shadertoy.com/view/M3cSDS\n{\n    return (2.0 * fragCoord - iResolution.xy) / min(iResolution.x, iResolution.y);\n}\nfloat CreatSingleRing(float len,float size,float line)//生成单个的环，可以根据len的样式生成不同的形状\n{\n    return smoothstep(size-line/2.,size-line/2.+0.02,len) * (1.-smoothstep(size+line/2.,size+line/2.+0.02,len));\n}\nvec2 TransformUV(vec2 uv,vec2 uvTiling,vec2 uvOffset,float move)//平铺圆环的uv转化，提取出来是因为需要uv判断遮罩关系\n{\n    vec2 Tuv = uv * uvTiling;\n    Tuv.x = mod(Tuv.x + uvOffset.x+ move ,2.)-1.;//水平方向需要显示完成的圆\n    Tuv.y = mod(Tuv.y + uvOffset.y+ move,1.);//数值方向显示显示一半就行\n    return Tuv;\n}\nvec2 CreatRings(vec2 uv,float line)\n{\n    float len = length(uv);\n    vec2 ring;//x为环本身，y为整个环的大小用于计算覆盖关系\n    for(int i=0;i<5;i++){\n        ring.x += CreatSingleRing(len,0.95-float(i)*0.15,line);//生成5个环\n    }\n    ring.y = step(len,1.);//生成整个半圆的遮罩\n    return ring;\n}\nfloat CoverRing(vec2 downRing,vec2 upRing)//圆环的覆盖\n{\n    float ring = downRing.x + upRing.x;//遮罩不重合区域的颜色是各自的颜色\n    return mix(ring,upRing.x,downRing.y*upRing.y);//重合区域根据上层环的遮罩，显示上层的环\n}\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = CenterUV(fragCoord);\n    \n    vec2 uv1 = TransformUV(uv,vec2(3.),vec2(0.),sin(iTime)/10.);//第一层uv\n    vec2 ring1 = CreatRings(uv1,0.07);//第一层的圆环平铺\n    \n    vec2 uv2 = TransformUV(uv,vec2(3.),vec2(1.,0.5),-sin(iTime)/10.);//根据第一层环平移所得\n    vec2 ring2 = CreatRings(uv2,0.07);//第二层圆环平铺\n    \n    float ring;\n    if(uv1.y<uv2.y) ring = CoverRing(ring1,ring2);//uv.y更大的覆盖在上层\n    else ring = CoverRing(ring2,ring1);\n\n    vec3 col = mix(vec3(1.),vec3(0.388,0.529,0.725),ring);//找一个合适的颜色混合\n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}