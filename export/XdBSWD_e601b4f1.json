{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[],"code":"#define MAX_DEPTH 32\n\n// ---8<----------------------------------------------------------------------\n// Tools for tree traversal\n\nstruct Item\n{\n    vec2 v;\n    float f;\n};\n    \nint stackPointer = 0;\nItem fifoStack[MAX_DEPTH];\n\nvoid push(Item item)\n{\n    stackPointer++;\n    for (int i = 0; i < MAX_DEPTH; ++i)\n    {\n        if (i == stackPointer)\n        {\n            fifoStack[i] = item;\n        }\n    }\n}\n\n// ---8<----------------------------------------------------------------------\n\nvec3 computeSomething(Item item)\n{\n    return vec3(item.v.x > 0. ? item.f : 0.,\n                item.v.y > 0. ? item.f : 0.,\n                0.);\n}\n\nvec3 recComputeSomething(vec2 uv)\n{\n    vec3 acc = vec3(0.);\n    fifoStack[0] = Item(uv, 0.1);\n\n    for (int i = 0; i < MAX_DEPTH; ++i)\n    {\n        if (i > stackPointer) break;\n        Item item = fifoStack[i];\n\n        acc += computeSomething(item);\n        float scale = 1.+0.1*sin(iTime);\n        push(Item(item.v * vec2(2.) + scale * vec2(-1., -1.), item.f * 0.5));\n        push(Item(item.v * vec2(2.) + scale * vec2(-1.,  1.), item.f * 0.5));\n        push(Item(item.v * vec2(2.) + scale * vec2( 1., -1.), item.f * 0.5));\n        push(Item(item.v * vec2(2.) + scale * vec2( 1.,  1.), item.f * 0.5));\n    }\n    \n    return acc;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 uv = 2. * fragCoord.xy / iResolution.xy - 1.;\n\tfragColor = vec4(recComputeSomething(uv),1.0);\n}\n","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"XdBSWD","date":"1411905342","viewed":221,"name":"Breadth first traversal","username":"Zavie","description":"A breadth first traversal proof of concept. This seems to work, but is offensively slow due to the O(n) fetches. Anyone has a clever idea to make it better?","likes":0,"published":1,"flags":0,"usePreview":0,"tags":["stack","recursion","breadthfirst"],"hasliked":0,"parentid":"","parentname":""}}