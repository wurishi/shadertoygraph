{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[{"channel":0,"type":"music","id":"XsXGzn","filepath":"/media/a/29de534ed5e4a6a224d2dfffab240f2e19a9d95f5e39de8898e850efdb2a99de.mp3","sampler":{"filter":"linear","wrap":"clamp","vflip":"false","srgb":"false","internal":"byte"}}],"code":"const float PI = 3.14159;\r\n\r\n// http://github.prideout.net/barrel-distortion/\r\nvec2 distort(vec2 p, float power)\r\n{\r\n    float a  = atan(p.y, p.x);\r\n    float r = length(p);\r\n    r = pow(r, power);\r\n    return vec2(r * cos(a), r*sin(a));\r\n\t//return vec2((a / PI), r*2.0-1.0);\t// polar\r\n}\r\n\r\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\r\n{\r\n    // create pixel coordinates\r\n\tvec2 uv = fragCoord.xy / iResolution.xy;\r\n\t\r\n\t// distort\r\n\tfloat bass = texture( iChannel0, vec2(0, 0) ).x;\t\t\r\n\tuv = distort(uv*2.0-1.0, 0.5+bass)*0.5+0.5;\r\n\t\t\r\n\t// quantize coordinates\r\n\tconst float bands = 20.0;\r\n\tconst float segs = 20.0;\r\n\tvec2 p;\r\n\tp.x = floor(uv.x*bands)/bands;\r\n\tp.y = floor(uv.y*segs)/segs;\r\n\t\r\n\t// read frequency data from first row of texture\r\n\tfloat fft  = texture( iChannel0, vec2(p.x,0.0) ).x;\t\r\n\r\n\t// led color\r\n\tvec3 color = mix(vec3(0.0, 2.0, 0.0), vec3(2.0, 0.0, 0.0), sqrt(uv.y));\r\n\t\r\n\t// mask for bar graph\r\n\tfloat mask = (p.y < fft) ? 1.0 : 0.0;\r\n\t\r\n\t// led shape\r\n\tvec2 d = fract((uv - p)*vec2(bands, segs)) - 0.5;\r\n\tfloat led = smoothstep(0.5, 0.3, abs(d.x)) *\r\n\t\t        smoothstep(0.5, 0.3, abs(d.y));\r\n\tvec3 ledColor = led*color*mask;\r\n\r\n    // second texture row is the sound wave\r\n\tfloat wave = texture( iChannel0, vec2(uv.x, 0.75) ).x;\r\n\tvec3 waveColor = vec3(0.001, 0.01, 0.04) / abs(wave - uv.y);\r\n\t\t\r\n\t// output final color\r\n\t//fragColor = vec4(vec3(fft),1.0);\r\n    //fragColor = vec4(d, 0.0, 1.0);\r\n\t//fragColor = vec4(ledColor, 1.0);\r\n\t//fragColor = vec4(waveColor, 1.0);\r\n\tfragColor = vec4(ledColor + waveColor, 1.0);\r\n}\r\n","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"Msl3zr","date":"1361983679","viewed":1686,"name":"led spectrum analyser","username":"simesgreen","description":"simple led spectrum analyser based on iq's sound visualizer","likes":15,"published":1,"flags":0,"usePreview":0,"tags":["sound"],"hasliked":0,"parentid":"","parentname":""}}