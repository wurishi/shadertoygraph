{"ver":"0.1","info":{"id":"Xs3yRM","date":"1518116503","viewed":728,"name":"Glowing petals","username":"lsdlive","description":"Variant of https://www.shadertoy.com/view/Mstczr","likes":34,"published":1,"flags":0,"usePreview":0,"tags":["raymarch","glow"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// variant of https://www.shadertoy.com/view/Mstczr\n\nvec3 glow = vec3(0.);\nfloat glow_intensity = .01;\nvec3 glow_color = vec3(.5, .8, .5);\n\nfloat smin(float a, float b) {\n\tfloat k = 3.;\n\tfloat res = exp(-k*a) + exp(-k*b);\n\treturn -log(res) / k;\n}\n\nmat2 r2d(float a) {\n\tfloat c = cos(a), s = sin(a);\n\treturn mat2(c, s, -s, c);\n}\n\nvec2 amod(vec2 p, float m) {\n\tfloat a = mod(atan(p.x, p.y) -m*.5, m) - m * .5;\n\treturn vec2(cos(a), sin(a)) * length(p);\n}\n\n#define sph(p, r) (length(p) - r)\n#define cyl sph\n#define cube(p, b) length(max(abs(p) - vec3(b), 0.))\n\nfloat de(vec3 p) {\n\t\n    p.xy *= r2d(iTime*.1 + p.z);\n    p.xz *= r2d(3.14/2.);\n    \n    \n    \n    p.zy = amod(p.zy, .785);\n    \n    p.y = abs(p.y) - .4;\n\tp.z = abs(p.z) - .4;\n\tif (p.z > p.y) p.yz = p.zy;\n    \n    \n    vec3 q = p;\n\n\tp.xy *= r2d(-3.14 / 3.);\n\tp.xz *= r2d(iTime);\n\tp.x += cos(p.y*8.)*.2;\n\tp.z += sin(p.y*4.)*.2;\n\tfloat d = cyl(p.xz, .1);\n\n\tp = q;\n\tp.xy *= r2d(3.14 / 3.);\n\tp.xz *= r2d(iTime);\n\tp.x += cos(p.y*8.)*.2;\n\tp.z += sin(p.y*4.)*.2;\n\n\td = smin(d, cyl(p.xz, .1));\n\n\tp = q;\n\tp.xz *= r2d(iTime);\n\tp.x += cos(p.y*8.)*.2;\n\tp.z += sin(p.y*4.)*.2;\n\n\td = smin(d, cyl(p.xz, .1));\n\n\tp = q;\n\tp.xy *= r2d(3.14 / 2.);\n\tp.xz *= r2d(iTime);\n\tp.x += cos(p.y*8.)*.2;\n\tp.z += sin(p.y*4.)*.2;\n\n\td = smin(d, cyl(p.xz, .1));\n\n\t// trick extracted from balkhan https://www.shadertoy.com/view/4t2yW1\n\tglow += glow_color * .025 / (.01 + d*d);\n\treturn d;\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord)\n{\n\tvec2 uv = ( fragCoord - .5*iResolution.xy ) / iResolution.y;\n\n\tvec3 ro = vec3(0., 0, 6. + cos(iTime)), p;\n\tvec3 rd = normalize(vec3(uv, -1));\n\tp = ro;\n\n\tfloat t = 0.;\n\tfor (float i = 0.; i < 1.; i += .01) {\n\t\tp = ro + rd * t;\n\t\tfloat d = de(p);\n\t\tif (d < .001 || t > 8.) break;\n\t\tt += d * .2; // avoid clipping, enhance the glow\n\t}\n\n\tvec3 c = vec3(.9, .05 + cos(iTime)*.1, .2);\n\tc.r *= p.y + p.z;\n\tc += glow * glow_intensity;\n\n\tfragColor = vec4(c, 1.);\n}","name":"Image","description":"","type":"image"}]}