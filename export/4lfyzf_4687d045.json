{"ver":"0.1","info":{"id":"4lfyzf","date":"1505688472","viewed":303,"name":"Test water with sin curves","username":"luluco250","description":"fsh","likes":10,"published":1,"flags":0,"usePreview":0,"tags":["2d","water","filter","sin","deform","curves"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4sfGRn","filepath":"/media/a/fb918796edc3d2221218db0811e240e72e340350008338b0c07a52bd353666a6.jpg","previewfilepath":"/media/ap/fb918796edc3d2221218db0811e240e72e340350008338b0c07a52bd353666a6.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XdXGzr","filepath":"/media/a/8979352a182bde7c3c651ba2b2f4e0615de819585cc37b7175bcefbca15a6683.jpg","previewfilepath":"/media/ap/8979352a182bde7c3c651ba2b2f4e0615de819585cc37b7175bcefbca15a6683.jpg","type":"texture","channel":1,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define CHANNEL0_RES vec2(1024, 1024)\n\n#define saturate(x) clamp(x, 0.0, 1.0)\n\nconst vec2 tex_res = CHANNEL0_RES;\nconst vec2 tex_ps = vec2(1.0) / tex_res;\n\nvec2 deform_uv(vec2, vec2);\nvec3 water_color(vec3, vec2);\n\nvoid mainImage(out vec4 out_col, vec2 coord) {\n    vec2 ps = vec2(1.0) / iResolution.xy;\n    vec2 uv = coord * ps;\n    vec2 uv_tex = coord * tex_ps;\n    \n    vec2 uv_deformed = deform_uv(uv_tex, coord);\n    \n    vec3 bg_col = texture(iChannel0, uv_deformed).rgb;\n    vec3 fg_col = texture(iChannel1, uv_deformed + vec2(1.0)).rgb;\n    float layer_factor = 0.15;\n    layer_factor = saturate(layer_factor);\n    \n    vec3 col = mix(bg_col, fg_col, layer_factor);\n    \n    col = water_color(col, uv);\n    \n    out_col = vec4(col, 1.0);\n}\n\nvec2 deform_uv(vec2 uv, vec2 coord) {\n    coord += vec2(iTime * 25.0) * vec2(0.5, 1.0);\n    vec2 offset;\n    offset.x += sin(coord.y * 0.01) * 0.1;\n    offset.x += sin(coord.y * 0.03) * 0.01;\n    offset.x += sin(coord.y * 1.0) * 0.001;\n    offset.y += sin(coord.x * 0.01) * 0.05;\n    offset.y += sin(coord.x * 0.03) * 0.005;\n    offset.y += sin(coord.x * 1.0) * 0.0005;    \n    \n    uv += offset / 3.0;\n    //uv.x += sin(coord.y * 0.1) * 0.01;\n    //uv.y += sin(coord.x * 0.1) * 0.01;\n    return uv;\n}\n\nvec3 water_color(vec3 col, vec2 uv) {\n    float vignette = 1.0 - distance(uv, vec2(0.5, 1.0));\n    \n    vec3 water_bright = vec3(0.5, 0.8, 1.0);\n    vec3 water_dark = vec3(0.0, 0.4, 0.7);\n    vec3 water_mix = mix(water_dark, water_bright, vignette);\n    water_mix = saturate(water_mix);\n    water_mix = pow(water_mix, vec3(2.0)) * 2.0;\n    \n    float lum = max(col.r, max(col.g, col.b));\n    //lum = pow(lum, 1.0 / 3.0);\n        \n    return mix(water_mix * col, col, lum);\n}\n","name":"Image","description":"","type":"image"}]}