{"ver":"0.1","info":{"id":"lttSz7","date":"1502510111","viewed":137,"name":"Waves 3D","username":"rory618","description":"Three dimensional! Who wants to make a raymarched version? :P","likes":2,"published":1,"flags":48,"usePreview":0,"tags":["3d","waves","multipass"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dfGRn","filepath":"/media/a/8de3a3924cb95bd0e95a443fff0326c869f9d4979cd1d5b6e94e2a01f5be53e9.jpg","previewfilepath":"/media/ap/8de3a3924cb95bd0e95a443fff0326c869f9d4979cd1d5b6e94e2a01f5be53e9.jpg","type":"texture","channel":1,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define ww  int(iResolution.x)\n#define  hh  int(iResolution.y)\n#define  cc  (int(pow(float(ww*hh),1./3.))-2)\n#define  ll  (cc*cc*cc)\n\nint II_I(int x, int y){\n    return (x+y*ww);\n}\nvec3 I_III(int d){\n    int q = d;\n    int z = q-(q/cc)*cc;\n    q=q/cc;\n    int y = q-(q/cc)*cc;\n    q=(q/cc);\n    int x = q;\n    return vec3(x,y,z);\n}\nint III_I(int x, int y, int z){\n    return (z+y*cc+x*cc*cc);\n}\nvec2 I_II(int d){\n    int q = d;\n    int x = q-(q/ww)*ww;\n    q=(q/ww);\n    int y = q;\n    return vec2(x,y);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{    \n\tvec2 uv = fragCoord.xy / iResolution.xy;\n    \n    int x = int(fragCoord.x - .5);\n    int y = int(fragCoord.y - .5);\n    \n    int xx = x/cc;\n    int yy = y/cc;\n    \n    x -= xx*cc;\n    y -= yy*cc;\n    \n    int z = xx + yy * (int(iResolution.x)/cc);\n    \n\tfragColor = texture(iChannel0,(I_II(III_I(x,y,z))+.5)/iResolution.xy);\n    fragColor.y=10.*fragColor.y;\n    fragColor = abs(fragColor);\n\t//fragColor = texture(iChannel1,uv);\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGRr","filepath":"/presets/tex00.jpg","previewfilepath":"/presets/tex00.jpg","type":"keyboard","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4dXGRr","filepath":"/presets/tex00.jpg","previewfilepath":"/presets/tex00.jpg","type":"keyboard","channel":3,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"\nconst float KEY_W  = 87.5/256.0;\nconst float KEY_R  = 82.5/256.0;\n\nbool keyIsDown( float key ) {\n    return texture( iChannel3, vec2(key,0.25) ).x > .5;\n}\n\n#define w  int(iResolution.x)\n#define  h  int(iResolution.y)\n#define  c  (int(pow(float(w*h),1./3.))-2)\n#define  l  (c*c*c)\n\nint II_I(int x, int y){\n    return (x+y*w);\n}\nvec3 I_III(int d){\n    int q = d;\n    int z = q-(q/c)*c;\n    q=q/c;\n    int y = q-(q/c)*c;\n    q=(q/c);\n    int x = q;\n    return vec3(x,y,z);\n}\nint III_I(int x, int y, int z){\n    return (z+y*c+x*c*c);\n}\nvec2 I_II(int d){\n    int q = d;\n    int x = q-(q/w)*w;\n    q=(q/w);\n    int y = q;\n    return vec2(x,y);\n}\n\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    \n    int fx = int(fragCoord.x - .5);\n    int fy = int(fragCoord.y - .5);\n    \n    vec3 pos = I_III(II_I(fx,fy));\n    int px = int(pos.x);\n    int py = int(pos.y);\n    int pz = int(pos.z);\n    \n    vec4 oc = texture(iChannel0, (I_II(III_I(px,py,pz))+.5)/iResolution.xy);\n    float x = oc.x;\n    float v = oc.y;\n    vec4 u = texture(iChannel0,(I_II(III_I(px,py,pz+1))+.5)/iResolution.xy);\n    vec4 d = texture(iChannel0,(I_II(III_I(px,py,pz-1))+.5)/iResolution.xy);\n    vec4 f = texture(iChannel0,(I_II(III_I(px,py+1,pz))+.5)/iResolution.xy);\n    vec4 b = texture(iChannel0,(I_II(III_I(px,py-1,pz))+.5)/iResolution.xy);\n    vec4 r = texture(iChannel0,(I_II(III_I(px+1,py,pz))+.5)/iResolution.xy);\n    vec4 lf = texture(iChannel0,(I_II(III_I(px-1,py,pz))+.5)/iResolution.xy);\n    \n    if(pz>=c-1)\n        u = oc, v *= .99;\n    if(py>=c-1)\n        f = oc, v *= .99;\n    if(px>=c-1)\n        r = oc, v *= .99;\n    if(pz<=0)\n        d = oc, v *= .99;\n    if(py<=0)\n        b = oc, v *= .99;\n    if(px<=0)\n        lf = oc, v *= .99;\n    \n    \n    v += (u.x+d.x+f.x+b.x+r.x+lf.x-6.*x)/6.;\n    x += v;\n    \n    if(keyIsDown(KEY_R)){\n        x*=0.;\n        v*=0.;\n    }\n    \n    \n    float ll = length(pos-float(c)/2.)*10.;\n    \n    fragColor = vec4(x,v,0.,1.);\n    float fq = (iMouse.x==0.)?1.:.06*iMouse.x;\n\tfragColor.y = mix(fragColor.y, sin(fq*iTime), .5*exp(-.2*ll));\n}","name":"Buf A","description":"","type":"buffer"}]}