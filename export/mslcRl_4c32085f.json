{"ver":"0.1","info":{"id":"mslcRl","date":"1687115117","viewed":72,"name":"Heart Generator NCA","username":"hotmultimedia","description":"Neural Cellular Automata. Point and click to add seed pixels. Slightly unstable, and can't handle changing to full screen due to unknown reasons.\n\nIdea from distill.pub, but training / playback code done from scratch.\n","likes":3,"published":1,"flags":32,"usePreview":0,"tags":["neural","nca"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    \n    \n    \n    vec2 uv = (fragCoord / iResolution.xx) * 50.0 + vec2(iTime) * 0.22;\n//    int po = (int(uv.x) ^ int(uv.y)) & 1;\n    float po = 1.0;\n    vec2 uvc = uv * 0.7;\n    po *= smoothstep(0.0, 0.1, fract(uvc.x)) * smoothstep(0.6, 0.5, fract(uvc.x)) * 2.0 - 1.0;\n    po *= smoothstep(0.0, 0.1, fract(uvc.y)) * smoothstep(0.6, 0.5, fract(uvc.y)) * 2.0 - 1.0;\n    po = (po * 0.5) + 0.5;\n\n    shift = (iFrame&1) == 1 ? 16u : 0u;\n\n    vec4 smp = loadTex(iChannel0, ivec2(fragCoord.xy/4.0));\n    \n    fragColor.a = 1.0;\n    \n    fragColor.rgb = mix(vec3(0.45f+float(po)*0.1f), smp.rgb, smp.a);\n}","name":"Image","description":"","type":"image"},{"inputs":[],"outputs":[],"code":"\n\nuint mulval = 0x1000u;\nfloat clampval = 7.f*1.0;\n\nuint shift = 0u;\n\nuint mask_store = 0u;\nuint shift_store = 0u;\nvec4 loadTex(sampler2D tex, ivec2 pos)\n{\n    vec4 cols = texelFetch(tex, pos, 0).rgba;\n    \n    uvec4 du1 = (floatBitsToUint(cols) >> shift) & 0xFFFFu;\n    \n    return (vec4(du1) - vec4(0x8000)) / float(mulval);\n}\n\n// outp_enc[0] = store_enc(outp[0], tex0);\nvec4 store_enc(vec4 inp, ivec2 pos, sampler2D tex, bool reset)\n{\n    vec4 cols = texelFetch(tex, pos, 0).rgba;\n    \n    if (reset)\n    {\n        cols = uintBitsToFloat(uvec4(0x80008000));\n    }\n    \n    uvec4 du1 = floatBitsToUint(cols) & mask_store;\n    \n    inp = clamp(inp, vec4(-clampval), vec4(clampval));\n    \n    uvec4 stuf = uvec4((inp * vec4(mulval)) + vec4(0x8000) + vec4(0.5f)) & uvec4(0xFFFFu);\n    \n    return uintBitsToFloat( du1 | (stuf << shift_store) );\n}\n\n#define USE_NEURAL\n\nvec4 getIdentityFeatures(ivec2 pos, sampler2D tex)\n{\n    return loadTex(tex, pos);\n}\n\nvec4 getSobelXFeatures(ivec2 pos, sampler2D tex)\n{\n    vec4 v1 = loadTex(tex, pos-ivec2(-1,-1)).rgba;\n    vec4 v2 = loadTex(tex, pos-ivec2(-1, 0)).rgba;\n    vec4 v3 = loadTex(tex, pos-ivec2(-1, 1)).rgba;\n    vec4 v4 = loadTex(tex, pos-ivec2( 1,-1)).rgba;\n    vec4 v5 = loadTex(tex, pos-ivec2( 1, 0)).rgba;\n    vec4 v6 = loadTex(tex, pos-ivec2( 1, 1)).rgba;\n    \n    return -v1-v2*2.0-v3+v4+v5*2.0+v6;\n}\n\nvec4 getSobelYFeatures(ivec2 pos, sampler2D tex)\n{\n    vec4 v1 = loadTex(tex, pos-ivec2(-1,-1)).rgba;\n    vec4 v2 = loadTex(tex, pos-ivec2( 0,-1)).rgba;\n    vec4 v3 = loadTex(tex, pos-ivec2( 1,-1)).rgba;\n    vec4 v4 = loadTex(tex, pos-ivec2(-1, 1)).rgba;\n    vec4 v5 = loadTex(tex, pos-ivec2( 0, 1)).rgba;\n    vec4 v6 = loadTex(tex, pos-ivec2( 1, 1)).rgba;\n    \n    return -v1-v2*2.0-v3+v4+v5*2.0+v6;\n}\n\n\nfloat getAlive(ivec2 pos, sampler2D tex)\n{\n    float v1 = loadTex(tex, pos-ivec2( 1,-1)).a;\n    float v2 = loadTex(tex, pos-ivec2( 1, 0)).a;\n    float v3 = loadTex(tex, pos-ivec2( 1, 1)).a;\n    float v4 = loadTex(tex, pos-ivec2( 0,-1)).a;\n    float v5 = loadTex(tex, pos-ivec2( 0, 0)).a;\n    float v6 = loadTex(tex, pos-ivec2( 0, 1)).a;\n    float v7 = loadTex(tex, pos-ivec2(-1,-1)).a;\n    float v8 = loadTex(tex, pos-ivec2(-1, 0)).a;\n    float v9 = loadTex(tex, pos-ivec2(-1, 1)).a;\n    \n    float ma = max(max(max(max(max(max(max(max(v1,v2),v3),v4),v5),v6),v7),v8),v9);\n    \n    return clamp((ma-0.1)*100.f,0.f, 1.f); \n    //return step(0.1, ma);\n}\n\nvec4 leaky_relu(vec4 inp)\n{\n    return max(vec4(0.0), inp) + 0.01 * min(vec4(0.0), inp);\n}\n\n\nfloat rand(vec2 co){\n    return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\n\nvec4 getOut(ivec2 pos, int slice, sampler2D tex0, sampler2D tex1, sampler2D tex2, sampler2D tex3, int frame, vec4 mouse)\n{\n    mouse /= 4.0;\n    shift = (frame&1) == 1 ? 16u : 0u;\n    shift_store = (frame&1) == 1 ? 0u : 16u;\n    mask_store = (frame&1) == 1 ? 0xFFFF0000u : 0x0000FFFFu;\n\n    vec4 features0 = getIdentityFeatures(pos, tex0);\n    vec4 features1 = getIdentityFeatures(pos, tex1);\n    vec4 features2 = getIdentityFeatures(pos, tex2);\n    vec4 features3 = getIdentityFeatures(pos, tex3);\n    vec4 features4 = getSobelXFeatures(pos, tex0);\n    vec4 features5 = getSobelXFeatures(pos, tex1);\n    vec4 features6 = getSobelXFeatures(pos, tex2);\n    vec4 features7 = getSobelXFeatures(pos, tex3);\n    vec4 features8 = getSobelYFeatures(pos, tex0);\n    vec4 features9 = getSobelYFeatures(pos, tex1);\n    vec4 featuresA = getSobelYFeatures(pos, tex2);\n    vec4 featuresB = getSobelYFeatures(pos, tex3);\n    \n\n    vec4 accu;\n    vec4 hidden[32];\n    vec4 outp[4];\n    \n    #ifdef USE_NEURAL\n// output for hidden dimension vector 0 -> 3\naccu = vec4(0.034065,0.188253,-0.062197,-0.215545);\naccu.x += dot(vec4(-0.381657,0.077026,0.077614,-0.568349), features0);\naccu.x += dot(vec4(0.050299,-0.261898,0.177743,-0.167455), features1);\naccu.x += dot(vec4(0.002571,-0.129252,-0.572506,-0.376854), features2);\naccu.x += dot(vec4(-0.534713,0.180116,0.047830,0.088308), features3);\naccu.x += dot(vec4(-0.380476,0.020061,0.019740,0.033451), features4);\naccu.x += dot(vec4(-0.293095,0.059433,-0.009549,-0.022801), features5);\naccu.x += dot(vec4(-0.338666,-0.068471,-0.181693,-0.037820), features6);\naccu.x += dot(vec4(0.108749,-0.140381,-0.322366,-0.177239), features7);\naccu.x += dot(vec4(0.087276,0.089720,0.092569,0.035732), features8);\naccu.x += dot(vec4(-0.325395,0.005522,-0.048233,0.277491), features9);\naccu.x += dot(vec4(-0.111771,0.097960,-0.020348,-0.034124), featuresA);\naccu.x += dot(vec4(-0.195604,-0.039056,-0.040372,0.203408), featuresB);\naccu.y += dot(vec4(-0.110346,0.065756,0.065227,-0.330638), features0);\naccu.y += dot(vec4(0.132199,-0.375642,-0.469604,-0.076965), features1);\naccu.y += dot(vec4(-0.239106,-0.104794,-0.559395,-0.465464), features2);\naccu.y += dot(vec4(0.346945,-0.238222,-0.143958,-0.012252), features3);\naccu.y += dot(vec4(0.355457,-0.158105,-0.157749,0.349492), features4);\naccu.y += dot(vec4(-0.071889,0.000233,0.181615,-0.327910), features5);\naccu.y += dot(vec4(-0.143337,0.112600,-0.070963,-0.053501), features6);\naccu.y += dot(vec4(-0.002244,-0.357154,-0.163020,-0.234305), features7);\naccu.y += dot(vec4(-0.432109,0.261317,0.263028,-0.073771), features8);\naccu.y += dot(vec4(0.102264,-0.151003,-0.081542,0.024821), features9);\naccu.y += dot(vec4(-0.228271,-0.019624,-0.011897,-0.041233), featuresA);\naccu.y += dot(vec4(0.040370,-0.018079,-0.309670,-0.080692), featuresB);\naccu.z += dot(vec4(0.399035,-0.124586,-0.126806,0.446521), features0);\naccu.z += dot(vec4(0.198941,0.198914,-0.139192,0.273608), features1);\naccu.z += dot(vec4(-0.056761,0.124479,0.040051,0.273773), features2);\naccu.z += dot(vec4(0.315804,0.466269,-0.144200,-0.245738), features3);\naccu.z += dot(vec4(-0.182969,0.059486,0.058363,-0.014510), features4);\naccu.z += dot(vec4(-0.002138,0.113039,-0.030536,0.001780), features5);\naccu.z += dot(vec4(-0.064460,0.092956,0.010400,-0.043645), features6);\naccu.z += dot(vec4(0.045061,-0.035642,0.182256,0.157682), features7);\naccu.z += dot(vec4(-0.459633,0.073352,0.076789,0.020840), features8);\naccu.z += dot(vec4(0.142294,-0.055457,-0.010739,0.013595), features9);\naccu.z += dot(vec4(0.174523,0.065544,-0.157216,0.083703), featuresA);\naccu.z += dot(vec4(0.025359,-0.095519,-0.139431,0.183729), featuresB);\naccu.w += dot(vec4(0.420892,0.107425,0.107793,0.853894), features0);\naccu.w += dot(vec4(-0.062354,0.159792,-0.101912,0.274861), features1);\naccu.w += dot(vec4(-0.162867,-0.114757,0.338613,0.202767), features2);\naccu.w += dot(vec4(0.103689,-0.028253,-0.358793,0.230712), features3);\naccu.w += dot(vec4(0.105667,-0.030514,-0.028618,0.035172), features4);\naccu.w += dot(vec4(-0.036562,0.065746,0.094417,-0.042420), features5);\naccu.w += dot(vec4(-0.107710,-0.116953,-0.050951,0.049918), features6);\naccu.w += dot(vec4(-0.113165,0.010326,0.074788,0.024967), features7);\naccu.w += dot(vec4(0.066408,-0.032095,-0.035962,0.058555), features8);\naccu.w += dot(vec4(0.107371,0.118027,-0.018317,0.045965), features9);\naccu.w += dot(vec4(0.096718,0.119938,-0.024430,0.018485), featuresA);\naccu.w += dot(vec4(-0.054283,-0.091095,0.026982,-0.013527), featuresB);\nhidden[0] = leaky_relu(accu);\n\n// output for hidden dimension vector 4 -> 7\naccu = vec4(-0.073235,0.042639,0.092103,-0.340587);\naccu.x += dot(vec4(-0.085037,0.007361,0.007546,-0.479244), features0);\naccu.x += dot(vec4(-0.214333,-0.170212,0.339719,-0.172267), features1);\naccu.x += dot(vec4(-0.056565,-0.004405,-0.691223,-0.633678), features2);\naccu.x += dot(vec4(-0.054214,0.245377,-0.259549,0.274238), features3);\naccu.x += dot(vec4(-0.079459,0.114208,0.115935,0.035110), features4);\naccu.x += dot(vec4(-0.532155,-0.460112,-0.319060,0.019527), features5);\naccu.x += dot(vec4(-0.204198,-0.247905,-0.082826,-0.205453), features6);\naccu.x += dot(vec4(-0.029956,-0.240066,-0.170276,0.007711), features7);\naccu.x += dot(vec4(0.158897,-0.161035,-0.161302,-0.095050), features8);\naccu.x += dot(vec4(-0.237838,0.095989,0.374985,0.135306), features9);\naccu.x += dot(vec4(0.181131,-0.141157,0.488969,-0.003334), featuresA);\naccu.x += dot(vec4(0.037348,-0.146405,-0.136911,0.049005), featuresB);\naccu.y += dot(vec4(0.069763,-0.609388,-0.609283,0.575382), features0);\naccu.y += dot(vec4(-0.122683,0.110057,0.549960,-0.197879), features1);\naccu.y += dot(vec4(0.334259,0.094033,-0.197653,0.044871), features2);\naccu.y += dot(vec4(0.216790,0.321397,0.128799,-0.080261), features3);\naccu.y += dot(vec4(-0.408092,0.037497,0.034049,-0.113424), features4);\naccu.y += dot(vec4(0.322444,0.078611,-0.057248,0.221417), features5);\naccu.y += dot(vec4(0.248850,0.185510,0.019701,0.047463), features6);\naccu.y += dot(vec4(0.251529,-0.003083,0.199357,0.026915), features7);\naccu.y += dot(vec4(0.064728,0.042873,0.042627,0.033737), features8);\naccu.y += dot(vec4(-0.137584,-0.105325,-0.029636,-0.289486), features9);\naccu.y += dot(vec4(-0.172012,-0.163262,-0.011317,-0.115696), featuresA);\naccu.y += dot(vec4(0.011034,-0.137778,-0.083039,-0.167658), featuresB);\naccu.z += dot(vec4(0.270315,-0.043574,-0.043881,0.020746), features0);\naccu.z += dot(vec4(0.088491,0.312788,0.002626,0.047117), features1);\naccu.z += dot(vec4(0.104925,0.353102,0.109921,-0.224134), features2);\naccu.z += dot(vec4(0.175721,0.548626,-0.237630,0.382087), features3);\naccu.z += dot(vec4(-0.353283,-0.118581,-0.118285,0.016518), features4);\naccu.z += dot(vec4(0.261010,0.019838,0.077058,0.323645), features5);\naccu.z += dot(vec4(0.404342,0.136375,-0.218239,0.246263), features6);\naccu.z += dot(vec4(0.072618,-0.004576,0.031334,0.303452), features7);\naccu.z += dot(vec4(-0.118483,0.040813,0.040207,-0.072005), features8);\naccu.z += dot(vec4(0.394693,-0.175479,0.190859,0.340907), features9);\naccu.z += dot(vec4(0.045333,0.156830,-0.145811,0.146257), featuresA);\naccu.z += dot(vec4(-0.053571,0.170234,0.090732,0.284298), featuresB);\naccu.w += dot(vec4(0.053377,0.222724,0.223705,0.020342), features0);\naccu.w += dot(vec4(0.253081,-0.141732,-0.374349,0.035278), features1);\naccu.w += dot(vec4(0.015800,-0.040519,0.112398,-0.096328), features2);\naccu.w += dot(vec4(0.038982,-0.032324,-0.365408,0.277374), features3);\naccu.w += dot(vec4(0.074619,-0.022811,-0.023855,0.162846), features4);\naccu.w += dot(vec4(-0.058497,0.049564,0.103175,-0.099237), features5);\naccu.w += dot(vec4(-0.168220,0.040752,0.097746,0.113456), features6);\naccu.w += dot(vec4(-0.048227,-0.046372,-0.035574,-0.087300), features7);\naccu.w += dot(vec4(-0.009251,-0.014653,-0.012998,-0.065685), features8);\naccu.w += dot(vec4(0.015332,-0.194410,-0.026090,0.050691), features9);\naccu.w += dot(vec4(0.088094,0.207349,0.100945,-0.029598), featuresA);\naccu.w += dot(vec4(0.156429,0.030824,-0.133492,-0.112836), featuresB);\nhidden[1] = leaky_relu(accu);\n\n// output for hidden dimension vector 8 -> 11\naccu = vec4(0.639552,-0.650287,-0.060921,-0.283656);\naccu.x += dot(vec4(-0.410033,-0.075901,-0.078231,0.086674), features0);\naccu.x += dot(vec4(-0.142129,-0.086967,0.136918,-0.128046), features1);\naccu.x += dot(vec4(-0.134214,-0.128322,-0.423202,-0.104306), features2);\naccu.x += dot(vec4(0.182891,-0.015229,-0.198923,-0.258489), features3);\naccu.x += dot(vec4(-0.199634,0.132416,0.132894,0.042582), features4);\naccu.x += dot(vec4(0.151246,-0.044998,0.045497,0.095001), features5);\naccu.x += dot(vec4(0.188444,-0.005172,-0.142335,0.161952), features6);\naccu.x += dot(vec4(0.236238,0.045929,-0.038515,0.159754), features7);\naccu.x += dot(vec4(0.103730,-0.188707,-0.189399,0.122070), features8);\naccu.x += dot(vec4(-0.106928,-0.134118,0.074037,0.060105), features9);\naccu.x += dot(vec4(0.005477,-0.010369,-0.019220,0.045195), featuresA);\naccu.x += dot(vec4(-0.045349,0.015587,0.018398,0.130291), featuresB);\naccu.y += dot(vec4(0.335229,0.134783,0.136505,0.420570), features0);\naccu.y += dot(vec4(0.070745,0.479966,-0.309349,-0.043116), features1);\naccu.y += dot(vec4(0.089763,-0.248902,0.272515,0.133661), features2);\naccu.y += dot(vec4(-0.115616,0.384589,-0.136444,0.587071), features3);\naccu.y += dot(vec4(-0.160279,0.034232,0.031328,-0.046569), features4);\naccu.y += dot(vec4(0.185617,0.086912,0.074729,0.077992), features5);\naccu.y += dot(vec4(0.047091,-0.059222,-0.007594,-0.096695), features6);\naccu.y += dot(vec4(-0.018809,0.064142,0.109293,0.116762), features7);\naccu.y += dot(vec4(-0.101809,-0.048499,-0.047328,0.014139), features8);\naccu.y += dot(vec4(0.036943,0.004611,-0.049831,0.005247), features9);\naccu.y += dot(vec4(0.051421,0.051073,-0.038820,-0.032387), featuresA);\naccu.y += dot(vec4(-0.068269,-0.110044,-0.066739,0.052623), featuresB);\naccu.z += dot(vec4(-0.000277,-0.052966,-0.053224,-0.449736), features0);\naccu.z += dot(vec4(-0.068672,0.210372,0.030163,-0.223360), features1);\naccu.z += dot(vec4(0.174747,-0.079737,-0.456834,-0.546573), features2);\naccu.z += dot(vec4(0.058369,0.199158,-0.149409,0.116627), features3);\naccu.z += dot(vec4(-0.115857,-0.016867,-0.021302,-0.067632), features4);\naccu.z += dot(vec4(0.025069,0.020502,0.177307,0.073636), features5);\naccu.z += dot(vec4(-0.071669,-0.161295,0.157367,0.024299), features6);\naccu.z += dot(vec4(-0.051245,-0.063823,0.107052,-0.211462), features7);\naccu.z += dot(vec4(-0.042442,0.104666,0.105697,-0.082257), features8);\naccu.z += dot(vec4(-0.418756,-0.184079,0.014435,-0.010800), features9);\naccu.z += dot(vec4(-0.252402,-0.056235,-0.031578,-0.037873), featuresA);\naccu.z += dot(vec4(-0.062334,0.009759,-0.240984,-0.309359), featuresB);\naccu.w += dot(vec4(0.040774,-0.042804,-0.042884,-0.574772), features0);\naccu.w += dot(vec4(-0.176399,-0.069554,0.200098,-0.334813), features1);\naccu.w += dot(vec4(-0.004236,0.286488,-0.720735,-0.939512), features2);\naccu.w += dot(vec4(0.131109,0.468969,0.164489,0.357318), features3);\naccu.w += dot(vec4(-0.036398,0.009114,0.008170,0.116473), features4);\naccu.w += dot(vec4(-0.118499,-0.339141,-0.797281,-0.251226), features5);\naccu.w += dot(vec4(-0.087980,-0.421615,0.115600,-0.188461), features6);\naccu.w += dot(vec4(-0.129267,-0.187611,-0.063645,-0.126580), features7);\naccu.w += dot(vec4(-0.062118,-0.153945,-0.153651,-0.144529), features8);\naccu.w += dot(vec4(0.039927,0.110414,0.593469,0.409655), features9);\naccu.w += dot(vec4(0.256600,0.037197,-0.022697,0.277553), featuresA);\naccu.w += dot(vec4(0.191801,0.309158,0.080710,0.343197), featuresB);\nhidden[2] = leaky_relu(accu);\n\naccu = vec4(0.022303,-0.028950,-0.029294,0.041537);\naccu.x += dot(vec4(0.093797,0.132394,0.132897,-0.028657), hidden[0]);\naccu.x += dot(vec4(-0.207648,-0.361000,0.222100,-0.217701), hidden[1]);\naccu.x += dot(vec4(-0.022078,0.372264,0.345764,-0.051687), hidden[2]);\naccu.y += dot(vec4(0.036121,-0.039056,-0.173261,-0.024587), hidden[0]);\naccu.y += dot(vec4(0.003501,0.270270,0.029915,0.174004), hidden[1]);\naccu.y += dot(vec4(0.059230,0.164511,-0.125011,-0.098222), hidden[2]);\naccu.z += dot(vec4(0.036578,-0.038783,-0.172834,-0.024600), hidden[0]);\naccu.z += dot(vec4(0.003645,0.270133,0.031002,0.174367), hidden[1]);\naccu.z += dot(vec4(0.059849,0.164360,-0.125475,-0.098881), hidden[2]);\naccu.w += dot(vec4(0.627672,0.111851,0.396456,0.690585), hidden[0]);\naccu.w += dot(vec4(0.553074,0.117804,0.229939,0.116229), hidden[1]);\naccu.w += dot(vec4(-0.266696,-0.579161,0.325503,0.040830), hidden[2]);\noutp[0] = accu;\n\naccu = vec4(-0.102541,-0.060875,0.036660,0.210747);\naccu.x += dot(vec4(0.070448,-0.148599,0.195736,0.123970), hidden[0]);\naccu.x += dot(vec4(0.326802,-0.050973,0.067357,-0.156135), hidden[1]);\naccu.x += dot(vec4(0.180420,0.087368,0.313277,0.471539), hidden[2]);\naccu.y += dot(vec4(0.102590,0.457910,-0.135787,0.336538), hidden[0]);\naccu.y += dot(vec4(0.112642,-0.331339,-0.236506,0.096535), hidden[1]);\naccu.y += dot(vec4(-0.186168,-0.023493,0.214972,0.299370), hidden[2]);\naccu.z += dot(vec4(-0.421581,0.524333,0.158250,-0.149951), hidden[0]);\naccu.z += dot(vec4(-0.739196,-0.666098,-0.141830,0.228003), hidden[1]);\naccu.z += dot(vec4(-0.213482,-0.283595,-0.462575,-0.051241), hidden[2]);\naccu.w += dot(vec4(-0.136198,-0.079481,-0.102912,-0.014151), hidden[0]);\naccu.w += dot(vec4(-0.205174,0.074685,0.001474,-0.094773), hidden[1]);\naccu.w += dot(vec4(-0.061350,0.160718,-0.173866,-0.141473), hidden[2]);\noutp[1] = accu;\n\naccu = vec4(-0.092738,0.093847,0.251471,0.166024);\naccu.x += dot(vec4(0.218084,0.195288,0.195417,-0.066463), hidden[0]);\naccu.x += dot(vec4(0.743413,-0.248784,0.390665,0.098607), hidden[1]);\naccu.x += dot(vec4(0.080785,0.016592,-0.343376,0.371926), hidden[2]);\naccu.y += dot(vec4(0.223520,0.211510,-0.018040,0.007226), hidden[0]);\naccu.y += dot(vec4(-0.252411,-0.339475,-0.717477,-0.110618), hidden[1]);\naccu.y += dot(vec4(-0.109122,-0.057457,-0.021075,-0.902130), hidden[2]);\naccu.z += dot(vec4(0.459577,0.319760,0.104585,0.302812), hidden[0]);\naccu.z += dot(vec4(0.697314,-0.072339,0.182437,0.025758), hidden[1]);\naccu.z += dot(vec4(-0.267074,0.647521,-0.186010,0.612530), hidden[2]);\naccu.w += dot(vec4(0.175143,0.266423,0.074120,0.189115), hidden[0]);\naccu.w += dot(vec4(0.169976,0.178319,0.461297,-0.057468), hidden[1]);\naccu.w += dot(vec4(0.345082,0.120579,0.079315,0.696318), hidden[2]);\noutp[2] = accu;\n\naccu = vec4(0.177740,0.014376,-0.016009,-0.224809);\naccu.x += dot(vec4(0.089349,-0.494537,-0.211565,-0.185594), hidden[0]);\naccu.x += dot(vec4(-0.212636,0.017464,0.161408,-0.040618), hidden[1]);\naccu.x += dot(vec4(-0.385331,-0.125348,0.088307,-0.264811), hidden[2]);\naccu.y += dot(vec4(-0.162785,0.349552,0.299300,0.157203), hidden[0]);\naccu.y += dot(vec4(-0.075854,-0.227482,-0.110796,0.242624), hidden[1]);\naccu.y += dot(vec4(-0.597437,-0.291615,0.078057,-0.245830), hidden[2]);\naccu.z += dot(vec4(-0.010370,0.376835,0.222763,-0.063764), hidden[0]);\naccu.z += dot(vec4(0.550475,-0.442263,-0.085692,0.304106), hidden[1]);\naccu.z += dot(vec4(0.264495,0.166749,0.092313,-0.208227), hidden[2]);\naccu.w += dot(vec4(0.051656,0.094011,-0.108194,0.167354), hidden[0]);\naccu.w += dot(vec4(-0.159022,0.090556,0.328962,0.010324), hidden[1]);\naccu.w += dot(vec4(0.167004,0.249804,-0.083703,-0.449567), hidden[2]);\noutp[3] = accu;\n\n\n\n    #endif\n    \n    //outp[0] = vec4();\n    outp[0] = outp[0] * 0.5 + features0 * 0.5;\n    outp[1] = outp[1] * 0.5 + features1 * 0.5;\n    outp[2] = outp[2] * 0.5 + features2 * 0.5;\n    outp[3] = outp[3] * 0.5 + features3 * 0.5;\n    \n    float updr = 1.0f; //step(0.7, rand(vec2(pos) + vec2(frame % 200)*000.13333f));\n    \n    outp[0] = mix(features0, outp[0], updr);\n    outp[1] = mix(features1, outp[1], updr);\n    outp[2] = mix(features2, outp[2], updr);\n    outp[3] = mix(features3, outp[3], updr);\n    \n    float alive = getAlive(pos, tex0);\n    \n    outp[0] = mix(vec4(0.0), outp[0], alive);\n    outp[1] = mix(vec4(0.0), outp[1], alive);\n    outp[2] = mix(vec4(0.0), outp[2], alive);\n    outp[3] = mix(vec4(0.0), outp[3], alive);\n    \n    ivec2 regen_point = ivec2(50,50);\n    \n    bool regen = false;\n    if (frame == 0)\n    {\n        regen = true;\n        outp[0] = vec4( 0.0f );\n        outp[1] = vec4( 0.0f );\n        outp[2] = vec4( 0.0f );\n        outp[3] = vec4( 0.0f );\n    }\n        \n    if (mouse.z > 1.f && mouse.w > 1.f)\n    {\n        regen_point = ivec2(mouse.zw);\n        regen = true;\n    }\n    \n    if (regen)\n    {       \n        if (pos == regen_point)\n        {\n            outp[0] = vec4(0.f, 0.f, 0.f, 1.f);\n            outp[1] = vec4(1.f);\n            outp[2] = vec4(1.f);\n            outp[3] = vec4(1.f);\n        }\n    }\n    \n    //outp[0] = vec4(updr, updr, updr, 1.0);\n    \n    vec4 outp_enc[4];\n    outp_enc[0] = store_enc(outp[0], pos, tex0, frame==0);\n    outp_enc[1] = store_enc(outp[1], pos, tex1, frame==0);\n    outp_enc[2] = store_enc(outp[2], pos, tex2, frame==0);\n    outp_enc[3] = store_enc(outp[3], pos, tex3, frame==0);\n\n\n\n \n    #if 1\n    vec4 rawtex1 = texelFetch(tex1, pos, 0).rgba;\n    if (floatBitsToUint(rawtex1) == uvec4(0u) && frame > 0)\n    {\n        vec4 resval = uintBitsToFloat(uvec4(0x80008000));\n        outp_enc[0] = resval;\n        outp_enc[1] = resval;\n        outp_enc[2] = resval;\n        outp_enc[3] = resval;\n    }\n    #endif\n\n\n    return outp_enc[slice];\n}","name":"Common","description":"","type":"common"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4sXGR8","filepath":"/media/previz/buffer02.png","previewfilepath":"/media/previz/buffer02.png","type":"buffer","channel":2,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XdfGR8","filepath":"/media/previz/buffer03.png","previewfilepath":"/media/previz/buffer03.png","type":"buffer","channel":3,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    fragColor = getOut( ivec2(fragCoord), 0, iChannel0, iChannel1, iChannel2, iChannel3, iFrame, iMouse);\n}\n","name":"Buffer A","description":"","type":"buffer"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4sXGR8","filepath":"/media/previz/buffer02.png","previewfilepath":"/media/previz/buffer02.png","type":"buffer","channel":2,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XdfGR8","filepath":"/media/previz/buffer03.png","previewfilepath":"/media/previz/buffer03.png","type":"buffer","channel":3,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"XsXGR8","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    fragColor = getOut( ivec2(fragCoord), 1, iChannel0, iChannel1, iChannel2, iChannel3, iFrame, iMouse);\n}\n","name":"Buffer B","description":"","type":"buffer"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4sXGR8","filepath":"/media/previz/buffer02.png","previewfilepath":"/media/previz/buffer02.png","type":"buffer","channel":2,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XdfGR8","filepath":"/media/previz/buffer03.png","previewfilepath":"/media/previz/buffer03.png","type":"buffer","channel":3,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4sXGR8","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    fragColor = getOut( ivec2(fragCoord), 2, iChannel0, iChannel1, iChannel2, iChannel3, iFrame, iMouse);\n}\n","name":"Buffer C","description":"","type":"buffer"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4sXGR8","filepath":"/media/previz/buffer02.png","previewfilepath":"/media/previz/buffer02.png","type":"buffer","channel":2,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XdfGR8","filepath":"/media/previz/buffer03.png","previewfilepath":"/media/previz/buffer03.png","type":"buffer","channel":3,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"XdfGR8","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    fragColor = getOut( ivec2(fragCoord), 3, iChannel0, iChannel1, iChannel2, iChannel3, iFrame, iMouse);\n}\n","name":"Buffer D","description":"","type":"buffer"}]}