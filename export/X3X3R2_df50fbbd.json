{"ver":"0.1","info":{"id":"X3X3R2","date":"1707663579","viewed":80,"name":"Zoom lens","username":"Gfscalco","description":"A simple zoom as i practice what i learned from book of shaders","likes":1,"published":1,"flags":0,"usePreview":0,"tags":["zoom","learning"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XdX3Rn","filepath":"/media/a/52d2a8f514c4fd2d9866587f4d7b2a5bfa1a11a0e772077d7682deb8b3b517e5.jpg","previewfilepath":"/media/ap/52d2a8f514c4fd2d9866587f4d7b2a5bfa1a11a0e772077d7682deb8b3b517e5.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// Author @gfscalco - 2024\n//Click on the image to see the zoom\n\nfloat circle(in float r, in vec2 pos, in vec2 pixel)\n{\n    pixel = pixel - pos;\n    float angle = atan(pixel.y/pixel.x);\n    float radius = length(pixel);\n    float mask = smoothstep(r-0.005,r+0.005, radius);\n    return (1.0-mask);\n}\n\nfloat ring(in float r, in float width, in vec2 pos, in vec2 pixel){\n    float outer_circle = circle(r+width/2.0, pos, pixel);\n    float inner_circle = circle(r-width/2.0, pos, pixel);\n    float mask = outer_circle - inner_circle;\n    return (mask);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // Normalized pixel coordinates (from 0 to 1)\n    vec2 uv = fragCoord/iResolution.xy;\n    \n    vec2 p = uv;\n\n    \n    vec2 zoom_pos = (iMouse.xy)/iResolution.xy;\n    float zoom_times = 3.0;\n    \n    vec2 zoomed_p = p - zoom_pos;\n    zoomed_p = zoomed_p/zoom_times;\n    zoomed_p += zoom_pos;\n\n    float lens_radius = 0.25;\n\n    vec4 background =  texture(iChannel0, uv);\n    vec4 zoomed_bg = texture(iChannel0, zoomed_p);\n    vec4 zoom_mask = clamp(vec4(vec3(circle(lens_radius, zoom_pos, p)),1.0),0.0,1.0);\n    zoomed_bg *= zoom_mask;\n    vec4 zoom_ring = vec4(vec3(ring(lens_radius,0.02, zoom_pos, p)),1.0);\n    vec4 ring_color = vec4(0.1,0.2,0.2,1.0);\n    zoom_ring *= ring_color;\n    \n    fragColor = vec4(zoomed_bg.xyz,1.0) + (1.0-zoom_mask)*background + zoom_ring;\n    //fragColor = zoom_ring;\n    //fragColor = zoom_mask;\n}","name":"Image","description":"","type":"image"}]}