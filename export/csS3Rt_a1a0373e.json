{"ver":"0.1","info":{"id":"csS3Rt","date":"1667990485","viewed":218,"name":"差不多得了","username":"1393323447","description":"流汗黄豆\n\nMy very first shader program. Thanks for this amazing series: https://www.youtube.com/watch?v=ZlNnrpM0TRg","likes":13,"published":1,"flags":0,"usePreview":0,"tags":["2d"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define SAT(t) clamp(t, 0., 1.)\n\nfloat remap01(float t, float a, float b) {\n    return SAT((t - a) / (b - a));\n}\n\nfloat remap(float t, float a, float b, float c, float d) {\n    return remap01(t, a, b) * (d - c) + c;\n}\n\nvec2 within(vec2 uv, vec4 rect) {\n    return (uv - rect.xy) / (rect.zw - rect.xy);\n}\n\nfloat Band(float t, float start, float end, float blur) {\n    float edge1 = smoothstep(start - blur, start + blur, t);\n    float edge2 = smoothstep(end   + blur, end   - blur, t);\n    return edge1 * edge2;\n}\n\nfloat RoundRect(vec2 uv, vec2 pos, float width, float height, float blur) {\n    float halfWidth = width / 2.;\n    float halfHeight = height / 2.;\n    float band1 = Band(uv.x, pos.x - halfWidth, pos.y + halfWidth, blur);\n    float band2 = Band(uv.y, pos.y - halfHeight, pos.y + halfHeight, blur);\n\n    float rect = band1 * band2;\n\n\n    uv -= pos;\n    uv = abs(uv);\n\n    float fouthHeight = halfHeight / 2.;\n    vec2 p = vec2(width - (halfWidth / 2.), fouthHeight);\n\n    float dis = length(uv - p);\n    float circle = smoothstep(fouthHeight, fouthHeight - 0.05, dis);\n\n    if (circle <= 0. && uv.x > p.x && uv.y > p.y) {\n        return 0.;\n    }\n\n    return rect;\n}\n\nvec4 WaterDrop(vec2 uv) {\n    uv -= .5;\n\n    vec4 waterDropCol = vec4(0.);\n\n    float x = -uv.y;\n    float y =  uv.x + 0.1;\n\n    {\n        float sum = x * x + y * y;\n        float waterDrop = sum * sum - 2. * x * sum + 3. * y*y;\n        vec4 col = vec4(0.);\n        col.a = smoothstep(.0, -.003, waterDrop) * 0.28;\n        waterDropCol = mix(waterDropCol, col, col.a);\n\n    }\n\n    x = -uv.y;\n    y =  uv.x;\n    {\n        float sum = x * x + y * y;\n        float waterDrop = sum * sum - 2. * x * sum + 3. * y*y;\n        vec4 col = vec4(25., 100., 176., 1.) / 256.;\n        col.a = smoothstep(.0, -.003, waterDrop);\n        waterDropCol = mix(waterDropCol, col, col.a);\n    }\n\n    x *= 1.2;\n    y *= 1.2;\n    x -= 0.25;\n    {\n        float sum = x * x + y * y;\n        float waterDrop = sum * sum - 2. * x * sum + 3. * y*y;\n        vec4 col = vec4(80., 159., 218., 1.) / 256.;\n        col.a = smoothstep(.0, -.003, waterDrop);\n\n        // hightlight\n        vec2 uvTrans = vec2(-uv.y, uv.x);\n        vec2 pos = vec2(1.7, 0.);\n        float dis = length(uvTrans - pos);\n        \n        vec4 hCol = vec4(102., 179., 222., 1.) / 256.;\n        hCol.a = smoothstep(0.4, 0.39, dis);\n        col.rgb = mix(col.rgb, hCol.rgb, hCol.a);\n\n        hCol = vec4(127., 202., 231., 1.) / 256.;\n        hCol.a = smoothstep(0.3, 0.29, dis);\n        col.rgb = mix(col.rgb, hCol.rgb, hCol.a);\n\n        hCol = vec4(145., 217., 241., 1.) / 256.;\n        hCol.a = smoothstep(0.2, 0.19, dis);\n        col.rgb = mix(col.rgb, hCol.rgb, hCol.a);\n\n        hCol = vec4(164., 233., 248., 1.) / 256.;\n        hCol.a = smoothstep(0.1, 0.09, dis);\n        col.rgb = mix(col.rgb, hCol.rgb, hCol.a);\n        \n        waterDropCol.rgb = mix(waterDropCol.rgb, col.rgb, col.a);\n    }\n\n    x *= 1.3;\n    y *= 1.8;\n    {\n        float sum = x * x + y * y;\n        float waterDrop = sum * sum - 2. * x * sum + 3. * y*y;\n        vec4 col = vec4(177., 208., 236., 1.) / 256.;\n        col.a = smoothstep(.0, -.01, waterDrop) * 0.55;\n        waterDropCol.rgb = mix(waterDropCol.rgb, col.rgb, col.a);\n    }\n\n    return waterDropCol;\n}\n\nvec4 Eye(vec2 uv) {\n    uv -= 0.5;\n\n    vec4 eyeCol = vec4(0.);\n\n    {\n        float delta = 0.08;\n        vec2 pos = vec2(uv.x, uv.y - delta);\n        vec4 col = vec4(1., 166./256., 56./256., 1.0);\n        float dis = length(pos);\n        col.a = smoothstep(.5, .48, dis);\n        eyeCol = mix(eyeCol, col, col.a);\n    }\n\n    {\n        vec4 col = vec4(102., 34., 0., 1.0) / 256.;\n        float dis = length(uv);\n        col.a = smoothstep(.5, .48, dis);\n        eyeCol = mix(eyeCol, col, col.a);\n    }\n\n    {\n        float delta = -0.08;\n        vec2 pos = vec2(uv.x, uv.y - delta);\n        vec4 col = vec4(134., 59., 17., 1.) / 256.;\n        float dis = length(pos);\n        col.a = smoothstep(.5, .48, dis);\n        eyeCol.rgb = mix(eyeCol.rgb, col.rgb, col.a);\n    }\n\n    {\n        vec4 col = vec4(250., 219., 164., 1.) / 256.;\n        float val = (1.6 - abs(uv.x)) * uv.x * uv.x;\n        col.a = smoothstep(val, val + 0.01, -uv.y);\n        eyeCol.rgb = mix(eyeCol.rgb, col.rgb, col.a);\n    }\n\n    {\n        vec4 col = vec4(.94, .74, .226, 1.);\n        float val = (1.6 - abs(uv.x)) * uv.x * uv.x + 0.06;\n        col.a = smoothstep(val, val + 0.01, -uv.y);\n        eyeCol.rgb = mix(eyeCol.rgb, col.rgb, col.a);\n    }\n\n    return eyeCol;\n}\n\nvec4 Mouth(vec2 uv) {\n    uv -= .5;\n\n    vec2 uvTrans1 = vec2(uv.x, uv.y * 1.5 - uv.x * uv.x * 2.1);\n    float dis = length(uvTrans1);\n    vec4 col = vec4(.5, .18, .05, 1.) * smoothstep(.75, .33, dis);\n    col.a = smoothstep(.5, .49, dis);\n\n\n    vec2 uvTrans2 = vec2(uv.x, uv.y * 1.5 - uv.x * uv.x);\n    vec4 toothCol = vec4(1.) * smoothstep(.55, .30, dis);\n    toothCol.a = RoundRect(uvTrans2, vec2(0., 0.2), .5, .3, .003);\n\n    col.rgb = mix(col.rgb, toothCol.rgb, toothCol.a);\n    \n\n    return col;\n}\n\nvec4 Head(vec2 uv) {\n    vec4 col = vec4(.94, .74, .226, 1.);\n\n    float dis = length(uv);\n\n    col.a = smoothstep(.5, .49, dis);\n    \n    {\n        float ring = smoothstep(0.42, 0.46, dis);\n        vec3 ring_col = vec3(1., 0.67, 0.23);\n        col.rgb = mix(col.rgb, ring_col, ring);\n    }\n\n    {\n        float ring = smoothstep(.46, .48, dis);\n        vec3  ring_col = vec3(.97, .5, .25);\n        col.rgb = mix(col.rgb, ring_col, ring);\n    }\n\n    float circle_shadow = remap01(dis, .35, .5);\n    circle_shadow = 1. - (circle_shadow * circle_shadow) * .5;\n    col.rgb *= circle_shadow;\n\n    float hightlight = smoothstep(.43, .405, dis);\n    float distr = remap(uv.y, .41, .0, .35, 0.) - 1.;\n    distr = 1. - distr*distr;\n    hightlight *= distr;\n    col.rgb = mix(col.rgb, vec3(1.), hightlight);\n\n    return col;\n}\n\nvec4 Bean(vec2 uv) {\n    vec4 col = vec4(0.);\n    \n    vec4 head = Head(uv);\n    vec4 waterDrop = WaterDrop(within(uv, vec4(.25, .35, .42, .55)));\n\n    // mirror\n    uv.x = abs(uv.x);\n    \n    vec4 eyes = Eye(within(uv, vec4(.06, -.1, .22, .13)));\n    vec4 mouth = Mouth(within(uv, vec4(-0.35, -0.45, 0.35, -0.1)));\n\n    col.rgb = mix(col.rgb, head.rgb, head.a);\n    col.rgb = mix(col.rgb, waterDrop.rgb, waterDrop.a);\n    col.rgb = mix(col.rgb, eyes.rgb, eyes.a);\n    col.rgb = mix(col.rgb, mouth.rgb, mouth.a);\n\n    return col;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n    // Normalized pixel coordinates (from 0 to 1)\n    vec2 uv = fragCoord.xy/iResolution.xy;\n    uv -= 0.5;    \n    uv.x *= iResolution.x / iResolution.y;\n\n    fragColor = Bean(uv);\n}\n","name":"Image","description":"","type":"image"}]}