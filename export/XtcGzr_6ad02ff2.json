{"ver":"0.1","info":{"id":"XtcGzr","date":"1467932697","viewed":1174,"name":"[SH16A] 589 Szcdng","username":"knarkowicz","description":"Wanted to share something earlier, but wasted a lot of time with the ray-traycing idea :(\nhttps://www.shadertoy.com/events/competition2016","likes":5,"published":3,"flags":0,"usePreview":0,"tags":["sizecoding","shadertoycompetition","sh16a"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"Xsf3zn","filepath":"/media/a/f735bee5b64ef98879dc618b016ecf7939a5756040c2cde21ccb15e69a6e1cfb.png","previewfilepath":"/media/ap/f735bee5b64ef98879dc618b016ecf7939a5756040c2cde21ccb15e69a6e1cfb.png","type":"texture","channel":0,"sampler":{"filter":"nearest","wrap":"repeat","vflip":"false","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// Thanks to coyote, fb39ca4, P_Malin and Stubbe for the awesome ideas\n#define V vec3(\n#define N normalize(V\n\nvoid mainImage( out vec4 Y, vec2 X )\n{\n\tvec3 \tv,\n        \t//v = iResolution,\n    \t\tu = V+1, 0, 0 ),\n    \t\tn = u,\n    \t\tp = V+2, .851, -2.87677 ),\n       \t \tc = N.2 * u + p ) ),\n        \td = N+cross( c, u ) ) );\n\n    // setup ray\n\tv = d = mat3( d, cross( d, c ), c ) * N+960, 540, 1080 ) - V+X, 0 ) );\n    //v = d = mat3( d, cross( d, c ), c ) * N.5 * v.xy - X, v.y ) );\n\n    // raymarch scene and shadows\n    for ( int i = 0; i < 128; ++i )\n        // nearest sphere\n        c = clamp( ceil( p - .5 ), -2., 2. ),\n\t\tc.x = .4 - .3 * fract( Y.w = c.y * 2.5 + c.z * .5 ),\n\n        p -= i == 63 ?\n                d = mod( p, 2. ) - 1.,\n                u = p.x > .1 ?\n                        // sphere color\n    \t\t\t\t\tn = N+p - c ) ),\n                        ceil( Y.w + 5.5 ) * V-8, 3, 6 ) * .02 + u + u\n                        :            \n                        // plane normal and color\n                        V.0 < d.y * d.z ? .8 : texture( iChannel0, p.yz * .1 ).x )\n                            * smoothstep( 0., .5, length( p - sign( c - c * n ) ) ), \n\n                // raymarch shadows                  \n                d = N-7, 6, 5 ) ),\n\t\t\t\td * .01\n\t\t\t\t: \n    \t\t\td * min( p, length( p - c ) - c ).x;\n    \n\n    // compute lighting\n    Y.xyz = sqrt( dot( -n, d ) * V.9 < p.x ) * \n        \t\t(\n            \t\tu * V.6, .51, .33 ) + pow( max( dot( reflect( v, n ), d ), 0. ), 16. )\n        \t\t)\n        + ++n.x * u * V.5, .7, 1 ) / 8.\n    );\n}","name":"Image","description":"","type":"image"}]}