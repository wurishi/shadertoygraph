{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[{"channel":0,"type":"texture","id":"Xsf3zn","filepath":"/media/a/f735bee5b64ef98879dc618b016ecf7939a5756040c2cde21ccb15e69a6e1cfb.png","sampler":{"filter":"mipmap","wrap":"repeat","vflip":"false","srgb":"false","internal":"byte"}}],"code":"//#define _DEBUG\nconst int kGridSize = 3; \n\nfloat Manhatan(vec2 dir)\n{\n\tfloat t = (1.+sin(iTime))*0.5;\n\tfloat manhattan = abs(dir.x)+abs(dir.y);\n\tfloat euclidean = sqrt(dot(dir,dir));\n\treturn mix(manhattan,euclidean,t);\n\t\n}\n\nvec3 sampleVoronoi(vec2 uv, float size)\n{\t\n\tfloat nbPoints = size*size;\n\tfloat m = floor(uv.x*size);\n\tfloat n = floor(uv.y*size);\t\t\t\n\t\n\tvec3 voronoiPoint = vec3(0.);;\t\t\t\n\tfloat dist2Max = 3.;\n\tconst float _2PI = 6.28318530718;\n\t\n\tfor (int i=-1; i<2; i++)\n\t{ \n\t\tfor (int j=-1; j<2; j++)\n\t\t{\n\t\t\tvec2 coords = vec2(m+float(i),n+float(j));\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\tfloat phase = _2PI*(size*coords.x+coords.y)/nbPoints;\n\t\t\tvec2 delta = 0.25*vec2(sin(iTime+phase), cos(iTime+phase));\n\t\t\tvec2 point = (coords +vec2(0.5) + delta)/size;\n\t\t\tvec2 dir = uv-point;\n\t\t\tfloat dist2 = Manhatan(dir);\t\t\t\t\t\t\t\t\t\t\n\t\t\tfloat t = 0.5*(1.+sign(dist2Max-dist2));\n\t\t\tvec3 tmp = vec3(coords/size,dist2);\n\t\t\tdist2Max = mix(dist2Max,dist2,t);\n\t\t\tvoronoiPoint = mix(voronoiPoint,tmp,t);\t\t\t\t\n\t\t}\n\t}\t\n\treturn voronoiPoint;\t\t\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\t\n\tvec2 uv = fragCoord.xy/iResolution.y;\n\tvec3 voronoi = sampleVoronoi(uv,float(kGridSize));\n\tfragColor = vec4(exp(-5.*voronoi.z)*texture(iChannel0, voronoi.xy).xyz,1.);\n}","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"Xs2GRd","date":"1392369548","viewed":301,"name":"Voronoi 3","username":"benito_luna","description":"Inspired by latest iq's voronoi shaders.\nMixing euclidean and manhattan distance function.","likes":1,"published":1,"flags":0,"usePreview":0,"tags":["voronoi","manhattan","euclidean"],"hasliked":0,"parentid":"","parentname":""}}