{"ver":"0.1","info":{"id":"XlGXDG","date":"1485605191","viewed":142,"name":"Line Test2","username":"pyalot","description":"testing if a pixel touches a line","likes":5,"published":1,"flags":0,"usePreview":0,"tags":["test"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"float gridSize = 20.0;\n\nfloat lineHit(vec2 start, vec2 end, vec2 pos, vec2 res){\n    return 0.0;\n}\n\nfloat grid(vec2 pos){\n    vec2 center = floor(pos)+0.5;\n    vec2 diff = abs(center-pos);\n    float dist = max(diff.x, diff.y);\n    float d = fwidth(dist)*2.0;\n    return smoothstep(0.5-d, 0.5+d, dist);\n}\n\nfloat line(vec2 pos, vec2 start, vec2 end){\n    vec2 a = normalize(end-start);\n    vec2 b = pos-start;\n    float f = dot(a,b);\n    vec2 nearest = start + a*f;\n    float dist = distance(pos, nearest);\n    return 1.0 - smoothstep(0.0, 1.0/gridSize, dist);\n}\n\nfloat min(vec2 value){\n    return min(value.x, value.y);\n}\n\nfloat max(vec2 value){\n    return max(value.x, value.y);\n}\n\nfloat hit(vec2 pos, vec2 origin, vec2 end){\n    pos = floor(pos)+0.5;\n    vec2 dir = end-origin;\n    vec2 t1 = (pos - 0.5 - origin)/dir;\n    vec2 t2 = (pos + 0.5 - origin)/dir;\n    \n    min(vec2(0), vec2(1));\n    \n\tfloat tmin = max(-1e15, max(min(t1, t2)));\n    float tmax = min(1e15, min(max(t1, t2)));\n    return step(tmin, tmax);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    \n    \n\tvec2 pos = gl_FragCoord.xy/gridSize;\n    vec2 center = floor(pos)+0.5;\n    float thickness = 2.0;\n    \n    vec2 start = vec2(10.5, 5.5);\n    vec2 end = iMouse.xy/gridSize;\n    \n    \n\tfloat g = grid(pos);\n    float l = line(pos, start, end);\n    float h = hit(pos, start, end);\n    \n    fragColor.rgb = (\n        g * vec3(0.25) +\n        l * vec3(0.5, 0, 0.5) +\n        h * vec3(0.25)\n    );\n    fragColor.a = 1.0;\n}","name":"Image","description":"","type":"image"}]}