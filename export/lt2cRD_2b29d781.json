{"ver":"0.1","info":{"id":"lt2cRD","date":"1507763630","viewed":412,"name":"- Funny Light - ","username":"FranciscoGarcia","description":"Another siemple test with FOV , raymarch and some ligthing. Try with other color to get interesting results, i liked this color too vec3(0.3, 0.2, 0.1);","likes":3,"published":1,"flags":0,"usePreview":0,"tags":["raymarch","fov","fakelight"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define EPS 0.001\n#define MAX 20.0\n#define STEPS 135\n#define PI 3.14159\n\nvec3 lig = vec3(0.0, 1.7, 0.4);\nconst float angle = 90.0;\nconst float fov = angle * 0.5 * PI / 180.0;\n\nfloat sph(in vec3 p) {\n  p.y -= 0.3*sin(5.0*p.x + 4.0*iTime);\n  return distance(p, vec3(0.0)) - 1.0;\n}\nfloat plane( in vec3 p) {\n  return p.y + 1.0;\n}\nfloat map(in vec3 p) {\n  float d1,d2;\n  d1 = sph(p);\n  d2 = plane(p);\n  return min(d1,d2);\n}\n\nvec3 normals(in vec3 p) {\n  vec2 e = vec2(EPS, 0.0);\n  vec3 gr = vec3( map(p + e.xyy) - map(p - e.xyy),\n                  map(p + e.yxy) - map(p - e.yxy),\n                  map(p + e.yyx) - map(p - e.yyx));\n  return normalize(gr);\n}\n\nfloat diffuse(in vec3 nor){\n  float diff;\n  \n  diff = max(0.0, dot(nor, -lig));\n  return diff;\n}\n\nfloat trace(in vec3 ro, in vec3 rd) {\n  float d, t;\n  d=1.0;\n  for( int i = 0; i<STEPS; i++) {\n    if (d < EPS) break;\n    d = map(ro+t*rd);\n    t += d;\n  }\n  return t;\n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = (fragCoord.xy*2.0 - iResolution.xy) / min(iResolution.x, iResolution.y);\n\n \tvec3 ro = vec3(0.0,-0.2, 2.5);\n  \tvec3 rd =  normalize(vec3(sin(fov) * uv.x, sin(fov) * uv.y, -cos(fov)));\n\n  \tvec3 col = vec3(0.0);\n  \tfloat tr = trace(ro, rd);\n    \n  \tif(tr < MAX){\n    vec3 pos = ro + tr*rd;\n    vec3 halfLE = normalize(lig-rd);\n    vec3 nor = normals(pos);\n    float dif = diffuse(nor);\n    float intFact = 2000.0;\n    float spec = pow(clamp(dot(halfLE, nor), 0.0, 1.0), intFact);\n    float ligShp = sph(pos);\n\n    col = vec3( dif + 0.2 / abs( 0.4 - ligShp*ligShp))*vec3(0.9) + spec;\n    col += vec3(0.1, 0.25, 0.25)*clamp(nor.y, 0.0, 0.8);\n    col *= exp(-tr*0.2);\n    \n  }\n    \n\tfragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}