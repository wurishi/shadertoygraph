{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[],"code":"mat3 rotateY(float a) {\n    float sa = sin(a), ca = cos(a);\n    return mat3(ca, 0.0, sa, 0.0, 1.0, 0.0, -sa, 0.0, ca);\n}\n\nfloat smin(float a, float b, float k) {\n    float h = clamp(0.5 + 0.5 * (b - a) / k, 0.0, 1.0);\n    return mix(b, a, h) - k * h * (1.0 - h);\n}\n\nfloat sdSphere(in vec3 p, in float r) {\n    return length(p) - r;\n}\n\nfloat sampleDistance(in vec3 p) {\n    float t = iDate.w * 2.0;\n    return smin(smin(\n        sdSphere(p - vec3(sin(t),cos(t),0.) * 2., 1.2),\n        sdSphere(p - vec3(0.,sin(t),cos(t)) * 3., 1.), 0.5),\n        sdSphere(p - vec3(cos(t),1.,sin(t)) * 1., 1.5), 0.5);\n}\n\nvec3 sampleNormal(in vec3 pos) {\n    float e = .01;\n\tfloat d = sampleDistance(pos);\n\treturn normalize(vec3(\n        (d + sampleDistance(pos + vec3(e, 0.0, 0.0))) / e,\n\t\t(d + sampleDistance(pos + vec3(0.0, e, 0.0))) / e,\n\t\t(d + sampleDistance(pos + vec3(0.0, 0.0, e))) / e));\n}\n\n#define CLOSE_ENOUGH 0.00001\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord) {\n\tfloat aspect = iResolution.x / iResolution.y;\n    vec2 uv = (fragCoord.xy / iResolution.xy) * 2.0 - 1.0;\n    uv.x *= aspect;\n    \n    mat3 viewMtx = rotateY(iDate.w);\n    \n   \tvec3 dir = normalize(vec3(uv, 1.0));\n    vec3 pos = vec3(0.0, 0.0, -5.0);\n    vec3 viewPos;\n\n    float d;\n    for (int i = 0; i < 100; ++i) {\n        viewPos = pos * viewMtx;\n        d = sampleDistance(viewPos);\n        pos += dir * d;\n        if (d < CLOSE_ENOUGH) break;\n    }\n    \n    if (d < CLOSE_ENOUGH) {\n        fragColor = vec4(sampleNormal(viewPos), 1.0);\n    }\n    else {\n        fragColor = vec4(dir, 1.0);\n    }\n}\n","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"4l23RR","date":"1426656826","viewed":190,"name":"Metaballs!","username":"notlion","description":"Just learning a little about raymarching :D","likes":3,"published":1,"flags":0,"usePreview":0,"tags":["learning"],"hasliked":0,"parentid":"","parentname":""}}