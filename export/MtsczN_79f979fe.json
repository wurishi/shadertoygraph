{"ver":"0.1","info":{"id":"MtsczN","date":"1503921141","viewed":551,"name":"Lego Style Shader","username":"FlexMonkey","description":"Lego blocks style shader - my first ever ShaderToy shader! Iterates over an array of Lego colors and adds highlights and shadows for stud and block borders.","likes":13,"published":1,"flags":0,"usePreview":0,"tags":["lego"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"Xdf3Rn","filepath":"/media/a/e81e818ac76a8983d746784b423178ee9f6cdcdf7f8e8d719341a6fe2d2ab303.webm","previewfilepath":"/media/ap/e81e818ac76a8983d746784b423178ee9f6cdcdf7f8e8d719341a6fe2d2ab303.webm","type":"video","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// Simon Gladman | http://flexmonkey.blogspot.co.uk/ | August 2017\n\n// http://www.brothers-brick.com/downloads/2010-LEGO-color-palette.pdf\nvec3 palette[] = vec3[](\n            vec3(255, 198, 0) / 255.0,\n            vec3(231, 99, 23) / 255.0,\n            vec3(233, 0, 12) / 255.0,\n            vec3(223, 56, 140) / 255.0,\n            vec3(0, 88, 168) / 255.0,\n            vec3(0, 124, 40) / 255.0,\n            vec3(150, 185, 12) / 255.0,\n            vec3(91, 29, 12) / 255.0,\n            vec3(214, 114, 65) / 255.0,\n            vec3(245, 245, 245) / 255.0,\n            vec3(255, 255, 155) / 255.0,\n            vec3(238, 158, 196) / 255.0,\n            vec3(136, 93, 235) / 255.0,\n            vec3(0, 151, 35) / 255.0,\n            vec3(218, 187, 123) / 255.0,\n            vec3(246, 194, 138) / 255.0,\n            vec3(229, 229, 218) / 255.0,\n            vec3(244, 156, 0) / 255.0,\n            vec3(156 , 0, 108) / 255.0,\n            vec3(71, 141, 199) / 255.0,\n            vec3(95, 117, 140) / 255.0,\n            vec3(95, 130, 101) / 255.0,\n            vec3(141, 116, 83) / 255.0,\n            vec3(169, 61, 21) / 255.0,\n            vec3(157, 147, 146) / 255.0,\n            vec3(128, 7, 27) / 255.0,\n            vec3(43, 22, 120) / 255.0,\n            vec3(0, 38, 65) / 255.0,\n            vec3(0, 52, 22) / 255.0,\n            vec3(170, 126, 86) / 255.0,\n            vec3(77, 81, 85) / 255.0,\n            vec3(48, 15, 6) / 255.0);\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 d = fragCoord.xy / iResolution.xy;\n\n    float aspect = iResolution.x / iResolution.y; \n    \n    vec2 pixelSize = vec2(0.03, 0.03 * aspect);\n    \n    vec2 halfPixelSize = pixelSize / 2.0; \n    vec2 borderWidth = pixelSize / 16.0;\n    \n    vec2 xy = vec2(floor(d / pixelSize)) * pixelSize;\n \n    vec3 originalColor = texture(iChannel0, xy).rgb;\n    \n    float colorDist = distance(originalColor.rgb, palette[0]);\n    vec3 returnColor = palette[0];\n    \n    for(int i = 1; i <= palette.length(); i++) {\n        \n        if (distance(originalColor.rgb, palette[i]) < colorDist) {\n            colorDist = distance(originalColor.rgb, palette[i]);\n            returnColor = palette[i];\n        }\n    }\n    \n   \n    // `xxyy` coordinates in `-halfPixelSize` to `halfPixelSize` with `(0,0)` in center\n    vec2 xxyy = d - xy - pixelSize * 0.5;\n    float dist = length(xxyy * vec2(1.0, 1.0 / aspect));\n    \n    bool isBorder = \n        xxyy.x  < -halfPixelSize.x + borderWidth.x || \n        xxyy.x > halfPixelSize.x - borderWidth.x || \n        xxyy.y < -halfPixelSize.y + borderWidth.y || \n        xxyy.y > halfPixelSize.y - borderWidth.y;\n\n    bool isStud = \n        dist > pixelSize.x * 0.3 && \n        dist < (pixelSize.x * 0.4) ;\n    \n\n    if (isBorder || isStud) {\n        vec3 lightPosition = normalize(vec3(-1.0, 1.0, 0.3));\n        \n        vec3 normal = normalize(vec3(xxyy, 1.0));\n        \n        float shadow = dot(normal, lightPosition * 4.0);\n        float specular = clamp((1.0 - length(normal.xy - lightPosition.xy)), 0.0, 1.0);\n        \n        returnColor = (returnColor + specular * 4.0) * shadow;\n    }\n  \t\n\tfragColor = vec4(returnColor, 1.0); \n}","name":"Image","description":"","type":"image"}]}