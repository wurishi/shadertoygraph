{"ver":"0.1","info":{"id":"mdjcWR","date":"1687624657","viewed":133,"name":"Vesica segment - Distance","username":"Poisson","description":"EXACT distance to an oriented vesica, no trig","likes":9,"published":1,"flags":0,"usePreview":0,"tags":["2d","distancefield","sdf","intersection","circle","distance","field","arc","circular","capsule","signed","exact","vesica","oriented"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// vesica segment sdf function, 4 square roots\nfloat sdVesicaSegment(vec2 p, vec2 a, vec2 b, float wi) {\n    float l = length(b-a); // distance between a and b\n    vec2 d = (b-a)/l; // direction of the segment\n    \n    p = p - (a+b)*.5; // center to mid point\n    p = mat2(d.x,-d.y, // rotation\n             d.y, d.x)*p;\n    p = abs(p); // symmetry\n        \n    float r = l*.5; // radius of the vesica\n    float h = sqrt(1.-wi*wi)/wi;\n        \n    return h*p.x>p.y+r*h ? length(p - vec2(r,0)) // caps\n                         : length(p + vec2(0,r*h)) - r/wi; // body\n}\n\n// simple vesica sdf\nfloat sdVesica(vec2 p, float ra, float rb, float d) {\n    p = abs(p);\n    \n    float r = ra-rb;\n    float h = sqrt(1.-d*d)/d;\n        \n    return (h*p.y>p.x+r*h ? length(p - vec2(0,r))\n                          : length(p + vec2(r*h,0))-r/d) - rb;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 p = 2.3*(fragCoord - .5*iResolution.xy) / iResolution.y;\n    vec2 m = 2.3*(iMouse.xy - .5*iResolution.xy) / iResolution.y;\n\n    vec2 a = cos(iTime*.5 + vec2(0,1));\n\tvec2 b = cos(iTime*.5 + vec2(0,3) + 1.5);\n    \n    float wid = .51+.49*sin(1.3*iTime); wid *= .8;\n    float ra = .07; // thickness\n    \n\tfloat d = sdVesicaSegment(p, a, b, wid) - ra;\n    \n\t// coloring\n    vec3 col = (d>0.) ? vec3(.9,.6,.3) : vec3(.55,.85,1);\n    col *= 1.-exp(-8.*abs(d));\n\tcol *= .8 + .2*cos(125.*d);\n\tcol = mix(col, vec3(1), smoothstep(.01,0.,abs(d)));\n\n    if (iMouse.z>0.) {\n        d = sdVesicaSegment(m, a, b, wid) - ra;\n        col = mix(col, vec3(1,1,0), smoothstep(.01,0., abs(length(p-m)-abs(d))-.0025));\n        col = mix(col, vec3(1,1,0), smoothstep(.01,0., length(p-m)-.015));\n    }\n        \n\tfragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}