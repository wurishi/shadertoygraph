{"ver":"0.1","info":{"id":"ttcBD8","date":"1612873503","viewed":135,"name":"Haru86_MengerSponge","username":"Haru86_","description":"Haru86_MengerSponge","likes":6,"published":1,"flags":0,"usePreview":0,"tags":["raymarching"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define PI 3.14159265\n#define rot(a) mat2(cos(a),sin(a),-sin(a),cos(a))\n\nvec2 pmod(vec2 p,float n)\n{\n    float a=(2.0*PI)/n;\n    float t=atan(p.x,p.y)-PI/n;\n    t=mod(t,a)-PI/n;\n    return vec2(length(p)*cos(t),length(p)*sin(t));\n}\n\nfloat Cube(vec3 p,float s)\n{\n    p=abs(p);\n    return length(max(p-vec3(s),0.0));\n}\n\nfloat sdCross(vec3 p)\n{\n    p=abs(p);\n    float dxy=max(p.x,p.y);\n    float dyz=max(p.y,p.z);\n    float dzx=max(p.z,p.x);\n    return min(dxy,min(dyz,dzx))-1.0;\n}\n\n\nfloat map(vec3 p)\n{\n    p.z+=iTime;\n    \n    //IFS\n    p.xy=pmod(p.xy,6.0);\n    float k=4.;\n    p=mod(p,k)-0.5*k;\n   \n    \n    //Modeling\n    float s=2.0;\n    float d=Cube(p,s);\n    float scale=6.0;\n    for(int i=0;i<6;i++)\n    {\n        p=mod(p,2.0)-1.0;\n        s*=scale;\n        p=1.0-scale*abs(p);\n        d=max(d,sdCross(p)/s);\n    }\n    \n    \n   \n\n    return d;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = (fragCoord*2.0-iResolution.xy)/min(iResolution.x,iResolution.y);\n   // uv*=rot(iTime);\n    vec3 col=vec3(0.);\n    \n    vec3 ta=vec3(0.0);\n   // vec3 ro=vec3(cos(iTime)*0.5,0.0,sin(iTime)*0.5);\n    vec3 ro=vec3(0.25,.25,1.0);\n    vec3 cDir=normalize(ta-ro);\n    vec3 cSide=cross(cDir,vec3(0.0,1.0,0.0));\n    vec3 cUp=cross(cDir,cSide);\n    float depth=1.0;\n    vec3 rd=vec3(uv.x*cSide+uv.y*cUp+depth*cDir);\n    \n    //vec3 rd=vec3(uv.xy,1.0);\n    \n    \n    float d,t,acc=0.0;\n    \n    for(int i=0;i<64;i++)\n    {\n        d=map(ro+rd*t);\n        if(d<0.0001)break;\n        t+=d;\n        acc+=exp(d);\n    }\n    \n    col=vec3(exp(-0.5*t));\n    col*=vec3(1.,0.,0.)*acc*0.04;\n    \n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}