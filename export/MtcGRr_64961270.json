{"ver":"0.1","info":{"id":"MtcGRr","date":"1467636405","viewed":118,"name":"layerSampleCatz","username":"jobjb","description":"adding samples for the cat","likes":0,"published":1,"flags":0,"usePreview":0,"tags":["sample","layer","catz"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dfGRn","filepath":"/media/a/8de3a3924cb95bd0e95a443fff0326c869f9d4979cd1d5b6e94e2a01f5be53e9.jpg","previewfilepath":"/media/ap/8de3a3924cb95bd0e95a443fff0326c869f9d4979cd1d5b6e94e2a01f5be53e9.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"Xsf3Rn","filepath":"/media/a/cbcbb5a6cfb55c36f8f021fbb0e3f69ac96339a39fa85cd96f2017a2192821b5.png","previewfilepath":"/media/ap/cbcbb5a6cfb55c36f8f021fbb0e3f69ac96339a39fa85cd96f2017a2192821b5.png","type":"texture","channel":2,"sampler":{"filter":"nearest","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4sf3Rn","filepath":"/media/a/0a40562379b63dfb89227e6d172f39fdce9022cba76623f1054a2c83d6c0ba5d.png","previewfilepath":"/media/ap/0a40562379b63dfb89227e6d172f39fdce9022cba76623f1054a2c83d6c0ba5d.png","type":"texture","channel":1,"sampler":{"filter":"nearest","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// Bruno Gohier - 09-02-2014\n\n// layers\nconst float layers=8.;\nconst float real_size = 2.5;\nconst vec2 scale = vec2(-.15,-1);\nconst vec2 size = scale * real_size;\n\n\n\n// test\nconst vec3 mag = vec3(0.,1.,0.);\nvec3 test = mag;\n\n\n\n// coord change\nvoid to01(inout vec2 v){v = v*.5+.5;}\nvoid to11(inout vec2 v){v = v*2.-1.;}\n\nvec2 ret11(vec2 v){ \n    to11(v);\n    return v;\n}\n\nvoid toSquare(inout vec2 v){ \n    // apect ratio\n    float ar = iResolution.x/iResolution.y;\n    //ar=.3;\n    v.x += 0.0 /ar -0.5;  \n    v.x *= ar;\n    v.y += 0.0 /ar -0.5;\n    v.y *= ar;\n}\nvoid demo_offset_circle(inout vec2 v, float offset){\n    float speed = 1.02;\n    float dis = 0.02;\n    float mx = dis*sin(iTime * speed + offset);\n    float my = dis*cos(iTime * speed + offset);\n    vec2 center = vec2(mx,my);\n    v+=center;\n}\n// rotate texcoords\nvoid spin(inout vec2 v, float o)\n{   \n    float dis = 0.0002;\n    float h = o*0.56;\n\tfloat t = iTime * 1.01+h;\n    float st = .05*cos(t);\n    //t=clamp(t,0.0,10.1);\n    float cosX = cos(st);\n\tfloat sinX = sin(st);\n    mat2 m = mat2(cosX,-sinX,sinX,cosX);\n    v-=0.5;\n    m*=.5;\n    m+=.5;\n    m=m*2.-1.;\n\tv = m*v;\n    v+=.5;\n}\n\n// create layer\nvoid addLayer(inout vec4 c,float d,vec2 uv,float s,float o, float i)\n{\n\t// wave uvs around\n\tvec2 st = uv + vec2(d ,0.);\n    //st = uv;\n    toSquare(st);\n    //demo_offset_circle(st,o);\n\tspin(st,o);\n\t// cats\n\tvec4 t = texture(iChannel2,st);\n\t\n\t// set white as tranparent\n\tfloat ta = step(dot(t.rgb,vec3(.3,.59,.21)),.9);\n\tta *= (i+1.)/layers;\n\tfloat aa = exp(ta)-1.;\n\tfloat mixer = clamp(aa,0.,1.);\t\n\t\n\t// smoke\n\tvec4 t2=texture(iChannel1,uv+vec2(0.,.5*iTime));\n\tfloat t2a = dot(t2.rgb, vec3(.3,.59,.21));\n\tt2a += i/layers;\n\t\n\t// change hue\n\tvec3 hue = mix(vec3(1.,1.,0.),vec3(1,.0,0.),4.*(layers-i)/layers);\n\tt.rgb *= hue;\n\t\n\t// burn\n\tc.rgb *= (i/layers)*vec3(1.);\n\tc.rgb = mix(c,t,mixer).rgb;\n\t\n\t// accumulative alpha\n\tc.a = clamp(t2a*(c.a + ta),0.,1.5);\n}\n\t\n// main\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 uv = fragCoord.xy / iResolution.xy;\n\tuv.y = 1. - uv.y;\n\t\n\t// out color\n\tvec4 c = vec4(0.);\n\t\n\t// create layers\n\tfor(float i=0.;i<layers;i+=1.)\n\t\taddLayer(c, i*0.0003, uv, 0.002, 0.05 * i, i);\n\t\n\t// heat shimmers\n    float heat_speed = 0.21;\n    \n    vec2 heat_action = vec2(heat_speed*iTime, .0);\n\tvec4 t2=texture(iChannel0, uv + heat_action.yx);\n\t\n    float t2a = dot(t2.rgb,vec3(.3,59.,21));\n\tvec2 hs = vec2(t2a*0.002,0.);\n\t\n    //vec4 t3=texture(iChannel2,uv+hs.xy);\n\tvec4 t3=texture(iChannel0,uv);\n\n\t// blend background\n\tc.rgb = mix(t3,c,c.a).rgb;\n\tc = clamp(c,0.,1.);\n\t\n\t// vignette\n\t//c.r += 1.95*dot(uv-vec2(.5),uv-vec2(.5));\n\t\n\tfragColor = c;\n\t\n\t//===============\n\t\n\t//if(test != mag)\n\t//\tfragColor = vec4(test,1.);\n}","name":"Image","description":"","type":"image"}]}