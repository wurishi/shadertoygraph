{"ver":"0.1","info":{"id":"Wsc3zH","date":"1567730536","viewed":143,"name":"Truchet Gut","username":"badjano","description":"Truchet Gut","likes":6,"published":1,"flags":0,"usePreview":0,"tags":["truchet","layers"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4df3Rr","filepath":"/media/a/3871e838723dd6b166e490664eead8ec60aedd6b8d95bc8e2fe3f882f0fd90f0.jpg","previewfilepath":"/media/ap/3871e838723dd6b166e490664eead8ec60aedd6b8d95bc8e2fe3f882f0fd90f0.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define pi 3.14159265359\n#define hash_const 43758.5453\n\nfloat  hash11( float  p ) {\n    return fract(sin(p*hash_const + hash_const)*hash_const)*2.-1.;\n}\n\nfloat hash21(vec2 p){\n    return fract(sin(dot(p,vec2(127.1,311.7))*hash_const)*hash_const);\n}\n\nvec4 truchet(vec2 uv, float phase, float random){\n\n    float width = sin(length(uv)*2. - phase*2.)*.05+.15;\n    \n    vec2 id = floor(uv);\n    vec2 gv = fract(uv)-.5;\n    \n    float b = step(.5,hash21(id+random))*2.-1.;\n    gv *= vec2(b,1.);\n    float c = sign(gv.x+gv.y+.001);\n\tgv = gv-c*vec2(.5);\n    float d = length(gv);\n    float checker = mod(id.x+id.y,2.)*2.-1.;\n    float mask = smoothstep(width+0.01,width,abs(d-.5));\n    \n\tfloat y = fract((d*b*checker)*2.-2.5*width);\n    float x = fract(c+checker*(atan(gv.x,gv.y)+pi)/pi - phase*.1);\n\treturn vec4(vec2(x,y),mask,1.-abs(d-.5)*2.);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = (fragCoord-.5*iResolution.xy)/iResolution.y;\n    float a = -iTime*.1;\n    uv = mat2(cos(a),sin(a),-sin(a),cos(a))*uv*100.; // rotation\n    \n    vec4 col = vec4(0.);\n    \n    float t = iTime;\n    float interDistance = 0.3;\n    \n    for (int i=0;i<10;i++){\n        float fi = float(i+1);\n        float id = fi-floor(t);\n        float z = fi+fract(t);\n        float s = interDistance - z*.1*interDistance;\n        float opacity = 1.-s/interDistance;\n        float h = hash11(id);\n\n        float rh = h+iTime*.00001;\n        mat2 rRot = mat2(cos(rh),sin(rh),-sin(rh),cos(rh));\n        vec2 uv2 = uv + sin(rRot * vec2(iTime,iTime*1.5))*abs(z-10.)*5.;\n        uv2 *= s;\n\t    vec4 truchet = truchet(uv2, t*3.+h, h);\n        vec4 tx = texture(iChannel0,truchet.xy)*pow(opacity,5.);\n\t\tcol = mix(col,tx*pow(truchet.w,2.),truchet.z*smoothstep(10.,9.9,z));\n    }\n    \n    fragColor = col;\n}","name":"Image","description":"","type":"image"}]}