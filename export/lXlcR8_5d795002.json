{"ver":"0.1","info":{"id":"lXlcR8","date":"1725861431","viewed":41,"name":"3d plane","username":"lbl","description":"3d plane","likes":0,"published":1,"flags":0,"usePreview":0,"tags":["3dplane"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"Xdf3zn","filepath":"/media/a/85a6d68622b36995ccb98a89bbb119edf167c914660e4450d313de049320005c.png","previewfilepath":"/media/ap/85a6d68622b36995ccb98a89bbb119edf167c914660e4450d313de049320005c.png","type":"texture","channel":0,"sampler":{"filter":"nearest","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\nstruct Cam {\n    vec3 pos,dir;\n    vec3 r,u;\n}cam;\n\n/**\n* 射线到点距离： https://blog.csdn.net/LIQIANGEASTSUN/article/details/119598965\n*/\nvoid mainImage( out vec4 O, in vec2 C ) {\n    vec2 uv = C / iResolution.xy * 2. - vec2(1.) ; //(C - .5 * iResolution.xy) /( iResolution.xy);\n    // 坐标系使用的是向屏幕外为正方向 （右手系）\n    vec3 q  = vec3(0.,0.,-1.);  /* 平面法线 */\n    vec3 p1 = vec3(0.,0.,-1.); /* 平面上点坐标 */\n    // vec3 p1 = vec3(0.,0.,0.); /* 平面上点坐标 */\n\n    float t = iTime * .5;\n    /**\n    摄像机相关参考： https://learnopengl-cn.github.io/01%20Getting%20started/09%20Camera/\n    */\n    cam.pos =   2. * vec3(sin(t),0.,cos(t));  // 相机位置\n    cam.dir = normalize(vec3(0.,0.,0.) - cam.pos);          // 相机方向\n    // cam.dir = normalize(vec3(0.,0.,-1.)  );          // 相机方向\n    cam.r   = normalize(cross(cam.dir,vec3(0,1.,0))); //相机右向量\n    cam.u   = normalize(cross(cam.r,cam.dir));        // 相机上向量\n    /**\n    *  射线方向 （最终射线方程： cam.pos + d ） \n    */\n    vec3 d  = normalize(uv.x * cam.r + uv.y * cam.u + 1. * cam.dir);\n    /**\n    * 可以想象成把屏幕贴点摄像机镜头上的\n    */\n    /* 射线和面相交： https://www.cnblogs.com/graphics/archive/2009/10/17/1585281.html */\n    float k = (dot(q,p1) -  dot(q,cam.pos)) / dot(q,d);\n    if(k > 0.) {\n        vec3  p = cam.pos + k * d;\n    // p.xy = uv;\n        if(abs(p.x) <= 1. && abs(p.y) <= 1. ) {\n            O = vec4(p.x,p.y,0.,1.);\n            O = texture(iChannel0,(p.xy + 1.)/2.);\n        }else {\n            O = vec4(0.);\n        }        \n    }else {\n        O = vec4(0.);\n    }\n\n}\n","name":"Image","description":"","type":"image"}]}