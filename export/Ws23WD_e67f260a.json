{"ver":"0.1","info":{"id":"Ws23WD","date":"1548906358","viewed":515,"name":"Molten core","username":"LordSk","description":"A simple deformed sphere.","likes":7,"published":1,"flags":0,"usePreview":0,"tags":["raymarching","lava"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XdXGzr","filepath":"/media/a/8979352a182bde7c3c651ba2b2f4e0615de819585cc37b7175bcefbca15a6683.jpg","previewfilepath":"/media/ap/8979352a182bde7c3c651ba2b2f4e0615de819585cc37b7175bcefbca15a6683.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define pi (3.14159265358979323846)\n#define EPSILON (0.0001)\n\nvec2 rotate(vec2 v, float a)\n{\n  float c = cos(a);\n  float s = sin(a);\n  return vec2(\n    v.x*c-v.y*s,\n    v.x*s+v.y*c\n  );\n}\n\nfloat sphere(vec3 p, float r)\n{\n  return length(p)-r;\n}\n\nfloat scene(vec3 p)\n{\n  float b = sphere(p, 1.6);\n  if(b > 0.001) return b; // optimisation\n\n  vec3 disp = vec3(0);\n  float f = 0.5;\n  disp.x = texture(iChannel0, p.zy * 0.05 + iTime * 0.02).x * f;\n  disp.z = texture(iChannel0, p.xy * 0.05 + iTime * 0.03).z * f;\n  disp.y = texture(iChannel0, p.xz * 0.05 + iTime * 0.04).y * f;\n\n  return sphere(p + disp, 1.0 + sin(iTime*2.4) * 0.15);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n  vec2 uv = vec2(fragCoord.x / iResolution.x, fragCoord.y / iResolution.y);\n  uv -= 0.5;\n  uv /= vec2(iResolution.y / iResolution.x, 1);\n\n  vec3 cam = vec3(0, -0.15, -3.5);\n  vec3 dir = normalize(vec3(uv,1));\n\n  float cam_a2 = sin(iTime) * pi * 0.1;\n  cam.yz = rotate(cam.yz, cam_a2);\n  dir.yz = rotate(dir.yz, cam_a2);\n\n  float cam_a = iTime * pi * 0.1;\n  cam.xz = rotate(cam.xz, cam_a);\n  dir.xz = rotate(dir.xz, cam_a);\n\n  vec3 color = vec3(0.16, 0.12, 0.10);\n  float t = 0.00001;\n  const int maxSteps = 128;\n  for(int i = 0; i < maxSteps; ++i) {\n      vec3 p = cam + dir * t;\n      float d = scene(p);\n\n      if(d < 0.0001 * t) {\n          color = vec3(1.0, length(p) * (0.6 + (sin(iTime*3.0)+1.0) * 0.5 * 0.4), 0);\n          break;\n      }\n\n      t += d;\n  }\n\n  fragColor.rgb = color;\n  fragColor.a = 1.0;\n}","name":"Image","description":"","type":"image"}]}