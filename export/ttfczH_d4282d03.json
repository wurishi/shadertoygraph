{"ver":"0.1","info":{"id":"ttfczH","date":"1591408214","viewed":171,"name":"people","username":"stb","description":"inspired by recent events","likes":12,"published":1,"flags":0,"usePreview":0,"tags":["2d","sdf","complex","conformal","functions","smin"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"/*\n\tpeople\n\tstb 2020\n\tNot golfed... or very tidy for that matter.\n*/\n\n#define PI 3.14159265\n#define T .7 * iTime\n\nconst float Rpt\t= 7.;\nconst float Sm\t= .5;\n\n// iq's polynomial smooth min;\nfloat smin( float a, float b, float k )\n{\n    float h = clamp( 0.5+0.5*(b-a)/k, 0.0, 1.0 );\n    return mix( b, a, h ) - k*h*(1.0-h);\n}\n\n// conformal function\nvec2 spiral(vec2 p, vec2 m) {\n    vec2 ri = vec2(log(length(p)), atan(p.y, p.x));\n    ri = vec2(ri.y*m.x-ri.x*m.y, ri.y*m.y+ri.x*m.x);\n    return ri / PI / 4.;\n}\n\n// a clunky, but working line function\nfloat line(in vec2 p, vec2 p0, vec2 p1) {\n    vec2 d\t= normalize(p1-p0);\n    float l\t= .5 * length(p1-p0);\n    p -= p0;\n    if(distance(p0, p1)>0.) {\n    \tp\t= mat2(d.y, d.x, -d.x, d.y) * p;\n\t    p.y\t= max(0., abs(p.y-l)-l);\n    }\n    return length(p);\n}\n\n// repeating humanoid sdf\nfloat map_(in vec2 p) {\n    float f;\n    vec3 o = vec3(-1., 0., 1.);\n    \n    // repetition\n    p.x = mod(p.x, 2.*Rpt)-Rpt;\n    \n    // head, body\n    f = smin(length(p-1.4*o.yz)-.5, line(p, o.yy, o.yx)-.5, Sm);\n    \n    // symmetry\n    vec2 p2 = vec2(abs(p.x), p.y);\n    \n    // arms\n    f = smin(f, line(p2, vec2(.5, 0.), vec2(2.7, .5))-.1, Sm);\n    \n    // legs\n    f = smin(f, line(p2, vec2(.5, -1.5), vec2(1., -4.))-.1, Sm);\n    \n    return f;\n}\n\n// smin() two repeating sdfs...\nfloat map(in vec2 p) {\n    p.x -= 10. * T;\n    return max(0., smin(map_(p), map_(p-vec2(Rpt, 0.)), 1.5));\n}\n\n// one spiral strip\nfloat map_spiral(in vec2 p, float o, inout vec3 col) {\n    p = spiral(p, vec2(12., 4.));\n    \n    p.y += o;\n    p.y = mod(-p.y, 2.) - 1.;\n    \n    col += .2 + .2 * vec3(sin(T*PI+PI*p.x/3.), cos(T*PI/3.+PI*p.x+1.712), sin(T*PI+PI*p.x/3.+2.2));\n    \n    return map(2.*Rpt*p);\n}\n\nvoid mainImage( out vec4 fo, in vec2 fc ) {\n\tvec2 res = iResolution.xy;\n\tvec2 p = (fc-res/2.) / res.y;\n\tvec2 uv = fc / res;\n\tp *= 24.;\n    \n    vec3 col = vec3(1.);\n    \n    // smin() two spiral strips\n    float m = smin(map_spiral(p, .25*T, col), map_spiral(p, .25*T+1., col), 2.);\n    \n    // ops\n    float f = 1. - pow(m, .7)/4.;\n    f += .05 * abs(fract(1./exp(m)*11.+T)-.5) * length(col) - .25;\n    f += max(0., 1.-.4*pow(length(p), .5))*(1.+.5*cos(iTime));\n    \n    // sinal output\n\tfo = vec4(col*vec3(f), 1.);\n}","name":"Image","description":"","type":"image"}]}