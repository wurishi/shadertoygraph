{"ver":"0.1","info":{"id":"MsycDR","date":"1521583505","viewed":159,"name":"Quaternion Collatz Cross Section","username":"rodolphito","description":"Quaternion Collatz Cross Section, try the mouse.\n\nThe mouse changes what cross section of the 4D fractal to display.\n\nComment line 41 to get the more familiar side view.","likes":0,"published":1,"flags":0,"usePreview":0,"tags":["fractal","quaternion","collatz"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"const float pi  = 4.0*atan(1.0);\n\n#define fractalIters 7\n\nvec4 qadd(vec4 a, float b)\n{\n    return vec4(a.xyz,a.w+b);\n}\n\nvec4 qmul(vec4 a, vec4 b)\n{\n\treturn vec4(\n        b.x*a.w + b.w*a.x + b.z*a.y - b.y*a.z,\n        b.y*a.w - b.z*a.x + b.w*a.y + b.x*a.z,\n        b.w*a.w - b.x*a.x - b.y*a.y - b.z*a.z,\n        b.z*a.w + b.y*a.x - b.x*a.y + b.w*a.z\n    );\n}\n\nvec4 qmulj(vec4 q)\n{\n    return vec4(-q.z, q.w, q.x, -q.y);\n}\n\nvec4 qexp(vec4 q)\n{\n    float len = length(q.xyz);\n    q.xyz /= len;\n    return exp(q.w)*vec4(q.xyz*sin(len), cos(len));\n}\n\nvec3 project(vec4 n)\n{\n    return n.yzw*inversesqrt(n.x*2.0 + 2.0);\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord)\n{\n    vec4 z = 2.5*(vec4(fragCoord, iMouse.xy) * 2.0 - iResolution.xyxy) / iResolution.y;\n    if (iMouse.xy == vec2(0.0,0.0)) z.zw = 0.1*sin(iTime + vec2(0.0, pi*0.5));\n    z = z.xwyz;  //Comment for side view\n    vec4 dz = vec4(0.0,0.0,0.0,1.0);\n    for(int i = 0; i < fractalIters; i++)\n    {\n        vec4 pz, z4, nz;\n        z4 = qadd(1.25*z, 0.5 );\n        pz =-qexp(qmulj(pi*z));\n        nz = qmulj(pi*z4);\n        nz = qadd(    nz, 1.25);\n        nz = qmul(    nz, pz  );\n        nz = qadd(    nz, 1.75);\n        dz = qmul(    nz, dz  );\n        //if (dz != dz) break;\n        z  = qadd(1.75*z, 0.5 );\n        z += qmul(    pz, z4  );\n    }\n    vec3 col = project(normalize(z)) * 0.5 + 0.5;\n    fragColor = vec4(1.0-pow(1.0-col,vec3(1.0-0.00000000000001*dot(z,z))),1.0);\n}","name":"Image","description":"","type":"image"}]}