{"ver":"0.1","info":{"id":"ssScWG","date":"1643989540","viewed":110,"name":"emelord","username":"namanonamako","description":"raymarch","likes":6,"published":1,"flags":0,"usePreview":0,"tags":["raymarch"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\n\nprecision highp float;\n\n#define resolution iResolution\n#define time iTime\n\nuniform vec2 mouse;\n\nconst float PI = acos(-1.);\n\nmat2 rot(float a){\n\tfloat s = sin(a), c = cos(a);\n\treturn mat2(c, s, -s, c);\n}\n\nfloat rand(vec2 p){\n\treturn fract(sin(dot(p, vec2(321.52, 92.324))) * 5321.532);\n}\n\nfloat sdBox(vec3 p, vec3 b){\n\tvec3 d = abs(p) - b;\n\treturn length(max(d, 0.)) + min(max(max(d.x, d.y), d.z), 0.);\n}\n\nfloat sdSphere(vec3 p, float r){\n\treturn length(p) - r;\n}\n\nfloat map(vec3 p){\n\tvec3 q = p;\n\tp = mod(p, 2.) - 1.;\n\tfloat s = 1.;\n\t\n\tfloat t = floor(time) + smoothstep(.5, .7, fract(time));\n\tp.z += sin(p.z) * .2;\n\tfor(int i = 0; i < 5; i++){\n\t\tp = abs(p) - .3;\n\t\tp.xy *= rot(.6);\n\t\tp = abs(p) - .1;\n\t\tp.xz *= rot(.28 * t);\n\t\tp *= 1.5;\n\t\ts *= 1.5;\n\t}\n\tq.xy *= rot(PI / 4.);\n\tq = abs(q);\n\tfloat d1 = max(q.x, q.y) - .1;\n\treturn max(-d1, sdBox(p, vec3(.2, .1, .2)) / s);\n}\n\nvec3 genNormal(vec3 p){\n\tvec2 d = vec2(0.01, 0.);\n\treturn normalize(vec3(\n\t\tmap(p + d.xyy) - map(p - d.xyy),\n\t\tmap(p + d.yxy) - map(p - d.yxy),\n\t\tmap(p + d.yyx) - map(p - d.yyx)\n\t\t));\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ){\n\n\tvec2 p = ( fragCoord.xy * 2. - resolution.xy ) / min(resolution.x, resolution.y);\n\n\tvec3 col = vec3(0.0);\n\t\n\tvec3 cp = vec3(0., 0., -2. + time);\n\tvec3 t = vec3(0., 0., 0. + time);\n\tvec3 f = normalize(t - cp);\n\tvec3 u = vec3(0., 1., 0.);\n\tvec3 s = normalize(cross(u, f));\n\tu = normalize(cross(f, s));\n\tvec3 rd = normalize(p.x * s + p.y * u + f * (1. + .05 * (1. - dot(p, p))));\n\t\n\tfloat dd, d;\n\tint k;\n\tfloat ac;\n\t\n\tcp += rand(p * time) * rd * .1;\n\t\n\tfor(int i = 0; i < 100; i++){\n\t\tdd = map(cp + d * rd);\n\t\tif(dd < 0.001){\n\t\t\tbreak;\n\t\t}\n\t\tac += exp(-d * .3);\n\t\tk = i;\n\t\td += dd;\n\t}\n\tcol += 1.-float(k) / 100.;\n\tcol -= ac * 0.1 * vec3(1., .1, .2);\n\t\t\n\tvec3 ip = cp + d * rd;\n\t\n    col = mix(vec3(1.), col, exp(-.1 * d));\n\tcol = pow(col, vec3(0.4545));\n\tfragColor = vec4(col, 1.0 );\n\n}","name":"Image","description":"","type":"image"}]}