{"ver":"0.1","info":{"id":"WdcyDs","date":"1601949015","viewed":76,"name":"Normal Map Stuff by Flyguy-v3","username":"jorge2017a1","description":"Normal Map Stuff by Flyguy-v3","likes":3,"published":1,"flags":0,"usePreview":0,"tags":["normalmapstuffbyflyguyv3"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"/* Normal Map Stuff */\n/* By: Flyguy */\n/* With help from http://stackoverflow.com/q/5281261 */\n\n// fancified a bit by psonice\n\n#define PI 3.141592\nvec2 mouse;\n\nvec3 heightmap(vec2 position)\n{\n\tfloat row = floor((position.y-15.)/100.);\n\tif (mod(row, 2.0) < 1.0)\n\t\tposition.x += 50.;\n\t\n\tfloat height = 0.0;\n\t\n\theight = sin(position.x*0.0625);\n\theight = clamp(height,0.0,0.5);\n\theight += clamp(sin(position.y*0.0625),0.0,1.0);\n\theight = clamp(height,0.0,0.5);\n\theight = 1.0 - height;\n\t\n\theight += height > 0.75 ? (max(acos(sin(position.x * .125 - PI * .5)) + asin(cos(position.y * .5 + PI)), 0.5) - 1.) * .25 : 0.;\n\t\n\theight -= height > 0.0 && height < 0.51 ? (max(sin(position.x * .5 + PI * .5) + cos(position.y * .5 - PI *2.), 1.25) - 2.0) * 0.75 : 0.;\n\t\n\treturn vec3(position,height);\n}\n\t\nvec3 n1,n2,n3,n4;\nvec2 size = vec2(-0.4,0.0);\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\t\n    mouse.x=0.5+0.25*cos(iTime);\n    mouse.y=0.5+0.25*sin(iTime);\n    \n\tvec2 pos = gl_FragCoord.xy;\n\n\tvec3 color = vec3(0.0);\n\t\n\tvec2 off = vec2(pos.x,pos.y-1.0);\n\t\n\tn1 = heightmap(off);\n\t\n\toff = vec2(pos.x-1.0,pos.y);\n\t\n\tn2 = heightmap(off);\n\t\n\toff = vec2(pos.x+1.0,pos.y);\n\t\n\tn3 = heightmap(off);\n\t\n\toff = vec2(pos.x,pos.y+1.0);\n\t\n\tn4 = heightmap(off);\n\t\n\tvec3 va = normalize(vec3(size.xy,n2.z-n3.z));\n\tvec3 vb = normalize(vec3(size.yx,n1.z-n4.z));\n\t\n\tvec3 p2m = vec3(-((pos/iResolution.xy)-mouse.xy)*iResolution.xy,64.0);\t\n\t\n\tvec3 normal = vec3(cross(va,vb));\n\t\n\tcolor = vec3(dot(normal.xyz, p2m)/96.0);\n\t\n\tcolor *= vec3(clamp(1.0-distance(mouse.xy*iResolution.xy,pos)/iResolution.x*2.0,0.0,1.0));\n\t\n\tfragColor = vec4( vec3( color ), 1.0 );\n\n}\n\n","name":"Image","description":"","type":"image"}]}