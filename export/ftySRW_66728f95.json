{"ver":"0.1","info":{"id":"ftySRW","date":"1640226908","viewed":335,"name":"volatile lava","username":"Carandiru","description":"based on  [url=https://www.shadertoy.com/user/lomateron]lomateron[/url] code, with help from [url=https://www.shadertoy.com/user/davidar]davidar[/url] code investigation.\nlearning from the wizards... breaking down and figuring out (somewhat) the magic.","likes":11,"published":3,"flags":32,"usePreview":0,"tags":["lava","automata","cellular"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XdfGR8","filepath":"/media/previz/buffer03.png","previewfilepath":"/media/previz/buffer03.png","type":"buffer","channel":3,"sampler":{"filter":"linear","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsBSR3","filepath":"/media/a/cb49c003b454385aa9975733aff4571c62182ccdda480aaba9a8d250014f00ec.png","previewfilepath":"/media/ap/cb49c003b454385aa9975733aff4571c62182ccdda480aaba9a8d250014f00ec.png","type":"texture","channel":0,"sampler":{"filter":"nearest","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// based on lomateron code, ( https://www.shadertoy.com/view/slcGRX ) \n// with help from davidar's code investigation. ( https://www.shadertoy.com/view/NldXWf )\n\n#define LUMA vec3(0.2126f, 0.7152f, 0.0722f)\n\n// https://www.shadertoy.com/view/WlfXRN\nvec3 inferno(float t) {\n\n    const vec3 c0 = vec3(0.0002189403691192265, 0.001651004631001012, -0.01948089843709184);\n    const vec3 c1 = vec3(0.1065134194856116, 0.5639564367884091, 3.932712388889277);\n    const vec3 c2 = vec3(11.60249308247187, -3.972853965665698, -15.9423941062914);\n    const vec3 c3 = vec3(-41.70399613139459, 17.43639888205313, 44.35414519872813);\n    const vec3 c4 = vec3(77.162935699427, -33.40235894210092, -81.80730925738993);\n    const vec3 c5 = vec3(-71.31942824499214, 32.62606426397723, 73.20951985803202);\n    const vec3 c6 = vec3(25.13112622477341, -12.24266895238567, -23.07032500287172);\n\n    return c0+t*(c1+t*(c2+t*(c3+t*(c4+t*(c5+t*c6)))));\n\n}\n\n\nvoid mainImage( out vec4 r, in vec2 u )\n{\n    vec4 a = Du;\n\n    // colorization //\n    r = a.z+(iTime * 9.0f)*a.z*exp(-length(a.xy)+vec4(1,2,3,0));\n    \n    float grey = dot(clamp(r.rgb, vec3(0), vec3(1)), LUMA);\n    \n    vec3 color = vec3(0);\n    \n    color = inferno(grey);\n    \n    r.rgb = color * color * (2.0f) + textureLod(iChannel0, u/1024.0f, 0.0f).r * (17.0f/255.0f); // more colors!\n    r.a = 1.0f;\n}","name":"Image","description":"","type":"image"},{"inputs":[],"outputs":[],"code":"#define R iResolution.xy\n#define GRID vec2(1,1)\n#define CELL ivec2(GRID * u/R)\n\n// convolutions\n#define CONV(z) for(int i=-z; i<=z; ++i) for(int j=-z; j<=z; ++j)\n#define CONVO(z) CONV(z) if(0. < length(ij) && length(ij) <= float(z))\n\n#define UVCOORD(u) ((vec2(CELL) + fract(GRID * (u)/R)) / GRID)\n#define A(u) texture(iChannel0,UVCOORD(u))\n#define B(u) texture(iChannel1,UVCOORD(u))\n#define C(u) texture(iChannel2,UVCOORD(u))\n#define D(u) texture(iChannel3,UVCOORD(u))\n\n#define Au A(u)\n#define Bu B(u)\n#define Cu C(u)\n#define Du D(u)\n\n#define Ai A(u+ij)\n#define Bi B(u+ij)\n#define Ci C(u+ij)\n#define Di D(u+ij)\n\n#define Ad (Ai - Au)\n#define Bd (Bi - Bu)\n#define Cd (Ci - Cu)\n#define Dd (Di - Du)\n\n// rotation\n#define rot90(b) ((b).yx * vec2(-1,1))\n\n// safe division\n#define normz(v) (length(v) == 0. ? v : normalize(v))\n#define recip(s) ((s) == 0. ? 1. : 1./(s))\n\n#define ij vec2(i,j)\n#define nij normz(ij)\n#define lij length(ij)\n\n// gaussian\n#define G(c) exp(-dot(c,c))","name":"Common","description":"","type":"common"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"nearest","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XdfGR8","filepath":"/media/previz/buffer03.png","previewfilepath":"/media/previz/buffer03.png","type":"buffer","channel":3,"sampler":{"filter":"linear","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"#define Dp vec2(dot(nij, Dd.xy), dot(nij, rot90(Dd.xy)))\n\nvoid mainImage( out vec4 r, in vec2 u )\n{\n    r = vec4(0);\n\n    CONV(8) r += .375 * lij * G(.375 * ij) * vec4(nij * Dd.z, Dp * Di.z);\n}","name":"Buffer A","description":"","type":"buffer"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"nearest","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4sXGR8","filepath":"/media/previz/buffer02.png","previewfilepath":"/media/previz/buffer02.png","type":"buffer","channel":2,"sampler":{"filter":"nearest","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XdfGR8","filepath":"/media/previz/buffer03.png","previewfilepath":"/media/previz/buffer03.png","type":"buffer","channel":3,"sampler":{"filter":"nearest","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"XdfGR8","channel":0}],"code":"void mainImage( out vec4 r, in vec2 u )\n{\n    r = vec4(0);\n\n    CONV(8) r += G((Ci.xy - ij)) * vec4(Ci.xyz, 1);\n    r.xy *= recip(r.w); // important\n\n    int scales[9] = int[](0,22,4,4,8,16,8,8,2);\n    float scale = float(scales[2]);\n    if(iMouse.z>0.) {\n        vec2 m = scale*(u-iMouse.xy)/R.y;\n        r += vec4(m,0,0)*G(m)*.1; // mouse press weighted add/seed\n    }\n    if(iFrame < 2) {\n        vec2 m = scale * (u/R - 0.5);\n        r = vec4(m,1,1)*G(m);\n    }\n}","name":"Buffer D","description":"","type":"buffer"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"nearest","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4sXGR8","filepath":"/media/previz/buffer02.png","previewfilepath":"/media/previz/buffer02.png","type":"buffer","channel":2,"sampler":{"filter":"nearest","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XdfGR8","filepath":"/media/previz/buffer03.png","previewfilepath":"/media/previz/buffer03.png","type":"buffer","channel":3,"sampler":{"filter":"linear","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4sXGR8","channel":0}],"code":"void mainImage( out vec4 r, in vec2 u )\n{\n    r = vec4(0);\n    float w = 1.;\n\n    r = Du;\n    r += Au * (max(0.0f, dot(Du, Au)) * Du.z - 0.5f);\n    w = .5;\n\n    float s = 0.;\n    CONV(8) s += G(w * (r.xy + ij));\n    r = vec4(r.xy, recip(s), 0);\n}","name":"Buffer C","description":"","type":"buffer"}]}