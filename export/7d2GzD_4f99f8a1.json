{"ver":"0.1","info":{"id":"7d2GzD","date":"1617135063","viewed":402,"name":"First fluid sim","username":"dysangel","description":"tried reimplementing one of wyatt's concise fluid sims. Basically ended up just copy and pasting his code before discovering I had a display bug rather than a physics bug!\n\nMaybe try https://github.com/KnairdA/compustream/tree/master/src/buffer/vertex","likes":3,"published":1,"flags":32,"usePreview":0,"tags":["fluidsim","wyatt"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"Main\n{\n    vec4 b = texture(iChannel0, U/R);\n    Q = abs(sin((b.w + b + (2. * vec4(sin(-b.x),sin(b.y),sin(b.x),1.)))));\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"Main\n{\n    Neighborhood;\n    \n    Q = B(U - B(U).xy);\n    Q.xy -= 0.25 * vec2(e.w - w.w, n.w - s.w);\n    \n    if (iMouse.z>0.&&length(U-iMouse.xy)<10.)\n        Q.xyw = vec3(clamp(iMouse.x - iMouse.z / 1.,-1.,1.), clamp(iMouse.w - iMouse.y / 1.,-1.,1.), 1.);\n}","name":"Buffer A","description":"","type":"buffer"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"XsXGR8","channel":0}],"code":"Main\n{\n    Neighborhood;\n    Neighborhood2;\n    \n    Q      = B(U - A(U).xy);\n    Q.w   -= 0.25 * (e.x - w.x + n.y - s.y);\n    Q.xyz -= 0.25*(N*n.y-S*s.y+E*e.x-W*w.x).xyz;\n    \n    \n    if (iMouse.z>0.&&length(U-iMouse.xy)<10.)\n        Q.xyz = abs(vec3(sin(20.2121*iTime),cos(10.43*iTime),clamp(length(abs(iMouse.zw) / 2.),0.,1.)));\n\n}","name":"Buffer B","description":"","type":"buffer"},{"inputs":[],"outputs":[],"code":"#define Main void mainImage(out vec4 Q, vec2 U)\n#define R iResolution.xy\n\n#define A(U) texture(iChannel0,(U)/R)\n#define B(U) texture(iChannel1,(U)/R)\n\n#define Neighborhood vec4 n = A(U+vec2(0,1)), e = A(U+vec2(1,0)), s = A(U-vec2(0,1)), w = A(U-vec2(1,0)), m = 0.25*(n+e+s+w);\n#define Neighborhood2 vec4 N = B(U+vec2(0,1)), E = B(U+vec2(1,0)), S = B(U-vec2(0,1)), W = B(U-vec2(1,0)), M = 0.25*(n+e+s+w);\n","name":"Common","description":"","type":"common"}]}