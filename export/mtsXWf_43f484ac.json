{"ver":"0.1","info":{"id":"mtsXWf","date":"1675445802","viewed":149,"name":"rust_logo_sdf","username":"skaplun","description":"Just a silly 2d sdf","likes":14,"published":1,"flags":0,"usePreview":0,"tags":["2d","sdf","texture"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4sXGRn","filepath":"/media/a/95b90082f799f48677b4f206d856ad572f1d178c676269eac6347631d4447258.jpg","previewfilepath":"/media/ap/95b90082f799f48677b4f206d856ad572f1d178c676269eac6347631d4447258.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// NOTE. There are extremely messed up with min/max functions\n#define AA 7./iResolution.x\n#define PI 3.141593\n#define TAU 6.283185\n#define MAX_FLOAT 1e10;\n\nfloat sdBox(in vec2 p, in vec2 b)\n{\n    vec2 d = abs(p)-b;\n    return length(max(d,0.0)) + min(max(d.x,d.y),0.0);\n}\n\nfloat ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }\nfloat sdRhombus( in vec2 p, in vec2 b ) \n{\n    p = abs(p);\n    float h = clamp( ndot(b-2.0*p,b)/dot(b,b), -1.0, 1.0 );\n    float d = length( p-0.5*b*vec2(1.0-h,1.0+h) );\n    return d * sign( p.x*b.y + p.y*b.x - b.x*b.y );\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord)\n{\n    vec2 aspect = iResolution.xy/iResolution.yy;\n    vec2 uv = fragCoord/iResolution.xy * aspect;\n    vec2 center = aspect * .5;\n    vec2 barycentric = uv - center;\n    float ang = atan(barycentric.x, -barycentric.y);\n    float ang_norm = ang/TAU + .5;\n    vec2 polar = vec2(ang_norm, length(barycentric));\n    vec2 uv_mod_5;\n    \n    float mask = MAX_FLOAT;\n    \n    { //outer gear\n        float outer_gear = .45 + pow(cos(polar.x * PI * 25.), 4.) * .05 - polar.y;\n        outer_gear = min(outer_gear, polar.y - .375);\n        mask = min(mask, outer_gear);\n    }\n    \n    { //screw holes\n        float mod_ang = mod(ang, TAU * .2) - TAU * .1;\n        uv_mod_5 = vec2(polar.y * sin(mod_ang), polar.y * cos(mod_ang));\n        float screw_holes = -sdRhombus(uv_mod_5 - vec2(0., .5), vec2(.15, .15)) + .035;\n        screw_holes = min(screw_holes, .45 - polar.y);\n        mask = max(mask, screw_holes);\n    }\n    \n    { // R\n        float r = -sdBox(barycentric + vec2(.25, .16), vec2(.25, .05)) + .015;\n        float vb = -sdBox(barycentric + vec2(.15, 0.), vec2(.08, .2)) + .015;\n        float tb = -sdBox(barycentric + vec2(.2, -.2), vec2(.35, .05)) + .015;\n        float rr = -distance(barycentric, vec2(.134, .1355)) + .13;\n        \n        r = max(r, vb);\n        r = max(r, tb);\n        r = max(r, rr);\n        r = min(r, .45 - polar.y);\n        mask = max(mask, r);\n    }\n    \n    { //tail\n        float tail = barycentric.y + .221 - (1. - pow(smoothstep(.0, .1, barycentric.x), 2.)) * .19;\n        tail = min(tail, -barycentric.y - .175 + (1. - pow(smoothstep(0.1, .25, barycentric.x), 2.)) * .2);\n        \n        tail = max(tail, -sdBox(barycentric - vec2(.42, -.1), vec2(.1, .075)) + .02);\n        tail = max(tail, -sdBox(barycentric - vec2(.35, -.15), vec2(.2, .05)) + .02);\n        \n        tail = min(tail, .45 - polar.y);\n        tail = min(tail, barycentric.x + .1);\n        tail = min(tail, distance(barycentric, vec2(.251, -.07)) - .05);\n    \n        mask = max(mask, tail);\n    }\n    mask = max(mask, -sdBox(barycentric - vec2(.02, .1), vec2(.1)));\n    mask = min(mask, distance(uv_mod_5, vec2(0., .385)) - .03);\n    mask = min(mask, max(-barycentric.x + .05, distance(barycentric, vec2(0.1, .11)) - .03));\n    mask = min(mask, sdBox(barycentric - vec2(0.02, .11), vec2(.075, .03)));\n    \n    fragColor = texture(iChannel0, fragCoord/iResolution.xy + vec2(.5) * smoothstep(0., AA, mask));\n    fragColor *= 1. - .5 * smoothstep(0., AA, mask);\n}","name":"Image","description":"","type":"image"}]}