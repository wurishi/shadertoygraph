{"ver":"0.1","info":{"id":"3tBfW1","date":"1598756805","viewed":121,"name":"Metaball dance II","username":"dub","description":"Used previous https://www.shadertoy.com/view/3ljfRD to experiment with dFdx, dFdy for cheap normals","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["2d","metaballs"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XdX3zn","filepath":"/media/a/488bd40303a2e2b9a71987e48c66ef41f5e937174bf316d3ed0e86410784b919.jpg","previewfilepath":"/media/ap/488bd40303a2e2b9a71987e48c66ef41f5e937174bf316d3ed0e86410784b919.jpg","type":"cubemap","channel":0,"sampler":{"filter":"mipmap","wrap":"clamp","vflip":"false","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define PI 3.14159265359\n#define quad 0.70710678118\n\n#define R2 .6\n#define ct cos(iTime*.2)\n#define st sin(iTime*.3)\n#define rot mat2(ct,st,-st,ct)\n#define rot4 mat2(quad,quad,-quad,quad)\n\nvec2 ball(vec2 p, float r)\n{\n    float d=length(p);\n    return (d<r)?\n        vec2(smoothstep(0., 1.,(r-d)/r),(r-d)/r):\n    \tvec2(0.,0.);\n}\n\nfloat parabola( float x, float k ){\n    return pow( 4.0*x*(1.0-x), k );\n}\n\nvec3 getCol(vec2 uv, float h)\n{\n    h=parabola(h*0.5, 0.5)*500.;\n    vec3 n=normalize(cross(vec3(1., 0., dFdx(h)), vec3(0., 1., dFdy(h))));\n    \n    return texture(iChannel0, reflect(normalize(vec3(uv, -1.)), n)).rgb;\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord*2.0/iResolution.y - vec2(iResolution.x/iResolution.y, 1.0);\n    \n    vec2 u= vec2(sin(iTime),0.);\n    vec2 h=vec2(0.,0.);\n\n    for (float i=8.;i>0.;i-=1.)\n        h+=ball(uv-(u*=rot4),R2*.5);\n\n    u= vec2(sin(-iTime),0.);\n    u*=inverse(rot);\n    for (float i=8.;i>0.;i-=1.)\n        h+=ball(uv-(u*=rot4),R2*.5);\n\n    if (h.x<.4) fragColor.rgb = vec3(texture(iChannel0, vec3(uv,1.)).rgb);\n    else fragColor.rgb = vec3(getCol(uv, h.y));\n}","name":"Image","description":"","type":"image"}]}