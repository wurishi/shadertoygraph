{"ver":"0.1","info":{"id":"4td3DX","date":"1472103042","viewed":118,"name":"ca self targeting","username":"qwzy","description":"target an image with colors from another image","likes":1,"published":1,"flags":32,"usePreview":0,"tags":["ca","targeting","accumulator"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 uv = fragCoord.xy / iResolution.xy;\n\tfragColor = texture(iChannel0, uv);\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"Xdf3Rn","filepath":"/media/a/e81e818ac76a8983d746784b423178ee9f6cdcdf7f8e8d719341a6fe2d2ab303.webm","previewfilepath":"/media/ap/e81e818ac76a8983d746784b423178ee9f6cdcdf7f8e8d719341a6fe2d2ab303.webm","type":"video","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"Xsf3zn","filepath":"/media/a/f735bee5b64ef98879dc618b016ecf7939a5756040c2cde21ccb15e69a6e1cfb.png","previewfilepath":"/media/ap/f735bee5b64ef98879dc618b016ecf7939a5756040c2cde21ccb15e69a6e1cfb.png","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":2,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"vec3 sample(sampler2D tex, vec2 uv) {\n\treturn texture(tex, mod(uv, iResolution.xy)).xyz;\n}\n\nvec3 mask(vec3 vec, float x, float v) {\n\treturn vec * (1.0 - step(0.9, abs(x - v)));\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord.xy / iResolution.xy;\n    \n    vec3 seed = texture(iChannel0, uv).xyz;\n    vec3 cur = texture(iChannel2, uv).xyz;\n    vec3 tar = step(0.25, texture(iChannel1, uv).xyz);\n    \n    if (iFrame == 0) {\n        fragColor = vec4(seed, 1.0);\n\t\treturn;\n    }\n    \n    vec2 b0 = vec2(2.0 / iResolution.x, 0.0);\n    vec2 b1 = vec2(0.0, 2.0 / iResolution.y);\n    \n    vec3 tl = sample(iChannel2, uv - b0 - b1);\n    vec3 t  = sample(iChannel2, uv      - b1);\n    vec3 tr = sample(iChannel2, uv + b0 - b1);\n    vec3 l  = sample(iChannel2, uv - b0);\n    vec3 r  = sample(iChannel2, uv + b0);\n    vec3 bl = sample(iChannel2, uv - b0 + b1);\n    vec3 b  = sample(iChannel2, uv      + b1);\n    vec3 br = sample(iChannel2, uv + b0 + b1);\n    \n    float tl_d = distance(tl, tar);\n    float t_d  = distance(t, tar);\n    float tr_d = distance(tr, tar);\n    float l_d  = distance(l, tar);\n    float cur_d = distance(cur, tar);\n    float r_d  = distance(r, tar);\n    float bl_d = distance(bl, tar);\n    float b_d  = distance(b, tar);\n    float br_d = distance(br, tar);\n    \n    float min_d = min(tl_d, min(t_d, min(tr_d, min(l_d, min(cur_d, min(r_d, min(bl_d, min(b_d, br_d))))))));\n    \n    vec3 col = vec3(0.0);\n    \n         if (tl_d == min_d) { col = tl; }\n    else if (t_d == min_d)  { col = t; }\n    else if (tr_d == min_d) { col = tr; }\n    else if (l_d == min_d) { col = l; }\n    else if (cur_d == min_d) { col = cur; }\n    else if (r_d == min_d) { col = r; }\n    else if (bl_d == min_d) { col = bl; }\n    else if (b_d == min_d) { col = b; }\n    else if (br_d == min_d) { col = br; }\n    \n    //col += mask(tl, tl_d, min_d);\n    //col += mask(t, t_d, min_d);\n    //col += mask(tr, tr_d, min_d);\n    //col += mask(l, l_d, min_d);\n    //col += mask(cur, cur_d, min_d);\n    //col += mask(r, r_d, min_d);\n    //col += mask(bl, bl_d, min_d);\n    //col += mask(b, b_d, min_d);\n    //col += mask(br, br_d, min_d);\n    \n    fragColor = vec4(col, 1.0);\n}\n","name":"Buf A","description":"","type":"buffer"}]}