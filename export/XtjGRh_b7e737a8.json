{"ver":"0.1","renderpass":[{"outputs":[{"channel":0,"id":"4dfGRr"}],"inputs":[],"code":"// UK Eclipse - @P_Malin\n\n// There was a solar eclipse today. This is what it looked like to me from the northwest of England (cloudy).\n\nconst vec3 sunCol = vec3(1.0, 0.9, 0.66);\nvec3 cloudColA = vec3(0.32, 0.4, 0.6);\nvec3 cloudColB = vec3(0.6, 0.4, 0.5);\nvec3 cloudColC = vec3(0.54, 0.53, 0.46);\n\nfloat kExposure = 1.7;\n\nvec3 sunLight = sunCol.rgb * 10000.0;\n\nfloat Hash(float p)\n{\n\tvec2 p2 = fract(vec2(p * 5.3983, p * 5.4427));\n    p2 += dot(p2.yx, p2.xy + vec2(21.5351, 14.3137));\n\treturn fract(p2.x * p2.y * 95.4337);\n}\n\nfloat Hash2D(vec2 p)\n{\n\treturn Hash( dot( p, vec2(1.0, 41.0) ) );\t\n}\n\nfloat Noise2D( vec2 p )\n{\n\tvec2 fl = floor(p);\n\n\tfloat h00 = Hash2D( fl + vec2(0.0, 0.0) );\n\tfloat h10 = Hash2D( fl + vec2(1.0, 0.0) );\n\tfloat h01 = Hash2D( fl + vec2(0.0, 1.0) );\n\tfloat h11 = Hash2D( fl + vec2(1.0, 1.0) );\n\t\n\tvec2 fr = p - fl;\n\t\n\tvec2 fr2 = fr * fr;\n\tvec2 fr3 = fr2 * fr;\n\t\n\tvec2 t1 = 3.0 * fr2 - 2.0 * fr3;\t\n\tvec2 t0 = 1.0 - t1;\n\t\n\treturn h00 * t0.x * t0.y\n\t\t + h10 * t1.x * t0.y\n\t\t + h01 * t0.x * t1.y\n\t\t + h11 * t1.x * t1.y;\n}\n\nfloat Crescent( const in vec2 uv )\n{    \n    float r= 0.15;\n    float offset = 0.02;\n    float d1 = distance( uv, vec2(0.5, 0.5)) / r - 0.5;\n    float d2 = distance( uv, vec2(0.5 + offset, 0.51)) / r - 0.5;\n    \n    float d = min( -d1, d2 ) * 0.03;\n    \n    return clamp(d, 0.0, 1.0);\n}\n\nfloat Glow( const in vec2 uv )\n{\n    float glow_dist = distance( uv, vec2(0.46, 0.45)) - 0.2;\n    float glow = exp2(glow_dist * -3.5) * 0.001;\n    glow += exp2(glow_dist * -7.0) * 0.0002;\n    return glow;    \n}\n\nfloat Cloud( const in vec2 uv )\n{\n\tfloat s = 0.0;\n    float a = 1.0, t = 0.0;\n    vec2 p = uv;\n    p = p * 2.5;\n    for(int i=0;i<5;i++)\n    {\n        s += Noise2D(p) * a;\n        t += a;\n        p *= 2.0;\n        a *= 0.5;\n        \n        p.x += iTime * 0.05;\n    }\n    s = s / t;    \n    return s;\n}\n\n////////////////\n\nvec3 ApplyVignetting( const in vec2 vUV, const in vec3 vInput )\n{\n\tvec2 vOffset = (vUV - 0.5) * sqrt(2.0);\n\t\n\tfloat fDist = dot(vOffset, vOffset);\n\t\n\tconst float kStrength = 1.0;\n\tconst float kPower = 0.2;\n\n\treturn vInput * ((1.0 - kStrength) +  kStrength * pow(1.0 - fDist, kPower));\n}\n\nvec3 ApplyTonemap( const in vec3 vLinear )\n{    \n    if(iTime < 2.0)\n    {\n        kExposure *= iTime / 2.0;\n    }\n    \n    kExposure *= 0.5;\n    \t\n\treturn 1.0 - exp2(vLinear * -kExposure);\t\n}\n\nvec3 ApplyGamma( const in vec3 vLinear )\n{\n\tconst float kGamma = 2.2;\n\n\treturn pow(vLinear, vec3(1.0/kGamma));\t\n}\n\nvec3 ApplyBlackLevel( const in vec3 vColour )\n{\n    float fBlackLevel = 0.1;\n    return vColour / (1.0 - fBlackLevel) - fBlackLevel;\n}\n\nvec3 ApplyPostFX( const in vec2 vUV, const in vec3 vInput )\n{\n\tvec3 vTemp = ApplyVignetting( vUV, vInput );\t\n\t\n\tvTemp = ApplyTonemap(vTemp);\n\t\n\tvTemp = ApplyGamma(vTemp);\t\t\n    \n    vTemp = ApplyBlackLevel(vTemp);\n    \n    return vTemp;\n}\n\n////////////////\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{    \n    vec2 uv = fragCoord.xy / iResolution.xy;\n    float ratio = iResolution.x / iResolution.y;     \n    vec2 bodyUV = (uv - 0.5) * vec2(ratio, 1.0) + 0.5;\n\n    bodyUV -= 0.1; // offset the sun\n\t\n    float cloudAmount = Cloud(uv * vec2(1.0, 1.75));\n            \n    float glow = Glow(bodyUV);\n    vec3 glowCol = glow * sunLight;\n\n    vec3 col = Crescent(bodyUV) * sunLight;\n\n    vec3 cloudCol = mix(cloudColA.rgb, mix(cloudColB.rgb, cloudColC.rgb, uv.y), cloudAmount);\n    cloudCol = cloudCol * cloudCol;\n    cloudCol += glowCol * (1.0 - cloudAmount * 0.5) * 0.25;\n\tcol = mix(col, cloudCol, cloudAmount);\n    \n    col = ApplyPostFX( uv, col );\n    fragColor = vec4(col, 1.0);\n}\n","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"XtjGRh","date":"1426863706","viewed":442,"name":"UK Eclipse","username":"P_Malin","description":"Yes, there was a solar eclipse today. This is what it looked like to me from the northwest of England (cloudy).\n","likes":13,"published":1,"flags":0,"usePreview":0,"tags":["eclipse","cloudy"],"hasliked":0,"parentid":"","parentname":""}}