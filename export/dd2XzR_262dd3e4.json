{"ver":"0.1","info":{"id":"dd2XzR","date":"1669850732","viewed":133,"name":"Circle-Line Intersection","username":"Envy24","description":".","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["line","intersection","circle"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define UNIT                      (  2.0 / iResolution.y  )\n#define SMAA(x)                   ( smoothstep(UNIT, 0., x) )\n\n/* https://www.shadertoy.com/view/DdsGDj */\n#define MOUSE_OFFSET ( iMouse.z > 0. ? iMouse.xy - iResolution.xy * 0.5 : vec2(0) )\nvec2 map_to_centered_ndc(in vec2 SC, in float scale, in vec2 origin, in bool mouse_drag)\n{\n    vec2 M = MOUSE_OFFSET * (mouse_drag == true ? 1. : 0.);\n    return ((2. * (SC - M) - iResolution.xy) / iResolution.y) * scale + origin;\n}\n\nfloat diskSDF_L2(in vec2 NDC, in vec2 C, in float r) { return length(C - NDC)-r; }\n\nfloat lineSDF_L2(in vec2 NDC, in float k, in float m, in float r)\n{\n    float x = (k*(NDC.y-m)+NDC.x) / (k*k + 1.);\n    vec2 C = vec2(x, k*x+m);\n    return length(C - NDC) - r;\n}\n\nvec2 circle_line_intersection(vec2 C, float r, float k, float m)\n{\n    k = min(k, 999.);\n    float h = m - C.y,\n          a = k*k + 1.,\n          b = 2.*(k*h - C.x),\n          c = C.x*C.x + h*h - r*r,\n          s = sqrt(b*b - 4.*a*c);\n          \n    return vec2(-b + s, -b - s) / (2.*a);\n}\n\nvoid mainImage( out vec4 O, in vec2 SC )\n{\n    vec2 NDC = map_to_centered_ndc(SC, 1., vec2(0), true);\n    \n    vec3 color = vec3(1);\n    \n    vec2 C = vec2(cos(iTime*0.5), sin(iTime*0.5))*0.2;\n    float r = 0.75, k = sin(iTime), m = sin(iTime*0.5)*0.5;\n    \n    color = mix( color, vec3(1,0,0), SMAA(lineSDF_L2(NDC, k, m, 0.)) );\n    color = mix( color, vec3(0,0,1), SMAA(abs(diskSDF_L2(NDC, C, r))) );\n    \n    vec2 roots = circle_line_intersection(C, r, k, m);\n    color = mix( color, vec3(1,0,1), SMAA(diskSDF_L2(NDC, vec2(roots.x, k*roots.x+m), 0.02)) );\n    color = mix( color, vec3(1,0,1), SMAA(diskSDF_L2(NDC, vec2(roots.y, k*roots.y+m), 0.02)) );\n\n    O = vec4(color,1.0);\n}","name":"Image","description":"","type":"image"}]}