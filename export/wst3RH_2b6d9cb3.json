{"ver":"0.1","info":{"id":"wst3RH","date":"1567830704","viewed":142,"name":"bounding slice","username":"gaz","description":"volume?","likes":4,"published":1,"flags":0,"usePreview":0,"tags":["3d"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define rot(a) mat2(cos(a),sin(a),-sin(a),cos(a))\n\n// https://www.shadertoy.com/view/Xlf3zf\nfloat DE(vec3 p0)\n{\n    //float time =0.0;\n    float time =iTime;\n\tvec3 p=p0+sin(p0.yzx*4.0+2.4*sin(p0.zxy*5.0+time)+time*0.7)*0.5;\n\tfloat d=length(p)-1.0;\n\treturn d;\n}\n\nfloat map(vec3 p)\n{\n    p.xz*=rot(iTime*0.2);\n\tp.yz*=rot(iTime*0.1);\n    return DE(p);\n}\n\nvec3 calcNormal(vec3 pos){\n  vec2 e = vec2(1,-1) * 0.002;\n  return normalize(\n    e.xyy*map(pos+e.xyy)+e.yyx*map(pos+e.yyx)+ \n    e.yxy*map(pos+e.yxy)+e.xxx*map(pos+e.xxx)  );\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = (fragCoord*2.-iResolution.xy)/iResolution.y;\n    vec3 ro = vec3(0,0,3);\n    vec3 rd = normalize(vec3(uv,-2));\n    vec3 col = vec3(0.3,0.3,0.5)*uv.y*uv.y;\n    \n    vec3 center = vec3(0);//vec3(sin(iTime),0,0);\n    float r=1.8;\n    float h=1.0;\n    vec3 p;\n \n    if(length(cross(rd,center-ro))<r)\n    {\n    \tfloat ITR=300.;\n   \t\tvec3 g= normalize(center-ro);\n    \tvec3 pos=center+g*r;   \n       \tfor(float i=0.;i<ITR;i++)\n    \t{\n        \tfloat z = dot(pos-ro,rd);\n        \tvec3 q = ro+rd*z;\n        \tfloat d = map(q-center);\n        \th = min(h,max(d,0.0));\n\t\t\tif(d<0.01)p = q-center;\n        \tpos -= g*(r/ITR)*2.0;\n    \t}\n    }\n    if (h<0.01)\n    {\n        float d=map(p);\n        vec3 nor = calcNormal(p);\n    \tvec3 li = normalize(vec3(1));\n        col = vec3(0.2,0.8,1.0);\n        float dif = clamp(dot(nor, li), 0.3, 1.0);\n        float amb = max(0.5 + 0.5 * nor.y, 0.0);\n        float spc = pow(clamp(dot(reflect(normalize(p - ro), nor), li), 0.0, 1.0), 50.0);\n        col *= dif * amb ;\n        col += spc;\n        col = clamp(col,0.0,1.0);\n    }\n    col = pow(col, vec3(0.6));\n\tfragColor = vec4(col, 1.0);\n}\n","name":"Image","description":"","type":"image"}]}