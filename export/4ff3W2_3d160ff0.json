{"ver":"0.1","info":{"id":"4ff3W2","date":"1703511795","viewed":61,"name":"sphere in rotate box","username":"nayk","description":"copypast/* originals https://www.shadertoy.com/view/XfsGWS https://www.shadertoy.com/view/MfsGRs https://www.shadertoy.com/view/DtGyWh*/","likes":0,"published":1,"flags":0,"usePreview":0,"tags":["colorful","rotate","space","box","neon"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"/* originals https://www.shadertoy.com/view/XfsGWS https://www.shadertoy.com/view/MfsGRs https://www.shadertoy.com/view/DtGyWh*/\n#define A(v) mat2(cos(m.v+vec4(0, -1.5708, 1.5708, 0)))  // rotate\n#define H2(v) (cos(radians(vec3(0, 60, 120))+(v)*6.2832)*.5+.5)  \n\n// modified torus from iq: https://iquilezles.org/articles/distfunctions/\nfloat tor(vec3 p, vec2 t)\n{\n    p.z = .5-abs(p.z);\n    p.y = abs(p.y)-.5;\n    p.yz *= mat2(cos(.785+vec4(0, -1.5708, 1.5708, 0)));\n    p.y *= .707;\n    return length( vec2(length(p.xy)-t.x, p.z) ) - t.y;\n}\n\n\n\n#define R(p,a,r)mix(a*dot(p,a),p,cos(r))+sin(r)*cross(p,a)\n#define H(h)(cos((h)*6.3+vec3(3,33,32))*.5+.5)\n\nvec2 hash2( float n )\n{\n    return fract(sin(vec2(n,n+1.0))*vec2(13.5453123,31.1459123));\n}\n\nfloat noise( in vec2 x )\n{\n    vec2 p = floor(x);\n    vec2 f = fract(x);\n    f = f*f*(3.0-2.0*f);\n    float a = textureLod(iChannel0,(p+vec2(0.5,0.5))/256.0,0.0).x;\nfloat b = textureLod(iChannel0,(p+vec2(1.5,0.5))/256.0,0.0).x;\nfloat c = textureLod(iChannel0,(p+vec2(0.5,1.5))/256.0,0.0).x;\nfloat d = textureLod(iChannel0,(p+vec2(1.5,1.5))/256.0,0.0).x;\n    return mix(mix( a, b,f.x), mix( c, d,f.x),f.y);\n}\n\nconst mat2 mtx = mat2( 0.80,  0.60, -0.60,  0.80 );\n\nfloat fbm( vec2 p )\n{\n    float f = 0.0;\n\n    f += 0.500000*noise( p ); p = mtx*p*2.02;\n    f += 0.250000*noise( p ); p = mtx*p*2.03;\n    f += 0.125000*noise( p ); p = mtx*p*2.01;\n    f += 0.062500*noise( p ); p = mtx*p*2.04;\n    f += 0.031250*noise( p ); p = mtx*p*2.01;\n    f += 0.015625*noise( p );\n\n    return f/0.96875;\n}\n\nfloat pattern(in vec2 p, in float t, in vec2 uv, out vec2 q, out vec2 r, out vec2 g)\n{\nq = vec2(fbm(p), fbm(p + vec2(10, 1.3)));\n   \n    float s = dot(uv.x + 0.5, uv.y + 0.5);\n    r = vec2(fbm(p + 4.0 * q + vec2(t) + vec2(1.7, 9.2)), fbm(p + 4.0 * q + vec2(t) + vec2(8.3, 2.8)));\n    g = vec2(fbm(p + 2.0 * r + vec2(t * 20.0) + vec2(2, 6)), fbm(p + 2.0 * r + vec2(t * 10.0) + vec2(5, 3)));\n    return fbm(p + 5.5 * g + vec2(-t * 7.0));\n}\n\nvoid mainImage(out vec4 O, vec2 C)\n{\n    O=vec4(0);\n   \n   \n    vec4 C2=O;\n    vec2 U=C;\n    float pi = 3.1416,\n          pi2 = pi*2.,\n          pi_2 = pi/2.,\n          t = iTime/5.,\n          s = 1., d = 0., i = d;\n   \n    vec2 R = iResolution.xy,\n         m = (iMouse.xy-.5*R)/R.y*4.,\n         ts = vec2(0.5, .01); // torus size\n   \n    vec3 o = vec3(0, 0, -40), // cam\n         u = normalize(vec3((U-.5*R)/R.y, 10)),\n         b = H2(t/5.)*3.*length(u.xy), // bg color\n         c = b, k = c, p;\n   \n    if (iMouse.z < 1.) m = -vec2(t-pi_2/2., .6);\n    mat2 v = A(y), h = A(x); // pitch & yaw\n   \n    for (; i++< 60.;) // raymarch\n    {\n        p = o+u*d;\n        p.yz *= v;\n        p.xz *= h;\n        p.xyz = abs(p.xyz) - cos(t+pi)*.5-.5; // clone\n        k.x = tor(p, ts);\n        k.y = tor(p.yzx, ts);\n        k.z = tor(p.zxy, ts);\n        s = min(s, min(k.z, min(k.x, k.y)));\n        d += s;\n        if (s < .001 || d > 100.) break;\n    }\n    c /= min(vec3(s*d), .05/c)*k + c;\n    C2+= vec4(c + b/3., 1);\n    vec2 q2, r2, g2;\n    float c22 =fbm(C);\n    vec3 p2,q,r=iResolution,\n    d2=normalize(vec3((C*2.-r.xy)/r.y,1));  \n       float noise = pattern(C* vec2(.004), iTime * 0.007, p2.xy, q2, r2, g2);\n    for(float i=0.,a,s2,e,g=0.;\n        ++i<110.;\n        O.xyz+=mix(vec3(1),H(g*.1),sin(.8))*1./e/8e3\n    )\n    {\n        p2=g*d2;\n        p2.z+=-cos(iTime)*0.5;\n        \n        a=20.;\n        p2=mod(p2-a,a*2.)-a;\n        p2.xz*=mat2(cos(iTime*0.2),sin(iTime*0.2),-sin(iTime*0.2),cos(iTime*0.2));\n         p2.yz*=mat2(cos(iTime*0.2),sin(iTime*0.2),-sin(iTime*0.2),cos(iTime*0.2));\n        s2=5.;\n        for(int i=0;i++<8;){\n            p2=.3-abs(p2)+C2.xyz;\n           \n            p2.x<p2.z?p2=p2.zyx:p2;\n            p2.z<p2.y?p2=p2.xzy:p2;\n            p2.y<p2.x?p2=p2.zyx:p2;\n           \n            s2*=e=1.4+sin(iTime*.234)*.1;\n            p2=abs(p2)*e-\n                vec3(\n                    5.+cos(iTime*.3+.5*cos(iTime*.3))*3.,\n                    120,\n                    8.+cos(iTime*.5)*5.\n                 )+C2.xyz*c;\n         }\n     \n         g+=e=length(p2.yx)/s2;\n           g+=e=length(p2.yz)/s2;\n    }\n \n}\n\n","name":"Image","description":"","type":"image"}]}