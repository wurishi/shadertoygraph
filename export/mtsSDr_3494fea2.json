{"ver":"0.1","info":{"id":"mtsSDr","date":"1674620613","viewed":81,"name":"Highlighted waves with noise","username":"shadertoy_legend","description":"Trying to highlight the peaks of the waves to simulate the look of foam in a wake. Using a perlin noise function to create more realistic foam on top of the waves. Base code is from \n From https://www.shadertoy.com/view/4llBRl","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["waves"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"float noise(vec2 x)\n{\n    vec2 n = vec2(dot(x, vec2(127.1, 311.7)), dot(x, vec2(269.5, 183.3)));\n    return fract(sin(n) * 1399763.5453123).r;\n}\n\nfloat noise(vec2 x, float zoom)\n{\n    vec2 n = vec2(dot(x, vec2(127.1, 311.7)), dot(x, vec2(269.5, 183.3)));\n    return fract(sin(n) * 1399763.5453123).r / zoom;\n}\n\n\nvoid mainImage( out vec4 O, vec2 U )\n{\n    vec2 R = iResolution.xy, \n         M = length(iMouse.xy) > 10. ? iMouse.xy / R : vec2(.55,.7);\n    O = vec4(0);\n    U = ( 2.*U - R ) / R.y;  U.x += 1.2;\n \n    float  S = 1.,                                // invariant scaling factor\n           V = 10./sqrt(S),                       // [m/s] boat spead\n           L = 2500./S,                           // [m] screen->world scaling\n          l0 = 2.*L*M.x,                          // boat scale - peak of emission spectrum\n           W =  128./S*exp2(5.*M.y),              // width of spectrum of emission\n           dx = 2./R.y;                           // pixel size. Multiply for more FPS\n    if ( U.x< 0. ) { O += .5; return;}            // 2 optimizations\n    if ( R.y>200. && abs(U.y*R.y)>100.) dx *= 8.*abs(U.y);\n    float threshold=0.09;\n    for (float x = 0.; x<=5.; x += dx ) {         // sum pulse emitted at each past location\n        vec2 P = U  - vec2(x,.2*sin(2.*x-iTime)); // pixel position in past boat frame\n        float l = length(P)*L, \n              k = 6.283/(2.*l),                   // k=2pi/L, energy at l=L/2 since Cg = 1/2 Cphi\n              t = x*L/V,                          // time where boat was at x (approx)\n              a = 3.1416 - sqrt(9.81*k) *t,       // cos(kl-wt), kl=pi, w=sqrt(gk)  \n              v = (l-l0)/W;                       // ( Dispersion relations: https://en.wikipedia.org/wiki/Dispersion_(water_waves)\n        \n        vec2 foamCoord = P * 0.1; // adjust this value to change the foam density\n        float foam = noise(foamCoord, 50.); // Perlin noise for foam texture\n        foam = pow(foam, 2.); // Adjust this value to change the foam shape\n        foam *= 0.2; // Adjust this value to change the foam intensity\n\n        //if (O.w > threshold){\n        //    O=O*1.1;\n        //}\n        O +=  cos(a) / l  * exp(-.5*v*v) + vec4(foam);         // spectrum of wave emission by the boat\n    }\n    O = .5 + .5* O*dx *1.7e3/S;\n}\n","name":"Image","description":"","type":"image"}]}