{"ver":"0.1","info":{"id":"XsSfW3","date":"1502373639","viewed":141,"name":"Bit packing","username":"fsole","description":"Bit packing test","likes":1,"published":1,"flags":32,"usePreview":0,"tags":["test"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// Visualization of the system in Buffer A\n\nfloat unpack(int firstBit, int length, int target)\n{\n  float range = pow(2.0,float(length));\n  int v = target >> (firstBit-length+1);\n  int mask = int(range) - 1 ;\n  return float(v & mask) / (range-1.0);\n}\n\nfloat DecodeFloatRG( vec2 enc )\n{\n    vec2 kDecodeDot = vec2(1.0, 1.0/255.0);\n    return dot( enc, kDecodeDot );\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    \n    vec2 uv = fragCoord.xy / iResolution.xy;\n    vec4 c = texture(iChannel0, uv).xyzw;\n    /*\n    int target = int(c.a*255.0);\n    float value = unpack(3,3,target);\n    \n    fragColor = vec4(value,value,value, 1.0);*/\n   \tfragColor = vec4(DecodeFloatRG(c.xy),0,0, 1.0);\n}","name":"Image","description":"","type":"image"},{"inputs":[],"outputs":[{"id":"4dXGR8","channel":0}],"code":"int pack(int value, int firstBit, int length, int target)\n{\n    int v2 = value << (firstBit-length+1);\n    int result = target | v2;\n    return result;\n}\n\nvec2 EncodeFloatRG( float v )\n{\n    vec2 kEncodeMul = vec2(1.0, 255.0);\n    float kEncodeBit = 1.0/255.0;\n    vec2 enc = kEncodeMul * v;\n    enc = fract (enc);\n    enc.x -= enc.y * kEncodeBit;\n    return enc;\n}\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n   \tvec2 encoded = EncodeFloatRG( 0.9 );\n   \t fragColor = vec4(encoded,0.0, 0.0);\n    /*\n    int value = 7;\n    int alpha = 0;\n    alpha = pack( value,7,4,alpha);\n    \n    int value2 = 7;\n    alpha = pack( value2,3,3,alpha);\n    \n   \tint value3 = 1 ;\n    alpha = pack( 1,0,1,alpha);\n    \n    fragColor = vec4(1.0,1.0,0.0, float( alpha ) / 255.0);\n*/\n    \n\n}","name":"Buf A","description":"","type":"buffer"}]}