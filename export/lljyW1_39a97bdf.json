{"ver":"0.1","info":{"id":"lljyW1","date":"1508445784","viewed":94,"name":"STExos 2) Segment","username":"ttoinou","description":"Second Shadertoy exercise : compute the distance to a line/segment and barycentric coefficient","likes":0,"published":1,"flags":0,"usePreview":0,"tags":["stexos"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// First exercise here : https://www.shadertoy.com/view/Mt2cDh\n\nvoid mainImage(\n    out vec4 color,\n    in vec2 coord \n) {\n    float zoom = (cos(iTime*3.)+1.1)/(2.*iResolution.x); // line will be 2px thick minimum\n    \n    float distLinePixels;\n    \n    float baryCoeff; // all real values\n    //unitless (0 means \"stay at A\", 1 means \"go from A to B\")\n    \n    // v(ZW) means vector from Z to W, equals W-Z\n    // · is dot product\n    \n    // Exo 2 : a line is defined by going through two points A and B with A != B\n    \n    vec2 A = iResolution.xy/2.;\n    vec2 B = iMouse.xy;\n    \n    // H in (AB) <=> there exist one t such as v(AH) = t * v(AB)\n    // so t is AH/AB (algebraic ! i.e. keeping the sign)\n    \n    // t = 0 => M=A\n    // t = 1 => M=B\n    // t is called a barycentric coefficient\n    \n    // for every M in the plane, there exist only one point H such as\n    // v(AM) = v(AH) + v(HM) && v(HM)·v(AB)=0 ( perpendicular )\n    \n    vec2 AB = B - A;\n    vec2 AM = coord - A;\n    \n    // v(AM)·v(AB) = v(AH)·v(AB) + v(HM)·v(AB) = v(AH)·v(AB) by construction\n    baryCoeff = dot(AM,AB)/dot(AB,AB);\n    \n    // segment when mouse pressed\n    // line otherwise\n    if(iMouse.z > .5)\n        baryCoeff = clamp(baryCoeff,0.,1.);\n    \n    vec2 HM = AM - baryCoeff*AB;\n    distLinePixels = length(HM);\n    \n    \n\tcolor.rgb = mix(\n          // red / blue mix, be sure to not go out of [0,1]\n          mix( vec3(1.,.0,.0) , vec3(.0,.0,1.) , clamp(baryCoeff,0.,1.) )\n          // white\n        , vec3(1.)\n        , clamp(1. - abs( pow(distLinePixels/iResolution.x,1.5) /zoom),0.,1.)\n    );\n}","name":"Image","description":"","type":"image"}]}