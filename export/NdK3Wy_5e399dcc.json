{"ver":"0.1","info":{"id":"NdK3Wy","date":"1632122812","viewed":157,"name":"draw brush line","username":"shiyuugo","description":"draw noise brush","likes":4,"published":1,"flags":32,"usePreview":0,"tags":["mouse","line"],"hasliked":0,"parentid":"ssy3Dy","parentname":"draw smooth line"},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec3 col = texture(iChannel0, fragCoord.xy/iResolution.xy).rgb;\n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"Xsf3zn","filepath":"/media/a/f735bee5b64ef98879dc618b016ecf7939a5756040c2cde21ccb15e69a6e1cfb.png","previewfilepath":"/media/ap/f735bee5b64ef98879dc618b016ecf7939a5756040c2cde21ccb15e69a6e1cfb.png","type":"texture","channel":1,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":" //#define DEBUG_BRUSH\n\n#define type 0\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord / iResolution.xy;\n    \n    if(iFrame<1){\n        fragColor = vec4(0,0,0,1.0);\n        return;\n    }\n    \n    if(fragCoord.x < 0.9 && fragCoord.y < 0.9){\n        fragColor = vec4(iMouse.xy, 0.,1.);\n        return;\n    }\n    \n    vec2 currMouse = iMouse.xy;\n    vec2 prevMouse = iMouse.w>0.0 ? iMouse.xy : texture(iChannel0,vec2(0)).xy;\n    vec2 mouseDir = normalize(currMouse-prevMouse);\n    float lineL = length(currMouse-prevMouse);\n     \n    vec4 col = texture(iChannel0, uv);\n    vec2 brsUV = (fragCoord - currMouse.xy) / iResolution.xy;\n    vec4 brush = 1.-texture(iChannel1, brsUV*1.0);\n         brush = 1.-texture(iChannel1, brsUV + brush.xy*0.01);\n    \n    if(type==0)\n        brush.r = pow(brush.r, 0.25);\n    else if(type==1)\n        brush.r = pow(brush.r, 3.5);\n    else if(type==2)\n        brush.r = pow(brush.r, 7.);\n\n#ifdef DEBUG_BRUSH\n    fragColor = vec4(vec3(brush.r), 1.0); \n    return;\n#endif\n    float lineW = 15.;\n    \n    if(iMouse.z>0.){\n        for(float d = 0.; d < lineL ; d++ ){\n            //col += brush.r * smoothstep(lineW, 0., length( mix(prevMouse,currMouse, d/lineL) - fragCoord ) ); \n            col += smoothstep(mix(brush.r*lineW,lineW,0.2), 0., length( mix(prevMouse,currMouse, d/lineL) - fragCoord ) ); \n        }\n    }\n    col *= 0.995;\n    \n    fragColor =col;\n}","name":"Buffer A","description":"","type":"buffer"}]}