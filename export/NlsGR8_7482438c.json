{"ver":"0.1","info":{"id":"NlsGR8","date":"1621524663","viewed":76,"name":"Equirectangular Projection_test","username":"kithy","description":"I would like to map 2D Texture Image to raymarching sphere using Equirectangular Projection...but something went wrong:(","likes":0,"published":1,"flags":0,"usePreview":0,"tags":["raymarching","texture","equirectangular"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"Xdf3zn","filepath":"/media/a/85a6d68622b36995ccb98a89bbb119edf167c914660e4450d313de049320005c.png","previewfilepath":"/media/ap/85a6d68622b36995ccb98a89bbb119edf167c914660e4450d313de049320005c.png","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define PI 3.141592\n#define ITR 64\n#define EPS 0.001\n\nmat2 rot(float a){\n\tfloat s=sin(a);\n\tfloat c=cos(a);\n\treturn mat2(c,-s,s,c);\n}\n\nfloat sdSphere(vec3 p){\n\treturn length(p)-0.8;\n}\n\nvec3 genNormal(vec3 p){\n\treturn normalize(vec3(\n\t\tsdSphere(p+vec3(EPS,0.0,0.0))-sdSphere(p+vec3(-EPS,0.0,0.0)),\n\t\tsdSphere(p+vec3(0.0,EPS,0.0))-sdSphere(p+vec3(0.0,-EPS,0.0)),\n\t\tsdSphere(p+vec3(0.0,0.0,EPS))-sdSphere(p+vec3(0.0,0.0,-EPS))\n\t));\n}\n\nvoid mainImage(out vec4 fragColor,in vec2 fragCoord){\n\tvec2 uv=(2.0*fragCoord.xy-iResolution.xy)/iResolution.y;\n\tvec2 vTexCoord=(2.0*fragCoord.xy-iResolution.xy)/iResolution.y;\n    //vec2 vTexCoord=fragCoord;\n\n\tfloat longitude=vTexCoord.x*2.0*PI-PI+PI/2.0;\n\tfloat latitude=vTexCoord.y*PI;\n\tvec3 dir=vec3(\n\t\t-sin(longitude)*sin(latitude),\n\t\tcos(latitude),\n\t\t-cos(longitude)*sin(latitude)\n\t\t);\n\n\tnormalize(dir);\n\n\tvec3 ro=vec3(0.0,0.0,0.0);\n\tvec3 rd=normalize(vec3(uv,1.0));\n\n\tfloat d=0.0;\n\tvec3 normal;\n\n\tfor(int i=0;i<ITR;i++){\n\t\tdir.xy*=fract(iTime*0.1);\n\t\td=sdSphere(dir);\n\t\tdir+=ro+rd*d;\n\t\tif(d<EPS)break;\n\t\tnormal=genNormal(dir);\n\t}\n\n\tvec3 color=texture(iChannel0,dir.xy).rgb;\n\n\tfragColor=vec4(color+normal,1.0);\n}","name":"Image","description":"","type":"image"}]}