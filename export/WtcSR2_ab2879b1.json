{"ver":"0.1","info":{"id":"WtcSR2","date":"1586479391","viewed":291,"name":"Triangled","username":"harry7557558","description":"Tangled + Triangulated. Diving down to Hell.\n\n(stay 1min and watch it change)","likes":7,"published":1,"flags":8,"usePreview":0,"tags":["tunnel","sound","sdf","triangle","hexagon","square"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XsX3Rn","filepath":"/media/a/92d7758c402f0927011ca8d0a7e40251439fba3a1dac26f5b8b62026323501aa.jpg","previewfilepath":"/media/ap/92d7758c402f0927011ca8d0a7e40251439fba3a1dac26f5b8b62026323501aa.jpg","type":"texture","channel":1,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4df3Rr","filepath":"/media/a/3871e838723dd6b166e490664eead8ec60aedd6b8d95bc8e2fe3f882f0fd90f0.jpg","previewfilepath":"/media/ap/3871e838723dd6b166e490664eead8ec60aedd6b8d95bc8e2fe3f882f0fd90f0.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"float smin(float a, float b, float k){\n    float d = a-b;\n    return abs(d)>k?min(a,b):.5*(-.5/k*d*d+a+b-.5*k);\n}\n\n#define _23 0.666666667\n#define rt3 1.732050808\n#define r3_2 0.866025404\n#define _23r3 1.154700538\n#define _43r3 2.309401077\n\n\nvec2 map4(vec2 p){\n    p = abs(mod(p,2.0)-1.0);\n    return vec2(min(p.x,p.y),length(p));\n}\nfloat Map4(vec3 p){\n    vec2 d = map4(p.xy);\n    return smin(length(vec2(d.x,p.z)),d.y,0.2)-0.1;\n}\n\n\nvec2 map3(vec2 p){\n\tp = mod(p+vec2(_23r3,_23),vec2(_43r3,4.));\n\tif (p.y>2.) p.y=4.-p.y;\n\tif (p.x>_23r3) p.x=_43r3-p.x;\n\tif (p.y>rt3*p.x) p=vec2(_23r3,2.)-p;\n\treturn vec2(rt3*p.y<p.x?p.y:.5*(rt3*p.x-p.y),\n\t\tp.x+rt3*p.y<_43r3?length(p):length(p-vec2(_23r3,2.)));\n}\nfloat Map3(vec3 p){\n    vec2 d = map3(p.xy);\n    return smin(length(vec2(d.x,p.z)),d.y,0.2)-0.1;\n}\n\n\nfloat map6g(vec2 p){\n    p = mod(vec2(p.x,.5*p.x+r3_2*p.y),3.);\n    if (p.y>p.x) p=p.yx;\n    if (p.x+p.y>3.) p=vec2(3)-p.yx;\n    return p.y>1.?p.x-p.y:p.x>2.?abs(p.x-p.y-2.):p.y>p.x-1.?abs(p.x-1.):p.y;\n}\nfloat map6v(vec2 p){\n    p = mod(p,vec2(1,rt3)*2.);\n    if (p.x>1.) p.x=2.-p.x;\n    if (p.y>rt3) p.y=2.*rt3-p.y;\n    if (p.y<rt3*p.x) p=vec2(1.,rt3)-p;\n    return length(p-vec2(0,_23r3));\n}\nfloat Map6(vec3 p){\n    return smin(length(vec2(map6g(p.xy),p.z)),map6v(p.xy),0.2)-0.1;\n}\n\n\nfloat map(vec3 p){\n    p.z = mod(p.z,2.0)-1.0;\n    const float o = 2.;\n    float t = iTime;\n    if (t<16.-o) return Map6(p);\n    if (t<16.) return mix(Map4(p),Map6(p),(16.-t)/o);\n    if (t<32.-o) return Map4(p);\n    if (t<32.) return mix(Map3(p),Map4(p),(32.-t)/o);\n    if (t<48.-o) return Map3(p);\n    if (t<48.) return mix(map3(p.xy).x-.1,Map3(p),(48.-t)/o);\n    if (t<60.-o) return map3(p.xy).x-.1;\n    if (t<60.) return mix(map3(p.xy).y,map3(p.xy).x,(60.-t)/o)-.1;\n    return map3(p.xy).y-.1;\n}\n\nvec3 grad(vec3 p){\n    const float e = .001;\n\tfloat a = map(vec3(p.x+e,p.y+e,p.z+e));\n\tfloat b = map(vec3(p.x+e,p.y-e,p.z-e));\n\tfloat c = map(vec3(p.x-e,p.y+e,p.z-e));\n\tfloat d = map(vec3(p.x-e,p.y-e,p.z+e));\n\treturn normalize(vec3(a+b-c-d,a-b+c-d,a-b-c+d));\n}\n\nbool intCirc(vec2 d, vec2 c, float r, inout float t, out vec2 n){\n    if (dot(c,d)<=0.0) return false;\n\tfloat d2 = c.x*d.y-c.y*d.x; if ((d2*=d2)>r*r) return false;\n\td2 = sqrt(dot(c,c)-d2)-sqrt(r*r-d2);\n    if (d2>t) return false; else t=d2;\n\tn = (d*t-c)/r; return true;\n}\n\nvec3 getTexture(sampler2D G, vec3 p, vec3 n){\n    return ((n=abs(n)).x*texture(G,p.yz)+n.y*texture(G,p.xz)+n.z*texture(G,p.xy)).rgb/(n.x+n.y+n.z);\n}\n\nvoid mainImage(out vec4 fcol, in vec2 coord){\n    float t = -2.0*iTime;\n    vec3 p = vec3(0,0,t+1.0);\n    vec2 uv = (coord - 0.5*iResolution.xy) / length(iResolution.xy);\n    vec3 d = normalize(vec3(uv,t)-p);\n    float dk = 1.0/length(d.xy); vec2 d0 = d.xy*dk;\n    \n    vec3 n, k;\n    t = 1e8;\n    float r = .05*max(1.-1e-7*pow(iTime,4.),.0);\n    if (intCirc(d0,vec2(-1.2*r,-0.25),r,t,n.xy)\n       ||intCirc(d0,vec2(1.2*r,-0.25),r,t,n.xy)) {\n        p += (t*=dk)*d;\n    \tk = mix(vec3(0.2),vec3(1.0),max(n.y,0.));\n    \tk *= 2.0*getTexture(iChannel1,2.0*p,n);\n    }\n    else {\n    \tt = 0.0; float dt;\n    \tfor (int i=0;i<64;i++){\n    \t    dt = map(p+t*d);\n    \t    t += dt;\n    \t    if (dt<.01 || t>40.) break;\n    \t    float a = 0.05*dt, c=cos(a),s=sin(a);\n    \t    d.xy = mat2(c,s,-s,c)*d.xy;\n    \t}\n    \tp += d*t;\n    \tn = grad(p);\n    \tk = mix(vec3(0.2),vec3(1.0),max(n.z,0.));\n    \tk *= 3.0*getTexture(iChannel0,p,n);\n    }\n    fcol.xyz = k*exp(-0.2*t*vec3(1.0,0.8,0.6));\n}\n","name":"Image","description":"","type":"image"},{"inputs":[],"outputs":[],"code":"vec2 mainSound( in int samp,float t){\n    float t0 = t;\n    float f = t>64.?392.:(t=mod(t,4.))<1.?523.:t<2.?415.:392.;\n    t = 6.283185307*mod(t,4.);\n    return vec2(sin(f*t)*max(cos(8.*t),0.)*min(exp(64.-t0),1.));\n}\n","name":"Sound","description":"","type":"sound"}]}