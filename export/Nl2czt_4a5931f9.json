{"ver":"0.1","info":{"id":"Nl2czt","date":"1650117941","viewed":113,"name":"sdf_practice_heatbeat","username":"riveranb","description":"signed distance field practice series: animated heart beating","likes":5,"published":1,"flags":0,"usePreview":0,"tags":["sdf"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// ref: https://www.shadertoy.com/view/XsfGRn\n\n#define PI 3.1415926\n#define LINE_SPACE 0.2\n#define LINE_THICKNESS 0.001666\n\nvec3 rainbow[8] = vec3[8] (\n    vec3(1.0, 0.0, 0.0),\n    vec3(0.9, 0.45, 0.0),\n    vec3(1.0, 1.0, 0.0),\n    vec3(0.0, 1.0, 0.0),\n    vec3(0.0, 0.666, 0.9),\n    vec3(0.25, 0.0, 1.0),\n    vec3(1.0, 0.0, 1.0),\n    vec3(1.0, 1.0, 1.0)\n);\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 scr_pos = (2.0 * fragCoord.xy - iResolution.xy) / min(iResolution.x, iResolution.y);\n    scr_pos.y -= 0.25;\n    float radius = length(scr_pos);\n    \n    // background color\n    vec3 bg_color = vec3(1.0, 0.9, 0.85 - 0.1 * scr_pos.y) * (1.0 - 0.3333 * radius);\n    \n    // animate beating over position\n    float time_factor = mod(iTime, 1.5) / 1.5;\n    float sined_factor = pow(time_factor, 0.2) * 0.5 + 0.5;\n    sined_factor = 1.0 + \n        sined_factor * 0.5 * sin(time_factor * PI * 10.0 + scr_pos.y * 0.5) * \n        exp(-time_factor * 5.0);\n    scr_pos *= vec2(0.5, 1.5) + sined_factor * vec2(0.5, -0.5);\n    \n    // heart shape\n    float amp = abs(atan(scr_pos.x, scr_pos.y) / PI);\n    float heart_dist = (13.0 * amp - 22.0 * amp * amp + 10.0 * amp * amp * amp) / \n        (6.0 - 5.0 * amp);\n    \n    // colored\n    float lighten = 1.0;\n    lighten = 0.75 + 0.75 * scr_pos.x;\n    lighten *= 1.0 - 0.25 * radius;\n    lighten = 0.25 + 0.75 * lighten;\n    lighten *= 0.5 + 0.5 * pow(1.0 - clamp(radius / heart_dist, 0.0, 1.0), 0.1);\n    vec3 heart_color = vec3(1.0, 0.5 * radius, 0.333) * lighten;\n    \n    // distance field lines\n    float heart_field = radius - heart_dist;\n    float dgradient = fwidth(heart_field);\n    float distance_coord = heart_field / LINE_SPACE;\n    distance_coord -= iTime / 1.5; // animate moving\n    float linespace_sdf = abs(fract(distance_coord + 0.5) - 0.5) * LINE_SPACE;\n    float lines = smoothstep(LINE_THICKNESS - dgradient, \n        LINE_THICKNESS + dgradient, \n        linespace_sdf);\n\n    float heart_range = smoothstep(0.06, -0.06, heart_field);\n    float beat_factor = abs(fract(iTime / 1.5 + 0.6666) - 0.3333);\n    lines = max(lines, heart_range);\n    // rainbow-ramped color\n    float dist_idx = floor(distance_coord);\n    dist_idx = 7.0 - mod(dist_idx, 8.0);\n    bg_color = mix(bg_color * rainbow[int(dist_idx)], bg_color, \n        smoothstep(0.01, -0.01, heart_field - 0.1)); // a bit outsider offset\n    \n    // final color composition (from outside-background to inside-heart)\n    vec3 final_color = mix(bg_color * lines, heart_color, \n        heart_range * beat_factor);\n    \n    fragColor = vec4(final_color, 1);\n}","name":"Image","description":"","type":"image"}]}