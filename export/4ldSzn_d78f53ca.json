{"ver":"0.1","info":{"id":"4ldSzn","date":"1477752242","viewed":225,"name":"Canabola","username":"zolozulman","description":"canabola equation\nauthor of formulas Anton Sukhinov (Антон Сухинов)\n\nadded AA","likes":10,"published":1,"flags":112,"usePreview":0,"tags":["canabola"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsS3Dz","filepath":"https://soundcloud.com/ljubav-1/bob-marley-ganja-gun","previewfilepath":"https://soundcloud.com/ljubav-1/bob-marley-ganja-gun","type":"musicstream","channel":2,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 uv = fragCoord.xy / iResolution.xy;\n\tfragColor = texture( iChannel0,uv*1.);\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGRr","filepath":"/presets/tex00.jpg","previewfilepath":"/presets/tex00.jpg","type":"keyboard","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"#define PI 3.14159265359\n\nfloat atan2(float y,float x){\n    if(x>0.){\n        return atan(y/x);\n    }\n    if(x<0. && y>=0.){\n        return atan(y/x)+PI;\n    }\n    if(x<0. && y<0.){\n        return atan(y/x)-PI;\n    }\n    if(x==0. && y>0.){\n        return PI/2.;\n    }\n    if(x==0. && y<0.){\n        return -PI/2.;\n    }    \n    return 0.;\n}\n\n//////////////////////////\n// canabola formulas\n//////////////////////////\n\nfloat fp1(float A, float R){\n    //leaves animation\n    return (0.3+(sin(iTime/1.5))/PI)*pow(R,4.);\n}\n\nfloat fp2(float A, float R){\n    return cos(7.*(A+PI)-fp1(A,R));\n}\n\nfloat fp3(float A, float R){\n    return cos(3.5*A-fp1(A,R));\n}\n\nfloat f1(float A, float R){\n    return 1./(abs(fp3(A,R))+0.005/R);\n}\n\nfloat f2(float A, float R){\n   \tfloat p1 = fp1(A,R);\n    float p2 = acos(cos(7.*(A+PI)-p1));\n    return 8. * (((pow(sin(7.*A/2.),2.))/(10.*(pow(R,2.)/pow(sin(A/2.),2.))+1.))/(abs(sin(8.*PI*(R-(p2+2.*R*pow(p2,2.))/20.)))+0.1+pow(fp3(A,R),2.)));\n}\n\nfloat f3(float A, float R){\n    return 3./(pow(100.*R,2.)+0.1);\n}\n\nfloat f4(float A, float R){\n    return abs(sin(A/2.))-pow(R,2.);\n}\n\nfloat f5(float A, float R){\n    return abs(sin(A/2.));\n}\n\nfloat f6(float A, float R){\n    float p1 = pow((sin(100.*R*cos(A)+10.*cos(40.*R*sin(A)))+sin(100.*R*sin(A)+10.*sin(40.*R*cos(A)))),2.)+0.01;\n    return 1.+(0.01/(p1)); \n}\n\nfloat f7(float A, float R){\n    return (R + 0.2)*(0.0002/(pow(A-0.1*R,2.)+0.0001));\n}\n\nfloat f(float A, float R){\n    return ((f1(A,R)+f2(A,R)+f3(A,R))*f4(A,R)-f5(A,R))*f6(A,R)+f7(A,R);\n}\n\nconst int AA_SIZE = 4;\nconst float AA_SIZE_F = float(AA_SIZE);\nconst float ZOOM = 3.9;\n\nfloat render(vec2 center, vec2 fragCoord){\n    vec2 newCoord = vec2(fragCoord.x-center.x,fragCoord.y-center.y)-vec2(0.,0.);\n    float r = sqrt(pow(newCoord.x,2.)+pow(newCoord.y,2.));\n    float phi = atan2(newCoord.y,newCoord.x);\n    float zoom = pow(ZOOM*10.,2.)-500.;\n    \n    if(zoom<250.){\n        zoom = 250.;\n    }\n    \n    float res = f(phi+PI/2.,r/zoom);\n    \n   \treturn res;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 center = ((iResolution.xy*vec2(1.,0.6)) / 2.) * AA_SIZE_F;\n    \n    vec4 vcol = vec4(0);\n    for(int i = 0;i<AA_SIZE;i++){\n        for(int j = 0;j<AA_SIZE;j++){\n            float res = render(center,fragCoord * AA_SIZE_F + vec2(j,i));\n            \n            if(res>0.){\n                //tree color\n                vcol += vec4(res/40.,res/15.+0.2,res/80.,1)/0.95;\n            }else{\n                //flag\n                vcol += vec4(0,0,0,1);\n                if(fragCoord.y > 0. && fragCoord.y < iResolution.y/3.){\n                    vcol += vec4(0.7,0,0,1);\n                }else if(fragCoord.y > iResolution.y/3. && fragCoord.y < 2.*iResolution.y/3.){\n                    vcol += vec4(0.9,0.9,0,1);\n                }else{\n                    vcol += vec4(0.*1000.,0.5,0,1);\n                }\n            }\n        }\n    }\n    vcol /= (AA_SIZE_F * AA_SIZE_F);\n\n    \n    fragColor = vcol;\n}","name":"Buffer A","description":"","type":"buffer"},{"inputs":[{"id":"4dXGRr","filepath":"/presets/tex00.jpg","previewfilepath":"/presets/tex00.jpg","type":"keyboard","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"XsXGR8","channel":0}],"code":"/////////////////////////\n// zoom + position\n/////////////////////////\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 zoom_save_point = vec2(0.,0.);\n    \n    vec2 uv = fragCoord.xy / iResolution.xy;\n    vec4 c = vec4(0,0,0,1);\n    float zoom = texture(iChannel0,zoom_save_point).x;\n    vec2 position = texture(iChannel0,vec2(1.0,0.0)/iResolution.xy).xy;\n    \n    if(iFrame == 0){\n        zoom = 1.6;\n        position = vec2(.5,.5);\n    }\n    \n    if(fragCoord.x >= 0. && fragCoord.x <= 0.5 && fragCoord.y >= 0. && fragCoord.y <= 0.5){\n        c = vec4(zoom,0,0,1);\n        if(texture( iChannel1, vec2(90.5,0.5)/255.).x==1.0){\n        \tc = vec4(zoom+0.01,0,0,1);\n        }\n        if(texture( iChannel1, vec2(88.5,0.5)/255.).x==1.0){\n            c = vec4(zoom-0.01,0,0,1);\n        }\n    }\n\n    if(fragCoord.x >= 1. && fragCoord.x <= 5.5){// && fragCoord.y >= 1. && fragCoord.y <= 1.5){\n        c = vec4(position,0,1);\n        float move_step = 0.1;\n        if(texture( iChannel1, vec2(37.5,0.5)/255.).x==1.0){\n            c = vec4(position+vec2(-move_step,0.),0,1);\n        }     \n        if(texture( iChannel1, vec2(38.5,0.5)/255.).x==1.0){\n            c = vec4(position+vec2(0.,move_step),0,1);\n        }     \n        if(texture( iChannel1, vec2(39.5,0.5)/255.).x==1.0){\n            c = vec4(position+vec2(move_step,0.),0,1);\n        }     \n        if(texture( iChannel1, vec2(40.5,0.5)/255.).x==1.0){\n            c = vec4(position+vec2(0.,-move_step),0,1);\n        }\n    }\n    fragColor = c;\n}","name":"Buffer B","description":"","type":"buffer"}]}