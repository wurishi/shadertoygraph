{"ver":"0.1","info":{"id":"dldyzf","date":"1699518574","viewed":86,"name":"dither with palette","username":"Godlander","description":"some macros","likes":1,"published":1,"flags":0,"usePreview":0,"tags":["dither","palette","quantize"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XdX3Rn","filepath":"/media/a/52d2a8f514c4fd2d9866587f4d7b2a5bfa1a11a0e772077d7682deb8b3b517e5.jpg","previewfilepath":"/media/ap/52d2a8f514c4fd2d9866587f4d7b2a5bfa1a11a0e772077d7682deb8b3b517e5.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define hex(i) vec3((i&0xFF0000)>>16, (i&0xFF00)>>8, (i&0xFF))/255.\n\n#define Gradient(out, arr, p) {           \\\n    float t = p * float(arr.length()-1);  \\\n    int i = int(t);                       \\\n    out = mix(arr[i], arr[i+1], fract(t));\\\n}\n\nvec3 palette[] = vec3[](\n    hex(0x040C06),\n    hex(0x112318),\n    hex(0x1E3A29),\n    hex(0x305D42),\n    hex(0x4D8061),\n    hex(0x89A257),\n    hex(0xBEDC7F),\n    hex(0xEEFFCC)\n);\n\nmat4 bayer = mat4(\n  0, 8, 2,10,\n 12, 4,13, 6,\n  3,11, 1, 9,\n 15, 7,13, 5\n) / 15.;\n\n#define size 8\n#define noise 0.2\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord) {\n    //dither\n    ivec2 coord = ivec2(fragCoord.xy) / size;\n    int x = coord.x % 4;\n    int y = coord.y % 4;\n    float dither = bayer[x][y];\n    //get value as luminance (can use whatever other value)\n    vec4 color = texture(iChannel0, vec2(coord*size)/iResolution.xy);\n    float value = dot(color.rgb, vec3(0.2, 0.7, 0.1));\n    value = clamp(value + (dither-0.5)*noise, 0.,1.);\n    //color from palette\n    vec3 col;\n    Gradient(col, palette, value);\n    \n    fragColor = vec4(col,1.);\n}","name":"Image","description":"","type":"image"}]}