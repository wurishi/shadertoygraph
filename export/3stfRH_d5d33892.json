{"ver":"0.1","info":{"id":"3stfRH","date":"1604363126","viewed":88,"name":"Sun setting on the sea","username":"Dombass","description":"varanasi sunset take 2","likes":0,"published":1,"flags":0,"usePreview":0,"tags":["sea","sunset","sun","alliteration","littleart","smolart","sopure"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"float sphereSDF(vec3 p, float r) {\n    return length(p) - r;\n}\n\nfloat boxSDF(vec3 a, vec3 b, float r) {\n    return length(max(abs(a)-b, 0.)) - r;\n}\n\nfloat noise(vec3 p) //Thx to Las^Mercury\n{\n\tvec3 i = floor(p);\n\tvec4 a = dot(i, vec3(1., 57., 21.)) + vec4(0., 57., 21., 78.);\n\tvec3 f = cos((p-i)*acos(-1.))*(-.5)+.5;\n\ta = mix(sin(cos(a)*a),sin(cos(1.+a)*(1.+a)), f.x);\n\ta.xy = mix(a.xz, a.yw, f.y);\n\treturn mix(a.x, a.y, f.z);\n}\n\nfloat fl2(vec3 p, float scene)\n{\n    float direction = noise(p+vec3(1.,iTime*0.25,1.0));\n    float height = 0.1; //dont bend! ascend! by going above about 0.3\n    float f = (scene + direction*height);\n    float a = abs(f);\n    return min(1000.-f, a);\n}\n\nvec3 rayDirection(float fieldOfView, vec2 size, vec2 fragCoord) {\n    vec2 xy = fragCoord - size / 2.0;\n    float z = size.y / tan(radians(fieldOfView) / 2.0);\n    return normalize(vec3(xy, -z));\n}\n\nfloat scene(in vec3 pos) {\n\tfloat box = boxSDF(pos,vec3(300.5,0.25,300.5), 0.2);\n    vec3 sun_pos = pos;\n    sun_pos.y -= 2.5;\n    sun_pos.x -= 4.0;\n    float sun = sphereSDF(sun_pos, 1.0);\n    return fl2(pos,box);\n}\n\nvec3 calcNormal( in vec3 pos )\n{\n    vec2 e = vec2(1.0,-1.0)*0.5773*0.0005;\n    return normalize( e.xyy*scene( pos + e.xyy ) + \n\t\t\t\t\t  e.yyx*scene( pos + e.yyx ) + \n\t\t\t\t\t  e.yxy*scene( pos + e.yxy ) + \n\t\t\t\t\t  e.xxx*scene( pos + e.xxx ) );\n}\n\nvec4 raymarch(vec3 org, vec3 dir)\n{\n\tfloat d = 0.0, glow = 0.0, eps = 0.01;\n\tvec3  p = org;\n\tbool glowed = false;\n\t\n\tfor(int i=0; i<64; i++)\n\t{\n\t\td = scene(p) + eps;\n\t\tp += d * dir;\n\t\tif( d>eps )\n\t\t{\n\t\t\tif(scene(p) < 0.)\n\t\t\t\tglowed=true;\n\t\t\tif(glowed)\n       \t\t\tglow = float(i)/64.;\n\t\t}\n\t}\n\treturn vec4(p,glow);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec3 eye = vec3(0, 2.1, 10.);\n    vec3 rayDir = rayDirection(90., iResolution.xy, fragCoord);\n    vec4 p = raymarch(eye, rayDir);\n\tfloat glow = p.w;\n\t\n    vec3  lig = normalize( vec3(0.0, -5., 2.) );\n    vec3  lig2 = normalize( vec3(0.0, 5., sin(iTime*0.5)*2.5 ));\n    vec3 hal = lig - rayDir;\n    \n    vec3 normal = calcNormal(p.xyz);\n    \n    float dif = clamp( dot( normal, lig ), 0.0, 1. );\n    float dif2 = clamp( dot( normal, lig2 ), 0.0, 1. );\n    vec3 mate = vec3(1.2);\n \n    vec3 lig1Colour = vec3(0.1, 0.3,0.4);\n    \n    vec3 lig2Colour = vec3(1.0,0.7, 0.7);\n    vec3 col = mate*dif*lig1Colour;\n    vec3 col2 = mate*dif2*lig2Colour;\n    \n    fragColor = mix(vec4(col, 1.), vec4(.4,0.3,0.1, 1.), pow(glow*2.,4.));\n  \tfragColor = mix(fragColor, vec4(col2, 1.), 0.5);\n\n}","name":"Image","description":"","type":"image"}]}