{"ver":"0.1","info":{"id":"7lsSRf","date":"1626243663","viewed":72,"name":"Reflection raymarch","username":"IDGAMER89","description":"Reflection","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["reflection","raymarch"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XsfGzn","filepath":"/media/a/585f9546c092f53ded45332b343144396c0b2d70d9965f585ebc172080d8aa58.jpg","previewfilepath":"/media/ap/585f9546c092f53ded45332b343144396c0b2d70d9965f585ebc172080d8aa58.jpg","type":"cubemap","channel":0,"sampler":{"filter":"mipmap","wrap":"clamp","vflip":"false","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define FOV 75.\n#define deg2rad (3.141/360.)\n\nfloat scene(vec3 p){\n    float d = length(p)-1.;\n    //d = min(d, (p).y+1.);\n    return d;\n}\n\nfloat RayMarch(vec3 ro,vec3 rd){\n    float dO = 0.0;\n    for(int i=0; i < 100; i++){\n        float dS = scene(ro+rd*dO);\n        dO+=dS;\n        if(dO > 100.||dS < 0.001)break;\n    }\n    return dO;\n}\n\nvec3 nor(vec3 p){\n    vec2 e = vec2(0.001, 0);\n    return normalize(\n            scene(p)-vec3(\n            scene(p-e.xyy),\n            scene(p-e.yxy),\n            scene(p-e.yyx)\n        )\n    );\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n    vec2 uv = (fragCoord-.5*iResolution.xy)/max(iResolution.x,iResolution.y);\n    vec3 ro = vec3(0,0,-6);\n    vec3 rd = normalize(vec3(uv, FOV*deg2rad));\n    float d = RayMarch(ro, rd);\n    vec3 p = ro+rd*d;\n    \n    vec3 col = vec3(0); \n    \n    if(d < 100.){\n        vec3 lpos = normalize(vec3(cos(iTime)*5.,6,sin(iTime)*5.)-p);\n        vec3 n = nor(p);\n        vec3 uV = reflect(rd, n);\n        vec3 coL = vec3(texture(iChannel0, uV));\n        col = coL;\n        //col += vec3(clamp(dot(n, lpos),0.,0.3));\n\n        \n    }else{\n        col = vec3(texture(iChannel0, rd));\n    }\n    \n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}