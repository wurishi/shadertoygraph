{"ver":"0.1","info":{"id":"3sfcD7","date":"1584880255","viewed":73,"name":"A complex smiley face","username":"betseyliu","description":"kawaiiii","likes":0,"published":1,"flags":0,"usePreview":0,"tags":["beginner"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define S(a, b, t) smoothstep(a, b ,t)\n#define sat(x) clamp(x, 0., 1.);\n\n\nfloat remap(float a, float b, float c, float d, float t) {\n \treturn clamp((t-a)/(b-a), 0., 1.)*(d-c)+c;\n}\n\nfloat normalize(float a, float b, float t) {\n\treturn sat(remap(a, b, 0., 1., t));\n}\n\nvec4 rgba(int r, int g, int b, float a) {\n\treturn vec4(float(r) / 255., float(g) / 255., float(b) / 255., a);\n}\n\nvec3 rgb(int r, int g, int b) {\n\treturn vec3(float(r) / 255., float(g) / 255., float(b) / 255.);\n}\n\nvec2 Within(vec2 uv, vec4 rect) {\n\treturn (uv - rect.xy) / (rect.zw - rect.xy);\n}\n\nvec4 Head(vec2 uv) {\n\tvec4 col = rgba(252, 183, 6, 1.0);\n    float d = length(uv);\n    // circle\n    col.a = S(.5, .49, d); // 裁剪出来一个圆形\n    \n \t// gradient\n    float edgeShade = normalize(.35, .5, d); // 渐变遮罩\n    edgeShade *= edgeShade; // 让渐变变得更加圆润\n    col.rgb *= 1. - edgeShade * .5; //让颜色加上去 \n    \n    // outline\n    col.rgb = mix(col.rgb, rgb(214, 117, 0), S(.48, .49, d)); // 增加边框\n    \n    //highlight\n    float highlight = S(.41, .405, d) * .75;\n    highlight *= remap(.41, -.1, .75, .0, uv.y);\n    col.rgb = mix(col.rgb, vec3(1.), highlight);\n    \n    d = length(uv - vec2(.3, -0.15));\n    float cheek = S(.2, 0., d);\n    col.rgb = mix(col.rgb, rgb(250, 143, 3), cheek);\n    return col;\n}\n\nvec4 Mouth(vec2 uv) {\n    uv -= .5;\n\tvec4 col = rgba(137, 7, 6, 1.);\n    uv.y *= 1.7;\n    uv.y -= uv.x * uv.x * 2.; \n    float d = length(uv);\n    col.a = S(.5, .48,d );\n    // tooth\n    float td = length(uv - vec2(0., .4));\n    vec3 toothCol = vec3(1.)*S(.6, .35, d); \n    col.rgb = mix(col.rgb, toothCol, S(.4, .37, td));\n    \n    \n    td = length(uv + vec2(0., .5));\n    col.rgb = mix(col.rgb, vec3(1., .5, .5), S(.4, .2,td));\n    return col;\n}\nvec4 Eye(vec2 uv) {\n    uv -= .5;\n    \n    float d = length(uv);\n    \n    vec4 irisCol = rgba(79, 141, 255, 1.);\n\tvec4 col = mix(vec4(1.), irisCol, S(.1, .7, d) * .6); //眼白的渐变\n    \n\tcol.rgb *= 1. - S(.45, .5, d) * sat(uv.y + uv.x);\n    \n\tcol.rgb = mix(col.rgb, vec3(0.), S(.3, .28, d)); // iris outline\n    col.rgb = mix(col.rgb, irisCol.rgb, S(.28, .25, d)); // iris color\n    col.rgb = mix(col.rgb, rgb(107, 217, 255), S(.25, .1 ,d)); // iris gradient\n    col.rgb = mix(col.rgb, vec3(0.), S(.17, .16 ,d)); // 瞳孔\n    \n    float highlight = S(.1, .09, length(uv - vec2(-.13, .1)));\n    highlight += S(.07, .05, length(uv - vec2(.1, -.1)));\n    col.rgb = mix(col.rgb, vec3(1.), highlight);\n    \n    col.a = S(.5, .48, d);\n    \n    return col;\n}\n\n\nvec4 Smiley(vec2 uv) {\n\tvec4 col = vec4(0.);\n    \n    //镜像\n    uv.x = abs(uv.x);\n    vec4 head = Head(uv);\n    col = mix(col, head, head.a);\n    \n    vec4 eye = Eye(Within(uv, vec4(.03, -.1, .37, .25)));\n    col = mix(col, eye, eye.a);\n    \n    uv.x = uv.x;\n    vec4 mouth = Mouth(Within(uv, vec4(-.3, -.4, .3, -.1)));\n    col = mix(col, mouth, mouth.a);\n    \n    return col;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // Normalized pixel coordinates (from 0 to 1)\n    vec2 uv = fragCoord/iResolution.xy;\n    \n    uv -= .5;\n    uv.x *= iResolution.x / iResolution.y;\n    \n    fragColor = Smiley(uv);\n}","name":"Image","description":"","type":"image"}]}