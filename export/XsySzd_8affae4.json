{"ver":"0.1","info":{"id":"XsySzd","date":"1465933709","viewed":251,"name":"C'est des belles roches, ca !","username":"atompacman","description":"For my beloved iguana","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["normalmap","gradient"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4sf3Rr","filepath":"/media/a/ad56fba948dfba9ae698198c109e71f118a54d209c0ea50d77ea546abad89c57.png","previewfilepath":"/media/ap/ad56fba948dfba9ae698198c109e71f118a54d209c0ea50d77ea546abad89c57.png","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// Parameters\nconst float MAX_SLOPE = 12.0;\n\n// Constants\nconst float PI = 3.14159265;\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord)\n{\n    vec2 dudv = 1.0 / iResolution.xy;\n\tvec2 xy = fragCoord.xy;\n    \n    float center = texture(iChannel0, (xy + vec2(0, 0)) * dudv).r;\n    float left   = texture(iChannel0, (xy - vec2(1, 0)) * dudv).r;\n    float right  = texture(iChannel0, (xy + vec2(1, 0)) * dudv).r;\n    float up     = texture(iChannel0, (xy + vec2(0, 1)) * dudv).r;\n    float down   = texture(iChannel0, (xy - vec2(0, 1)) * dudv).r;\n    \n    vec2 dxdy = vec2((center - left) + (right - center), \n                     (center - up  ) + (down  - center));\n    vec2 n_dxdy = dxdy / 2.0 + 0.5;\n    \n    vec2 maxSlope = MAX_SLOPE * dudv;\n    vec2 min_n = 0.5 - maxSlope;\n\tvec2 max_n = 0.5 + maxSlope;\n    vec2 n_s_dxdy = (clamp(n_dxdy, min_n, max_n) - min_n) / (max_n - min_n);\n\n    vec3 dir_x = vec3(cos(n_s_dxdy.x * PI), sin(n_s_dxdy.x * PI), 0);\n    vec3 dir_y = vec3(0, sin(n_s_dxdy.y * PI), cos(n_s_dxdy.y * PI));\n    \n    vec3 n = normalize(dir_x + dir_y);\n    \n    vec3 lightDir = normalize(vec3(cos(iTime / 2.0), 0.5, sin(iTime / 2.0)));\n        \n\tfragColor = vec4(pow(dot(n, lightDir), 1.0));\n}","name":"Image","description":"","type":"image"}]}