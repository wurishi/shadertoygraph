{"ver":"0.1","info":{"id":"3dySzK","date":"1574368233","viewed":110,"name":"Annoying auto buffer swapping","username":"Maddig","description":"Auto buffer swapping is annoying if you wanna use buffers to store abstracted data and stuff, can we fix that?\n\nLooks like we can! Better example coming in a bit!","likes":1,"published":1,"flags":32,"usePreview":0,"tags":["buffer","annoying","auto","swapping","arrrr"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // call from main image to buffer\n    fragColor = texelFetch(iChannel0,ivec2(fragCoord),0);\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"// IMPORTANT: make sure the buffer is in on of the iChannels below your code\n// or texelFetch() will give you nothing\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord/iResolution.xy;\n\t\n    // define a box to draw\n    vec2 fragLocation = vec2(0.25, 0.5) * iResolution.xy;\n    float inBounds = float(fragLocation.x - 10.0 < fragCoord.x &&\n                           fragLocation.x + 10.0 > fragCoord.x &&\n                           fragLocation.y - 10.0 < fragCoord.y &&\n                           fragLocation.y + 10.0 > fragCoord.y);\n\n    // initial buffer value (drawn only on the 1st frame)\n    vec3 col = vec3(inBounds) * float(iFrame % 2 == 0);\n    \n    // on the next frame copy the last buffer over\n    // removing this will make the box flicker because of the buffer swapping\n    col += texelFetch(iChannel0,ivec2(fragCoord),0).xyz * float(iFrame % 2 == 1);\n    \n    // discard any buffer draws after the second frame\n    if (iFrame > 1) discard;\n    \n    fragColor = vec4(col,1.0);\n}\n\n\n\n\n// TODO: handle multiple buffers? lol I have no idea how that would work\n// unless they somehow swap in a linear order or only two swap lol\n// I don't wanna spend ages testing that so I'll leave it here","name":"Buffer A","description":"","type":"buffer"}]}