{"ver":"0.1","info":{"id":"MdGcDG","date":"1523117366","viewed":161,"name":"strangeterrain","username":"nezza","description":"minified, but based on http://jamie-wong.com/2016/07/15/ray-marching-signed-distance-functions/ added terrain functions etc, just took phong + raymarching code","likes":4,"published":1,"flags":0,"usePreview":0,"tags":["terraintest"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4sf3Rr","filepath":"/media/a/ad56fba948dfba9ae698198c109e71f118a54d209c0ea50d77ea546abad89c57.png","previewfilepath":"/media/ap/ad56fba948dfba9ae698198c109e71f118a54d209c0ea50d77ea546abad89c57.png","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"const int m=255;const float v=0.,f=100.,e=.01;float n(float v,float f){return max(v,f);}float s(float v,float f){return min(v,f);}float x(float v,float e){return max(v,-e);}float n(vec3 v){vec3 f=abs(v)-vec3(1.,1.,1.);float m=min(max(f.r,max(f.g,f.b)),0.),e=length(max(f,0.));return m+e;}float n(vec3 v,vec3 e,float m){return length(v-e)-m;}float s(vec3 v){return length(v)-1.;}float x(vec3 v){float m=sin(iTime+v.b)*sin(iTime+v.r)*.5;m*=texture(iChannel0,v.rb*.08).r;return v.g-m;}float i(vec3 v){float f=n(v/1.2,vec3(4.*sin(iTime),1.,4.*cos(iTime)),.3);return min(x(v),f);}float i(vec3 v,vec3 f,float n,float b){float r=n;for(int l=0;l<m;l++){float t=i(v+r*f);if(t<e)return r;r+=t;if(r>=b)return b;}return b;}vec3 i(float v,vec2 m,vec2 e){vec2 f=e-m/2.;float b=m.g/tan(radians(v)/2.);return normalize(vec3(f,-b));}vec3 t(vec3 v){return normalize(vec3(i(vec3(v.r+e,v.g,v.b))-i(vec3(v.r-e,v.g,v.b)),i(vec3(v.r,v.g+e,v.b))-i(vec3(v.r,v.g-e,v.b)),i(vec3(v.r,v.g,v.b+e))-i(vec3(v.r,v.g,v.b-e))));}vec3 i(vec3 v,vec3 m,float f,vec3 e,vec3 i,vec3 r,vec3 b){vec3 n=t(e),g=normalize(r-e),l=normalize(i-e),c=normalize(reflect(-g,n));float s=dot(g,n),o=dot(c,l);if(s<0.)return vec3(0.,0.,0.);if(o<0.)return b*(v*s);return b*(v*s+m*pow(o,f));}vec3 i(vec3 v,vec3 f,vec3 m,float e,vec3 r,vec3 b){const vec3 n=.5*vec3(1.,1.,1.);vec3 l=n*v,g=vec3(4.*sin(iTime),1.,4.*cos(iTime)),s=vec3(.4,.4,.4);l+=i(f,m,e,r,b,g,s);vec3 t=vec3(2.*sin(.37*iTime),2.*cos(.37*iTime),2.),c=vec3(.4,.4,.4);l+=i(f,m,e,r,b,t,c);return l;}mat4 s(vec3 v,vec3 f,vec3 e){vec3 m=normalize(f-v),r=normalize(cross(m,e)),i=cross(r,m);return mat4(vec4(r,0.),vec4(i,0.),vec4(-m,0.),vec4(0.,0.,0.,1));}void mainImage(out vec4 r,in vec2 b){vec3 m=i(45.,iResolution.rg,b),g=vec3(8.,5.,7.);mat4 n=s(g,vec3(0.,0.,0.),vec3(0.,1.,0.));vec3 l=(n*vec4(m,0.)).rgb;float t=i(g,l,v,f);if(t>f-e){r=vec4(0.,0.,0.,0.);return;}vec3 c=g+t*l,o=vec3(.2,.2,.2),x=vec3(.2,0.,1.),a=vec3(1.,0.,0.);float u=10.;vec3 T=i(o,x,a,u,c,g);r=vec4(T,1.);}\n","name":"Image","description":"","type":"image"}]}