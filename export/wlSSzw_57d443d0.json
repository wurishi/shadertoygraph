{"ver":"0.1","info":{"id":"wlSSzw","date":"1565359547","viewed":112,"name":"RayMarchBuildings","username":"Hirai_worthless","description":"non-shading","likes":5,"published":1,"flags":0,"usePreview":0,"tags":["raymarching"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"float PI = 3.14159265;\nmat2 genRot(float val){\n\treturn mat2(cos(val),-sin(val),sin(val),cos(val));\n}\n\nfloat pipeWidth(float t){\n\treturn floor((2. + 0.5 * sin(t * 2. * PI))*2.) / 4.;\n}\n\nfloat mapR(vec3 p){\n        p.y = -abs(p.y - 1.5) + 1.5;\n        p.xz += 0.5;\n    p.xz = fract(p.xz);\n    p.xz -= 0.5;\n    p += vec3(0.1,-0.6,0.1);\n\tfloat building = max(abs(p.x) - 0.2,\n                         max(abs(p.y) - 0.6,\n                             abs(p.z) - 0.2));\n    vec3 q = p;\n    q.y -= 0.25;\n    q = abs(q);\n    float window1 = max(abs(q.x - 0.08) - 0.05,abs(abs(q.y - 0.08) - 0.08) - 0.05);\n        float window2 = max(abs(q.z - 0.08) - 0.05,abs(abs(q.y - 0.08) - 0.08) - 0.05);\n    float window = min(window1,window2);\n\tfloat door = max(abs(p.x + 0.1) - 0.3,\n                         max(abs(p.y + 0.6) - 0.3,\n                             abs(p.z) - 0.1));\n    window = min(window,door);\n    return max(building,-window);\n}\nfloat mapB(vec3 p){\n        p.y = -abs(p.y - 1.5) + 1.5;\n        p.xz += 0.5;\n    p.xz = fract(p.xz);\n    p.xz -= 0.5;\n    vec3 q = p + vec3(0.1,-0.6,0.1);\n\tfloat building1 = max(abs(q.x) - 0.18,\n                         max(abs(q.y) - 0.58,\n                             abs(q.z) - 0.18));\n    vec3 r = p + vec3(-0.1,-0.3,-0.1);\n    float building2 = max(abs(r.x) - 0.18,\n                         max(abs(r.y) - 0.28,\n                             abs(r.z) - 0.18));\n    return min(building1,building2);\n}\nfloat mapG(vec3 p){\n        p.y = -abs(p.y - 1.5) + 1.5;\n        p.xz += 0.5;\n    p.xz = fract(p.xz);\n    p.xz -= 0.5;\n    p += vec3(-0.1,-0.3,-0.1);\n    float building = max(abs(p.x) - 0.2,\n                         max(abs(p.y) - 0.3,\n                             abs(p.z) - 0.2));\n    vec3 q = p;\n    q.y -= 0.12;\n    q = abs(q);\n    float window1 = max(abs(q.x - 0.08) - 0.05,abs(q.y - 0.08) - 0.05);\n    float window2 = max(abs(q.z - 0.08) - 0.05,abs(q.y - 0.08) - 0.05);\n    float window = min(window1,window2);\n    return max(building,-window);\n\n}\n\nfloat mapA (vec3 p){\n    p.y = -abs(p.y - 1.5) + 1.5;\n        p.xz += 0.5;\n    p.xz = fract(p.xz);\n    p.xz -= 0.5;\n\treturn max(p.y,length(p.xz) - 0.5);\n}\nvec4 trace (vec3 o, vec3 r){\n\tfloat tR = 0.0;\n    for(int i = 0; i < 256; ++i){\n        vec3 pR = o + r * tR;\n        float dR = mapR(pR);\n        tR += dR * 0.25;\n    }\n    float tB = 0.0;\n    for(int i = 0; i < 256; ++i){\n        vec3 pB = o + r * tB;\n        float dB = mapB(pB);\n        tB += dB * 0.25;\n    }\n    float tG = 0.0;\n    for(int i = 0; i < 256; ++i){\n        vec3 pG = o + r * tG;\n        float dG = mapG(pG);\n        tG += dG * 0.25;\n    }\n    float tA = 0.0;\n    for(int i = 0; i < 256; ++i){\n        vec3 pA = o + r * tA;\n        float dA = mapA(pA);\n        tA += dA * 0.25;\n    }\n    return vec4(tR,tB,tG,tA);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // Normalized pixel coordinates (from 0 to 1)\n    float PI = 3.14159265;\n    vec2 uv = fragCoord.xy /iResolution.xy;\n\tuv = uv * 2.0 - 1.0;\n    uv.x *= iResolution.x / iResolution.y;\n    vec3 r = normalize(vec3(uv,1.5));\n    r.xy *= genRot(-1./4.);\n    r.xz *= genRot(-1./4.);\n    vec3 o = vec3(0.5,1.0,iTime * 2.);\n    vec4 t = trace(o,r);\n    vec3 colX = vec3(36,145,255) / 255.;\n    vec3 colY = vec3(250,209,106)/ 255.;\n    vec3 colZ = vec3(82,216,255) / 255.;\n    vec3 colA = vec3(71,79,91)/255.;\n    vec3 fc = \n        t.w < min(t.x,min(t.y,t.z)) ? colA :\n        t.x < min(t.y,t.z) ? colX :\n    \tt.y < t.z ? colY : colZ;\n    float fogT = min(min(t.x,t.w),min(t.y,t.z));\n    float fog = 1.0 / (1.0 + fogT * fogT * 0.1);\n    fc = mix(vec3(69,60,123)/255.,fc,fog);\n\n    // Output to screen\n    fragColor = vec4(fc,1.0);\n}","name":"Image","description":"","type":"image"}]}