{"ver":"0.1","info":{"id":"3lj3zD","date":"1558784029","viewed":174,"name":"torus12345454","username":"biki73","description":"torus","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["torus"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XdX3zn","filepath":"/media/a/488bd40303a2e2b9a71987e48c66ef41f5e937174bf316d3ed0e86410784b919.jpg","previewfilepath":"/media/ap/488bd40303a2e2b9a71987e48c66ef41f5e937174bf316d3ed0e86410784b919.jpg","type":"cubemap","channel":0,"sampler":{"filter":"mipmap","wrap":"clamp","vflip":"false","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"float R=0.3;\nvec3 sph=vec3(0.5,0.5,0.5);    \n\n\nvec4 Distance(vec3 p) {\nfloat dst,h;\nvec3 grad;\nvec3 pt;\nfloat ID;\nfloat rad;\nfloat lxz;\n    \n   ID=floor(p.x)+floor(p.y)+floor(p.z);\n   rad=0.2+0.10*sin(ID+float(iFrame)*0.01);\n   p.x=fract(p.x);\n   p.y=fract(p.y);\n   p.z=fract(p.z);\n   pt=p-sph;\n   h=dot(pt,pt);\n       \n   lxz=length(pt.xz);\n   dst=dot(pt,pt)+rad*rad-0.05*0.05-2.0*rad*lxz;\n    \n   grad.x=pt.x-rad*pt.x/lxz;\n   grad.z=pt.z-rad*pt.z/lxz;\n   grad.y=pt.y;\n   dst=0.5*dst/length(grad);\n   \n   return vec4(grad,dst);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n  vec3  pos,look,up,dir2,dir,p,n,lp,lv,reflected;\n  vec3  v1,v2,v3;\n  vec2  pix;\n  float diffuse,specular;\n  float angle,dist;\n  vec4  h;\n  int i;\n       \n  pos=vec3(5.0*sin(float(iFrame)*0.0031),\n           10.0*sin(float(iFrame)*0.0012),\n           5.0*sin(float(iFrame)*0.00234));\n  up=vec3(0,1,0);\n  look=vec3(0,0,0);\n  v1=normalize(look-pos);\n  v2=normalize(cross(v1,up));\n  v3=cross(v1,v2);\n    \n  pix=vec2(fragCoord-iResolution.xy); \n  dir=v1*iResolution.x+v2*pix.x+v3*pix.y;\n  dir=normalize(dir);\n\n  lp=vec3(40.0*sin(iTime),40.0*cos(iTime),0);\n    \n  dist=0.0;\n  for (i=0;i<200;i++) {\n    h=Distance(pos+dist*dir);\n    dist+=h.w;\n    if (h.w<0.00001) break;\n  }\n    n=h.xyz;\n    p=pos+dist*dir;\n    n=n+vec3(0.01*sin(fract(p.x)*200.0),0.01*sin(fract(p.y)*200.0),0.01*sin(fract(p.z)*200.0));\n    n=normalize(n);    \n    reflected=reflect(dir,n);\n    vec4 envmap=texture(iChannel0,reflected);\n    lv=lp-p;\n    lv=lv/length(lv);\n    diffuse=clamp(dot(lv,n),0.0,1.0);\n    specular=pow(clamp(dot(reflected,lv),0.0,1.0),100.0);\n    \n    float shade=mix(1.0+diffuse+specular,0.0,0.1*dist);\n     \n    shade=clamp(shade,0.0,1.0);\n    vec4 color=1.5*envmap*shade;\n    fragColor=vec4(color);\n}","name":"Image","description":"","type":"image"}]}