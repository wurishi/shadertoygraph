{"ver":"0.1","info":{"id":"lf2fzR","date":"1724599316","viewed":33,"name":"Mini march s = abs(s), s < 4e-3","username":"Elsio","description":"Varias tentativas de fazer esse estilo ficar bom. \numa hora eu paro em um","likes":3,"published":1,"flags":0,"usePreview":0,"tags":["fractal","test","raymarch","rotation","blackboard","cubo","estudy","cudomagico","lousa"],"hasliked":0,"parentid":"Xc23WK","parentname":"Swarovski"},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define rot(a) mat2(cos(a + vec4(0, 11, 33, 0)))\n#define cyl(q) max(length(q.xy) - .3, abs(q.z) - 3.)\n#define t iTime\n\nfloat link(vec3 p) {\n    p.zx *= rot(p.y * .5);\n    p = abs(p),\n    p.y = abs(p.y) - 1.;\n    return length(vec2(length(max(p.xy, 0.)) - .75, p.z)) - .4;\n}\n\nfloat map(vec3 p){\n    float cyl1, cyl2;\n    vec3 q = p;\n    \n    q.xz *= rot(-3.14/4.);\n    q.y += -1.;\n    cyl1 = cyl(q);\n\n    q = p;\n    q.xz *= rot(3.14/4.);\n    q.y += 1.;\n    cyl2 = cyl(q);\n    \n    return min(link(p), min(cyl1, cyl2));\n}\n\nvoid mainImage(out vec4 o, vec2 u) {\n    vec2 R = iResolution.xy,\n         m = (iMouse.xy - R / 2.)/ R.y;\n         u = (u - R / 2.)/ R.y;\n         \n    float d, s, ss, sg, i, j,\n          T = mod(t * .7, 4.),\n          a = smoothstep(1., 1.2, T), \n          b = smoothstep(2., 2.5, T), \n          c = smoothstep(3., 3.3, T); \n    \n    // transitions\n    ss = mix(.0001, \n             mix(.01, \n                 mix(1., \n                     .0001, \n         c), b), a);\n    \n    o *= 0.; \n    while(i++ < 44.) {\n        // camera\n        vec3 q = d * vec3(u, .8);  \n        q.z -= 3.;\n        \n        if(iMouse.z > 1.)\n            q.xz *= rot(m.x * 3.14),\n            q.yz *= rot(m.y * 3.14);\n        else\n            q.xy *= rot(t * .3),\n            q.yz *= rot(t * .2);\n\n        \n        // map\n        s = map(q);\n        \n        // displacement\n        for(j = 1.; j < 8.; j += j) \n            q *= j * 2., \n            s += .018 * abs(dot(sin(q), q / q)) / j;\n        \n        // mini march \n        sg = s,\n        s = abs(s),\n        \n        s < 4e-3\n            ? o += 3. / exp(i / d * 1.5)\n            : o += sg > 0. \n                      ? vec4(.004, .004, 0, 0) \n                      : vec4(.002, .002, .005, 0);\n        \n        // transite s in ss\n        d += max(s, ss);\n    }\n}","name":"Image","description":"","type":"image"}]}