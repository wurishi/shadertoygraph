{"ver":"0.1","info":{"id":"tlccWN","date":"1609179689","viewed":102,"name":"fontastic (vlllll)","username":"valalalalala","description":"Little bit of font fun. Love to put it in the \"common\" tab, but needs access to the font sampler... :-/","likes":3,"published":1,"flags":0,"usePreview":0,"tags":["utility","font"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGzr","filepath":"/media/a/08b42b43ae9d3c0605da11d0eac86618ea888e62cdd9518ee8b9097488b31560.png","previewfilepath":"/media/ap/08b42b43ae9d3c0605da11d0eac86618ea888e62cdd9518ee8b9097488b31560.png","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"////////////////////////////////////////////////////////////////////////////\n//\n// \"fontastic\" \n//\n// small font utility package\n//\n// by Val \"valalalalala\" GvM - 2020\n// Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License\n//\n// super useful: https://www.shadertoy.com/view/ldSBzd\n// ascii table https://theasciicode.com.ar/\n// https://shadertoyunofficial.wordpress.com/2016/07/20/special-shadertoy-features/\n//\n/////////////////////////////////////////////////////////////////////////////\n\n#define FONT_DEMO\n\n#define FONT_SAMPLER    iChannel0\n#define FONT_STRIDE(n)  ((n)*vec2( .5, .0 ))\n\n#define FONT_STAR 28\n#define FONT_0    48\n#define FONT_DASH 45\n#define FONT_DOT  46\n#define FONT_T    84\n#define FONT_e    101\n#define FONT_s    115\n#define FONT_t    116\n\nfloat characterDistance( vec2 point, int character ) {\n    vec2 charAt = vec2( character % 16, 15 - character / 16 ) / 16. + 1./32.;    \n    float w = textureLod( FONT_SAMPLER, charAt + point / 16., .0 ).w;\n    vec2 box = abs( point / .8 );\n    return max( w, max( box.x, box.y ) );\n}\n\nfloat characterLength( int value ) {\n    return floor( 1. + log2( float( abs( ( value == 0 ) ? 1 : value ) ) ) / log2( 10.) );\n}\n\nfloat numericStringDistance( vec2 point, int value ) {\n    point -= FONT_STRIDE( characterLength( value ) - 1. );\n    float d = 0 == value ? characterDistance( point, FONT_0 ) : 1e33;  \n    for( int v = abs( value ) ; 0 != v ; v /= 10, point += FONT_STRIDE( 1. ) ) {\n        d = min( d, characterDistance( point, FONT_0 + v % 10 ) );\n    }  \n    return min( d, value < 0 ? characterDistance( point, FONT_DASH ) : 1e33 );\n}\n\nfloat numericStringDistance( in vec2 point, in float value, int decimals ) {\n    int vi = int( sign( value ) * floor( abs( value ) ) );\n    float d = numericStringDistance( point, vi );  \n    \n    point -= FONT_STRIDE( characterLength( vi ) );\n    d = min( d, characterDistance( point, FONT_DOT ) );\n\n    point -= FONT_STRIDE(1.);\n    \n    float vf = fract( abs( value ) ) * 10.;\n    int max = int( pow( 10., float( decimals ) ) );\n    for ( int i = 1 ; i <= decimals ; i++, vf *=10. , point -= FONT_STRIDE( 1. ) ) {\n        int n = int( vf ) % 10;\n        d = min( d, characterDistance( point, FONT_0 + n % 10 ) );\n    }\n\n    return d;\n}\n\nfloat numericStringDistance( in vec2 point, in float value ) {\n    return numericStringDistance( point, value, 2 );\n}\n\nfloat stringDistance( vec2 point, int string ) {\n    return \n        min( characterDistance( point, ( string >> 0 ) & 0xFF ),\n        min( characterDistance( point - FONT_STRIDE( 1. ), ( string >> 8 ) & 0xFF ),\n        min( characterDistance( point - FONT_STRIDE( 2. ), ( string >> 16 ) & 0xFF ),\n             characterDistance( point - FONT_STRIDE( 3. ), ( string >> 24 ) & 0xFF ))));\n}\n\nfloat stringDistance( vec2 point, ivec4 string ) {\n    return\n        min( stringDistance( point - FONT_STRIDE( 0. * 4. ), string[ 0 ] ),\n        min( stringDistance( point - FONT_STRIDE( 1. * 4. ), string[ 1 ] ),\n        min( stringDistance( point - FONT_STRIDE( 2. * 4. ), string[ 2 ] ),\n             stringDistance( point - FONT_STRIDE( 3. * 4. ), string[ 3 ]))));\n}\n\n#ifdef FONT_DEMO\n\n#define NUMERIC    numericStringDistance\n#define STRING     stringDistance\n#define CHARACTER  characterDistance\n\nfloat distanceToShape( float d, float t ) {\n    return smoothstep( .5 - t, .5 + t, 1.-d );\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n    vec2 uv = ( 2. * fragCoord - iResolution.xy ) / iResolution.y;\n    \n    float d = 1e33;\n    \n    int character = int( mod( iTime, 256. ) );\n    vec2 trig = vec2( cos( iTime ), sin( iTime ) );\n    d = min( d, CHARACTER( ( uv - trig * .3 ) / .22, character ) );\n    d = min( d, NUMERIC(   ( uv - trig * .6 ) / .22, character ) );\n    \n    //float d = characterLoop( uv );    \n    d = min( d, NUMERIC( ( uv - vec2( 1.3, .8 ) ) / .13, 10. * sin( iTime * 2. ) ) );\n    d = min( d, NUMERIC( ( uv - vec2( 1.3, .7 ) ) / .13, 10. * cos( iTime * 2. ) ) );\n    \n    // pack 4 characters into an int \n    int test = FONT_T << 0 | FONT_e << 8 | FONT_s << 16 | FONT_t << 24;\n    d = min( d, STRING(  ( uv - vec2( 1.2, -.4 ) ) / .1, test ) );\n    d = min( d, NUMERIC( ( uv - vec2( 1.2, -.5 ) ) / .1, test ) );\n    d = min( d, NUMERIC( ( uv - vec2( 1.2, -.6 ) ) / .1, -1*test ) );\n    d = min( d, NUMERIC( ( uv - vec2( 1.2, -.7 ) ) / .1, 0*test ) );\n\n    // https://luckybit4755.github.io/shady-lady/html/text-to-ivec4.html\n    ivec4 text1 = ivec4( 543516756, 1667855729, 1919033451, 544110447 ); /* \"The quick brown \" */\n    ivec4 text2 = ivec4( 544763750, 1886221674, 1986994291, 538997349 ); /* \"fox jumps over  \" */\n    ivec4 text3 = ivec4( 543516788, 2038063468, 1735353376, 538976288 ); /* \"the lazy dog    \" */\n    d = min( d, STRING( ( uv - vec2( -1.7, .9 ) ) / .1, text1 ) );\n    d = min( d, STRING( ( uv - vec2( -1.7, .8 ) ) / .1, text2 ) );\n    d = min( d, STRING( ( uv - vec2( -1.7, .7 ) ) / .1, text3 ) );\n    \n    d = min( d, CHARACTER( ( uv - vec2( trig.x * 1.33, -.88 ) ) / .22, FONT_STAR ) );\n\n    ////\n    \n    float r = distanceToShape( d, .07 );\n    float c = distanceToShape( d, .01 );\n    fragColor = vec4( vec3( r * 33., c, c *.3 ), 1. );\n}\n\n#endif","name":"Image","description":"","type":"image"}]}