{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[{"channel":0,"type":"video","id":"4sX3Rn","filepath":"/media/a/c3a071ecf273428bc72fc72b2dd972671de8da420a2d4f917b75d20e1c24b34c.ogv","sampler":{"filter":"linear","wrap":"clamp","vflip":"false","srgb":"false","internal":"byte"}},{"channel":1,"type":"keyboard","id":"4dXGRr","filepath":"/presets/tex00.jpg","sampler":{"filter":"nearest","wrap":"clamp","vflip":"false","srgb":"false","internal":"byte"}}],"code":"// TV Moire Pattern Effect\n// by rinf 2014.\n//\n// Simulates a TV screen consisting of RGB pixels and a camera filming the screen,\n// which creates a nice Moire pattern.\n//\n// Use fullscreen mode for best experience\n//\n// Press 'x' to toggle effect on and off\n\n#define KEY_X 88.5/256.0\n#define TV_SCREEN_RESOLUTION_X 640.0\n\nstruct Rectangle\n{\n    vec3 v1;\n    vec3 v2;\n    vec3 v3;\n};\n\nvec3 CalcNormal(Rectangle A)\n{\n vec3 first = A.v1 - A.v2;\n vec3 second = A.v2 - A.v3;\n    \n return cross(first,second);\n}\n\nvec3 Intersect(vec3 B, vec3 r, vec3 A, vec3 p)\n{\n float u=0.0;\n if (r.x*p.x+r.y*p.y+r.z*p.z!=0.0)\n {\n \tu =  (dot(A,p)-dot(B,p))/(dot(r,p));\n }\n \n return B+r*u;\n}\n\nvec2 Calc_ul(vec3 B, vec3 C, vec3 r, vec3 s)\n{\n    float l = (C.y*r.x-B.y*r.x-C.x*r.y+B.x*r.y)/(s.y-s.x*r.y);\n    float u = 0.0;\n\tif (r.x==0.0)\n\t{\n\t\tu=0.0;\n\t}\n\telse\n\t{\n\t\tu = (C.x-B.x-l*s.x)/r.x;\n\t}\n    \n    return vec2(u,l);\n}\n\nvec3 GetScreenPixelColor(vec2 ul)\n{\n    float x = mod(ul.x * TV_SCREEN_RESOLUTION_X / (1600.0/iResolution.x) * 3.0,3.0);\n\n    vec3 tex = texture(iChannel0, vec2(ul.x,ul.y) ).xyz;\n    \n    return mix(mix(vec3(tex.r,0.0,0.0),vec3(0.0,tex.g,0.0),step(1.0,x)),\n              vec3(0.0,0.0,tex.b),step(2.0,x));\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 q = fragCoord.xy / iResolution.xy;\n    \n    vec2 rect_offset = vec2(-0.5, -0.5);\n    float zoom = 0.9+sin(iTime*0.3)*0.55;\n \n    Rectangle rect;\n    rect.v1 = vec3(0.1+rect_offset.x, 0.1+rect_offset.y, 0.4+sin(iTime*1.5)*0.15);\n    rect.v2 = vec3(0.1+rect_offset.x, 0.9+rect_offset.y, 0.5+sin(iTime*1.5)*0.15);\n    rect.v3 = vec3(0.9+rect_offset.x, 0.9+rect_offset.y, 0.5+cos(iTime*1.0)*0.15);\n    \n    float bu = abs(rect.v2.x - rect.v3.x);\n    float bl = abs(rect.v1.y - rect.v2.y);\n    \n    \n    vec3 rect_normal_vector = CalcNormal(rect);\n    rect_normal_vector = normalize(rect_normal_vector);\n    \n    vec3 plane_vector1 = normalize(rect.v2 - rect.v1);\n    vec3 plane_vector2 = normalize(rect.v3 - rect.v2);\n    \n    \n    vec3 screen_vector = vec3( q.x/10.0 , q.y/10.0 , -1);\n    vec3 camera = vec3( q.x-0.5, q.y+0.5, zoom);\n    vec3 ray = camera - screen_vector;\n    vec3 intersection = Intersect(camera,ray,rect.v3,rect_normal_vector);\n    \n    vec2 ul = Calc_ul(rect.v2, intersection, plane_vector2, plane_vector1);\n\tvec3 new_col = vec3(0.0, 0.0, 0.0);\n    vec3 old_col = vec3(0.0, 0.0, 0.0);\n    \n    if (ul.x>0.0 && ul.x<1.0 && ul.y>0.0 && ul.y<1.0)\n    {\n        float count=0.0;\n        \n        for (float i=-1.0;i<1.0;i+=0.33)\n        {\n            new_col += GetScreenPixelColor(vec2(ul.x+i/iResolution.x,ul.y));\n            count = count + 1.0;\n        }\n\n        new_col = 3.0*new_col/count;\n        old_col = texture(iChannel0, vec2(ul.x,ul.y) ).xyz;\n    }\n    \n    \n    if (texture(iChannel1,vec2(KEY_X, 0.75)).x > 0.0)\n        new_col =old_col;\n        \n    fragColor = vec4(new_col,1.0);\n}","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":true,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"4sjXzm","date":"1410876761","viewed":1862,"name":"TV Moire Pattern Effect","username":"rinf","description":"Simulates a TV screen consisting of RGB pixels and a camera filming the screen, which creates a nice Moire pattern. Press 'x' to toggle effect on and off. \nby rinf 2014.","likes":43,"published":1,"flags":16,"usePreview":0,"tags":["tvcrtaliasingmoirepatterneffect"],"hasliked":0,"parentid":"","parentname":""}}