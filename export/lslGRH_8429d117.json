{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[],"code":"// With tweaks from fernlightning\n\nfloat rand(vec3 n) {\n  n = floor(n);\n  return fract(sin((n.x+n.y*1e2+n.z*1e4)*1e-4)*1e5);\n}\n\n// .x is distance, .y = colour\nvec2 map( vec3 p ) {\n\tconst float RADIUS = 0.25;\n\n\t// cylinder\n\tvec3 f = fract( p ) - 0.5;\n\tfloat d = length( f.xy );\n        float cr = rand( p );\n\tfloat cd = d - cr*RADIUS;\n\n\t// end - calc (rand) radius at more stable pos\n\tp.z -= 0.5;\n\tfloat rr = rand( p );\n\tfloat rn = d - rr*RADIUS;\n    float rm = abs( fract( p.z ) - 0.5 );  // offset so at end of cylinder\n       \n\tfloat rd = sqrt( rn*rn + rm*rm ); // end with ring\n\n\treturn (cd < rd) ?  vec2( cd, cr ) : vec2( rd, rr ); // min\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n    vec2 pos = (fragCoord.xy*2.0 - iResolution.xy) / iResolution.y;\n    vec3 camPos = vec3(cos(iTime*0.3), sin(iTime*0.3), 3.5);\n    vec3 camTarget = vec3(0.0, 0.0, .0);\n\n    vec3 camDir = normalize(camTarget-camPos);\n    vec3 camUp  = normalize(vec3(0.0, 1.0, 0.0));\n    vec3 camSide = cross(camDir, camUp);\n    float focus = 1.8;\n\n    vec3 rayDir = normalize(camSide*pos.x + camUp*pos.y + camDir*focus);\n    vec3 ray = camPos;\n    float m = 0.32;\n    vec2 d;\n    float total_d = 0.;\n    const int MAX_MARCH = 100;\n    const float MAX_DISTANCE = 100.0;\n    for(int i=0; i<MAX_MARCH; ++i) {\n        d = map(ray-vec3(0.,0.,iTime/2.));\n        total_d += d.x;\n        ray += rayDir * d.x;\n        m += 1.0;\n        if(abs(d.x)<0.01) { break; }\n        if(total_d>MAX_DISTANCE) { total_d=MAX_DISTANCE; break; }\n    }\n\n    float c = (total_d)*0.0001;\n    vec4 result = vec4( 1.0-vec3(c, c, c) - vec3(0.025, 0.025, 0.02)*m*0.8, 1.0 );\n    fragColor = result*d.y;\n}\n","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"lslGRH","date":"1362962541","viewed":1315,"name":"NanoTubes","username":"Trisomie21","description":"For the tube lover, tubes & more tubes.","likes":37,"published":1,"flags":0,"usePreview":0,"tags":["raymarching"],"hasliked":0,"parentid":"","parentname":""}}