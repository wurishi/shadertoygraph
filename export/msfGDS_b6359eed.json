{"ver":"0.1","info":{"id":"msfGDS","date":"1666711586","viewed":137,"name":"Old crt tv effect","username":"Eldeston","description":"Old crt effect with barrel distortion and vignette","likes":0,"published":1,"flags":0,"usePreview":0,"tags":["retro","distortion","crt","vignette"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4sX3Rn","filepath":"/media/a/c3a071ecf273428bc72fc72b2dd972671de8da420a2d4f917b75d20e1c24b34c.ogv","previewfilepath":"/media/ap/c3a071ecf273428bc72fc72b2dd972671de8da420a2d4f917b75d20e1c24b34c.ogv","type":"video","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void mainImage(out vec4 fragColor, in vec2 fragCoord){\n    // Calculate main uv\n    vec2 uv = fragCoord.xy / iResolution.xy - 0.5;\n    \n    // Calculate new resolution\n    const float resolutionMultiplier = 0.25;\n    vec2 newResolution = iResolution.xy * resolutionMultiplier;\n    \n    // Calculate distance\n    float dist = length(uv);\n    \n    // Calculate distorted \"barrel\" effect\n    vec2 distortedUv = uv * (1.0 + (dist - 0.5) * 0.5) + 0.5;\n    \n    // Get separate retro distorted uv\n    vec2 retroUv = floor(distortedUv * newResolution) / newResolution;\n    \n    // Sample texture with retro distorted uv\n    vec3 finalCol = texture(iChannel0, retroUv).rgb;\n    \n    // Vignette\n    finalCol *= 1.0 - dist * dist;\n    \n    // Get fracted distorted uv scaled by the new resolution\n    float pixelFract = fract(distortedUv.x * newResolution.x);\n    \n    // Separate each color into segments for the old crt effect\n    if(pixelFract < 0.333) finalCol.bg = vec2(0);\n    else if(pixelFract < 0.666) finalCol.rb = vec2(0);\n    else if(pixelFract < 1.0) finalCol.rg = vec2(0);\n\n    // Output to screen\n    if(distortedUv.x < 0.0 || distortedUv.y < 0.0 || distortedUv.x > 1.0 || distortedUv.y > 1.0) fragColor = vec4(0, 0, 0, 1);\n    else fragColor = vec4(finalCol, 1);\n}","name":"Image","description":"","type":"image"}]}