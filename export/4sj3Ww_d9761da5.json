{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[],"code":"#define STEPS 80\n#define LIGHTPASSES 2\n\n#define center vec2(0.5,0.5*iResolution.y/iResolution.x)\nconst vec3 wallColor = vec3(1.,1.,1.);\n\n/*by Olivier de Schaetzen (citiral)\nhaven't really seen anything like this before, so either I don't check enough shaders or I might have made something original once ;)\n*/\n\n//random function not by me, found it somewhere on the internet!\nfloat rand(vec2 n)\n{\n  return 1. * \n     fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453);\n}\n\nvec3 getColor(vec2 p)\n{\t vec3 wallColor = vec3(1.,1.,1.);\n\tif (p.x >= 0.1 && p.x <= 0.19 && p.y >= 0.1 && p.y <= 0.19) {\n\t\treturn wallColor;\n\t}\n\t\n\tp.x += sin(iTime)*0.1;\n\tp.y += cos(iTime)*0.1;\n\tif (length(p-center) <= 0.05) {\n\t\treturn wallColor;\t\n\t}\n\t\n\treturn vec3(0.3,0.3,0.3);\n}\n\nvec3 getLighting(vec2 p, vec2 lp)\n{\n\tvec2 sp = p;\n\tvec2 v = (lp-p)/float(STEPS);\n\t\n\tfor (int i = 0 ; i < STEPS ; i++) {\n\t\tif (getColor(sp) == wallColor) {\n\t\t\treturn length(p-lp)/vec3(1.,1.,1.) + 1./length(p-lp)*0.075*vec3(1.0,0.5*(sin(iTime)+1.),0.6);\n\t\t}\n\t\tsp += v;\n\t}\n\t\n\treturn vec3(1.0,1.0,1.0)+1./length(p-lp)*0.075*vec3(1.0,0.5*(sin(iTime)+1.),0.6);\n}\n\nvec3 blendLighting(vec2 p, vec2 lp)\n{\t\n\tvec2 r;\n\tvec3 c = vec3(0.,0.,0.);\n\t\n\tfor (int i = 1 ; i <= LIGHTPASSES ; i++) {\n\t\tr = vec2(rand(sin(iTime*float(i))+p.xy)*0.03-0.015,rand(cos(iTime*float(i))+p.yx)*0.03-0.015);\n\t\tc += getLighting(p,lp+r)/float(LIGHTPASSES);\n\t}\n\t\n\treturn c;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n\n\tvec2 p = fragCoord.xy/iResolution.xy;\n\tvec2 lp = iMouse.xy / iResolution.xy;\n\tp.y *= iResolution.y/iResolution.x;\n\tlp.y *= iResolution.y/iResolution.x;\t\n\t\n\t\n\tfragColor = vec4(getColor(p)*blendLighting(p,lp),1.);\n}","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"4sj3Ww","date":"1389292626","viewed":1148,"name":"2D lighting","username":"Citiral","description":"Pretty sketchy 2D lighting, it can be heavily improved as it still has some artifacts, (like at the shadow of the cube) and I'm not completely pleased with the shadows just yet, but I had some real fun making this!","likes":19,"published":1,"flags":0,"usePreview":0,"tags":["2d","shadow","lighting","sketch"],"hasliked":0,"parentid":"","parentname":""}}