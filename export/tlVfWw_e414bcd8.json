{"ver":"0.1","info":{"id":"tlVfWw","date":"1614638010","viewed":201,"name":"Rodarte","username":"mhnewman","description":"Inspired by Rodarte","likes":21,"published":1,"flags":0,"usePreview":0,"tags":["procedural","2d","flower","heart","pattern","fabric","rodarte"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"const float speed = 0.6;\nconst vec3 pink = vec3(1.0, 0.9, 0.9);\nconst vec3 red = vec3(1.0, 0.2, 0.1);\nconst vec3 petalA = vec3(1.0, 0.7, 0.8);\nconst vec3 petalB = vec3(0.7, 0.0, 0.0);\nconst vec3 green = vec3(0.1, 0.4, 0.1);\n\nvec2 rotate(vec2 p, float a) {\n    float s = sin(a);\n    float c = cos(a);\n    return p * mat2(c, -s, s, c);\n}\n\n// Heart shape from https://www.shadertoy.com/view/XdcyW8\nfloat heart(vec2 p) {\n    float k = 1.2 * p.y - sqrt(abs(p.x) + 0.3) + 0.7;\n    return step(p.x * p.x + k * k, 1.0);\n}\n\nfloat leaf(vec2 p) {\n    p.y = abs(p.y);\n    p -= vec2(0.5, -0.5);\n    return step(dot(p, p), 0.5);\n}\n\nvoid petal(inout vec3 color, vec2 p) {\n    float grad = 1.0 - p.x;\n    color = mix(color, mix(petalA, petalB, grad * grad), leaf(p));\n}\n\nvoid flower(inout vec3 color, vec2 p) {\n    p -= vec2(0.3, -0.1);\n    float stem = step(p.x, 0.1) * step(-1.7, p.x);\n    color = mix(color, green, step(abs(p.y + 0.2 * sin(2.0 * p.x)), 0.1 * stem));\n    petal(color, rotate(p, -0.5));\n    petal(color, rotate(p, 0.5));\n    petal(color, p);\n    p -= vec2(-0.7, 0.17);\n    color = mix(color, green, leaf(rotate(p, -1.1)));\n    color = mix(color, green, leaf(rotate(p, 1.1)));\n}\n\nvoid heartLayer(inout vec3 color, vec2 p, float t) {\n    p *= 2.0;\n    float col = floor(p.x);\n    p.x = fract(p.x);\n    p.y += 0.5 * t * (mod(col + 0.5, 2.0) - 1.0);\n    float row = floor(p.y);\n    p.y = fract(p.y);\n    p -= vec2(0.5) + 0.2 * sin(vec2(11.0, 17.0) * (row + col) + t);\n    color = mix(color, pink, smoothstep(0.25, 0.0, length(p)));\n    p = rotate(p, col + 5.0 * row + 4.0 * (mod(row + 0.5, 2.0) - 1.0) * t);\n    color = mix(color, red, heart(10.0 * p));\n}\n\nvoid flowerLayer(inout vec3 color, vec2 p, float t) {\n    p *= 2.0;\n    float col = floor(p.x);\n    p.x = fract(p.x);\n    p.y += 0.5 * t * (mod(col + 0.5, 2.0) - 1.0);\n    float row = floor(p.y);\n    p.y = fract(p.y);\n    p -= vec2(0.5) + 0.2 * sin(vec2(11.0, 17.0) * (row + col) + t);\n    color = mix(color, pink, smoothstep(0.25, 0.0, length(p)));\n    p = rotate(p, col + 5.0 * row + 4.0 * (mod(row + 0.5, 2.0) - 1.0) * t);\n    flower(color, 10.0 * p);\n}\n\nvoid heartFrame(inout vec3 color, vec2 p, float t) {\n    p.y = -abs(p.y);\n    color = mix(color, pink, smoothstep(-0.5, -1.1, p.y));\n\n    p *= 0.5;\n    p.x = fract(p.x);\n    color = mix(color, red, heart(15.0 * (p + vec2(-0.93, 0.43))));\n    \n    float smallHeart = step(p.x, 0.86);\n    p *= 10.5;\n    float wave = 4.5 + 0.3 * sin(6.283185 * floor(p.x) / 10.5 + 2.0 * t);\n    p.x = fract(p.x);\n    color = mix(color, red, heart(2.3 * (p + vec2(-0.5, wave))) * smallHeart);\n}\n\nfloat stemHeight(float x) {\n    return 0.5 * cos(0.6 * x) + 0.1 * sin(3.0 * x) + 0.04 * cos(5.3 * x);\n}\n\nfloat growth(float x, float t) {\n    float center = t + 0.4 * (iResolution.x / iResolution.y) * sin(0.3 * t) - 0.5;\n    return 1.0 - abs(center - x);\n}\n\nvoid bloom(inout vec3 color, vec2 p, float t) {\n    p += vec2(t, 0.0);\n    float center = t + sin(0.3 * t);\n    float stem = clamp(2.0 * growth(p.x, t), 0.0, 1.0);\n    color = mix(color, green, step(abs(p.y - stemHeight(p.x)), 0.006 * stem));\n    \n    float id = floor(p.x * 10.0 + 0.2) / 10.0;\n    vec2 base = p - vec2(id, stemHeight(id));\n    float g = smoothstep(0.0, 0.5, growth(id, t)) + 0.01;\n    float size = (10.0 + 4.0 * sin(13.0 * id)) / g;\n    color = mix(color, green, leaf(size * rotate(base, -1.1 * g)));\n    size = (10.0 + 4.0 * sin(17.0 * id)) / g;\n    color = mix(color, green, leaf(size * rotate(base, 1.1 * g)));\n    \n    id = floor(p.x * 3.0 + 0.4) / 3.0;\n    base = p - vec2(id, stemHeight(id));\n    g = growth(id, t);\n    size = 5.0 / (smoothstep(0.0, 0.4, g) + 0.01);\n    float dir = 1.5 * sin(10.0 * id);\n    float r = smoothstep(0.0, 0.8, g);\n    petal(color, size * rotate(base, dir - 0.9 * r));\n    petal(color, size * rotate(base, dir + 0.9 * r));\n    petal(color, size * rotate(base, dir - 0.5 * r));\n    petal(color, size * rotate(base, dir + 0.5 * r));\n    petal(color, size * rotate(base, dir));\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord) {\n    vec2 pos = (2.0 * fragCoord - iResolution.xy) / iResolution.y;\n    float time = speed * iTime;\n\n    vec3 color = pink;\n    \n    heartLayer(color, rotate(3.0 * pos + vec2(time / 3.0, 0.0), 1.0), time + 10.0);\n    color = mix(color, pink, 0.2);\n    flowerLayer(color, rotate(2.5 * pos + vec2(time / 2.5, 0.0), 2.0), time + 20.0);\n    color = mix(color, pink, 0.2);\n    heartLayer(color, rotate(1.6 * pos + vec2(time / 1.6, 0.0), 2.0), time + 20.0);\n    color = mix(color, pink, 0.2);\n    flowerLayer(color, rotate(1.1 * pos + vec2(time / 1.1, 0.0), 3.0), time + 30.0);\n    heartFrame(color, pos + vec2(time, 0.0), time);\n    bloom(color, pos, time);\n\n    fragColor = vec4(color, 1.0);\n}","name":"Image","description":"","type":"image"}]}