{"ver":"0.1","info":{"id":"XtG3DV","date":"1476736626","viewed":239,"name":"Noise regions","username":"piotrekli","description":"cave generation test...\nUpdate 18.10.2016: added animation (thanks, FabriceNeyret2) and \"shading\"","likes":4,"published":1,"flags":0,"usePreview":0,"tags":["procedural","2d","noise"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"Xsf3zn","filepath":"/media/a/f735bee5b64ef98879dc618b016ecf7939a5756040c2cde21ccb15e69a6e1cfb.png","previewfilepath":"/media/ap/f735bee5b64ef98879dc618b016ecf7939a5756040c2cde21ccb15e69a6e1cfb.png","type":"texture","channel":3,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define ANIMATION\n#define SHADING\n\n#define OCTAVES 6\n#define SCALE 2.0\n#define THRESHOLD 0.035\n\n#define CHECK(V,R,G,B) if (V > greatest) {sgt = greatest; greatest = V; col = vec3(R, G, B);} else if (V > sgt) sgt = V;\n\nvec4 random(vec2 uv)\n{\n    return texture(iChannel3, fract(uv\n#                                     ifdef ANIMATION\n                                      +.003*iTime\n#                                     endif\n                                     ));\n}\n\nvec4 vn(vec2 uv, float persistence)\n{\n    vec4 v = vec4(0.0);\n    float m = 0.0;\n    for (int i=0; i<OCTAVES; ++i)\n    {\n        v = v*persistence+random(uv);\n        m = m*persistence+1.0;\n        uv *= SCALE;\n    }\n    return v/m;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 uv = fragCoord.xy / min(iResolution.x, iResolution.y);\n    vec4 tex = vn(uv*0.05, 3.0);\n    tex /= tex.x + tex.y + tex.z + tex.w;\n    vec3 col = vec3(1.0, 0.0, 0.0);\n    float greatest = tex.x, sgt = 0.0;\n    CHECK(tex.y, 0.0, 1.0, 0.0)\n    CHECK(tex.z, 0.0, 0.0, 1.0)\n    //CHECK(tex.w, 0.75, 0.75, 0.25)\n    if (greatest-sgt < THRESHOLD) col = vec3(0.0);\n#   ifdef SHADING\n    else col *= 1.0-(greatest-sgt-THRESHOLD)*4.0;\n#   endif\n\tfragColor = vec4(col, 1.0);\n}","name":"Image","description":"","type":"image"}]}