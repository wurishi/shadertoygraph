{"ver":"0.1","info":{"id":"wlcfWn","date":"1612501337","viewed":164,"name":"CIE Lab visualizer","username":"pacaro","description":"Animates through the CIE Lab colorspace, varying l with time","likes":3,"published":1,"flags":0,"usePreview":0,"tags":["lab","colorspace","cie"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"const vec4 kLight = vec4(0.75, 0.75, 0.75, 1.0);\nconst vec4 kDark = vec4(0.5, 0.5, 0.5, 1.0);\n\nvec4 checkerBoard(in vec2 fragCoord) {\n    return (int(fragCoord.x / 16.0) + int(fragCoord.y / 16.0)) % 2 == 1 ? kLight : kDark;\n}\n\nconst vec3 kD65 = vec3(95.047, 100.00, 108.883);\n\nfloat xyzF(in float t) {\n  const float kThreshold = 6.0 / 29.0;\n  const float kFactor = 3.0 * pow(6.0 / 29.0, 2.0);\n  const float kConstant = 4.0 / 29.0;\n \n  return t > kThreshold ? pow(t, 3.0) : kFactor * (t - kConstant);\n}\n\nfloat gamma(in float c) {\n  return c < 0.0031308 ? 12.92 * c : 1.055 * pow(c, 1.0 / 2.4) - 0.055;\n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    float xCenter = iResolution.x / 2.0;\n    float yCenter = iResolution.y / 2.0;\n    float scale = 110.0 / (min(iResolution.x, iResolution.y) / 2.0);\n    \n    float a = scale * (fragCoord.x - xCenter);\n    float b = scale * (fragCoord.y - yCenter);\n    \n    if (a < -100.0 || a > 100.0 || b < -100.0 || b > 100.0) {\n      fragColor = checkerBoard(fragCoord);\n    } else {\n      // animate l\n      float l = sin(iTime / 2.0) * 50.0 + 50.0;\n      // mouse control of l\n      // float l = clamp(100.0 * iMouse.y / iResolution.y, 0.0, 100.0);\n      \n      float lf = (l + 16.0) / 116.0;\n  \n      vec3 colorXyz = vec3(\n          kD65.x * xyzF(lf + a / 500.0),\n          kD65.y * xyzF(lf),\n          kD65.z * xyzF(lf - b / 200.0));\n      \n      float r = gamma(( 3.2406 * colorXyz.x - 1.5372 * colorXyz.y - 0.4986 * colorXyz.z) / 100.0);\n      float g = gamma((-0.9689 * colorXyz.x + 1.8758 * colorXyz.y + 0.0415 * colorXyz.z) / 100.0);\n      float b = gamma(( 0.0557 * colorXyz.x - 0.2040 * colorXyz.y + 1.0570 * colorXyz.z) / 100.0);\n      \n      if (r < 0.0 || r > 1.0 || g < 0.0 || g >= 1.0 || b < 0.0 || b >= 1.0) {\n          fragColor = checkerBoard(fragCoord);\n      } else {\n          fragColor = vec4(r, g, b, 1.0);\n      }\n    }    \n}","name":"Image","description":"","type":"image"}]}