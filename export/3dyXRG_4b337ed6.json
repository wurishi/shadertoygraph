{"ver":"0.1","info":{"id":"3dyXRG","date":"1574240381","viewed":196,"name":"voronov noise","username":"MallSerg","description":"test mask noise","likes":4,"published":1,"flags":0,"usePreview":0,"tags":["testvoronov"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dfGRn","filepath":"/media/a/8de3a3924cb95bd0e95a443fff0326c869f9d4979cd1d5b6e94e2a01f5be53e9.jpg","previewfilepath":"/media/ap/8de3a3924cb95bd0e95a443fff0326c869f9d4979cd1d5b6e94e2a01f5be53e9.jpg","type":"texture","channel":1,"sampler":{"filter":"linear","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"Xsf3Rn","filepath":"/media/a/cbcbb5a6cfb55c36f8f021fbb0e3f69ac96339a39fa85cd96f2017a2192821b5.png","previewfilepath":"/media/ap/cbcbb5a6cfb55c36f8f021fbb0e3f69ac96339a39fa85cd96f2017a2192821b5.png","type":"texture","channel":0,"sampler":{"filter":"nearest","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\n#define PI 3.14159\n// Поворот блика\n#define RB 0.19 \n// Глубина шума граней\n#define NG 15.0\n// koficent vremeni\n#define KV 0.012\n// Коф преломления\n#define KP 0.0810\n// Коф дифракции цветовое смещение\n#define KS 0.0160\n\nvec2 rand( vec2 p ) {\n    \n    vec2 rnd = fract(\n        sin( vec2(\n            dot(p,vec2(127.1,311.7)),\n            dot(p,vec2(269.5,183.3))\n        ))*43758.5453);\n    return rnd;\n}\nvec3 gmain(in vec2 fragCoord) {\n\tvec2 st = fragCoord.xy/iResolution.xy;\n\tst.x *= iResolution.x/iResolution.y;\n    //vec2 mouse;\n    vec2 mouse = iMouse.xy/iResolution.xy;\n    //mouse = mouse/.5 + vec2(-1.,-1.);\n    \n    //mouse = translate\n    \n\tvec3 color = vec3(.0);\n\tst *= NG;\n\tvec2 i_st = floor(st);\n\tvec2 f_st = fract(st);\n\tfloat m_dist = 1.;\n\tvec2 m_point;\n\t\n\n\tfor(int y=-1; y <=1; y++){\n\t\tfor(int x=-1; x <= 1; x++){\n\t\t\tvec2 neighbor = vec2(float(x), float(y));\n\t\t\t\n\t\t\tvec2 point = rand(i_st + neighbor);\n\t\t\t//point = 0.5 + 0.5*sin(iTime + 6.2831*point);\n\t\t\t//point = 0.5 + 0.5*sin((iMouse.x*.03+iTime*KV) + 6.2831*point);\n            //fract(iTime*KV);\n            point = 0.5 + 0.5*sin((iMouse.x*.03) + 6.2831*point);\n            \n\t\t\t\n\t\t\tvec2 diff = neighbor + point - f_st;\n\t\t\t\n            //diff = mix(diff,mouse,.5);\n                \n            // Distance to the point\n\t\t\tfloat dist = length(diff)*0.43;\n\t\t\tif(dist < m_dist){\n\t\t\t\tm_dist = dist;\n\t\t\t\tm_point = point;\n\t\t\t}\n\t\t}\n\t}\n    \n    \n    \n\t//color += dot(m_point, vec2(.3,.6));\n    vec2 normalPointXY = fragCoord.xy/iResolution.xy;\n    vec2 ki = vec2(0.5,0.5);\n    float kj = distance(normalPointXY.x,mouse.x+(normalPointXY.y-.5)*RB);\n    \n    //fract(iTime*KV)\n    \n    color = vec3( m_point.x,kj/.6,m_dist);//m_point);\n        //color = vec3( m_point.x,normalize(sin(iTime))-1.,m_dist);//m_point);\n        \n    //color = smoothstep();\n\t//vec2 pz = gl_FragCoord.xy/iResolution.xy;\n\t//vec3 pl = vec3(color.x*mouse.x*2.,color.x*mouse.y,color.y );\n\t//color += vec3(pz.x-iMouse.x,pz.y-iMouse.y,color.z)*.2;\n\t//color += 1.-step(0.02, m_dist);\n\treturn color;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n  vec4 outcol;\n  vec2 xy = fragCoord/iResolution.xy;\n  vec2 mascxy = xy;\n    // Маштабирование текстуры маски\n    mascxy.x *= 1.0/5.;\n    mascxy.x -= 0.02;  \n\tvec4 texColor=texture(iChannel0,mascxy);\n\n            vec3 map=gmain(fragCoord);\n        float r = texture(iChannel1,xy)[0];\n        float g = texture(iChannel1,xy)[1];\n        float b = texture(iChannel1,xy)[2];\n    float bs = (1.-map.x);\n    \n        if ( map.y < .3){\n            \n        \tr =texture(iChannel1,xy +map.x*KP)[0];\n        \tg =texture(iChannel1,xy +map.x*(KP+KS))[1];\n        \tb =texture(iChannel1,xy +map.x*(KP+KS+KS))[2];\n            \n        \t//r = mix(texture(iChannel1,xy)[0],r,1.-map.y) ;//map.y/43.;\n        \t//g = mix(texture(iChannel1,xy)[0],g,1.-map.y);\n        \t//b = mix(texture(iChannel1,xy)[0],b,1.-map.y);//+= map.y/43.;\n            \n            //if(map.x < 0.1){ r *= 0.5;g *= 0.5; b *= 0.5;};\n            //if(map.x > 0.9){ r *= 1.9;g *= 1.9; b *= 1.9;};\n            if(map.x > 0.95){\n                bs *= 20.; // окр 1 - 0 \n                if (map.y > .2) bs *= 0.2;\n                r += (1.-r)*bs ;g += (1.-g)*bs; b += (1.-b)*bs;\n                //if (map.y < .2) bs *= .02;\n                //\tr *= bs ;g *= bs; b *= bs;\n\n            };\n            if(map.x < 0.2){    \n                \n                r -= (r*.5)*(bs*0.5) ;g -= g*.5*(bs*0.5); b -= b*.5*(bs*0.5);\n            };\n            \n        };\n        outcol = vec4(vec3(r,g,b)  ,1.0);\n    \n    \n    \n    if ((texColor.x+texColor.y+texColor.z) < 2.9  ) { // все что не белое или альфа\n        \n\n        //outcol = vec4(vec3(r,0.,0.)  ,1.);\n        //outcol = vec4(map  ,1.);\n\n        \n        \n        \n    }\n    else{\n    //outcol =vec4(mouse.x,mouse.y,0.0,1.);\n        //outcol=vec4(1.0,1.0,1.0,1.0);\n        outcol=texture(iChannel1,xy)*.15;\n        \n    };\n    //texColor *= 0.42;\n    \n\n    fragColor=outcol;\n}","name":"Image","description":"","type":"image"}]}