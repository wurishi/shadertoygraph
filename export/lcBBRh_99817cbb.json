{"ver":"0.1","info":{"id":"lcBBRh","date":"1724622082","viewed":55,"name":"Rainbow Fireworks","username":"Gopherknee","description":"Any improvement?","likes":5,"published":1,"flags":0,"usePreview":0,"tags":["firework"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// Constants\nconst float PI = 3.14159265359;\nconst float TWO_PI = 6.28318530718;\nconst float EXPLOSION_COUNT = 6.0;\nconst float SPARKS_PER_EXPLOSION = 150.0;\nconst float EXPLOSION_DURATION = 20.0;\nconst float EXPLOSION_SPEED = 5.0;\nconst float EXPLOSION_RADIUS_THRESHOLD = 0.07;\nconst vec3 RAINBOW_OFFSET = vec3(0.0,0.33,0.67);\n\n// Hash function to generate pseudo-random values\nvec3 hash33(vec3 p3) {\n    p3 = fract(p3 * vec3(0.1031, 0.11369, 0.13787));\n    p3 += dot(p3, p3.yxz + 19.19);\n    return fract((p3.xxy + p3.yxx) * p3.zyx);\n}\n\n// Function to generate rainbow colors\nvec3 rainbow(float t) {\n    vec3 c = 0.5 + 0.5 * cos(TWO_PI * (t + RAINBOW_OFFSET));\n    return c * c; // Squaring to make colors more vibrant\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord) {\n    mediump vec2 uv = fragCoord / iResolution.y;\n    float aspectRatio = iResolution.x / iResolution.y;\n    float t = mod(iTime + 10., 7200.);\n    lowp vec3 col = vec3(0, 0, 0);\n    \n    // Loop through all sparks for all explosions\n    for (float i = 0.; i < SPARKS_PER_EXPLOSION * EXPLOSION_COUNT; ++i) {\n        float j = floor(i / SPARKS_PER_EXPLOSION);\n        vec3 oh = hash33(vec3(j + 1234.1939, 641.6974, 1.0));\n        vec2 origin = vec2(oh.x * aspectRatio, oh.y) * .6 + .2;\n        float localT = t + (j + 1.) * 9.6491 * oh.z;\n        \n        vec3 h = hash33(vec3(j, i, 497.8943));\n        float a = h.x * TWO_PI;\n        float rScale = h.y * EXPLOSION_RADIUS_THRESHOLD;\n  \n        if (mod(localT * EXPLOSION_SPEED, EXPLOSION_DURATION) > 2.) {\n            float r = mod(localT * EXPLOSION_SPEED, EXPLOSION_DURATION) * rScale;\n            vec2 sparkPos = vec2(r * cos(a), r * sin(a));\n            \n            sparkPos.y -= pow((length(sparkPos) - (rScale - 0.04)) / 0.04, 3.0) * 6e-5;\n            \n            float spark = .0002 / pow(length(uv - sparkPos - origin), 1.65);\n            float sd = 2. * length(origin - sparkPos);\n            float shimmer = max(0., sqrt(sd) * sin((localT + h.y * 2. * PI) * 20.));\n            \n            float fade = max(0., (EXPLOSION_DURATION - 5.) * rScale - r);\n            \n            // Generate a random rainbow color for each spark\n            vec3 sparkColor = rainbow(h.x + iTime * 0.1);\n            col += spark * mix(1., shimmer, smoothstep(6.4 * rScale, 7.4 * rScale, r)) * fade * sparkColor;\n        }\n    }\n    \n    fragColor = vec4(col, 1.0);\n}\n","name":"Image","description":"","type":"image"}]}