{"ver":"0.1","info":{"id":"tdGczW","date":"1602570041","viewed":220,"name":"Mosaic_6","username":"bigt","description":"马赛克","likes":4,"published":1,"flags":0,"usePreview":0,"tags":["mosaic"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dfGRn","filepath":"/media/a/8de3a3924cb95bd0e95a443fff0326c869f9d4979cd1d5b6e94e2a01f5be53e9.jpg","previewfilepath":"/media/ap/8de3a3924cb95bd0e95a443fff0326c869f9d4979cd1d5b6e94e2a01f5be53e9.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"const float sqrt3 = 1.7320508076;\n\n// 六边形马赛克变种\n// https://www.shadertoy.com/view/WdVcz1\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 diamondRadius = vec2(16.0,16.0);\t// 菱形马赛克的大小(单位:长度)\n    float threshold = 0.18;\t\t\t\t\t// 边框大小\n    vec3 borderColor = vec3(0.0,0.0,0.0);\t// 边框颜色\n    \n    vec2 mosaicSize = vec2(diamondRadius.x * (0.75), diamondRadius.y * 0.75);\n    vec2 gridCoord = floor(fragCoord/mosaicSize);\n    \n    vec3 col = vec3(0.1,0.1,0.1);\n    \n    float bRow = 1.0 - step(0.99999, mod(gridCoord.y, 2.0));\n    float bCol = 1.0 - step(0.99999, mod(gridCoord.x, 2.0));\n    float bResult = 1.0 - step(0.00001, abs(bRow - bCol));\n\n    vec2 c1 = mix(gridCoord + vec2(0.0), gridCoord + vec2(0.0,1.0), 1.0 - bResult);\n    vec2 c2 = mix(gridCoord + vec2(1.0), gridCoord + vec2(1.0,0.0), 1.0 - bResult);\n    \n    // 与六边形区别:直接拿格子坐标去判断距离即可\n    vec2 curCoordInGrid = fragCoord/mosaicSize;\n    float fL1 = length(curCoordInGrid-c1);\n    float fL2 = length(curCoordInGrid-c2);\n    \n    vec3 col1 = texture(iChannel0, c1*mosaicSize/iResolution.xy).rgb;\n\tvec3 col2 = texture(iChannel0, c2*mosaicSize/iResolution.xy).rgb;\n    col = mix(col1, col2, step(0.0, fL1-fL2));\n    \n    // 边框部分\n    // 左下部分为0，对角线部分为0~1，右上部分为1\n    float res = smoothstep(-threshold,threshold,fL1 - fL2);\n    // abs(res-1.0)为左下部分为1，对角线部分为0~1,右上部分为0\n    // res * abs(res-1.0)提取出对角线部分,值略小，*2.5提亮\n    res = res * abs(res-1.0) * 2.5;\n    //fragColor = vec4(vec3(res), 1.0);\n    col = mix(borderColor, col, 1.0-res);\n\n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}