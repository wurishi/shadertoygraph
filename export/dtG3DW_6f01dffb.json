{"ver":"0.1","info":{"id":"dtG3DW","date":"1683989026","viewed":128,"name":"Hyperbola - Distance approx","username":"Poisson","description":"The approximation of a hyperbola sdf.","likes":6,"published":1,"flags":0,"usePreview":0,"tags":["2d","raymarching","math","sdf","circle","approximation","cone","distance","graph","ellipse","parabola","conic","maths","hyperbola","derivate"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// hyperbola sdf approximation\n\n// x^2 - y^2 + k^2 = 0\n// y^2 - x^2 = k^2\n// y^2 = x^2 + k^2\n// y = sqrt(x^2 + k^2)\n\n// f(x) = sqrt(x^2 + k^2)\n\n// f'(x) = x/sqrt(x^2 + k^2); -> this is the dervate of f(x)\n// x and y are the coordinates of the point\n\n//          f(x) - y\n// d â‰ˆ -------------------\n//      sqrt(1 + f'(x)^2)\n\nfloat sdHyperbola(vec2 p, float k) {\n    float k2 = k*k;\n\n    float s = p.x*p.x - p.y*p.y + k2;\n    if (s<0.) { // interior distance\n        p = abs(p); // symetry\n        p = p.y + vec2(1,-1)*p.x; // rotation\n        \n        float x2 = p.x*p.x;\n        float h = 1. + k2*k2/(x2*x2);\n        return (k2/p.x - p.y) / (h*sqrt(2.));\n    }\n    // exterior distance\n    float x2 = p.x*p.x;\n    float h = 1. + x2/(x2 + k2); // 1 + f'(x)^2\n    return sqrt((x2 + k2)/h) - abs(p.y)/sqrt(h);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 p = (2.*fragCoord - iResolution.xy) / iResolution.y;\n    vec2 m = (2.*iMouse.xy - iResolution.xy) / iResolution.y;\n\n    float k = .5+.5*sin(1.5*iTime);\n\tfloat d = sdHyperbola(p, k);\n    \n\t// coloring\n    vec3 col = (d>0.) ? vec3(.9,.6,.3) : vec3(.55,.85,1);\n    col *= 1.-exp(-8.*abs(d));\n\tcol *= .8 + .2*cos(150.*d);\n\tcol = mix(col, vec3(1), smoothstep(.01,0.,abs(d)));\n\n    if (iMouse.z>0.) {\n        d = sdHyperbola(m, k);\n        col = mix(col, vec3(1,1,0), smoothstep(.01,0., abs(length(p-m)-abs(d))-.0025));\n        col = mix(col, vec3(1,1,0), smoothstep(.01,0., length(p-m)-.015));\n    }\n    \n\tfragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}