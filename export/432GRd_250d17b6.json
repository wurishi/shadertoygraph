{"ver":"0.1","info":{"id":"432GRd","date":"1709068343","viewed":149,"name":"Star_galaxy_formation ","username":"stefanbanev","description":"Modeling of star formation ( gravity star galaxy )\nRem: iChannel0 should be nearest/clamp\nTo reset click the left mouse button...\n","likes":5,"published":1,"flags":32,"usePreview":0,"tags":["star","galaxy","gravity"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"nearest","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{   NMB_STRS = min(NMB_STRS_DEF,int(iResolution.x));\n    vec2 pxy = fragCoord.xy/iResolution.xy ;\n    fragColor = vec4(0.0);\n    for(int i = 0; i < NMB_STRS; i++)\n    { \tvec4 s = texelFetch(iChannel0, ivec2(i,0), 0);\n        fragColor += 0.001/(length(pxy-s.xy)*pow(float(NMB_STRS),1.0-STAR_BRIGHTNESS));\n    }\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"nearest","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"bool InRange( vec2 xy )  { return all(equal(max(xy,vec2(0.0)),min(xy,vec2(1.0)))); } //to test if xy inside [0...1] range\nvoid mainImage( out vec4 s, in vec2 pxy )\n{   NMB_STRS = min(NMB_STRS_DEF,int(iResolution.x));\n    if( int(pxy.x) >= NMB_STRS || pxy.y>=1.0 ) return ;\n    if(iFrame==0 || iMouse.z>0.0 ) // To reset click the left mouse button...\n          { float sd = sqrt((pxy.x+0.13571)*iDate.w)*3.141593 ;\n            s = vec4(vec2(fract(cos(sd*0.512)*532.13571),fract(sin(sd*0.255)*758.54537)),0.0,0.0);\n            vec2 v = vec2(0.5-s.y,s.x-0.5)*ROTATION_SPEED/SLOW_DOWN; s = vec4(s.xy,v); return; \n          }\n    s = texelFetch( iChannel0 , ivec2(pxy) , 0 ) ;\n    for(int i = 0; i < NMB_STRS; i++)\n      if(i!=int(pxy.x)) { vec4 o = texelFetch(iChannel0, ivec2(i,0), 0);\n                          vec2 d = s.xy-o.xy ; float sl = dot(d,d);\n                          if(sl!=0.0) s.zw -= normalize(d)*((STAR_MASS*STAR_MASS)*GR_CNST)/max(sl, STAR_DIAMETER*STAR_DIAMETER );\n                        }\n    s.xy += s.zw*SLOW_DOWN;\n#define BV(s) (vec2(0.5-s.y,s.x-0.5)*ROTATION_SPEED/SLOW_DOWN+vec2(s.zw)*0.333)*(1.001-BAUNDARY_FRICTION) ;   \n    if(!InRange(s.xy)) {s.xy = mod( s.xy, 1.0 ) ; s.zw=BV(s);} //mod(... is to wrap xy around 0...1?\n} \n","name":"Buffer A","description":"","type":"buffer"},{"inputs":[],"outputs":[],"code":"// --- Modeling of star(s)/galaxy formation ---\n\n#define STAR_DIAMETER     0.2 //The smaller it is the stronger gravity \"Slingshot\": 0.02-star system 0.2-galaxy.\n#define STAR_MASS         (0.15*1800.0/float(NMB_STRS)) // mass of single star\n#define STAR_BRIGHTNESS   0.54 // 1.0-brightest ... 0.5-dimmest\n#define NMB_STRS_DEF      9999 // A desirable number of stars, it cannot be bigger than X-resolution.\n#define GR_CNST           0.0000000667430 // 0.0000000667430 = gravitational constant 6.67430(15)×10−8\tdyn⋅cm2⋅g−2\n#define ROTATION_SPEED    0.0045 // initial speed of rotation relatively center of view port \n#define BAUNDARY_FRICTION 0.5  // 0.001 - no friction, 1.00 -  max friction\n#define SLOW_DOWN         1.0 // 0.5 half speed \n\nint NMB_STRS = NMB_STRS_DEF ; // The actual number of stars, it cannot be bigger than X-resolution.","name":"Common","description":"","type":"common"}]}