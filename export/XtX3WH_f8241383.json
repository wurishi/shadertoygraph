{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[{"channel":0,"type":"texture","id":"4sXGRn","filepath":"/media/a/95b90082f799f48677b4f206d856ad572f1d178c676269eac6347631d4447258.jpg","sampler":{"filter":"mipmap","wrap":"repeat","vflip":"false","srgb":"false","internal":"byte"}}],"code":"vec2 rotate(in vec2 p, in float t)\n{\n\treturn p*cos(-t)+vec2(p.y, -p.x)*sin(-t);\n}\n\nfloat sdTorus(in vec3 p, in vec2 t)\n{\n\tvec2 q = vec2(length(p.xz)-t.x, p.y);\n\treturn length(q)-t.y;\n}\n\nfloat map(in vec3 p)\n{\n    return sdTorus(p, vec2(0.8,0.3));\n}\n\nvec3 calcNormal(in vec3 p)\n{\n\tconst vec2 e = vec2( 0.0001, 0.0 );\n\tvec3 n = vec3(\n\t\tmap( p + e.xyy ) - map( p - e.xyy ),\n\t\tmap( p + e.yxy ) - map( p - e.yxy ),\n\t\tmap( p + e.yyx ) - map( p - e.yyx ) );\n\treturn normalize( n );    \n}\n\nvec3 transform(in vec3 p)\n{\n    p.zx = rotate(p.zx, iTime*0.5);\n    p.yz = rotate(p.yz, iTime*0.6);\n    return p;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 p2 = (2.0*fragCoord.xy-iResolution.xy)/iResolution.y;\n    vec3 col = vec3(0.3+0.1*p2.y);\n    vec3 light = normalize(vec3(0.5, 0.8, 3.0));\n    const float steps = 64.0;\n    float pe = 3.0;\n\tfor(float i=0.0; i<steps; i++)\n\t{\n        float z = 1.0-2.0*pow(i/steps, 2.0);\n        float s = pe/(pe+z);\n        vec3 p3 = vec3(p2*s, z);\n        p3 = transform(p3);\n        if (map(p3) < 0.001)\n        {\n\t\t\tfloat dif = dot(calcNormal(p3), transform(light));\n        \tdif = clamp((dif+0.5)*0.7, 0.3, 1.0);\n\t\t\tcol =  texture(iChannel0, p3.xy).rgb*dif;\n            break;\n        }\n    }\n\tfragColor = vec4(col, 1.0);\n}","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"XtX3WH","date":"1421328348","viewed":345,"name":"Parallax Torus","username":"gaz","description":"Idea from https://www.shadertoy.com/view/4sSGD1","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["parallex"],"hasliked":0,"parentid":"","parentname":""}}