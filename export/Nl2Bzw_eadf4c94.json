{"ver":"0.1","info":{"id":"Nl2Bzw","date":"1651980218","viewed":144,"name":"try bokeh","username":"yunhai","description":"bokeh","likes":5,"published":1,"flags":0,"usePreview":0,"tags":["postprocess"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4sfGRn","filepath":"/media/a/fb918796edc3d2221218db0811e240e72e340350008338b0c07a52bd353666a6.jpg","previewfilepath":"/media/ap/fb918796edc3d2221218db0811e240e72e340350008338b0c07a52bd353666a6.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"//refrence\n//https://www.shadertoy.com/view/4d2Xzw\n//xor's realistic bokeh grassï¼š\n//https://www.shadertoy.com/view/7llfRf\n\n/*\nthe idea is detecting the light pixel around.\nthe rot angle and length of sample are\nthe main factors to adjust,\nin order to let them \nsample well-distributed pixels.\nAs far as possible to reduce the\nsampling times(itr) for real time\n*/\nconst float ITR=90.;\nconst float RADIUS=.7;\nconst float ANGLE=2.4;\nvoid mainImage( out vec4 O, in vec2 I )\n{\n    float a=ANGLE,\n        r=1.;\n        \n    mat2 rot = mat2(\n    cos(a), \n    sin(a), \n    -sin(a), \n    cos(a));\n    \n    vec2 R=1./iResolution.xy,\n    d=R/R;//dir\n\n    O-=O;\n    vec4 div=O;\n    for(float i=0.;i<ITR;i++)\n    {\n        d*=rot;//rotate angle\n        r+=1./r;//dynamic length\n        vec4 c=texture(iChannel0,I*R+d*(r-1.)*R\n        *RADIUS);//compact sampling range\n        vec4 bk=c*c;//cull the dark sample\n        O+=c*bk;\n        div+=bk;\n        \n    }\n    I.x>.5/R.x?\n    O/=div : O=texture(iChannel0,I*R);\n        \n}\n\n   ","name":"Image","description":"","type":"image"}]}