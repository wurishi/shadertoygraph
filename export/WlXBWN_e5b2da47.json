{"ver":"0.1","info":{"id":"WlXBWN","date":"1601495001","viewed":794,"name":"Circuits III","username":"Kali","description":"Yet another fractal circuit","likes":55,"published":1,"flags":0,"usePreview":0,"tags":["fractal","circuits"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"mat2 rot(float a) {\n\tfloat s=sin(a), c=cos(a);\n    return mat2(c,s,-s,c);\n}\n\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n\nvec3 fractal(vec2 p) {\n    float o=100.,l=o;\n    p*=rot(-.3);\n    p.x*=1.+p.y*.7;\n    p*=.5+sin(iTime*.1)*.3;\n    p+=iTime*.02;\n    p=fract(p);\n    for (int i=0; i<10; i++) {\n        p*=rot(radians(90.));\n        p.y=abs(p.y-.25);\n        p=p/clamp(abs(p.x*p.y),0.,3.)-1.;\n        o=min(o,abs(p.y-1.)-.2)+fract(p.x+iTime*.3)*.5;\n        l=min(l,length(max(vec2(0.),abs(p)-.5)));\n        \n    }\n\to=exp(-5.*o);\n\tl=smoothstep(.1,.11,l);\n    return hsv2rgb(vec3(o*.5+.6,.8,o+.1))+l*vec3(.4,.3,.2);\n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord/iResolution.xy;\n    uv-=.5;\n    uv.x*=iResolution.x/iResolution.y;\n    vec3 col=vec3(0.);\n    float aa=4.;\n    vec2 eps=1./iResolution.xy/aa;\n    for (float i=-aa; i<aa; i++){\n        for (float j=-aa; j<aa; j++){\n            col+=fractal(uv+vec2(i,j)*eps);\n        }\n    }\n\tcol/=pow(aa*2.,2.);\n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}