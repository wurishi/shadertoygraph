{"ver":"0.1","info":{"id":"4cj3zG","date":"1704365580","viewed":18,"name":"TestABallInTheSpace","username":"fhyxz","description":"Ball in the space","likes":0,"published":1,"flags":32,"usePreview":0,"tags":["3d"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\n\nconst vec3 CIRCLE_CENTRE = vec3(10.,70.,10.);\nconst float RAD = 50.;\n\nfloat SDF(vec3 pos)\n{\n    // 空间中只有一个球，所以到球表面的距离就是SDF的值\n    return length(pos - CIRCLE_CENTRE) - RAD;\n}\n\nvec3 RayMarch(vec3 origin, vec3 direction, float start, float end)\n{\n\n    float depth = start;\n    // 最多检测255次\n    for (int i = 0;i < 255; i++)\n    {\n        // 每次前进SDF告知的安全距离\n        vec3 pos = origin + direction * depth;\n        \n        float t = SDF(pos);\n        depth += t;\n        \n        // 安全距离小于 0.001 认为是已经碰撞\n        if (length(t) <= 0.001) return vec3(0.7, 0.56, 0.8);\n        // 超出极限距离后强制结束\n        if ( depth > end ) break;\n    }\n    return vec3(0.45);\n        \n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    \n    // 坐标系中心归到屏幕中心，并添加z轴坐标\n    vec2 Coord = fragCoord - 1./2. * iResolution.xy;\n    vec3 coord3 = vec3(Coord, 0.);\n    \n    // 定义摄像机位置\n    vec3 camera_pos = vec3(0., 0., -200.);\n    \n\n    // 定义射线方向\n    vec3 dir = coord3 - camera_pos;\n    dir = normalize(dir);\n    \n    // raymarching\n    vec3 col = RayMarch(camera_pos, dir, 50., 500.);\n    \n    fragColor = vec4(col, 1.);\n}","name":"Image","description":"","type":"image"},{"inputs":[],"outputs":[{"id":"4dXGR8","channel":0}],"code":"const vec3 CIRCLE_CENTRE = vec3(10.,70.,10.);\nconst float RAD = 50.;\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // 坐标系中心归到屏幕中心，并添加z轴坐标\n    vec2 Coord = fragCoord - 1./2. * iResolution.xy;\n    vec3 coord3 = vec3(Coord, 0.);\n}","name":"Buffer A","description":"","type":"buffer"}]}