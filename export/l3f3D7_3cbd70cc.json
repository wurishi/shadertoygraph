{"ver":"0.1","info":{"id":"l3f3D7","date":"1719061222","viewed":162,"name":"The Endless Steps","username":"shadertoyjiang","description":"六棱柱，无尽阶梯 体素行进","likes":24,"published":1,"flags":0,"usePreview":0,"tags":["voxel","hexagon"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// 2024-2-10 \n// The Endless Steps\n\n//            300\n#define DEPTH 800  \n\n#define rot(a) mat2(cos(a),-sin(a),sin(a),cos(a))\n\nvec3 nc(vec3 p){        \n        vec3 c = floor(p);\n        c += mod(vec3(c.x+1., c.y+floor(c.x*.5),c.z+1.), 2.);\n        c += sign(p-c)*vec3(2,1,0)     * floor(dot(abs(p-c).xy,  vec2(.75,.5)));\n        return c;\n}\n\nbool map(vec3 p){\n        return dot(sin(.1*p), cos(.1*p.yzx)) < -1.2;                                          \n}\n\n\nfloat edg(vec3 p){\n        float f = max(dot(abs(p).xy, vec2(.75,.5)), abs(p).y)-1.,        \n              a = length( vec2(f, 1.-  abs(p.z) )),\n              b = 2.* abs( length(p.xy*vec2(.866,1))*.866-1.);             \n        return a;\n}\n\nvec3 light(vec3 n){return  vec3(.5+.5* dot( n, normalize(vec3(1,2,-3)) )); }\n\n\n// \nvec3 hexg(vec3 o,vec3 r){\n        float d,md  ;\n        int i,j,k=0;\n        vec3 q;\n        vec3 LA =normalize(vec3(1,1,8));\n        o /= LA;  r/=LA;\n        float fang=3.;\n        vec3 n[4]=vec3[4](vec3(.75,-.5,0), vec3(0,1,0), vec3(.75,.5,0), vec3(0,0,1));\n        float fu[4]=float[4](1.,1.,1.,1.); // clr\n        vec3 b,c = nc(o),bk,clr=bk=vec3(0,.25,1)*.35;\n        for(int i=0;i<4;i++)n[i] *= fu[i]=sign(dot(r, n[i]));        \n        //fu[i]=-1.;\n        for(int j=0;j<DEPTH;j++)\n        {\n                md = 1e8;\n                for(int i=0;i<4;i++)\n                {\n                        d = (1. - dot(o-c, n[i])) / dot(r, n[i]);\n                        if(md>=d){md=d;k=i;}\n                }\n                b=c; \n                c += n[k]/vec3(.75,1,1)*2.;\n                if(map(c*fang*LA)==true)\n                {\n                        q = o + r * md; \n                        clr = light(n[k]);\n                        if(k<3)clr[k]-=(.3+fu[k]*.1)*.5,clr.yz+=clamp(2.*sin(iTime+q.x*0.+(c.z/20.)),-1.,1.);    else   clr.xy-=fu[k]*.51;\n                        clr.yz += 55.* exp(-40.*edg(q-c))*sin(iTime*.5*0.+4.) ;\n                        clr -= exp(-50.*edg(q-c));\n                        break;\n                }\n        }\n        return mix(bk,clr,exp(-.01*length(q-o) )); // length==md?\n}\n\nvoid mainImage( out vec4 O, vec2 v){\n        vec2 R = iResolution.xy,\n             u = (v+v - R)/R.x;\n        vec3 o = vec3(0,.5,-1)+vec3(-.0,.0,.3)*iTime*30.,\n             r = (vec3(u,R.x>R.y?.99:1.)),            \n             x = normalize(vec3(1,.866 ,.866) / vec3(1,.4,1))  ;       \n        o *= x; r*=x;  //r=normalize(r);        \n        //o.yz*=rot(.2);\n        r.yz*=rot(.2);\n        O = vec4(hexg(o.xzy,r.xzy),1);\n}\n\n\n\n\n\n\n","name":"Image","description":"","type":"image"}]}