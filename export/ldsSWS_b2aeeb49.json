{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[{"channel":0,"type":"music","id":"4dfGzn","filepath":"/media/a/ec8a6ea755d34600547a5353f21f0a453f9f55ff95514383b2d80b8d71283eda.mp3","sampler":{"filter":"linear","wrap":"clamp","vflip":"false","srgb":"false","internal":"byte"}}],"code":"//////////////////////////////////////////////////\n// XBE\n// Weird Warp\n// Playing with domain warp to produce weird anim.\n\n// Simplex Noise by IQ\nvec2 hash( vec2 p )\n{\n\tp = vec2( dot(p,vec2(127.1,311.7)),\n\t\t\t  dot(p,vec2(269.5,183.3)) );\n\n\treturn -1.0 + 2.0*fract(sin(p)*43758.5453123);\n}\n\nfloat noise( in vec2 p )\n{\n    const float K1 = 0.366025404; // (sqrt(3)-1)/2;\n    const float K2 = 0.211324865; // (3-sqrt(3))/6;\n\n\tvec2 i = floor( p + (p.x+p.y)*K1 );\n\t\n    vec2 a = p - i + (i.x+i.y)*K2;\n    vec2 o = (a.x>a.y) ? vec2(1.0,0.0) : vec2(0.0,1.0); //vec2 of = 0.5 + 0.5*vec2(sign(a.x-a.y), sign(a.y-a.x));\n    vec2 b = a - o + K2;\n\tvec2 c = a - 1.0 + 2.0*K2;\n\n    vec3 h = max( 0.5-vec3(dot(a,a), dot(b,b), dot(c,c) ), 0.0 );\n\n\tvec3 n = h*h*h*h*vec3( dot(a,hash(i+0.0)), dot(b,hash(i+o)), dot(c,hash(i+1.0)));\n\n    return dot( n, vec3(70.0) );\n\t\n}\n\nconst mat2 m = mat2( 0.80,  0.60, -0.60,  0.80 );\n\nfloat fbm4( in vec2 p )\n{\n    float f = 0.0;\n    f += 0.5000*noise( p ); p = m*p*2.02;\n    f += 0.2500*noise( p ); p = m*p*2.03;\n    f += 0.1250*noise( p ); p = m*p*2.01;\n    f += 0.0625*noise( p );\n    return f;\n}\n\nfloat fbm6( in vec2 p )\n{\n    float f = 0.0;\n    f += 0.5000*noise( p ); p = m*p*2.02;\n    f += 0.2500*noise( p ); p = m*p*2.03;\n    f += 0.1250*noise( p ); p = m*p*2.01;\n    f += 0.0625*noise( p ); p = m*p*2.04;\n    f += 0.031250*noise( p ); p = m*p*2.01;\n    f += 0.015625*noise( p );\n    return f;\n}\n\nfloat turb4( in vec2 p )\n{\n    float f = 0.0;\n    f += 0.5000*abs(noise(p)); p = m*p*2.02;\n    f += 0.2500*abs(noise(p)); p = m*p*2.03;\n    f += 0.1250*abs(noise(p)); p = m*p*2.01;\n    f += 0.0625*abs(noise(p));\n    return f;\n}\n\nfloat turb6( in vec2 p )\n{\n    float f = 0.0;\n    f += 0.5000*abs(noise(p)); p = m*p*2.02;\n    f += 0.2500*abs(noise(p)); p = m*p*2.03;\n    f += 0.1250*abs(noise(p)); p = m*p*2.01;\n    f += 0.0625*abs(noise(p)); p = m*p*2.04;\n    f += 0.031250*abs(noise(p)); p = m*p*2.01;\n    f += 0.015625*abs(noise(p));\n    return f;\n}\n\nfloat marble(in vec2 p)\n{\n\treturn cos(p.x+fbm4(p));\n}\n\nfloat wood(in vec2 p)\n{\n\tfloat n = noise(p);\n\treturn n-floor(n);\n}\n\nfloat dowarp ( in vec2 q, out vec2 a, out vec2 b )\n{\n\tfloat ang = 1.5*texture(iChannel0, vec2(0.2, 0.)).x;\n\tmat2 rotmat = mat2(cos(ang), -sin(ang), sin(ang), cos(ang));\n\ta = vec2( marble(q), marble(q) );\n\n\tang = 1.5*texture(iChannel0, vec2(0.6, 0.)).x;\n\trotmat = mat2(cos(ang), -sin(ang), sin(ang), cos(ang));\n\tb = vec2( marble( rotmat*(q + a)), marble( rotmat*(q + a) ) );\n\t\n\tvec2 offset;\n\toffset.x = texture(iChannel0, vec2(0.1, 0.)).x;\n\toffset.y = texture(iChannel0, vec2(0.5, 0.)).x;\n\treturn marble( q + b + 2.*offset);\n}\n\n// -----------------------------------------------\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n \tvec2 uv = fragCoord.xy / iResolution.xy;\n\tvec2 q = 2.*uv-1.;\n\tq.y *= iResolution.y/iResolution.x;\n\t\n\tfloat Time = 0.25*(15.0 + iTime) - 1.*texture(iChannel0, vec2(0.65, 0.)).x;\n\tq += vec2( 4.0*cos(Time+45.), 2.0*sin(Time) );\n\tq *= .625 + 3.*texture(iChannel0, vec2(0.35, 0.)).x;\n\t\n\tvec2 a = vec2(0.);\n\tvec2 b = vec2(0.);\n\tfloat f = dowarp(q, a, b);\n\tf = 0.5+0.5*f;\n\t\n\tvec3 col = vec3(f);\n\tfloat c = 0.;\n\tc = f;\n\tcol = vec3(c, c*c, c*c*c);\n\tc = fract(abs(a.x));\n\tcol -= vec3(c*c, c, c*c*c);\n\tc = fract(abs(b.x));\n\tcol += vec3(c*c*c, c*c, c);\n\tcol *= 0.7;\n\tcol.x = pow(col.x, 2.18);\n\tcol.z = pow(col.z, 1.88);\n\tcol = smoothstep(0., 1., col);\n\tcol = sqrt(col);\n\tcol = clamp(col, 0.,1.);\n\t\n\t// Vignetting\n\tvec2 r = -1.0 + 2.0*(uv);\n\tfloat vb = max(abs(r.x), abs(r.y));\n\tcol *= (0.15 + 0.85*(1.0-exp(-(1.0-vb)*30.0)));\n\tfragColor = vec4( col, 1.0 );\n}","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"ldsSWS","date":"1406491771","viewed":306,"name":"Weird Warp","username":"xbe","description":"Playing with domain warp to produce weird anim with audio.","likes":6,"published":1,"flags":0,"usePreview":0,"tags":["2d","warp"],"hasliked":0,"parentid":"","parentname":""}}