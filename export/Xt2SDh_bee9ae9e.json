{"ver":"0.1","info":{"id":"Xt2SDh","date":"1443309608","viewed":329,"name":"Why declaration inside the loop ","username":"buksy","description":"I'm trying to make a snow falling animation, why my animation doesn't work when `y` is declared outside the loop?\n\nStackoverflow: http://stackoverflow.com/questions/32803014/why-declaration-inside-the-loop-breaks-the-animation","likes":1,"published":1,"flags":0,"usePreview":0,"tags":["error","curious"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[],"code":"vec3 circle(in vec2 r, in vec2 center, in float radius)\n{   \n    return vec3(smoothstep(1.0, 0.0, smoothstep(0.0, 0.01, length(r-center)-radius)));\n}\n\nvoid snow(inout vec3 ret, in vec2 r, in float time)\n{\n    vec3 membership;\n    \n    membership = vec3(0.0);\n    // Why this declaration of \"y\" DOESNT work?\n    //float y;\n    float x;\n    \n    for(float j=0.0; j < 1.0; j+=0.9)\n    {\n        for(float i=0.0; i < 1.0; i+=0.3)\n        {   \n            // But this one DOES ?\n            float y;\n            \n            y = iTime * 0.3;\n            x = -0.98 + i*0.3;\n            \n            membership+= circle(r, vec2(x, 0.5 - mod(y, 1.0)), 0.001);\n            ret = mix(ret, vec3(0.9, 0.9, 1.0), membership);\n        }\n    }\n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 r = (fragCoord.xy - 0.5 * iResolution.xy) / iResolution.y ;\n    vec3 ret = vec3(0.0, 1.0 - (r.y+1.4)*0.5, 1.0 - (r.y+0.9)*0.5);\n\n    snow(ret, r, iTime);   \n\n    fragColor = vec4(ret.x, ret.y, ret.z, 1.);\n}","name":"","description":"","type":"image"}]}