{"ver":"0.1","info":{"id":"tljGWG","date":"1560984668","viewed":583,"name":"Feedback Tunnel","username":"TekF","description":"Unwinding after some stress by making something simple and trippy.","likes":12,"published":3,"flags":32,"usePreview":0,"tags":["feedback","psychadelic"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void mainImage( out vec4 o, in vec2 i )\n{\n\to = texelFetch(iChannel0,ivec2(i),0);\n\n    // linear -> gamma\n    o.rgb = pow( o.rgb, vec3(1./2.2) );\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"void mainImage( out vec4 o, in vec2 i )\n{\n    // read previous frame with a perspective twist\n    vec2 aspect = iResolution.xy/sqrt(iResolution.x*iResolution.y);\n    vec2 uv = (i/iResolution.xy-.5)*aspect;\n    \n    // ray trace a plane at z=0, and map uv on that\n    // this way I can move the camera to control the feedback shape\n    // without adding redundant params for controlling the plane\n    vec3 ray = normalize(vec3(uv,1));\n\n    // adjust camera rotation\n    vec3 rot = .02*sin(iTime*vec3(1.618,1.,.382)*.3);\n    vec2 s = vec2(-1,1);\n\t#define rot(a) mat2(cos(a),-sin(a),sin(a),cos(a))\n    ray.xy *= rot(rot.z);\n    ray.yz *= rot(rot.x);\n    ray.zx *= rot(rot.y);\n    \n\t// position camera (position of <0,0,-1> and 0 rotation = direct image)\n    vec3 camPos = vec3(rot.yx*vec2(-1.1,1.1),-1.01);\n    float t = (0.-camPos.z)/ray.z;\n    vec3 pos = camPos + ray*t;\n    uv = pos.xy;\n    \n    o = texture(iChannel0,uv/aspect+.5);\n    \n    // draw things on top\n    \n    // box / tunnel wall\n    o.rgb = mix( o.rgb, step(0.,sin(iTime*vec3(16.18,20,1.618*.618*10.))), smoothstep(.02,.015,abs(max(abs(uv.x)-.5*aspect.x,abs(uv.y)-.5*aspect.y))) );\n    // alternative colours:\n//    o.rgb = mix( o.rgb, sin(floor(iTime*vec3(16.18,20,1.618*.618*10.)))*.8+.2, smoothstep(.02,.015,abs(max(abs(uv.x)-.5*aspect.x,abs(uv.y)-.5*aspect.y))) );\n\n    // circle / snake\n    o.rgb = mix( o.rgb, sin(iTime*vec3(1,1.382,1.618)*3.)*.7+.5, smoothstep(.03,.025,length( uv-vec2(.45)*aspect*mix(sin(iTime*vec2(.618,1.382)),sin(iTime*vec2(1.618,2.)),.3) )/(abs(sin(iTime))+.5)) );\n\t// grey version:\n//    o.rgb = mix( o.rgb, sin(iTime*vec3(10))*.5+.5, smoothstep(.03,.025,length( uv-vec2(.5)*aspect*mix(sin(iTime*vec2(.618,1.382)),sin(iTime*vec2(1.618,2.)),.3) )) );\n    \n    o.rgb = clamp(o.rgb,0.,1.);\n}","name":"Buffer A","description":"","type":"buffer"}]}