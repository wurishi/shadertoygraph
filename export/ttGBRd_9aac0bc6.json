{"ver":"0.1","info":{"id":"ttGBRd","date":"1614864209","viewed":102,"name":"#Mars2020","username":"kithy","description":"Ground of Mars made from noise.","likes":4,"published":1,"flags":0,"usePreview":0,"tags":["raymarching","noise","random","plane"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define MAX_STEPS 64\n#define EPS 1e-4\n\nfloat random(in vec2 st){\n\treturn fract(sin(dot(st.xy,vec2(12.9898,78.233)))*43758.5453123);\n}\n\nfloat noise(in vec2 st){\n\tvec2 i=floor(st);\n\tvec2 f=fract(st);\n\tfloat a=random(i);\n\tfloat b=random(i+vec2(1.0,0.0));\n\tfloat c=random(i+vec2(0.0,1.0));\n\tfloat d=random(i+vec2(1.0,1.0));\n\tvec2 u=f*f*(3.0-2.0*f);\n\treturn mix(a,b,u.x)+\n\t(c-a)*u.y*(1.0-u.x)+\n\t(d-b)*u.x*u.y;\n}\n\n#define OCTAVES 6\n\nfloat fbm(in vec2 st){\n\tfloat value=0.0;\n\tfloat amplitude=0.5;\n\tfloat frequency=0.0;\n\tfor(int i=0;i<OCTAVES;i++){\n\t\tvalue+=amplitude*noise(st);\n\t\tst*=2.0;\n\t\tamplitude*=0.5;\n\t}\n\treturn value;\n}\n\n// float ground(vec3 p){\n// \treturn dot(p,vec3(0.0,1.0,0.0))+1.0;//basic plane\n// \t//return dot(p,normalize(vec3(0.0,1.0,0.0)))-sin(p.x*1.5+iTime)+1.0;//waving plane\n// }\n\nfloat ground(vec3 p){\n\tfloat d=p.y+fbm(p.xz)+12.0*noise(p.xz*0.08-vec2(0.0,0.1));\n\treturn d;\n}\n\nfloat map(vec3 p){\n\tfloat g=ground(p);\n\treturn abs(g);\n}\n\nvec3 genNormal(vec3 p){\n\treturn normalize(vec3(\n\t\tmap(p+vec3(EPS,0.0,0.0))-map(p+vec3(-EPS,0.0,0.0)),\n\t\tmap(p+vec3(0.0,EPS,0.0))-map(p+vec3(0.0,-EPS,0.0)),\n\t\tmap(p+vec3(0.0,0.0,EPS))-map(p+vec3(0.0,0.0,-EPS))\n\t\t));\n}\n\nvoid mainImage(out vec4 fragColor,in vec2 fragCoord){\n\tvec2 uv=(2.0*fragCoord.xy-iResolution.xy)/iResolution.y;\n\n\tvec3 ro=vec3(0.0,0.0,0.0-iTime*7.0);\n\tvec3 rd=normalize(vec3(uv,-1.0));\n\tfloat d,t=0.0;\n\tvec3 rp;\n\n\n\n\tfor(int i=0;i<MAX_STEPS;i++){\n\t\trp=ro+rd*t;\n\t\td=map(rp);\n\t\tif(d<EPS)break;\n\t\tt+=d;\n\t}\n\n\t// vec3 n=genNormal(rp);\n\t// fragColor=vec4(n,1.0);\n\n\tvec3 col=vec3(exp(-0.4*d));\n\n\n\tfragColor=vec4(col.x*0.9,col.y*0.3,col.z*0.1,1.0);\n}","name":"Image","description":"","type":"image"}]}