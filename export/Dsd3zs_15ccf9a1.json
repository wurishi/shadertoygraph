{"ver":"0.1","info":{"id":"Dsd3zs","date":"1677711317","viewed":153,"name":"Some smoke/clouds","username":"ianertson","description":"Some smoke/clouds.\nUse the mouse to look around :)","likes":8,"published":1,"flags":0,"usePreview":1,"tags":["sdf","clouds","smoke","march"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XdX3Rr","filepath":"/media/a/aea6b99da1d53055107966b59ac5444fc8bc7b3ce2d0bbb6a4a3cbae1d97f3aa.bin","previewfilepath":"/media/ap/aea6b99da1d53055107966b59ac5444fc8bc7b3ce2d0bbb6a4a3cbae1d97f3aa.bin","type":"volume","channel":3,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define R (iResolution.xy)\n#define T (iTime)\n#define M_PI (3.14159265359)\n#define TAU (M_PI * 2.0)\n#define ZERO (min(0, int(iTime)))\n#define adot(a,b) (abs(dot(a, b)))\n#define cdot(a,b) (max(0.0, dot(a, b)))\n#define rgb(a,b,c) (vec3(a, b, c) / 255.0)\nmat2 rot(in float a) { float c = cos(a); float s = sin(a); return mat2(c, s, -s, c); }\nvec3 noise(in vec3 p, in float seed) { return textureLod(iChannel3, (p+(seed*1.928271731))/10., 0.0).xyz;}\n\nvec3 snoise(in vec3 p, in float seed) {\n    vec3 id = floor(p);\n    vec3 lv = fract(p);\n    lv = lv*lv*(3.0-2.0*lv);\n    \n    return mix(\n    mix(\n        mix(noise(id + vec3(0, 0, 0), seed), noise(id + vec3(1, 0, 0), seed), lv.x),\n        mix(noise(id + vec3(0, 1, 0), seed), noise(id + vec3(1, 1, 0), seed), lv.x),\n        lv.y\n    ),\n    mix(\n        mix(noise(id + vec3(0, 0, 1), seed), noise(id + vec3(1, 0, 1), seed), lv.x),\n        mix(noise(id + vec3(0, 1, 1), seed), noise(id + vec3(1, 1, 1), seed), lv.x),\n        lv.y\n    ), lv.z);\n}\n\nvec3 snoise(in vec3 p, in float seed, in float freq) {\n    float div = 0.0;\n    float amp = 1.0;\n    vec3 n = vec3(0.0);\n    #define ADV n += amp*snoise(p*freq, seed); div += amp; amp /= 2.0; freq *= 2.0;\n    ADV;ADV;ADV;ADV;ADV;ADV;\n    #undef ADV\n    return n / div;\n}\n\nfloat sdf(in vec3 p) {\n    float time = T*0.1;\n    vec3 shift = (0.5+(0.5*cos(time)))*vec3(cos(time)*0.5, sin((time*1.6)+1.2938871875)*2., sin(time-4.88827715)*0.5);\n    vec3 n1 = snoise((p+shift)*0.1, 1.293915, 10.);\n    shift += (0.5+(n1*4.))*vec3(sin((time+(n1.x*2.0-1.0))), cos((time+(n1.y*2.0-1.0))), cos((time+(n1.z*2.0-1.0))));\n    vec3 n2 = snoise(((p-shift)*0.1)+(n1*0.5), 0.09928913, 10.) * 2.0 - 1.0;\n    vec3 n = reflect(n1, n2);\n    return clamp(length(n+(dot(n1, n2)/2.)) - length(p/2.), 0.0, 2.0);\n}\n\nvec3 march(in vec3 ro, in vec3 rd) {\n    float d = 0.0;\n    vec3 col = vec3(0.0);\n    float sum = 0.0;\n    for (float d = 10.0; d > 0.0;  d -= 0.5) {\n        vec3 p = ro+(rd*d*1.3); float next = sdf(p); sum += next;\n        if (sum > 0.001) col += snoise(p, 2.2232124, 3.5)*max(0.0, next - sdf(p + normalize(vec3(1, 2, -3))));   \n    }\n    \n    return col;\n}\n\nvec3 sky(in vec3 rd) {\n    vec3 c1 = rgb(1, 1, 1);\n    vec3 c2 = rgb(66, 66, 66);  \n    float dotup = max(0.0, dot(rd, vec3(0, 1, 0)));\n    return mix(c1, c2, clamp(dotup*dotup, 0.0, 1.0));\n}\n\nvoid mainImage( out vec4 O, in vec2 fc )\n{\n    vec3 col = vec3(0.0);\n    vec4 m = iMouse;\n    vec2 uv = (fc-0.5*R.xy)/R.y;\n    m.xy = (m.xy-0.5*R.xy)/R.y;\n    vec3 ro = vec3(0, 0.0, -5.0);\n    vec3 rd = normalize(vec3(uv.xy, 1.0));\n    if (m.z > 0.001) {\n        ro.yz *= rot(m.y*TAU); ro.xz *= rot(m.x*TAU);  \n        rd.yz *= rot(m.y*TAU); rd.xz *= rot(m.x*TAU);\n    }\n    col = sky(rd);\n    col += march(ro, rd);\n    col /= vec3(1.0) + col;\n    col = pow(col, vec3(1.0 / 2.2));\n    O = vec4(col, 1.0);\n}","name":"Image","description":"","type":"image"}]}