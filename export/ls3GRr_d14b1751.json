{"ver":"0.1","info":{"id":"ls3GRr","date":"1447677612","viewed":3641,"name":"Paper Kaleidoscope","username":"fizzer","description":"A sketch with some paper-like pieces and soft shadowing in layers.","likes":85,"published":1,"flags":0,"usePreview":0,"tags":["kaleidoscope","heart","paper"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[],"code":"\nvec2 softPolyOffset;\nint softPolyIndex;\n\nfloat poly(vec2 p, int n, float r)\n{\n    float d=0.;\n    for(int i=0;i<8;++i)\n    {\n        float a=float(i)/float(n)*acos(-1.)*2.;\n        float b=max(0.,dot(p,vec2(cos(a),sin(a)))-r);\n        d+=b*b;\n    }\n    return sqrt(d);\n}\n\n\nfloat heart(vec2 p,float s)\n{\n    float d=max(dot(p, vec2(-1., -1.2)*8.), dot(p, vec2(1., -1.2)*8.));\n    float u=abs(p.x) + 1.7;\n    float v=max(0.0, p.y + .9);\n    return length(vec2(d, length(vec2(u, v))))-1.8-s;\n}\n\nfloat softPoly(vec2 p, int n, float r, float s)\n{\n    if(softPolyIndex==12)\n    {\n        float d=heart(p,r-s);\n        return clamp(smoothstep(0.,s*2.,d),0.,1.);\n    }      \n    p=abs(p);\n    if(p.x>p.y)\n        p=p.yx;\n    float aa=float(n);\n    p*=mat2(cos(aa),sin(aa),-sin(aa),cos(aa));\n    p-=softPolyOffset;\n    float d=poly(p,n,r-s);\n    return clamp(smoothstep(0.,s*2.,d),0.,1.);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord.xy / iResolution.xy;\n    vec2 t=(uv-vec2(.5))*1.5;\n    t.x*=iResolution.x/iResolution.y;\n    vec3 col=vec3(0.2,0.15,0.1)*(cos((t.y*100.+sin(t.x+t.y*5.)*10.*cos(t.x*3.)*sin(t.y*20.))*2.)*.1+.9);\n    float depth=0.;\n    float shad0=1.,shad1=1.;\n\n    for(int i=0;i<20;++i)\n    {\n        softPolyIndex=i;\n        softPolyOffset=vec2(cos(float(i)+iTime*0.3),sin(float(i)*2.+iTime*0.1))*0.4;\n        vec2 p=t.xy;\n        vec2 p2=p;\n        int n=3+int(mod(float(i),7.));\n        float r=0.2;\n        float a=1.0-softPoly(p2,n,r,0.003);\n        float as0=softPoly(p2+2.0*vec2(0.002,0.005)*(1.0+float(i)-depth),n,r,0.01+0.003*(1.0+float(i)-depth));\n        float as1=softPoly(p2,n,r,0.01+0.01*(1.0+float(i)-depth));\n        shad0*=as0;\n        shad1*=as1;\n        shad0=mix(shad0,1.,a);\n        shad1=mix(shad1,1.,a);\n        vec3 c=(i==12)?vec3(1,.3,.6):vec3(1);\n        col=mix(col,c,a);\n        depth=mix(depth,float(i+1),a);\n    }\n\n    col=(.6*.5*col*mix(0.,1.,shad0)*vec3(1,1,.6)+.5*vec3(.8,.8,1)*col*mix(0.,1.,shad1));\n\n    col+=pow(1.0-smoothstep(0.,3.,-t.y+1.),4.)*vec3(1,1,.6)*.3;\n\n    fragColor.rgb=sqrt(col);\n}\n","name":"","description":"","type":"image"}]}