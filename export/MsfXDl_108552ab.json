{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[],"code":"#define MAX_STEPS 500\n\nfloat max_distance = 30.0;\nfloat epsilon = 0.1;\n\nfloat getDistance(vec3 p)\n{\n    float sr=1.9;\n    float br=.29;\n    float a = length(mod(gl_FragCoord.xy*2.,9.)-4.5)+iTime;\n    vec3 pos = sr*vec3(cos(a),.8*sin(iTime)+.5*cos(a+iTime),sin(a));\n    return length(p-pos)-br;\n}\n\nfloat march(vec3 start_pos, vec3 ray_dir)\n{\n\tfloat d = 0.0;\n\t\n\tfor (int i = 0; i < MAX_STEPS; i++)\n\t{\n\t\tvec3 ray_pos = start_pos + ray_dir*d;\n\t\tfloat s = getDistance(ray_pos);\n\t\t\n\t\td += s;\n\t\tif (s < epsilon)\n\t\t\treturn d;\t\t\t\n\t\t\n\t\tif (d > max_distance)\n\t\t\tbreak;\n\t\t\n\t}\n\t\n\treturn max_distance;\n}\n\nvec3 getNormal(vec3 point)\n{\n  float d0 = getDistance(point);\n  float dX = getDistance(point - vec3(epsilon, 0.0, 0.0));\n  float dY = getDistance(point - vec3(0.0, epsilon, 0.0));\n  float dZ = getDistance(point - vec3(0.0, 0.0, epsilon));\n\t\n  vec3 r = vec3(dX-d0, dY-d0, dZ-d0);\n  return normalize(r);\n}\n\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 uv = 2.0*fragCoord.xy / iResolution.xy - 1.0;\n    uv.x *= iResolution.x/iResolution.y;\n\t\n\tvec3 up = vec3(0.0, 1.0, 0.0);\n\tvec3 right = vec3(1.0, 0.0, 0.0);\n\tvec3 forward = vec3(0.0, 0.0, -1.0);\n\t\n\tfloat dist = 3.0;\n\n\tvec3 eye_pos = vec3(0.0, 0., dist);\n\t\n\tvec3 ray_dir = normalize(up * uv.y + right * uv.x + forward);\n\n\tfloat d = march(eye_pos, ray_dir);\n\tvec3 point = eye_pos + ray_dir*d;\n\tif (d < max_distance)\n\t{\n\t\tvec3 normal = getNormal(point);\n\n\t\tvec3 light = normalize(vec3(0.707, .707, 1.0)-ray_dir);\n\t\t\t\t\n\t\tvec3 diff_color = vec3(.4, 0.5, 1.);\n\t\tfloat diffuse = max(0.0, dot(-light, normal));\n\t\tvec3 eye_vec = ray_dir-eye_pos;\n\t\tvec3 halfa = normalize(eye_vec - light);\n\t\tfloat sdot = dot(halfa, normal);\n\t\tfloat specular = pow(sdot, 50.0);\n\t\tvec3 color =  (diffuse*diff_color + vec3(specular));\n\t\tfragColor = vec4(color, 1.0);\n\t}\n\telse\n\t{\n        fragColor = vec4(0.4);\n\t}\n}","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"MsfXDl","date":"1407814785","viewed":292,"name":"Ditherball","username":"dirkadirkadan","description":"This is ghastly","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["balls","dithering"],"hasliked":0,"parentid":"","parentname":""}}