{"ver":"0.1","info":{"id":"tlK3Dm","date":"1579130780","viewed":172,"name":":d","username":"C_H","description":"Drag your mouse around! \n\nMy own take on https://www.youtube.com/watch?v=ZlNnrpM0TRg","likes":4,"published":1,"flags":0,"usePreview":0,"tags":["puke","smiley"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define S(a, b, t) smoothstep(a, b, t)\n#define sat(x) clamp(x, 0., 1.)\n#define PI 3.1415926535897932384626433832795\n\nfloat remap01(float a, float b, float t) {\n    return sat((t-a)/(b-a));\n}\n\nfloat remap(float a, float b, float c, float d , float t) {\n    return sat(((t-a)/(b-a)) * (d-c) + c);\n}\n\n// https://gist.github.com/patriciogonzalezvivo/670c22f3966e662d2f83#generic-123-noise\nfloat rand(vec2 n) { \n\treturn fract(sin(dot(n, vec2(12.9898, 4.1414))) * 43758.5453);\n}\n\nfloat noise(vec2 p){\n\tvec2 ip = floor(p);\n\tvec2 u = fract(p);\n\tu = u*u*(3.0-2.0*u);\n\t\n\tfloat res = mix(\n\t\tmix(rand(ip),rand(ip+vec2(1.0,0.0)),u.x),\n\t\tmix(rand(ip+vec2(0.0,1.0)),rand(ip+vec2(1.0,1.0)),u.x),u.y);\n\treturn res*res;\n}\n\nvec2 within(vec2 uv, vec4 rect) {\n    return (uv-rect.xy)/(rect.zw-rect.xy);\n}\n\nvoid distortEyeArea(inout vec2 eyeArea, float eyeYShrinkFactor, float puke) {\n    eyeArea.y *= eyeYShrinkFactor;\n    eyeArea.y += (eyeArea.x * eyeArea.x) * 2. * puke;\n    eyeArea.x += eyeArea.x * .2 * puke;\n}\n\nvec4 Brow(vec2 uv, float puke) {\n    vec4 col = vec4(.15, 0., 0., 1.);\n\n    uv.y += -.5 * (1. - puke) + uv.x * uv.x * (.4 * (1. - puke)) * (.5 + puke / (uv.x + 2.)) + (uv.x * .4 + .2) * puke;\n    uv.y /= 1. + puke * .2;\n    float browMask = S(1., .98, max(abs(uv.x)*1.1, abs(uv.y)*8.));\n    vec2 shadowDist = vec2(.05, .15) * (1. + 2. * (1. - puke));\n    float shadowMask = sat(S(1., .1, max( abs(uv.x-shadowDist.x)*1.1, abs(uv.y+shadowDist.y)*8. )) - browMask) * .2;\n\n    col.a *= shadowMask + browMask;\n    col.rgb = mix(col.rgb, vec3(1.), S(1., .0, length(uv*1.5-vec2(0.,.5))*.5)*.2);\n    col.rgb = mix(col.rgb, vec3(0.), shadowMask);\n\n    return col;\n}\n\nvec4 Eye(vec2 uv, float puke, vec2 m, float side) {\n    vec4 col = vec4(1.);\n\n    float eyeYShrinkFactor = 1. + puke * 4.;\n\tdistortEyeArea(uv, eyeYShrinkFactor, puke);\n\n    float d = length(uv);\n    col.a = S(1.0, 0.98, d);\n    col.rgb = mix(col.rgb, vec3(0.), S(0.9, 1., d) * .5 * sat(-uv.y-uv.x));\n\n    uv.y /= eyeYShrinkFactor;\n    uv.x *= side;\n\n    d = length(uv-vec2(m.x, m.y*.5));\n    vec3 irisCol = vec3(.3,.5,1.);\n    col.rgb = mix(col.rgb, irisCol, S(0.3, 1.0, d) * 0.3);\n    col.rgb = mix(col.rgb, vec3(0.), S(0.5, 0.45, d));\n    \n    // irisCol *= 1. + S(.6, .05, d);\n    // col.rgb = mix(col.rgb, irisCol, S(0.44, 0.43, d));\n    // col.rgb = mix(col.rgb, vec3(0.), S(0.30, 0.29, d));\n\n    uv.y *= eyeYShrinkFactor;\n    float highlight = S(0.2, 0.15, length(uv+vec2(-.15,.15))) * 0.95 * (1. - puke);\n    highlight += S(0.25, 0.20, length(uv-vec2(-.25,.25))) * .95 * (1. - puke);\n    col.rgb = mix(col.rgb, vec3(1.), highlight);\n    \n    return col;\n}\n\nvec4 Head(vec2 uv, vec2 eyeArea, float puke) {\n    vec4 col = vec4(.5 + (1. - puke) * .3, .6 + puke * .1, .2 - puke * .1, 1.0);\n  \n    float d = length(uv);\n    col.a = S(0.801, 0.8, d);\n    \n    float edgeShade = remap01(.1, .8, d);\n    edgeShade *= edgeShade;\n    col.rgb *= 1. - edgeShade * .4;\n    \n    col.rgb = mix(col.rgb, vec3(.7 + (1. - puke) * .2, .7 + puke * .1, .3 + puke * .1), S(0.770, 0.771, d));\n    \n    float highlight = S(0.651, 0.65, d);\n    highlight *= remap(0.651, -.0, .5, 0., uv.y);\n    highlight*= highlight * 2.;\n  \n\tdistortEyeArea(eyeArea, 1. + puke * 4., puke);\n    eyeArea *= 0.82;\n    float ed = length(eyeArea);\n    highlight *= 1. - S(1., 0.9, ed);\n\n    col.rgb = mix(col.rgb, vec3(1.0), highlight);\n    \n    d = length(uv-vec2(.36,-.2));\n\tfloat cheek = S(0.301, 0.05, d) * .3;\n    cheek *= S(0.25, 0.20, d);\n\n    col.rgb = mix(col.rgb, vec3(.8 ,puke,.8), cheek);\n    \n    return col;\n}\n\nfloat teethShape(vec2 uv, float puke) {\n    vec4 col = vec4(0.);\n\n    uv.y *= 1.5;\n    uv.y += puke * .2;\n    uv.x -= cos(uv.y) * 0.04;\n\n    float td = length(uv-vec2(0., -.6));\n    float l = uv.x * 3.;\n    l *= fract(l);\n\tl = S(.8,.65, l);\n\tl -= S(.01,.0, uv.x);\n    \n    return S(.6, .55, td) * l;\n}\n\nvec4 Mouth(vec2 uv, float puke) {\n    vec4 col = vec4(0.);\n\n    float teethShape = teethShape(uv, puke);\n\n    uv.y *= 1.5;\n    uv.y -= uv.x * uv.x * puke;\n    \n    float xShrink = uv.x * 0.4 * (1. - puke);\n    uv.x += xShrink;\n    \n    float d = length(uv);\n    col.a = S(1., 0.95, d);\n\n    uv.x -= xShrink;\n    uv.y += puke * .2;\n\n    float shadow = pow(S(1., 0.3, d *.8), 2.);\n    teethShape *= shadow;\n\n    col.rgb = mix(col.rgb, vec3(1.), teethShape);\n\n    uv /= 1.5;\n    uv.y -= uv.x * uv.x * 1.1 + puke * .2;\n    float td = length(uv-vec2(.0, 1.));\n    col.rgb = mix(col.rgb, vec3(1., .6, .6), pow(S(1., .5, td), 1.6) * .7);\n\n    return col;\n}\n\nvec4 Puke(vec2 uv, float mouthShape, float puke) {\n    vec4 col = vec4(.1, .7, .1, 1.);\n    \n    col.rgb *= 1. - noise(uv * 4. + iTime ) * .24;\n    \n    uv.x += sin(uv.y * 0.2) * noise(uv + iTime * 1.2);\n    uv.x /= .5 + puke * .5;\n\n    float mask = mouthShape * S(0.34, 0.32, uv.x);\n    mask += S(-.42, -.50, uv.y) * S(.33, .29, uv.x);\n    mask = clamp(0., 1., mask);\n\n    col.a = mask;\n    return col;\n}\n\nvec4 Smiley(vec2 uv, vec2 m) {\n    vec4 col = \tvec4(0.);\n    float side = sign(uv.x);\n    float puke = ((sin(iTime) + 1.) / 2. * 0.1) + 0.9 * (cos(PI * m.x) + 1.) / 2.;\n    uv.x = abs(uv.x);\n    uv.y *= 0.95 + puke *.05;\n    vec2 eyeArea = within(uv, vec4(.35, .1, .65, .4));\n    vec4 head = Head(uv, eyeArea, puke);\n    vec4 eye = Eye(eyeArea, puke, m, side);\n    vec4 brow = Brow(within(uv, vec4(.35, .4, .65, .8)), puke);\n    \n    vec2 mouthArea = within(uv, vec4(.0, -.35, .4, -.55));\n    vec4 mouth = Mouth(mouthArea, puke);\n    vec4 pukeFlow = Puke(uv, mouth.a * S(.0, 1., (1. - length(mouthArea-vec2(0., .9))) *2.8), puke);\n\tpukeFlow.a *= S(0., -.1, uv.y * puke * .15);\n\n    col = mix(col, head, head.a);\n    col = mix(col, eye, eye.a);\n    col = mix(col, brow, brow.a);\n    col = mix(col, mouth, mouth.a);\n    col = mix(col, pukeFlow, pukeFlow.a);\n\n    return col;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord/iResolution.xy;\n    uv = uv * 2. - 1.;\n    uv.x *= iResolution.x/iResolution.y;\n\n    vec2 m = iMouse.xy/iResolution.xy * 2. - 1.;\n    uv -= m * (.25- dot(uv, uv) * 0.2);\n\n    fragColor = Smiley(uv, m);\n}","name":"Image","description":"","type":"image"}]}