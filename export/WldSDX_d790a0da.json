{"ver":"0.1","info":{"id":"WldSDX","date":"1581861809","viewed":421,"name":"Image border 9-slicing","username":"ruojake","description":"Wanted to do sprite 9-slicing in the fragment shader for a work thing and couldn't find anything good by googling so I came up with this. Chances are my Google-fu is weak but if that's not the case, here's a solution for anyone to use.","likes":1,"published":1,"flags":0,"usePreview":0,"tags":["texture","ui","border","9slicing"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4sf3Rn","filepath":"/media/a/0a40562379b63dfb89227e6d172f39fdce9022cba76623f1054a2c83d6c0ba5d.png","previewfilepath":"/media/ap/0a40562379b63dfb89227e6d172f39fdce9022cba76623f1054a2c83d6c0ba5d.png","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// Image 9-slicing in fragment shader. \n// Feel free to share and use anywhere.\n// Graph that I used to reason about the problem: \n// https://www.desmos.com/calculator/wkvma9uh0a\n\n// borders in pixels, x = left, y = bottom, z = right, w = top\n#define B vec4(10., 20., 30., 20.)\n\nvec2 uv9slice(vec2 uv, vec2 s, vec4 b)\n{\n    vec2 t = clamp((s * uv - b.xy) / (s - b.xy - b.zw), 0., 1.);\n\treturn mix(uv * s, 1. - s * (1. - uv), t);\n}\n\n/* HLSL for convenience\n\nfloat2 uv9slice(float2 uv, float2 s, float4 b)\n{\n\tfloat2 t = saturate((s * uv - b.xy) / (s - b.xy - b.zw));\n\treturn lerp(uv * s, 1. - s * (1. - uv), t);\n}\n\n*/\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord/iResolution.xy;\n    vec2 ts = vec2(textureSize(iChannel0, 0));\n    // scaling factor\n    // probably available as uniform irl\n    vec2 s = iResolution.xy / ts;\n\n    // border by texture size, shouldn't be > .5\n    // probably available as uniform irl\n    vec4 b = min(B / ts.xyxy, vec4(.499));\n    uv = uv9slice(uv, s, b);\n    \n    vec3 col = vec3(texture(iChannel0, uv).x);\n\n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}