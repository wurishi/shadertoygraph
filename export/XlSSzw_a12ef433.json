{"ver":"0.1","info":{"id":"XlSSzw","date":"1442267946","viewed":477,"name":"fluidthing","username":"vortex","description":"Giving it a try at a procedural fluid","likes":16,"published":1,"flags":0,"usePreview":0,"tags":["fluid"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[],"code":"// Created by Stefan Draganov - vortex/2015\n// License Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License.\n\nconst float s2=30.0;\nconst float s =40.0/s2;\n\nvec3 n(vec2 x,float t)\n{\n    vec3 u=floor(vec3(x,t));\n    \n    vec3 c=fract(\n        u.xyz*(vec3(0.16462,0.84787,0.98273)+\n         u.xyz*vec3(0.24808,0.75905,0.13898)+\n         u.yzx*vec3(0.31517,0.62703,0.26063)+\n         u.zxy*vec3(0.47127,0.58568,0.37244))+\n        \n        u.yzx*(vec3(0.35425,0.65187,0.12423)+\n         u.yzx*vec3(0.95238,0.93187,0.95213)+\n         u.zxy*vec3(0.31526,0.62512,0.71837))+\n        \n        u.zxy*(vec3(0.95213,0.13841,0.16479)+\n         u.zxy*vec3(0.47626,0.69257,0.19738))\n    );//*vec3(0.5,0.5,1.0)+vec3(0.25,0.25,0.0);//*vec3(1.0,1.0,0.5)+vec3(0.0,0.0,0.25);\n    \n    return u+c;\n}\n\nfloat arrow(vec2 x,vec2 d)\n{\n    \n    float l=min(length(d),1.0);\n    \n    x=mat2(normalize(d)/l,normalize(vec2(d.y,-d.x))/l)*(x-vec2(0.5));\n    \n    return min(max(floor(abs(x.y)-0.05)+1.0,x.x>0.0&&x.x<0.25?0.0:1.0 ),\n               x.x-0.25>0.0 && x.x-0.25+abs(x.y)<0.25 ? 0.0 : 1.0 );\n}\n\nvec3 col(vec2 x,float t)\n{\n    return vec3(0.5)+0.5*cos(fract(vec3(x,t))*371.0241);\n}\n\nvec2 idx(vec2 x)\n{\n    return \n        //clamp(floor(3.0*normalize(vec2(x.y,-x.x))),vec2(-1.0),vec2(1.0));\n                       floor(fract(x*29.0)*3.0)-vec2(1.0);\n}\n\nfloat circle(vec2 x,vec2 c,float r)\n{\n    return max(0.0,1.0-dot(x-c,x-c)/(r*r));//<r*r?1.0:0.0;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 x = s*(fragCoord.xy-1.0*iMouse.xy)/iResolution.x;\n    \n    vec2 u = floor(x*s2)+vec2(0.5);\n    \n    float t=iTime*0.1;\n    \n    vec2 v=vec2(0.0);\n    \n    vec4 c=vec4(vec3(0.0),0.1);\n    \n    for (int N=0;   N<10; N++)\n    for (int k=-1; k<=0; k++)\n    for (int i=-1; i<=1; i++)\n    for (int j=-1; j<=1; j++)\n    {\n        vec2 X=x+vec2(j,i);\n        float t=t+float(N)*38.0;\n        float T=t+float(k);\n        vec3 a=n(X,T);\n        \n        vec2 o=idx(a.xy);\n        vec3 b=n(X+o,T+1.0);\n        vec2 m=mix(a.xy,b.xy,(t-a.z)/(b.z-a.z));\n        \n        float strength=clamp(sin(3.1415927*(t-a.z)/(b.z-a.z)),0.0,1.0)\n            *(mix(col(a.xy,a.z).r,col(b.xy,a.z).r,(t-a.z)/(b.z-a.z))-0.5);\n        \n        float r=60.0*(strength);\n        \n        if (length(a.xy-b.xy)/(b.z-a.z)>2.0) r=0.0;\n        \n        v+=r*exp(-dot(u/s2-m,u/s2-m)/(0.025))*vec2((u/s2-m).y,-(u/s2-m).x);\n     //   c+=vec4(circle(x,m,0.25)*col(a.xy,a.z),0.0);\n    }\n    \n    c=vec4(mix(vec3(0.0),vec3(1.0),arrow(s2*(x-(u-vec2(0.5))/s2),v)),1.0);\n\tfragColor = c;\n}","name":"","description":"","type":"image"}]}