{"ver":"0.1","info":{"id":"4dGXRm","date":"1463403361","viewed":240,"name":"color keeping tonemap","username":"nikq","description":"HDR colors should be tonemapped.\nSimple linear tonemap kills color in brighter pixel.\nThis tonemap keeps color instead of losing luminance.","likes":4,"published":1,"flags":0,"usePreview":0,"tags":["tonemap"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"vec3 hsv2rgb(vec3 c)\n{\n    // https://www.shadertoy.com/view/XlfGDN\n    return mix(vec3(1.),clamp((abs(fract(c.x+vec3(3,2,1)/3.)*6.-3.)-1.),0.,1.),c.y)*c.z;\n}\n\nvec3 rgb_clamp( vec3 rgb )\n{\n    return vec3( \n        rgb.x > 1. ? 1. : rgb.x,       \n        rgb.y > 1. ? 1. : rgb.y,\n       \trgb.z > 1. ? 1. : rgb.z );\n                \n}\n\n// keep color vibrant\nvec3 rgb_clamp2( vec3 rgb )\n{\n\tfloat max = max( rgb.x, max( rgb.y, rgb.z ) );\n    return (max > 1.0) ? rgb / max : rgb;\n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    float time = iTime / 10.;\n\tvec2 uv = fragCoord.xy / iResolution.xy;\n    vec4 m = iMouse / iResolution.xxxx;\n\n    if( uv.y > 0.5 )\n    {\n\t    vec3 hsv = vec3( time - floor(time), (uv.y-0.5)*2., uv.x * 2. );\n\t    vec3 rgb = hsv2rgb( hsv );\n        fragColor = vec4( rgb_clamp(rgb), 1. );\n    }\n    else\n    {\n\t    vec3 hsv = vec3( time - floor(time), (uv.y)*2., uv.x * 2. );\n\t    vec3 rgb = hsv2rgb( hsv );\n        vec3 c1 = rgb_clamp( rgb );\n        vec3 c2 = rgb_clamp2( rgb );\n        fragColor = vec4( mix(c1,c2,m.x), 1. );\n    }\n}","name":"Image","description":"","type":"image"}]}