{"ver":"0.1","info":{"id":"wsSfD3","date":"1591984226","viewed":886,"name":"sound lac","username":"louis_C","description":"playing to mix sounds and visuals","likes":48,"published":1,"flags":40,"usePreview":0,"tags":["raymarching","sound"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"float rd(float t){return fract(sin(dot(floor(t),45.236))*7845.236);}\nfloat no(float t){return mix(rd(t),rd(t+1.),smoothstep(0.,1.,fract(t)));}\nvec3 bl(vec2 uv){   \n    vec3 col = vec3(0.);\n    float bound = sqrt(32.);\n    float time = iTime;\n    float md =  mix(1.-pow(fract(time*2.),0.1),1.-pow(fract(time*4.),0.1),step(fract(time/3.),1./3.))\n        *pow(no(time+1.),3.)*0.1;\n\t\tfloat li = mix(0.00015,0.006+md,distance(uv.y,0.47));\n        for(float i = -.5*bound; i<=.5*bound; i++)\n        for(float j=-.5*bound; j<=.5*bound; j++)\n        {\n            col += texture(iChannel0,uv+vec2(i,j)*li).xyz;\n        }\n    col /= 32.;\nreturn col;\n}\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n   \n    vec2 uv = fragCoord/iResolution.xy;\n\tvec3 t = bl(uv);\n    fragColor = vec4(t,0.);\n}","name":"Image","description":"","type":"image"},{"inputs":[],"outputs":[],"code":"float PI = 3.14159265359;\nfloat rd(float t){return fract(sin(dot(floor(t),45.236))*7845.236);}\nfloat no(float t){return mix(rd(t),rd(t+1.),smoothstep(0.,1.,fract(t)));}\nfloat it(float t){float r=0.;float amp = 0.5;for (int i = 0 ; i < 4 ; i++){\nr +=no(t/amp)*amp;amp*=0.5;}return r;} \nfloat map(float value, float min1, float max1, float min2, float max2) {\n  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\n}\nfloat cl (float t){ return mix(1.-fract(t*8.),map(fract(t),0.125,1.,0.,1.),step(0.125,fract(t)));}\nmat2 rot (float t){float c=cos(t);float s=sin(t);return mat2(c,s,-s,c);}\nvec2 mainSound( in int samp, float time )\n{\n    float f1 = 0.;\n    float f2 = 0.;\n    float it1 = it(time*100.);\n    int nbr = int((sin(time/PI)*0.5+0.5)*8.+2.);\n    float va1 = 30.+(it1)*5.*sin(time*PI*8.);\n    float va2 = 100.+(it1)*sin(time/PI)*-2.*sin(time*PI*8.);\n    float bf = pow(sin(time*PI*2.)*0.5+0.5,pow(sin(time*PI*8.)*0.5+0.5,0.1)*0.3);\n    for(int i = 1 ; i < nbr; i ++ ) {\n        float v = float(i);\n    f1 += it(bf*va2*v)/float(nbr);\n    f2 += sin(bf*va1*v)/float(nbr);    \n    }\n    vec2 ff1 = f1*0.7 + mix(vec2(f1*0.3,f2),vec2(f2,f1*0.3),sin(time*8.)*0.5+0.5);\n    float f3 = sin(time*200.+(it1-0.5)*0.5)*3.;\n    float f4 = rd(fract(time)*1e7)*(1.-pow(fract(time*10.),0.2))*2.5;\n    float vtt = no(time*48.);\n    float bct = fract(time*0.05);\n    float ct = smoothstep(0.5,-0.25,distance(fract(pow(bct,mix(6.,-1.,bct))*4.),0.5))*smoothstep(20.,30.,time);\n    float bs = no(time*0.2)*20.*no(time*0.5);\n    float bs2 = pow(fract(time*2.),0.3);\n    float bs3 = no(time*10000.);\n    float s1 = sin(pow(bs3,abs(pow(fract(time*6.+0.5),bs)-bs2)));\n    float s2 = sin(pow(bs3,abs(pow(fract(time*6.),bs)-bs2)));   \n    vec2 ff2 = vec2(s1,s2)*step(0.3,fract(time*8.));\n    float deb = clamp(pow(time*0.1,5.),0.,1.);\n    float dba = mix(1.-pow(fract(time*2.),0.1),1.-pow(fract(time*4.),0.1),step(fract(time/3.),1./3.));\n    vec2 bat = vec2((fract(time*100000.)*0.5+rd(time*100000.)*0.3+sin(time*100000.)*0.5));\n    bat *= rot(time*4.);\n    bat *= dba;\n    vec2 bff = mix(ff2,ff1*2.5,smoothstep(0.2,0.8,cl(time*0.05)));    \n\treturn (clamp(mix(bff,vec2(f3+f4),ct)*deb+bat*pow(no(time+1.),3.),-1.,1.));\n}","name":"Sound","description":"","type":"sound"},{"inputs":[],"outputs":[{"id":"4dXGR8","channel":0}],"code":"float PI = 3.14159265359;\nfloat t = 40.;\nfloat rd(float p){return fract(sin(dot(floor(p),45.236))*7845.236);}\nfloat no(float p){return mix(rd(p),rd(p+1.),smoothstep(0.,1.,fract(p)));}\nfloat it(float p){float r=0.;float amp = 0.5;for (int i = 0 ; i < 4 ; i++){\nr +=no(p/amp)*amp;amp*=0.5;}return r;} \nfloat rd(vec2 p){return fract(sin(dot(floor(p),vec2(95.23,145.95)))*7895.236);}\nfloat hs(vec2 p){return fract(sin(dot((p),vec2(95.23,145.95)))*7895.236+t*3.);}\nfloat map(float value, float min1, float max1, float min2, float max2) {\n  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\n}\nfloat cl (float t){ return mix(1.-fract(t*8.),map(fract(t),0.125,1.,0.,1.),step(0.125,fract(t)));}\nfloat no(vec2 t){vec2 e=vec2(1.,0.);float a=rd(t);float b=rd(t+e.xy);\n  float c=rd(t+e.yx);float d=rd(t+e.xx);vec2 h=smoothstep(0.,1.,fract(t));\n  return mix(mix(a,b,h.x),mix(c,d,h.x),h.y);}\nfloat it (vec2 t){float r=0.;float amp=0.5; for(int i=0;i<5;i++){\n  r +=no(t/amp)*amp;amp*=0.5;}return r;}\n  float cy (vec3 p,float h,float r){\n    vec2 d = abs(vec2(length(p.xz),p.y))-vec2(h,r);\n    return min(max(d.x,d.y),0.)+length(max(d,0.));\n  }\n  float box (vec3 p,vec3 b){vec3 q = abs(p)-b;return length(max(q,0.))+min(0.,max(max(q.x,q.y),q.z));}\n  vec3 rep(vec3 p , vec3 c){return mod(p+0.5*c,c)-0.5*c;}\n float z1 = 0.;\n  float z2 = 0.;\n  float l1 = 0.;\n  float z3 = 0.;\n  float l3 = 0.;\nfloat m(vec3 p){\n   float t = iTime;\n  vec3 p1 = rep(p+vec3(5.,-1.,-5.),vec3(10.,0.,4.));\n    float t5 =mix(0.3,it(t*100.)+(sin(t*PI*8.)*0.5+0.5),smoothstep(0.4,0.6,cl(t*0.05))\n                  *smoothstep(2.,3.,t));\n  float v1 = max(box(p+vec3(0.,0.,mix(-10.,-40.,t5)),vec3(mix(30.,10.,step(4.,t)),10.,20.)),\n                 cy(p1,0.07,3.5));\n  float va = ((no(p.xz*vec2(0.6,1.)+t)-0.5)+(no(p.xz*vec2(0.6,1.2)-t)-0.5))*0.3;\n  float v2 = dot(p,vec3(0.,1.,0.))+va+2.;\n  float v3 = box(p+vec3(0.,1.,-40.),vec3(35.,20.,4.));\n  z2 = v2;\n  z1 = v1;\n  z3 = v3;\n  float bl1 =0.4;\n  l1 += (bl1/(bl1+v1));\n  float bl3 =3.;\n  l3 += bl3/(bl3+v3);\n  float f1 = min(min(v1,v2),v3);\n  return f1;}\n  vec3 nor(vec3 p){vec2 e = vec2(0.01,0.);return normalize(m(p)-vec3(m(p+e.xyy),m(p+e.yxy),m(p+e.yyx)));}\n float ov(float a,float b ){return mix(2.*a*b,1.-2.*(1.-a)*(1.-b),step(0.5,a));}\n vec3 ov(vec3 a,vec3 b ){return mix(2.*a*b,1.-2.*(1.-a)*(1.-b),step(0.5,a));}\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    float time = iTime;\n     vec2 uv = fragCoord/iResolution.xy;\n    uv -=0.5;\n    uv *=2.;\n    uv.x*=iResolution.x/iResolution.y;\n    vec3 e = vec3(0.,0.,-7.);\n  vec3 r = normalize(vec3(uv,1.));\n  vec3 p = e;\n  vec3 col = vec3(0.);\n  vec3 n = vec3(0.);\n  float dd= 0.;\n  float di =1.;\n  float zb = 0.;\n  for(int i =0;i<64;i++){\n    float d =m(p);   \n    if(dd>64.){dd=64.;break;}\n    if(d<0.001){\n      zb =0.1-z2;\n      n = nor(p);\n      di +=zb ;\n      if(di<0.01){break; }      \n      r = reflect(r,n);\n      d=0.01;\n    }\n    p +=r*d;\n    dd +=d;\n  } \n  float ma = smoothstep(64.,0.,dd);\n  float dba = mix(pow(fract(time*2.),5.),pow(fract(time*4.),5.),step(fract(time/3.),1./3.));\n float t1 = 1.5*dba;\n float bs = no(time*0.2)*20.*no(time*0.5);\n float bs2 = pow(fract(time*2.),0.3);\n float s1 = abs(pow(fract(time*6.+0.5),bs)-bs2);\n float s2 = abs(pow(fract(time*6.),bs)-bs2); \n  float t2 = mix(s1,s2,smoothstep(-0.3,0.3,uv.x))*2.5*step(0.3,fract(time*8.));\n    float deb = clamp(pow(time*0.1,5.),0.,1.);\n  float t3 = mix(t1,t2,deb);\n  float t4 = pow(sin(time*PI*2.)*0.5+0.5,pow(sin(time*PI*8.)*0.5+0.5,0.1)*0.3)*1.5;  \n  float t5 = mix(t3,t4,smoothstep(0.4,0.6,cl(time*0.05)))*smoothstep(1.,2.,time) ;\n  col +=clamp( smoothstep(1.,0.,z1)*ma+l1*mix(0.02,0.05,smoothstep(-0.15,0.2,uv.y)),0.,1.)*vec3(0.7,0.8,1.)*t5;\n  float nn = it(uv*vec2(2.,4.)+vec2(time*-0.1,0.));\n  float le = smoothstep(0.5,0.0,distance(vec2(0.5),fract(uv*150.)))*step(0.05,fract(uv.x*10.+0.5));\n    float f4 = it(time*100.)+(rd(fract(time)*1e7)*1.-pow(fract(time*10.),0.2))*2.;\n    float bct = fract(time*0.05);\n    float ct = smoothstep(0.5,-0.25,distance(fract(pow(bct,mix(6.,-1.,bct))*4.),0.5))*smoothstep(20.,30.,time);\n  col += (ov(clamp(smoothstep(0.1,0.,z3)*le+l3*mix(0.02,0.1,smoothstep(-0.7,0.5,uv.y)),0.,1.),nn))\n   *vec3(1.,0.,0.2)*f4*1.2*ct;\n   vec3 coln = ov(col,mix(vec3(0.5),vec3(hs(uv),hs(uv+48.236),hs(uv+845.234)),0.15));\n    fragColor = vec4(coln,1.);\n}","name":"Buffer A","description":"","type":"buffer"}]}