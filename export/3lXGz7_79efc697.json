{"ver":"0.1","info":{"id":"3lXGz7","date":"1555852401","viewed":156,"name":"Aura","username":"gaz","description":"3d","likes":3,"published":1,"flags":0,"usePreview":0,"tags":["3d"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"vec3 rotate(vec3 p,vec3 axis,float theta)\n{\n    vec3 v = cross(p, axis), u = cross(v, axis);\n    return u * cos(theta) + v * sin(theta) + axis * dot(p, axis);   \n}\n\nfloat map(vec3 p)\n{\n    p = rotate(p,normalize(vec3(1)), iTime);\n    p = abs(p);\n    return min(length(p)-1.8,(p.x+p.y+p.z-2.5)*0.5773);\n\n}\n\nvec3 calcNormal(vec3 pos){\n  vec2 e = vec2(1, -1) * 0.002;\n  return normalize(\n    e.xyy*map(pos+e.xyy)+e.yyx*map(pos+e.yyx)+ \n    e.yxy*map(pos+e.yxy)+e.xxx*map(pos+e.xxx)\n  );\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord)\n{\n    vec2 p = (gl_FragCoord.xy * 2.0 - iResolution.xy) / iResolution.y;\n    vec3 ro = vec3(0,0,7);\n    vec3 rd = normalize(vec3(p, -2));\n\n\tvec3 col = vec3(0.05, 0.05, 0.15);\n\tconst float maxd = 80.0, precis = 0.001;\n\tfloat t,d;\n\tt = 0.0;\n\tfloat weight =  0.5+sin(iTime)*0.25;\n \tfor(int i = 0; i < 32; i++)\n  \t{\n\t\tvec3 p=ro + rd * t; \n        t += d =map(p) * weight;\n    \tif (d < precis || t > maxd) break;\n    }\n  \tcol = mix(vec3(0.9,0.4,0.1),col, smoothstep(0.0, 1.0, d*0.08+0.05));  \n\tt = 0.0;\n\tfor(int i = 0; i < 128; i++)\n  \t{\n\t\tvec3 p=ro + rd * t; \n    \tt += d =map(p);\n    \tif (d < precis || t > maxd) break;\n    }\n    if(d < precis)\n  \t{\n\t  \tvec3 p = ro + rd * t;\n\t \tvec3 nor = calcNormal(p);\n    \tvec3 li = normalize(vec3(1));\n        col = vec3(0.3,0.7,0.5);\n        float dif = clamp(dot(nor, li), 0.3, 1.0);\n        float amb = max(0.5 + 0.5 * nor.y, 0.0);\n        col *= dif * amb;\n    }\n  \tcol = pow(col, vec3(1.2));        \n\tt=iTime * 5.0;\n\tcol +=vec3(1,0.5,0)*sin(p.y*500.0-t)*sin(p.x*300.0-t)*0.2;\n\tcol *= clamp(2.0-length(p),0.0,1.0);\n    fragColor = vec4(col, 1.0);\n}","name":"Image","description":"","type":"image"}]}