{"ver":"0.1","info":{"id":"NsGXRd","date":"1635108301","viewed":126,"name":"Autumn triangles","username":"sinvec","description":"I have no idea what it actually is, but I hope it will cheer you up :) Based on Truchet tiles and Penrose triangles.","likes":6,"published":1,"flags":0,"usePreview":0,"tags":["2d","truchet","penrose"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XdX3Rn","filepath":"/media/a/52d2a8f514c4fd2d9866587f4d7b2a5bfa1a11a0e772077d7682deb8b3b517e5.jpg","previewfilepath":"/media/ap/52d2a8f514c4fd2d9866587f4d7b2a5bfa1a11a0e772077d7682deb8b3b517e5.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4dXGzn","filepath":"/media/a/0c7bf5fe9462d5bffbd11126e82908e39be3ce56220d900f633d58fb432e56f5.png","previewfilepath":"/media/ap/0c7bf5fe9462d5bffbd11126e82908e39be3ce56220d900f633d58fb432e56f5.png","type":"texture","channel":1,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\n#define PI 3.14159\n#define s(v,l) smoothstep(l/R.y,0.,v) // AA\n#define r(a) (mat2(cos(a),sin(a),-sin(a),cos(a))) // 2d rotation matrix\n#define R iResolution.xy\n\nfloat hash21(vec2 p) {return fract(fract(dot(p,vec2(5.15123,2.1235)))*41.3151);}\n\n// IQ's SDF function for line segment (https://www.shadertoy.com/view/3tdSDj)\nfloat udSegment(in vec2 p, in vec2 a, in vec2 b){\n    vec2 ba = b-a;\n    vec2 pa = p-a;\n    float h = clamp(dot(pa,ba)/dot(ba,ba), 0., 1.);\n    return length(pa-h*ba);\n}\n\n// My SDF function for one segment of Penrose Triangle\n#define ST sqrt(3.)\nfloat penrose_triangle_segment(in vec2 p, in float a, in float b) {\n    float d = udSegment(p, vec2(a*.5,-a*ST/6.),vec2(a*.5+b/ST,-a*ST/6.-b));\n    d = min(d,udSegment(p, vec2(-b*2./ST-a*.5,-a*ST/6.),vec2(a/2.,-a*ST/6.)));\n    d = min(d,udSegment(p, vec2(-b*5./ST-a*.5,-a*ST/6.-b),vec2(a*.5+b/ST,-a*ST/6.-b)));\n    d = min(d,udSegment(p, vec2(-b*2./ST-a*.5,-a*ST/6.),vec2(b/ST,a*ST/3.+3.*b)));\n    d = min(d,udSegment(p, vec2(-b*5./ST-a*.5,-a*ST/6.-b),vec2(b/ST-b*2./ST,a*ST/3.+3.*b)));\n    d = min(d,udSegment(p, vec2(b/ST-b*2./ST,a*ST/3.+3.*b),vec2(b/ST,a*ST/3.+3.*b)));\n    return (p.y<(p.x*ST/3.+0.66*b)) ? \n        (p.y>(-a*ST/6.-b)&&p.y<-a*ST/6.&&p.y<(-p.x*ST+a*ST/3.)) ? -d:d : \n        (p.y<(a*ST/3.+3.*b)&&p.y<(p.x*ST+a*ST/3.+4.*b)&&p.y>(p.x*ST+a*ST/3.+2.*b)) ? -d:d;\n}\n\n// SDF Function for circle\nfloat circle (vec2 p, vec2 c, float r, float w) {return abs(length(p-c)-r)-w;}\n\n// Three different patterns based on Truchet tiles\nvec3 pattern1 (vec2 u) {\n    u*=30.;\n    u.x-=u.y/ST;\n    vec3 col =  mix(vec3(1.,.9,.8), vec3(.0), texture(iChannel1, u).x*.9);\n    vec2 grid = floor(u);\n    float id = hash21(grid);\n    vec2 cent = u-grid-.5;\n\tcent = r(PI/2. * floor(id * 7.)) * cent;\n    float t = length(texture(iChannel0, u+sin(iTime*.01)).xyz)*1.1;\n\tcol = mix(col, vec3(.8,.2,.0)*t, s(circle(cent, vec2(-.5,.5), .5, .1),30.));\n\tcol = mix(col, vec3(.8,.2,.0)*t, s(circle(cent, vec2(.5,-.5), .5, .1),30.));\n    return col;\n}\n\nvec3 pattern2 (vec2 u) {\n    u*=20.;\n    u.x-=u.y/ST;\n    vec3 col = mix(vec3(.9,.9,.8), vec3(.0), texture(iChannel1, u).x*.9);\n    vec2 grid = floor(u);\n    float id = hash21(grid);\n    vec2 cent = u-grid-.5;\n\tcent = r(PI/2. * floor(id * 7.)) * cent;\n    float t = length(texture(iChannel0, u+sin(iTime*.01)).xyz)*1.1;\n\tcol = mix(col, vec3(.7,.4,.1)*t, s(circle(cent, vec2(-.5,.5), .05, .06),10.));\n\tcol = mix(col, vec3(.7,.4,.1)*t, s(circle(cent, vec2(.5,-.5), .05, .06),10.));\n\tcol = mix(col, vec3(.7,.4,.1)*t, s(circle(cent, vec2(-.5,.5), .95, .06),10.));\n\tcol = mix(col, vec3(.7,.4,.1)*t, s(circle(cent, vec2(.5,-.5), .95, .06),10.));\n    return col;\n}\n\nvec3 pattern3 (vec2 u) {\n    u*=20.;\n    u.x-=u.y/ST;\n    vec3 col = mix(vec3(.8,.9,.8), vec3(.0), texture(iChannel1, u).x*.9);\n    vec2 grid = floor(u);\n    float id = hash21(grid);\n    vec2 cent = u-grid-.5;\n\tcent = r(PI/2. * floor(id * 7.)) * cent;\n    float t = length(texture(iChannel0, u+sin(iTime*.01)).xyz)*1.1;\n\tcol = mix(col, vec3(.6,.5,.0)*t, s(circle(cent, vec2(-.5,.5), .35, .06),30.));\n\tcol = mix(col, vec3(.6,.5,.0)*t, s(circle(cent, vec2(.5,-.5), .35, .06),30.));\n\tcol = mix(col, vec3(.6,.5,.0)*t, s(circle(cent, vec2(-.5,.5), .65, .06),30.));\n\tcol = mix(col, vec3(.6,.5,.0)*t, s(circle(cent, vec2(.5,-.5), .65, .06),30.));\n    col = mix(col, vec3(.6,.5,.0)*t, s(circle(cent, vec2(.5,-.5), .65, .06),30.));\n    return col;\n}\n\n// Standart formula for the distance from a point to a line\nfloat dtl(vec2 p, vec3 l) {return abs(l.x*p.x+l.y*p.y+l.z)/sqrt(l.x*l.x+l.y*l.y);}\n\nvoid mainImage( out vec4 O, in vec2 E )\n{\n    vec2  u = (E - R*.5) / R.y; \n    vec3 col = vec3(.5,.3,.1);\n    \n    // Background color\n    float t = length(texture(iChannel0, u*r(iTime*.01)).xyz)*1.1;\n    \n    // Initial parameters for triangles\n    float a = .1, b = .05;\n    \n    // \"Power\" of inner shadows\n    const float shadow_pow = .01;\n    \n    for (int i=0;i<8;i++) {\n        vec2 u1 = u*r(PI/1.5);\n        vec2 u2 = u1*r(PI/1.5);\n        vec3 cl1 = col;\n        // Shadows outside triangle\n        col = mix(col, cl1*1.2, s( penrose_triangle_segment(u, a, b), 500.));\n        col = mix(col, cl1*1.2, s( penrose_triangle_segment(u1, a, b), 500.));\n        col = mix(col, cl1*1.2, s( penrose_triangle_segment(u2, a, b), 500.));\n        // Shadows inside triangle\n        vec3 sh = (u.y<-a*ST/6.) ?\n            mix(pattern1(u),vec3(.1),shadow_pow/(abs(dtl(u, vec3(-ST,-1.,a*ST/3.)))+shadow_pow)):\n            mix(pattern1(u),vec3(.1),shadow_pow/(abs(dtl(u, vec3(0.,-1.,a*ST/3.+b*3.)))+shadow_pow));\n        col = mix(col, sh, s(penrose_triangle_segment(u, a, b), 1.5));\n        sh = (u1.y<-a*ST/6.) ?\n            mix(pattern2(u1),vec3(.1),shadow_pow/(abs(dtl(u1, vec3(-ST,-1.,a*ST/3.)))+shadow_pow)):\n            mix(pattern2(u1),vec3(.1),shadow_pow/(abs(dtl(u1, vec3(0.,-1.,a*ST/3.+b*3.)))+shadow_pow));\n        col = mix(col, sh, s(penrose_triangle_segment(u1, a, b), 1.5));\n        sh = (u2.y<-a*ST/6.) ?\n            mix(pattern3(u2),vec3(.1),shadow_pow/(abs(dtl(u2, vec3(-ST,-1.,a*ST/3.)))+shadow_pow)):\n            mix(pattern3(u2),vec3(.1),shadow_pow/(abs(dtl(u2, vec3(0.,-1.,a*ST/3.+b*3.)))+shadow_pow));\n        col = mix(col, sh, s(penrose_triangle_segment(u2, a, b), 1.5));\n        col = mix(col, vec3(.9,.45,.0)*t, s(abs(penrose_triangle_segment(u, a, b))-.002, 1.5));\n        col = mix(col, vec3(.9,.45,.0)*t, s(abs(penrose_triangle_segment(u1, a, b))-.002, 1.5));\n        col = mix(col, vec3(.9,.45,.0)*t, s(abs(penrose_triangle_segment(u2, a, b))-.002, 1.5));\n        u*=r(PI/15.);\n        a+=.32;b+=0.02;\n    }\n    O = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}