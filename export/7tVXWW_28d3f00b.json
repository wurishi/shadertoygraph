{"ver":"0.1","info":{"id":"7tVXWW","date":"1640726309","viewed":159,"name":"Arty farty","username":"pieter1627362712","description":"Xsharpen","likes":2,"published":1,"flags":2,"usePreview":0,"tags":["blur","sharpen"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4sf3zn","filepath":"/presets/webcam.png","previewfilepath":"/presets/webcam.png","type":"webcam","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\n\n\nvec4 getPixel(vec2 tex, float dx, float dy)\n{\n\ttex.x += dx;\n\ttex.y += dy;\n\n\treturn texture( iChannel0, tex);\t\n}\n \nvec4 rgb2yuv(vec4 rgb)\n{\n   mat4 coeffs=mat4(\n               0.299,  0.587,  0.114, 0.000,           // first column\n               -0.147, -0.289,  0.436, 0.000,           // second column\n               0.615, -0.515, -0.100, 0.000,           // third column\n               0.000,  0.000,  0.000, 0.000);\n\n\n\treturn  rgb*coeffs;\n}\n\nvec4 yuv2rgb(vec4 yuv)\n{\n\tmat4 coeffs =mat4(\n\t\t1.000,  0.000,  1.140, 0.000,\n\t\t1.000, -0.395, -0.581, 0.000,\n\t\t1.000,  2.032,  0.000, 0.000,\n\t\t0.000,  0.000,  0.000, 0.000\n\t);\n\n\treturn  yuv*coeffs;\n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord/iResolution.xy;      \n    int radius=4;//1.0 .... 5.0\n    int n=64;\n\tfloat strength=1.0;//0.5 .... 8.0\n    \n                 \t\t\t\t\n\tvec4 c0 = texture( iChannel0, uv);\t\n    \n    float dx = 1.0 / iResolution.x;\n\tfloat dy = 1.0 / iResolution.y;\t\n     \n    \n\tvec4 yuv=rgb2yuv(c0);\t\n\tfloat min=999.0;\n\tfloat max=0.0;\t\n\t\n\tfor(int y1=-radius;y1<=radius;y1++)\n\t  for(int x1=-radius;x1<=radius;x1++)\n\t  {\n        int xt=x1*n;\n        int yt=y1*n;\n\t    if (xt*xt+yt*yt<=radius*radius*n*n)\n\t\t{\n\t      vec4 yuv00 = rgb2yuv(getPixel(uv, float(xt)*dx, float(yt)*dy));\n\t\t  if (yuv00[0]>max)\n\t\t     max=yuv00[0];\n\t      if (yuv00[0]<min)\n\t\t     min=yuv00[0];\n\t\t}\n\t  }\n\t\t\t\t\t\t\t\t    \n\t\n \n\t if (abs(max-yuv[0])<abs(min-yuv[0]) )\t\n\t   yuv[0]=(yuv[0]*1.0+max*strength)/(1.0+strength);\n     else\n\t   yuv[0]=(yuv[0]*1.0+min*strength)/(1.0+strength);\n\n\t \t                 \n    fragColor =yuv2rgb(yuv);\n}\n","name":"Image","description":"","type":"image"}]}