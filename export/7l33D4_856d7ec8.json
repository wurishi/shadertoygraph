{"ver":"0.1","info":{"id":"7l33D4","date":"1636123141","viewed":85,"name":"LineWidth Correction","username":"yunhai","description":"I found the unshapely line is because the vertical line width is always a const, \nthe better line I want should be the same wide at Tangential direction.","likes":7,"published":1,"flags":0,"usePreview":0,"tags":["mathdrawmapping"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\n#define map(x) map1(x)\n//#define map(x) map2(x)\n\n//---------------------Lines-------------------\nconst float HLW=.09;//half line width\nconst float MSI=2.;//mesh space interval\nfloat line(vec2 uv,vec2 ori,vec2 dir)\n{\n    vec2 sp=uv-ori;\n    return SL(length(uv-dot(sp,dir)*dir+ori));\n}\n//----------------------------------------------\nvec3 cartesian(vec2 uv)\n{\n    vec3 col=vec3(0.);\n    float msp=MSI;\n    float lhlw=HLW/2.;//local HLW\n    vec3 mesh=vec3(SS(lhlw+2.*PIXW,lhlw-PIXW,abs(uv.x-round(uv.x/msp)*msp)));\n    mesh+=vec3(SS(lhlw+2.*PIXW,lhlw-PIXW,abs(uv.y-round(uv.y/msp)*msp)));\n    col+=mesh*.5;\n    col=mix(col,vec3(0.,1.,0.),line(uv,vec2(0.),vec2(1.,0.)));\n    col=mix(col,vec3(0.,1.,0.),line(uv,vec2(0.),vec2(0.,1.)));\n    return col;\n}\n\n//-------------------experiment-----------------\nfloat map1(float x)\n{\n    return x*x-10.;\n}\nfloat map2(float x)\n{\n    return sin(x);\n}\nfloat costheta(float x)\n{\n    float e=PIXW;\n    float trick=0.;\n//trick=1.;//this is my trick to deal with not-full-screen alias\n    return normalize(vec2((2.+trick)*e,map(x+e)-map(x-e))).x;\n}\nvoid mainImage( out vec4 O, in vec2 C )\n{\n    vec2 uv=(C-.5*iR)*PIXW;\n    float x=uv.x,y=uv.y,t=iTime*.1;\n    O.rgb=cartesian(uv);    \n    \n    float f=map(x);\n    \n    \n    //O.rgb=mix(vec3(1),O.rgb,SS(0.,10.*PIXW,abs(f-y)));\n    \n    float bef=abs(f-y)<20.*PIXW?1.:O.r,//before correct\n          aft=abs(f-y)*costheta(x)<20.*PIXW?1.:O.r;//after correct\n\n    O.r=mix(aft,bef,step(0.,sin(t*PI)));\n    if(abs(x-sin((t-.25)*2.*PI)*4.)/PIXW<1.1&&abs(O.r-1.)<1e-3) O.gb=vec2(1.);\n    \n}","name":"Image","description":"","type":"image"},{"inputs":[],"outputs":[],"code":"#define iR iResolution.xy\n#define iM iMouse\n#define PIXW (50./iR.x)\n#define SS(a,b,t) smoothstep(a,b,t)\n#define SL(d) smoothstep(HLW+PIXW,HLW-PIXW,d)\n\nconst float PI=3.14159265;","name":"Common","description":"","type":"common"}]}