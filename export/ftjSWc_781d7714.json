{"ver":"0.1","info":{"id":"ftjSWc","date":"1628779640","viewed":48,"name":"Noisy Displacement","username":"kithy","description":"displacement sphere surface random.","likes":0,"published":1,"flags":0,"usePreview":0,"tags":["raymarching","displacement","hash"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define ITR 64\n#define EPS 0.001\n#define PI 3.141592\n\nmat2 rot(float angle){\n\tfloat s=sin(angle);\n\tfloat c=cos(angle);\n\treturn mat2(s,c,-c,s);\n}\n\nfloat hash(vec2 p){\n\treturn fract(sin(dot(p,vec2(43.232,75.876)))*4526.3257);\n}\n\nfloat sdSphere(vec3 p){\n\treturn length(p)-clamp(sin(iTime),0.2,1.0);\n}\n\nfloat sdTorus(vec3 p){\n\tvec2 t=vec2(1.0,0.5);\n\tvec2 q=vec2(length(p.xz)-t.x,p.y);\n\treturn length(q)-t.y;\n}\n\nfloat sdPlane(vec3 p){\n\treturn p.y;\n}\n\nfloat displacement(vec3 p){\n\tp*=hash(vec2(p.x,p.y))*5.0;\n\treturn sin(p.x)*sin(p.y)*sin(p.z);\n}\n\nfloat mainDist(vec3 p){\n\tp.xy*=rot(iTime*0.5);\n\tp.yz*=rot(iTime*0.5);\n\tfloat dis=displacement(p);\n\tfloat d1=sdSphere(p);\n\t//float d2=sdPlane(p);\n\tfloat d3=sdTorus(p);\n\t//return d2;\n\treturn d1+dis;\n}\n\n//generate normal of sphere\n// vec3 genNormal(vec3 p){\n// \treturn normalize(p);\n// }\n\nvec3 genNormal(vec3 p){\n\tvec3 normal=vec3(\n\t\tsdSphere(p+vec3(EPS,0.0,0.0))-sdSphere(p+vec3(-EPS,0.0,0.0)),\n\t\tsdSphere(p+vec3(0.0,EPS,0.0))-sdSphere(p+vec3(0.0,-EPS,0.0)),\n\t\tsdSphere(p+vec3(0.0,0.0,EPS))-sdSphere(p+vec3(0.0,0.0,-EPS))\n\t\t);\n\treturn normalize(normal);\n}\n\n\n\nvoid mainImage(out vec4 fragColor,in vec2 fragCoord){\n\tvec2 uv=(2.0*fragCoord.xy-iResolution.xy)/iResolution.y;\n\tvec3 ro=vec3(0.0,0.0,-10.0);\n\tvec3 lookat=vec3(0.0,0.0,0.0);\n\tfloat zoom=5.0;\n\n\tvec3 f=normalize(lookat-ro);\n\tvec3 r=normalize(cross(vec3(0.0,1.0,0.0),f));\n\tvec3 u=cross(f,r);\n\tvec3 c=ro+f*zoom;\n\tvec3 i=c+uv.x*r+uv.y*u;\n\tvec3 rd=normalize(i-ro);\n   \n    float d,t;\n    vec3 p,n;\n\n\tvec3 col=vec3(1.0);\n    \n    for(int i=0;i<ITR;i++){\n        p=ro+rd*t;\n        d=mainDist(p);\n        n=genNormal(p);\n        if(d<EPS)break;\n        t+=d;\n    }\n\tcol=n*0.5+0.5;\n\n\tfragColor=vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}