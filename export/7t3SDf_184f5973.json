{"ver":"0.1","info":{"id":"7t3SDf","date":"1639977359","viewed":1038,"name":"Simplest detailed fluid","username":"davidar","description":"Golfing lomateron's fluid shader down to 30% of the original size, and a single buffer","likes":59,"published":3,"flags":32,"usePreview":0,"tags":["simulation","fluid","convolution","2tweets","golf"],"hasliked":0,"parentid":"sl3Szs","parentname":"simple detailed fluid"},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"M {\n    r = 1.-A().zzzz;\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"M {\n    r *= 0.;\n    for(vec2 i = vec2(-7); ++i.x < 7.;) for(i.y = -7.; ++i.y < 7.;) {\n        vec2 v = A(i).xy;                          // neighbour velocity\n        r += A(i).z                                // neighbour mass\n                * exp(-dot(v+i,v+i)) / 3.14        // normalised Gaussian\n                * vec4(mix(v+v+i, v, A(i).z),1,1); // velocity contribution\n    }\n    r.xy /= r.z + 1e-6;\n    if(iFrame % 500 == 1) {\n        vec2 m = 4.*u/iResolution.xy-2.;\n        r += vec4(m,1,0) * exp(-dot(m,m));\n    }\n}","name":"Buffer A","description":"","type":"buffer"},{"inputs":[],"outputs":[],"code":"#define M void mainImage(out vec4 r, vec2 u)\n#define A(i) texelFetch(iChannel0,ivec2(i+u),0)","name":"Common","description":"","type":"common"}]}