{"ver":"0.1","info":{"id":"wlGBzh","date":"1613849029","viewed":413,"name":"HG vs CS Phase Function.","username":"kenhu","description":"Side-by-side comparison of Henyey-Greenstein phase function and Cornette-Shanks phase function.\nHold left-click to tweak the preferred scattering direction parameter.\nTop: Henyey-Greenstein\nBottom: Cornette-Shanks","likes":3,"published":1,"flags":0,"usePreview":0,"tags":["phasefunction"],"hasliked":0,"parentid":"4ltGWl","parentname":"HG vs Schlick Phase Function"},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// Forked from https://www.shadertoy.com/view/4ltGWl\n// Schlick -> CornetteShanks\n\n// Uncomment to show difference\n// R = (HG - CS) * BOOST, G = (CS - HG) * BOOST\n// #define SHOW_DIFF_WITH_BOOST 20.0\n\n#define M_PI 3.14159265359\n\n// Equations from http://patapom.com/topics/Revision2013/Revision%202013%20-%20Real-time%20Volumetric%20Rendering%20Course%20Notes.pdf\n\nfloat HenyeyGreenstein(float g, float costh)\n{\n    return (1.0 - g * g) / (4.0 * M_PI * pow(1.0 + g * g - 2.0 * g * costh, 3.0/2.0));\n}\n\nfloat CornetteShanks(float g, float costh)\n{\n    return (3.0 * (1.0 - g * g) * (1.0 + costh * costh)) / (4.0 * M_PI * 2.0 * (2.0 + g * g) * pow(1.0 + g * g - 2.0 * g * costh, 3.0/2.0));\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // compute \"g\"/\"k\" from mouse X coordinate\n    float g = iMouse.x * 2.0 / iResolution.x - 1.0;\n    \n    // fake a mouse position to make a better icon for shadertoy\n    if (iMouse.xy == vec2(0.0))\n        g = 0.7;\n    \n    // make position from -1 to 1 in x and y, with (0,0) in the center of the screen.\n    vec2 pos = fragCoord * 2.0 / iResolution.xy - vec2(1.0);\n    \n    // implement the split-screen effect\n    if (fragCoord.y >= iResolution.y / 2.0)\n        pos.y = (pos.y - 0.5) * 2.0;\n    else\n        pos.y = (pos.y + 0.5) * 2.0;\n    \n    // compute cos(theta) used as input to Phase Function\n    // = dot((1,0), pos) / (length((1,0)) * length(pos))\n    // = dot((1,0), pos) / length(pos)\n\tfloat costh = pos.x / length(pos);\n    \n    // compute Phase Function\n    float p;\n    if (fragCoord.y >= iResolution.y / 2.0)\n        p = HenyeyGreenstein(g, costh);\n    else\n        p = CornetteShanks(g, costh);\n    \n    // convert to a color\n    vec4 color = vec4(vec3(p),1.0);\n    \n    // gamma-correct it\n    color.rgb = pow(color.rgb, vec3(1.0/2.2));\n    \n#ifdef SHOW_DIFF_WITH_BOOST\n    if (fragCoord.y >= iResolution.y / 2.0)\n        color.rgb = vec3(\n            HenyeyGreenstein(g, costh) - CornetteShanks(g, costh),\n            CornetteShanks(g, costh) - HenyeyGreenstein(g, costh),\n            0.0) * SHOW_DIFF_WITH_BOOST;\n#endif // SHOW_DIFF_WITH_BOOST\n    \n    // render it        \n    fragColor = color;\n}","name":"Image","description":"","type":"image"}]}