{"ver":"0.1","info":{"id":"MltcWf","date":"1534510976","viewed":105,"name":"ld42_polyarnik_waves","username":"GRaAL","description":"Wave shader for LD42 entry: https://ldjam.com/events/ludum-dare/42/polyarnik","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["ld42"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XsfGRn","filepath":"/media/a/1f7dca9c22f324751f2a5a59c9b181dfe3b5564a04b724c657732d0bf09c99db.jpg","previewfilepath":"/media/ap/1f7dca9c22f324751f2a5a59c9b181dfe3b5564a04b724c657732d0bf09c99db.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"//uncomment if you want to see shader used in LD42 entry\n//#define AS_IN_LD42\n\n//uncomment to see waves only\n//#define WAVES_ONLY\n\n\n#define WAVES 10.\n#define WSCALEY 6.\n#define TIMESCALEY 2.\n#define TIME_SPEED_X -0.01\n#define TIME_SPEED_INC_PER_ROW 0.1\n#define WOFFSET -0.5\n#define WAVE_COUNT 60.\n#define EDGE 0.2\n\n\n\n\nfloat rand(vec2 co){\n    return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\nvec4 getColor() {\n    return vec4(0x62, 0x90, 0xc3, 0xff)/255.;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n    vec2 vTextureCoord = fragCoord.xy/iResolution.xy;\n    float onWave = 0.0;\n    float onGlare = 0.0;\n    for (int i = 0; i < int(WAVES); i++) {\n        float scaleTime = TIMESCALEY*((cos(iTime + vTextureCoord.x*10.) + 1.)/0.5 + 1.);\n        float yInWave = WAVES * (vTextureCoord.y - (float(i)*1.0 / WAVES)) * (WSCALEY + scaleTime);\n        float speedX = mod(iTime * (TIME_SPEED_X), 3.1415) + float(i)*TIME_SPEED_INC_PER_ROW;\n\n        onWave = max(onWave, step(abs(sin((vTextureCoord.x + speedX + WOFFSET*float(i))*WAVE_COUNT) - yInWave), EDGE));\n\n        float inWave = vTextureCoord.y > yInWave && vTextureCoord.y < yInWave + 1.0/WAVES ? 1.0 : 0.0;\n        #ifdef AS_IN_LD42\n        float glare = step(rand(vec2(floor(fragCoord.x/8.+ speedX), vTextureCoord.y+fragCoord.y)), 0.001);\n        #else\n        float glare = step(rand(vec2(floor(fragCoord.x/8.+ speedX), vTextureCoord.y+fragCoord.y/20.)), 0.005);\n        #endif\n        glare = glare * (0.5 + 0.5*step((1. + sin(iTime + vTextureCoord.x + rand(fragCoord.xy)))*0.5, 0.5));\n        onGlare = max(onGlare, glare);\n    }\n    fragColor = getColor();\n    fragColor.rgb *= (0.8 + 0.2*onWave);\n#ifndef WAVES_ONLY   \n    fragColor = clamp(fragColor*(1.0 + onGlare), 0., 1.);\n#endif    \n}\n\n\n","name":"Image","description":"","type":"image"}]}