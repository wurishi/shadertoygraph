{"ver":"0.1","info":{"id":"4tc3zr","date":"1468143275","viewed":119,"name":"[SH16A] Size Coding","username":"SamGondelman","description":"Entry into the 2016 Shadertoy competition, week 1.","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["raymarching","shadertoy","competition","2016","sh16a"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"Xsf3zn","filepath":"/media/a/f735bee5b64ef98879dc618b016ecf7939a5756040c2cde21ccb15e69a6e1cfb.png","previewfilepath":"/media/ap/f735bee5b64ef98879dc618b016ecf7939a5756040c2cde21ccb15e69a6e1cfb.png","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"false","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define n normalize\n#define k floor\n#define s(a,b) length(a)-b\n#define u(a,b) a.x < b.x ? a : b\n#define q mod\n#define l(a) clamp(a, 0., 1.)\n#define e (int i = 0; i < 64; i++)\n\nvec3 o, d, c, w, u, v;\nvec2 y, r;\nfloat t = 0.;\n\n// map\nvec2 m(vec3 p) {\n    r = vec2(p.y, 13);\n    for (float i = 0.; i < 25.; i++) {\n        float y = q(i,2.) == 0. ? .4 : .25;\n        r = u(r, vec2(s(p-vec3(-2 + int(i/5.), y, -2. + q(i,5.)), y), k(i/2.)));\n    }\n    return r;\n}\n\n// render\nvec3 x() {\n    c = vec3(.4);\n    y = vec2(0);\n    for e {\n        vec2 a = m(o + d*y.x);\n        if (a.x < 0.0) break;\n        y.x += a.x;\n        y.y = a.y;\n    }\n\n    w = o + y.x*d;\n    vec2 r = vec2(.001, 0.);\n    u = vec3(\n        m(w+r.xyy).x - m(w-r.xyy).x,\n        m(w+r.yxy).x - m(w-r.yxy).x,\n        m(w+r.yyx).x - m(w-r.yyx).x);\n    u = n(u);\n\n    if(y.y < 13.) c = vec3(1, 0, 0) + y.y*vec3(-.08, .03, .06);\n    else {\n    \tif(q(q(k(w.x), 2.) + q(k(w.z), 2.), 2.) >= 0.5) {\n            c *= 1.25;\n            vec2 u = 25.6*w.xz + vec2(37,17);\n            c *= texture(iChannel0, (k(u) + .5)/256., -100.).y;\n        }\n\n        if(max(abs(w.x), abs(w.z)) < 1.5){\n        \tvec2 q = q(w.xz + .5, 1.) - .5;\n            c *= smoothstep(0., .5, length(q));\n        }\n    }\n\n    o = n(vec3(-.6, .7, -.5));\n    t = .01;\n    for e {\n        r = m(w + o*t);\n        if(r.x < 0.) break;\n        t += r.x;\n    }\n    t = t > 3. ? 1. : 0.;\n    float f = l(dot(n(u), o))*t;\n    c *= f*vec3(1.2,1.02,.66) + .5*l(.5 + .5*u.y)*vec3(.5,.7,1.);\n    c += pow(l(dot(n(reflect(d, u)), o)), 16.)*f;\n\n    return c;\n}\n\nvoid mainImage(out vec4 a, vec2 b) {\n    c = iResolution;\n    r = -1. + 2.*b.xy/c.xy;\n    r.x *= c.x/c.y;\n    o = vec3(0.85, 2, -2.876);\n    w = n(vec3(0, -.2, 0)-o);\n    u = n(cross(w,vec3(0, 1, 0)));\n    v = cross(u,w);\n    d = mat3(u, v, w) * n(vec3(r.xy, 2));\n    a.xyz = sqrt(x());\n}","name":"Image","description":"","type":"image"}]}