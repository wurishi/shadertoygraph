{"ver":"0.1","info":{"id":"DdjBWw","date":"1689789197","viewed":32,"name":"Fork PoseCafé I mkundera 012","username":"mkundera","description":"Use the mouse and have fun :p","likes":0,"published":1,"flags":32,"usePreview":0,"tags":["fluid","waterfall"],"hasliked":0,"parentid":"cdSyRG","parentname":"PoseCafé Incoming"},"renderpass":[{"inputs":[{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\n#define R iResolution.xy\n#define T1(U) texture(iChannel0,U/R)\n\nvoid mainImage( out vec4 C, in vec2 U )\n{   \n\n    float m = 45.*T1(U).w;//masse\n    float v = length(T1(U).xy)/10.;//velocity\n    float p = T1(U).z/10.;//pressure\n    \n\n    \n    float circ_sdf = smoothstep(0.41, 0.4, length((U/R - vec2(0.5))*vec2(R.x / R.y, 1.)));\n    C = m*vec4(1,1.,1.,1)*circ_sdf;\n    \n    vec3 brown = vec3(0.75, 0.45, 0.2);\n    \n    C.xyz += brown*circ_sdf;\n    \n    //if (U.x < 0.2*R.x&&U.y < 0.5*R.y) C = vec4(0.5);\n    //if (U.x < 0.4*R.x&&U.y < 0.3*R.y) C = vec4(0.5);\n    \n}  \n","name":"Image","description":"","type":"image"},{"inputs":[{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"\nvoid mainImage( out vec4 Q, in vec2 U )\n{      \n    R = iResolution.xy; t = iTime; Mouse = iMouse; Frame = iFrame;\n    pass( Q, iChannel0, U );\n    \n}","name":"Buffer A","description":"","type":"buffer"},{"inputs":[],"outputs":[],"code":"// #define dt .01\n// #define g 0.\n#define k 25.\n#define l 15.\n#define s .25\n#define nu 0.5\n#define mu 0.5 \n#define kappa 0.5\n\nvec2 R;\nvec4 Mouse;\nfloat t;\nint Frame;\n\n\n\n#define T(p) texture(ch,(p)/R)\n\nvoid pass( out vec4 Q, in sampler2D ch, in vec2 U )\n{   \n    float radius = length((U/R - vec2(0.5))*vec2(R.x / R.y, 1.));\n    \n    float g = 10.*exp(-t/5.);\n    float dt = clamp(0.3/(2.*t),0.0,0.05);\n    \n    vec4 a = vec4(T(U+vec2(1,0)).xy * 10. - vec2(5.),T(U+vec2(1,0)).zw * 5.);\n    vec4 b = vec4(T(U+vec2(0,1)).xy * 10. - vec2(5.),T(U+vec2(0,1)).zw * 5.);\n    vec4 c = vec4(T(U+vec2(-1,0)).xy * 10. - vec2(5.),T(U+vec2(-1,0)).zw * 5.);\n    vec4 d = vec4(T(U+vec2(0,-1)).xy * 10. - vec2(5.),T(U+vec2(-1,0)).zw * 5.);\n    \n    vec4 e=.25*(a+b+c+d), dx=(a-c), dy=(b-d);\n    \n    vec2 vu = T(U-dt*e.xy*.5).xy*10. - vec2(5.);//advection vector estimate\n    Q = vec4(T(U-dt*vu).xy*10. - vec2(5.), T(U-dt*vu).zw*5.);//advection\n    \n \tvec2 gp = vec2(dx.z,dy.z);//pressure gradient\n    vec2 gw = vec2(dx.w,dy.w);//density gradient\n    float div = (dx.x+dy.y);//divergence\n    vec2 vdv = vec2(Q.x*dx.x+Q.y*dy.x,Q.x*dx.y+Q.y*dy.y); \n    \n    \n    Q.xy -= dt *(k*gp + Q.w*l*gw + Q.w*vec2(0.,g)+ s*vdv*Q.w);//forces\n    Q.z = e.z - 0.025*div;//pressure\n    Q -=  dt * vec4(nu,nu,mu,kappa) * 4.*(Q-e);//diffusion\n    \n    //Boundaries\n    if (t < 0.01) Q = vec4(0,0,1,0);\n    \n    \n    //if (U.x < 1.||U.y < 1.) Q.xy *= 0.;\n    //if (R.x-U.x < 1.||R.y-U.y < 1.) Q.w *= 0.;\n    //if (U.x < 0.2*R.x&&U.y < 0.5*R.y) Q.xy *= 0.;\n    //if (U.x < 0.4*R.x&&U.y < 0.3*R.y) Q.xy *= 0.;\n    \n\n \tif (radius < 0.39)\n        {if (length(U-Mouse.xy) < 3.) \n            {Q.xy= vec2(0.1,0.1); Q.w = 1.0;}\n            };\n    if (0.39 < radius)\n    { \n        if (radius < 0.4){Q.x = max(Q.x - 0.2, 0.); Q.y = max(Q.y - 0.2, 0.);}\n        if (radius > 0.4) {Q.xy = vec2(0.);}\n        }\n    Q.xy = (Q.xy + vec2(5.))/vec2(10.);\n    Q.zw /= 5.;\n    Q = clamp(Q, vec4(0,0,0,0), vec4(1.,1.,1.,1.));\n}\n\n","name":"Common","description":"","type":"common"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"XsXGR8","channel":0}],"code":"\nvoid mainImage( out vec4 Q, in vec2 U )\n{      \n    R = iResolution.xy; t = iTime; Mouse = iMouse; Frame = iFrame;\n    pass( Q, iChannel0, U );\n    \n}","name":"Buffer B","description":"","type":"buffer"}]}