{"ver":"0.1","info":{"id":"ts2yD1","date":"1586601964","viewed":158,"name":"pattern_practice_03","username":"bhuwan0000","description":"improvement to the previous one","likes":5,"published":1,"flags":0,"usePreview":0,"tags":["pattern","rotation","tiles"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4sXGzn","filepath":"/media/a/a6a1cf7a09adfed8c362492c88c30d74fb3d2f4f7ba180ba34b98556660fada1.mp3","previewfilepath":"/media/ap/a6a1cf7a09adfed8c362492c88c30d74fb3d2f4f7ba180ba34b98556660fada1.mp3","type":"music","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define PI 3.14159265358979323846\n#define scale 22.\n\nfloat line(vec2 st, vec2 a, vec2 b, float size)\n{\n    vec2 pa = st-a;\n    vec2 ba = b-a;\n    float d = dot(pa, ba)/dot(ba,ba);\n    d = clamp(d, 0.0, 1.0);\n    return smoothstep(size, size-0.01, length(pa-ba*d));\n}\n\nvec2 rotate2D(vec2 st, float ang, vec2 cen)\n{\n    float cth = cos(radians(ang));\n    float sth = sin(radians(ang));\n    st -= cen;\n    st = mat2(cth, -sth, sth, cth)*st;\n    st += cen;\n    return st;\n}\n\nfloat box(vec2 st, vec2 size)\n{\n    vec2 cent = vec2(1., 1.0);\n    st = rotate2D(st, 45.0, cent);\n   \n    size *= 0.5;\n    st += vec2(-1.0, -1.0);\n    float aa = 0.01;\n    vec2 d = smoothstep(-size, -size+aa, st);\n    d *= smoothstep(size, size-aa, st);\n    return d.x*d.y;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = (fragCoord-0.5*iResolution.xy)/iResolution.y;\n    vec2 uv_pres = uv;\n    float asp = iResolution.x/iResolution.y;\n    vec2 st = uv*scale;\n    uv = (fract(uv*scale)-0.5)*2.0; // each cell goes from -1.0 to 1.0\n    vec2 uvid = floor(st);\n    vec3 col = vec3(0.0);\n\n\t//music\n    float sound = texelFetch(iChannel0, ivec2(0,0), 0).x;\n    float sound1 = sound;\n    sound *= .1;\n    \n    //line 1\n    vec2 pa = vec2(1.0, -1.0);\n    vec2 pb = vec2(1.0, 1.0);\n    float lsi = mix(0.03, 0.08, \n                   \t\t\tpow( (sin(PI*iTime*1.\n                                      +1.0-length(uv_pres)*4.)*0.5+0.5), 2.)\n                   \t\t\t);\n    float line1 = line(abs(uv), pa, pb, lsi);\n    //line2\n    vec2 pa2 = vec2(-1.0, 1.0);\n    vec2 pb2 = vec2(1.0, 1.0);\n    float lsi2 = mix(0.03, 0.08, \n                   \t\t\tpow( (sin(PI*iTime*1.\n                                      +length(uv_pres)*2.)*0.5+0.5), 3.)\n                   \t\t\t);\n    line1 += line(abs(uv), pa2, pb2, lsi2);\n    line1 = clamp(line1, 0.0, 1.0);\n    \n    //box2\n    vec2 si1 = vec2( mix(0.01, 1.5, pow((sin(PI*iTime*2.\n                                             +\n                                            1.0-length(uv_pres)*6.)*0.5+0.5), 4.) ) );\n    float bo1 = box(abs(uv), si1);\n    float bo2 = box(abs(uv), si1-0.15);\n    float box = bo1-bo2;\n    \n    float pattern = box+(clamp(line1-bo1, 0.0, 1.0));\n    \n\n    // Output to screen\n    //pattern *= sound1;\n    vec3 acol = vec3(sound, sound1, 0.5)*(pattern)*sound1*14.;\n    col = (vec3(1.0-pattern)+acol) * vec3(0.1, 0.14, 0.1);\n    col = mix(vec3(col*0.9), col, 1.0-length(uv_pres)*2.);\n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}