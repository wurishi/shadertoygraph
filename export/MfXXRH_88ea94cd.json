{"ver":"0.1","info":{"id":"MfXXRH","date":"1704915987","viewed":89,"name":"Simplest dither","username":"jcarrano","description":"Simplest structured dithering.","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["dithering"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"Xdf3Rn","filepath":"/media/a/e81e818ac76a8983d746784b423178ee9f6cdcdf7f8e8d719341a6fe2d2ab303.webm","previewfilepath":"/media/ap/e81e818ac76a8983d746784b423178ee9f6cdcdf7f8e8d719341a6fe2d2ab303.webm","type":"video","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\n#define WRONG 0\n#define FAKE_DOWNSAMPLE 0\n\nconst int nLevels = 8;\nconst int downsample = 4;\n\nmat4x4 ditherMap = mat4x4(\n    0,  8,  2, 10,\n    12,  4, 14,  6,\n    3, 11,  1,  9,\n    15,  7, 13,  5);\n\nfloat improveImage(float grayLevel)\n{\n    float contrastFixed = (grayLevel - 0.1f)*1.2f;\n    return clamp(contrastFixed, 0.0, 1.0);\n}\n\nfloat ditherGray(float grayLevel, ivec2 coord)\n{\n    float g1 = grayLevel * float(nLevels);\n    float l_low = trunc(g1);\n    float l_hi = ceil(g1);\n    float l_frac = fract(g1);\n    \n    ivec2 coordblock = coord % 4;\n    float subindex = ditherMap[coordblock.x][coordblock.y]/16.0f;\n    \n#if WRONG == 0\n    return ((subindex > l_frac)? l_low: l_hi)/float(nLevels);\n#else\n    return ((subindex > l_frac)? l_hi: l_low)/float(nLevels);\n#endif\n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 fragCoordR = fragCoord/float(downsample);\n#if FAKE_DOWNSAMPLE == 0\n    fragCoordR = trunc(fragCoordR);\n#endif\n\n    vec3 iResolutionR = iResolution/float(downsample);\n    \n    vec4 col = texture(iChannel0, fragCoordR/iResolutionR.xy);\n    float gray = (col.r + col.g + col.b) / 3.0;\n    gray = ditherGray(improveImage(gray), ivec2(fragCoordR));\n\n    // Output to screen/\n    fragColor = vec4(gray, gray, gray, 1.0);\n}","name":"Image","description":"","type":"image"}]}