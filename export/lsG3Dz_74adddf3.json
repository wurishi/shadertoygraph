{"ver":"0.1","info":{"id":"lsG3Dz","date":"1453998049","viewed":215,"name":"Spiraling Metablobs","username":"Emil","description":"Testing smoothstep with distance function","likes":9,"published":1,"flags":0,"usePreview":0,"tags":["raymarching","spiral","metaball"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"float map(vec3 p){\n    float zmodval = 5.0;\n    float xmodval = 11.0;\n    float stepz = p.z;\n    p.z = mod(p.z+zmodval*0.5, zmodval)-zmodval*0.5;\n    p.x = mod(p.x+xmodval*0.5, xmodval)-xmodval*0.5;\n    p.y = mod(p.y+xmodval*0.5, xmodval)-xmodval*0.5;\n    stepz -= p.z;\n    float r = 0.0;// = smoothstep(0.0,1.0,(length(p)));\n    float ma = 0.7+0.2*sin(iTime*0.2);\n    const float maxval = 30.0;\n    float spinval;\n    for(float i = 5.0; i<=maxval; i++){\n        spinval = i*ma+(iTime+stepz)*0.2;\n    \tr += smoothstep(0.0,0.3+i*0.04+0.2*(sin(iTime)),(length(p-(i*0.15)*vec3(sin(spinval),cos(spinval),0.0))));\n    }\n    \n    r -= maxval - 4.5;\n    \n    return r;\n}\n\nfloat trace(vec3 o, vec3 r){\n    float t = 0.0;\n    const int maxSteps = 32;\n    for (int i = 0; i < maxSteps; i++){ \n        vec3 p = o + r * t;\n        float d = map(p);\n        t += d * 0.9;\n        if(d<0.001) break;\n    }\n    return t;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec3 r = normalize(vec3(2.*fragCoord.xy - iResolution.xy, iResolution.y)); \n    \n    vec3 o = vec3(0.0,0.0,-3.0+iTime*0.6);\n    \n    float t = trace(o,r);\n    float fog = 1.0 / (3.0 + t * t * 0.06);\n    vec3 fc = vec3(fog);\n    \n\tfragColor = vec4(fc,1.0)*2.0*vec4(1.2,1.6,1.8,1.0);\n}","name":"Image","description":"","type":"image"}]}