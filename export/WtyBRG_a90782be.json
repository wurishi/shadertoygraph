{"ver":"0.1","info":{"id":"WtyBRG","date":"1614526740","viewed":55,"name":"jellyfish","username":"kithy","description":"hemisphere made from sphere and plane.","likes":0,"published":1,"flags":0,"usePreview":0,"tags":["raymarching","hemisphere"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define MAX_DIST 64\n#define EPS 1e-5\n\nfloat sphere(vec3 p){\n\tfloat r=mix(0.3,0.35,sin(iTime+10.0));\n\treturn length(p)-r;\n}\n\nfloat plane(vec3 p){\n\treturn dot(p,vec3(0.0,1.0,0.0));\n}\n\nvec2 pmod(vec2 p,float n){\n\tfloat np=3.141592*2./n;\n\tfloat r=atan(p.x,p.y)-0.5*np;\n\tr=mod(r,np)-0.5*np;\n\treturn length(p)*vec2(cos(r),sin(r));\n}\n\nfloat sd(vec3 p){\n\t\n\t//p.xy=pmod(p.xy,6.0);\n\tp=mod(p,0.8)-0.4;\n\tfloat s1=sphere(p);\n\tfloat p1=plane(p);\n\treturn max(s1,-p1);\n\t//return min(s1,p1);\n\t//return min(s1,-p1);\n\t//return min(-s1,p1);\n\t//return p1;\n\t//return s1;\n}\n\nvec3 genNormal(vec3 p){\n\treturn normalize(vec3(\n\t\tsd(p+vec3(EPS,0.0,0.0))-sd(p+vec3(-EPS,0.0,0.0)),\n\t\tsd(p+vec3(0.0,EPS,0.0))-sd(p+vec3(0.0,-EPS,0.0)),\n\t\tsd(p+vec3(0.0,0.0,EPS))-sd(p+vec3(0.0,0.0,-EPS))\n\t\t));\n}\n\n\nvoid mainImage(out vec4 fragColor,in vec2 fragCoord){\n\tvec2 p=(2.0*fragCoord.xy-iResolution.xy)/iResolution.y;\n\n\tvec3 ro=vec3(0.0,1.0-iTime*0.3,2.0);\n\tvec3 rd=normalize(vec3(p,1.0));\n\n\tfloat d,t=0.0;\n\tvec3 n,rp;\n\n\tfor(int i=0;i<MAX_DIST;i++){\n\t\trp=ro+rd*t;\n\t\td=sd(rp);\n\t\tif(d<EPS)break;\n\t\tn=genNormal(rp);\n\t\tt+=d;\n\t}\n\n\t//fragColor=vec4(n,1.0);\n\tvec3 col=vec3(exp(-0.4*t));\n\tfragColor=vec4(col,1.0);\n\t\n}","name":"Image","description":"","type":"image"}]}