{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[],"code":"\t\tvec4 permute(vec4 x) {\n\t\t  return mod((34.0 * x + 1.0) * x, 289.0);\n\t\t}\n\t\t\n\t\tvec3 cellular2x2p(vec2 P)\n\t\t{\n\t\t\t\t#define K 0.142857142857 // 1/7\n\t\t\t\t#define K2 0.0714285714285 // K/2\n\t\t\t\t#define jitter 0.8 // jitter 1.0 makes F1 wrong more often\n\t\t\t\t\n\t\t\t\tvec2 Pi = mod(floor(P), 289.0);\n\t\t\t\tvec2 Pf = fract(P);\n\t\t\t\tvec4 Pfx = Pf.x + vec4(-0.5, -1.5, -0.5, -1.5);\n\t\t\t\tvec4 Pfy = Pf.y + vec4(-0.5, -0.5, -1.5, -1.5);\n\t\t\t\tvec4 p = permute(Pi.x + vec4(0.0, 1.0, 0.0, 1.0));\n\t\t\t\tp = permute(p + Pi.y + vec4(0.0, 0.0, 1.0, 1.0));\n\t\t\t\tvec4 ox = mod(p, 7.0)*K+K2;\n\t\t\t\tvec4 oy = mod(floor(p*K),7.0)*K+K2;\n\t\t\t\tvec4 dx = Pfx + jitter*ox;\n\t\t\t\tvec4 dy = Pfy + jitter*oy;\n\t\t\t\tvec4 d = dx * dx + dy * dy; \n\t\t\t\t\n\t\t\t\tvec3 f;\n\n\t\t\t\tvec2 fo=min(d.xy,d.zw);\n\n//\t\t\tThere may be a smarter way to return the smallest coordinate.... \n//      as the if-statement spagetti replaces the two lines below so that we can return the coordinateds as well as the distance\n//\n//\t\t\tvec2 fo=min(d.xy,d.zw);\n//\t\t\tf.z=min(fo.x,fo.y);\n\t\t\t\t\n\t\t\t\tif(fo==d.xy){\n\t\t\t\t\t\tif(fo.x<fo.y){\n\t\t\t\t\t\t\t\t// x\n\t\t\t\t\t\t\t\tf.x=dx.x;\n\t\t\t\t\t\t\t\tf.y=dy.x;\n\t\t\t\t\t\t\t\tf.z=fo.x;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t// y\n\t\t\t\t\t\t\t\tf.x=dx.y;\n\t\t\t\t\t\t\t\tf.y=dy.y;\n\t\t\t\t\t\t\t\tf.z=fo.y;\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t}else if(fo==d.zy){\n\t\t\t\t\t\tif(fo.x<fo.y){\n\t\t\t\t\t\t\t\t// z\n\t\t\t\t\t\t\t\tf.x=dx.z;\n\t\t\t\t\t\t\t\tf.y=dy.z;\n\t\t\t\t\t\t\t\tf.z=fo.x;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t// y\n\t\t\t\t\t\t\t\tf.x=dx.y;\n\t\t\t\t\t\t\t\tf.y=dy.y;\n\t\t\t\t\t\t\t\tf.z=fo.y;\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t}else if(fo==d.xw){\n\t\t\t\t\t\tif(fo.x<fo.y){\n\t\t\t\t\t\t\t\t// x\n\t\t\t\t\t\t\t\tf.x=dx.x;\n\t\t\t\t\t\t\t\tf.y=dy.x;\n\t\t\t\t\t\t\t\tf.z=fo.x;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t// w\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tf.x=dx.w;\n\t\t\t\t\t\t\t\tf.y=dy.w;\n\t\t\t\t\t\t\t\tf.z=fo.y;\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t}else{ \t\t\t\t\t\t\t\t\t//fo==d.zw\n\t\t\t\t\t\tif(fo.x<fo.y){\n\t\t\t\t\t\t\t\t// z\n\t\t\t\t\t\t\t\tf.x=dx.z;\n\t\t\t\t\t\t\t\tf.y=dy.z;\n\t\t\t\t\t\t\t\tf.z=fo.x;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t// w\n\t\t\t\t\t\t\t\tf.x=dx.w;\n\t\t\t\t\t\t\t\tf.y=dy.w;\n\t\t\t\t\t\t\t\tf.z=fo.y;\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t}\t\t\t\t\n\n\t\t\t\treturn f; \n\t\t}\n\n    void mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n\t\t\t\tvec2 uv = fragCoord.xy / iResolution.xy;\n\t\t\t\tuv.x*=(iResolution.x/iResolution.y);\n\t\t\t\t\n\t\t\t\tvec2 inc;\n\t\t\t\t\n\t\t\t\tvec2 scuv=uv*1.5;\n\t\t\t\tscuv.y-=(iTime*0.1);\n\n\t\t\t\t// Moving Bubbles\t\t\t\t\n\t\t\t\tvec3 p=cellular2x2p(scuv*6.0);\n\n\t\t\t\t// Stationary Bubbles\n\t\t\t\tvec3 q=cellular2x2p(uv*3.0);\n\n\t\t\t\t// Glass and Bubble Colors\t\t\t\t\n\t\t\t\tvec3 midcol=vec3(0.91,0.73,0.27);\n\t\t\t\tvec3 bottomcol=vec3(1.0,0.96,0.40);\n\t\t\t\tvec3 white=vec3(1.0,1.0,1.0);\n\t\t\t\tvec3 bubcol=vec3(0.63,0.27,0.09);\n\t\t\t\tvec3 gray=vec3(0.7,0.7,0.7);\n\t\t\t\t\n\t\t\t\t// Moving Bubbles\n\t\t\t\tfloat ring = smoothstep(0.975,0.985,1.0-p.z);\n\t\t\t\tfloat cent = smoothstep(0.98,0.995,1.0-p.z);\n\n\t\t\t\tfloat bubdiv =1.0-clamp(abs(p.y*16.0),0.0,1.0);\n\t\t\t\tfloat bubdivx =clamp(abs(p.x*8.0),0.0,1.0);\n\n\t\t\t\tfloat bubtop,bubbot;\n\t\t\t\tbubtop=clamp(p.y*10.0,0.0,1.0);\n\n\t\t\t\tbubtop=(bubtop*0.8)+((bubdivx*bubdivx)*0.2);\n\t\t\t\tbubbot=(1.0-bubtop)*cent;\n\t\t\t\tbubtop=bubtop*cent;\n\n\t\t\t\tfloat bub=(ring-cent);\n\n\t\t\t\t// Stationary Bubbles\n\t\t\t\tfloat ring2 = smoothstep(0.975,0.985,1.0-q.z);\n\t\t\t\tfloat cent2 = smoothstep(0.98,0.995,1.0-q.z);\n\n\t\t\t\tfloat bubdiv2 =1.0-clamp(abs(q.y*16.0),0.0,1.0);\n\t\t\t\tfloat bubdivx2 =clamp(abs(q.x*8.0),0.0,1.0);\n\n\t\t\t\tfloat bubtop2,bubbot2;\n\t\t\t\tbubtop2=clamp(q.y*10.0,0.0,1.0);\n\n\t\t\t\tbubtop2=(bubtop2*0.8)+((bubdivx2*bubdivx2)*0.2);\n\t\t\t\tbubbot2=(1.0-bubtop2)*cent2;\n\t\t\t\tbubtop2=bubtop2*cent2;\n\n\t\t\t\tfloat bub2=(ring2-cent2);\n\n\t\t\t\t// Attenuation of layers\t\t\t\t\n\t\t\t\tfloat glasstop=smoothstep(0.75,0.55,uv.y);\n\t\t\t\tfloat foambot=smoothstep(0.80,0.82,uv.y);\n\t\t\t\tfloat nobub=1.0-smoothstep(0.85,0.95,uv.y);\n\t\t\t\tfloat nofoam=smoothstep(0.75,0.85,uv.y);\n\t\t\t\tfloat nostat=smoothstep(0.67,0.68,uv.y);\n\t\t\t\t\n\t\t\t\tfloat d;\n\t\t\t\t\n\t\t\t\t// Foam layer bubbles\n\t\t\t\tfloat scaf=1.0+(1.0-((uv.y*4.0)-9.0));\n\t\t\t\tvec3 foamy=cellular2x2p(uv*6.0*scaf);\n\t\t\t\td=smoothstep(0.5,0.8,1.0-foamy.z)-smoothstep(0.5,1.0,1.0-foamy.z);\n\t\t\t\td+=clamp(foamy.y*10.0,0.0,1.0)*smoothstep(0.5,1.0,1.0-foamy.z)*0.3;\n\n\n\t\t\t\tvec3 col=mix(midcol,bottomcol,glasstop);\n\t\t\t\t\n\t\t\t\tbubcol=mix(bubcol,gray,nofoam);\n\t\t\t\tbubcol=mix(white,bubcol,nobub);\n\t\t\t\tbottomcol=mix(bottomcol,white,nofoam);\n\n\t\t\t\tcol=mix(col,white,foambot);\n\n\t\t\t\tcol=mix(col,bubcol,bub);\n\t\t\t\tcol=mix(col,bottomcol,bubbot);\n\t\t\t\tcol=mix(col,bubcol,bubtop*0.5);\n\n\t\t\t\tvec3 foamcol=mix(white,gray,d);\n\t\t\t\tfoamcol=mix(white,foamcol,nobub);\n\n\t\t\t\tcol=mix(col,foamcol,nofoam);\t\t\t\t\t\t\t\n\t\t\t\t\n\t\t\t\tcol=mix(col,bubcol,bub2*nostat);\n\t\t\t\tcol=mix(col,bottomcol,bubbot2*nostat);\n\t\t\t\tcol=mix(col,bubcol,bubtop2*0.5*nostat);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\tfragColor = vec4(col,1.0);\n\n    }\n","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"Xds3RN","date":"1364154941","viewed":2321,"name":"Beer","username":"HeGu","description":"Using a modified stegu simplex vorley I am trying to simulate beer.\n\nI am not quite satisfied with the look so any suggestions are welcome.\n\nI do like the look of the bubbles. But the composition is not quite there yet. Hopefully I will get time to finish","likes":26,"published":1,"flags":0,"usePreview":0,"tags":["2dproceduralworley"],"hasliked":0,"parentid":"","parentname":""}}