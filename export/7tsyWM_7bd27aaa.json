{"ver":"0.1","info":{"id":"7tsyWM","date":"1648132560","viewed":102,"name":"Volume of the 3 Moduli","username":"lwswl","description":"mouse to move","likes":5,"published":1,"flags":0,"usePreview":0,"tags":["volume","modulus","analytic","integral"],"hasliked":0,"parentid":"stlyWM","parentname":"Volume of the Modulus "},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"//#define ortho\n//#define COMPARE\n//#define RAYMARCH\n#define modint(ox,dx,t) ((floor(ox+t*dx)*0.5+mod(ox+dx*t,1.)*mod(ox+dx*t,1.)*0.5)/dx )\nfloat volume(vec3 o,vec3 d, float t1, float t2){\n    vec3 p1=(o+d*t1);vec3 p2=(o+d*t2);\n    float if_=modint(o.x,d.x,t1)-modint(o.x,d.x,t2);\n    if_+=modint(o.y,d.y,t1)-modint(o.y,d.y,t2);\n    if_+=modint(o.z,d.z,t1)-modint(o.z,d.z,t2);\n    float t=t2;\n    float step_size=0.001;\n    float density=0.;\n    while(t<t1){\n        t+=step_size;\n        density+=step_size*( mod((o+d*t).x,1.)+mod((o+d*t).y,1.)+mod((o+d*t).z,1.) );\n    }\n#ifdef COMPARE\n    return if_-density;\n#else\n#ifdef RAYMARCH\n    return density;\n#else\n    return if_;\n#endif\n#endif\n}\n#define rot(d) mat2(cos(d),sin(d),-sin(d),cos(d))\nvoid mainImage( out vec4 col, in vec2 co )\n{\n    col=vec4(0.6,0.4,0.2,1)*0.01;\n    //col=vec4(0,0,0,1);\n    vec2 uv = (co-iResolution.xy*0.5)/iResolution.x;\n#ifndef ortho\n    vec3 d=normalize(vec3(uv,-0.7));\n    vec3 o=vec3(0,0,8);\n#else\n    vec3 d=vec3(0,0,-1);\n    vec3 o=vec3(uv*10.0,8);\n#endif\n    o.xz*=rot(iTime);\n    d.xz*=rot(iTime);\n    o.xz*=rot(-4.*iMouse.x/iResolution.x+0.5);\n    d.xz*=rot(-4.*iMouse.x/iResolution.x+0.5);\n    o.yz*=rot(-4.*iMouse.y/iResolution.y+0.5);\n    d.yz*=rot(-4.*iMouse.y/iResolution.y+0.5);\n    o.xz*=rot(-4.*iMouse.x/iResolution.x+0.5);\n    d.xz*=rot(-4.*iMouse.x/iResolution.x+0.5);\n\n    //box intersection from https://www.shadertoy.com/view/ld23DV\n    vec3 m = 1.0/d;\n    vec3 n = o/d;\n    vec3 k = abs(m)*1.9;\n    vec3 t1 = -n - k;\n    vec3 t2 = -n + k;\n\n    float tN = max( max( t1.x, t1.y ), t1.z );\n    float tF = min( min( t2.x, t2.y ), t2.z );\n    if( tN<tF&&tF>0.0) {\n        float v=volume(o,d,tF,tN);\n        col+=vec4(v)*0.1;\n        col.r=abs(col.r);\n        \n    }\n    col=sqrt(col);\n}","name":"Image","description":"","type":"image"}]}