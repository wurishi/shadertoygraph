{"ver":"0.1","info":{"id":"3sjBz3","date":"1590771490","viewed":339,"name":"prisme","username":"louis_C","description":"a prism making chicken calls","likes":25,"published":1,"flags":40,"usePreview":0,"tags":["raymarchingsound"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\nvec3 ov(vec3 a, vec3 b){return mix(2.*a*b,1.-2.*(1.-a)*(1.-b),step(a,vec3(0.5)));}\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n   \n    vec2 uv = fragCoord/iResolution.xy;\n    vec4 t = texture(iChannel0,uv);\n    vec3 t2=texture(iChannel0,vec2(uv.x,0.5-uv.y)).xyz;\n\n    vec3 t3 = ov(t.xyz,mix(vec3(0.5),t2,t.a));\n    vec3 t4 = smoothstep(vec3(-0.15,-0.02,-0.0),vec3(1.1,1.05,0.9),t3);\n    fragColor = vec4(t4,1.);\n}","name":"Image","description":"","type":"image"},{"inputs":[],"outputs":[{"id":"4dXGR8","channel":0}],"code":"\nfloat rd(vec2 t){return fract(sin(dot(floor(t),vec2(95.236,74.125)))*7845.236);}\nfloat rd(float t){return fract(sin(dot(floor(t),95.236))*7845.236);}\nfloat no(float t){return mix(rd(t),rd(t+1.),smoothstep(0.,1.,fract(t)));}\nfloat it(float t){float r=0.;float amp=0.5;\n  for(int i=0;i<3;i++){r+=rd(t/amp)*amp;amp*=0.5;}\n  return r;}\nfloat no(vec2 t){vec2 e=vec2(1.,0.);float a=rd(t);float b=rd(t+e.xy);\nfloat c=rd(t+e.yx);float d=rd(t+e.xx);vec2 h=smoothstep(0.,1.,fract(t));\n                 return mix(mix(a,b,h.x),mix(c,d,h.x),h.y);}\nfloat it(vec2 t){float r=0.;float amp=0.5;\n  for(int i=0;i<5;i++){r+=no(t/amp)*amp;amp*=0.5;}\n  return r;}\n  float hs (vec2 t){return fract(sin(dot((t),vec2(95.236,74.125)))*7845.236+iTime*6.);}\n  float oct (vec3 p,float s){\n    p = abs(p);\n    return (p.x+p.y+p.z-s)*0.57735027;\n  }\nmat2 rot(float t){float c= cos(t);float s = sin(t);return mat2(c,s,-s,c);}  \nfloat box(vec3 p,vec3 b ){vec3 q = abs(p)-b;\n  return length(max(q,0.))+min(0.,max(q.x,max(q.y,q.z)));}\nfloat cy (vec3 p, float h , float r){\n  vec2 d = abs(vec2(length(p.xy),p.z))-vec2(h,r);\n  return min(max(d.x,d.y),0.)+length(max(d,0.));\n}\nfloat cy2 (vec3 p, float h , float r){\n  vec2 d = abs(vec2(length(p.zy),p.x))-vec2(h,r);\n  return min(max(d.x,d.y),0.)+length(max(d,0.));\n}\nfloat zli = 0.;\nfloat zcy = 0.;\nfloat zco = 0.;\nfloat zlu = 0.;\nfloat lit = 0.;\nfloat pri = 0.;\nfloat lpr = 0.;\nvec3 rep(vec3 p,vec3 c){ return mod(p+c*0.5,c)-c*0.5;}\nfloat map(vec3 p){\n  vec3 pb = p+vec3(0.,0.,1.5);\n  vec3 pr1 = rep(p+vec3(11.,-3.,-0.5),vec3(20.,0.,3.));\n  pr1.xz *=rot(1.2);\n  vec3 pr3 = rep(p+vec3(-0.5,-3.,1.),vec3(3.,0.,20.));\n  pr3.xz *=rot(1.2);\n  vec3 p2 = rep(pb,vec3(0.7,0.,0.));\n  vec3 p3 = rep(pb,vec3(5.5,0.,9.));\n  vec3 p4 = rep(pb+vec3(0.,-0.1,4.5),vec3(0.,0.,9.));\n  vec3 p5 = rep(pb+vec3(2.8,0.,0.),vec3(5.5,0.,0.));\n  vec3 p6 = rep(pb,vec3(0.,0.,0.5));\n  vec3 p7 = rep(p+vec3(10.,0.,0.),vec3(20.,0.,0.));\n  vec3 p8 = rep(p+vec3(12.,0.,0.),vec3(20.,0.,0.));\n  vec3 p10 = rep(p,vec3(0.,0.,20.));\n  vec3 p11 = rep(p+vec3(0.,0.,2.),vec3(0.,0.,20.));\n  vec3 p9 = rep(p+vec3(1.,0.,0.),vec3(0.,0.,0.));\n  float b1 = box(p2,vec3(0.18,0.2,100.));\n  float b2 = box(p3,vec3(1.8,0.3,3.2));\n  float b3 = box(p3,vec3(2.,0.15,3.5));\n  float b4 = box(p3,vec3(1.8,0.3,3.3));\n  float b5 = box(p4, vec3(100.,0.3,0.2));\n  float b6 = box(p5,vec3(0.2,0.5,100.));\n  float b7 = box(p6,vec3(100.,3.,0.2));\n  float c1 = cy(p7+vec3(0.,-1.,0.),0.15,100.);\n  float c2 = cy(p7+vec3(0.,-3.,0.),0.15,100.);\n  float c3 = cy(p8+vec3(0.,-1.,0.),0.15,100.);\n  float c4 = cy(p8+vec3(0.,-3.,0.),0.15,100.);\n  float c5 = cy(pr1,0.1,1.);\n  float c7 = cy(pr1+vec3(0.,2.,0.),0.1,1.);\n  float c9 = cy2(p10+vec3(0.,-1.,0.),0.15,100.);\n  float c10 = cy2(p10+vec3(0.,-3.,0.),0.15,100.);\n  float c11 = cy2(p11+vec3(0.,-1.,0.),0.15,100.);\n  float c12 = cy2(p11+vec3(0.,-3.,0.),0.15,100.);\n  float c13 = cy2(pr3,0.1,1.);\n  float c15 = cy2(pr3+vec3(0.,2.,0.),0.1,1.);\n  float cve = min(min(c5,c7),min(min(c3,c4),min(c1,c2)));\n  float cla = min(min(min(c9,c10),min(c11,c12)),min(c13,c15));\n  float cyf = min(cla,cve);\n  float bf = min(min(max(b1,b2),max(-b4,b3)),b5);\n  float s1 = dot(p,vec3(0.,1.,0.));\n  float s2 = max(-max(b3,b7),max(-b6,s1));\n  float m1 = dot(p,vec3(1.,0.,0.))+45.;\n  float m2 = dot(p,vec3(-1.,0.,0.))+45.;\n  float m3 = dot(p,vec3(0.,0.,-1))+80.;\n  float m4 = dot(p,vec3(0.,0.,1.))+80.;\n  float b = dot(p,vec3(0.,-1.,0.))+30.;\n  vec3 pac = rep(abs(p)+vec3(-45.,0.,1.),vec3(0.,0.,20.));\n  float ac = box(pac,vec3(2.5,40.,1.5));\n  float cr = box(p+vec3(0.,-25.,0.),vec3(47.5,5.,85.));\n  float mf = min(min(m2,m1),min(m3,m4));\n  float md = min(max(-cr,mf),ac);\n  float bco1 = min(md,b);\n  float f1 = min(bf,s2);\n  vec3 ppi1 = rep(abs(p)+vec3(-19.,0.,0.),vec3(0.,0.,25.));\n  float pi1 = box(ppi1, vec3 (1.2,40.,1.4));\n  float pi2 = box(abs(p)+vec3(-19.,0.,0.),vec3(2.,1.,100.));\n  vec3 ppi3 = rep(p+vec3(0.,0.,0.),vec3(0.,0.,25.));\n  float pi3 = box(ppi3,vec3(100.,1.,2.));\n  float pif = min(min(pi1,pi2),pi3);\n  vec3 pli = rep(p+vec3(0.,-2.,10.),vec3(28.,0.,20.));\n  float li = box(pli,vec3(2.7,0.2,6.));\n  float bco2 = min(bco1,pif);\n  float rl = min(f1,li);\n  float ffo = max(dot(p,vec3(0.,-1.,0.))+25.2,oct(p*vec3(1.,0.7,1.)+vec3(0.,-17.7,0.),3.2));\n   zli = li;\n   zcy = 0.;\n   zco = 0.;\n   zlu = 0.;\n   pri = 0.;\n   lpr += 0.05/(0.05+ffo);  \n    lit += 0.05/(0.05+li); \n   if(rl<bco2){zco=1.;}\n  float f2 = min(rl,bco2);\n    if(f2<cyf){zcy=1.;}\n  if(min(min(f1,bco2),cyf)>li){zlu=1.;}\n    if(min(f2,cyf)<ffo){pri=1.;}\n  return min(ffo,min(f2,cyf));}\nfloat ov(float a, float b){return mix(2.*a*b,1.-2.*(1.-a)*(1.-b),step(a,0.5));}\nvec3 ov(vec3 a, vec3 b){return mix(2.*a*b,1.-2.*(1.-a)*(1.-b),step(a,vec3(0.5)));}\nvec3 nor (vec3 p){vec2 e = vec2(0.001,0.); return normalize(map(p)-vec3(map(p-e.xyy),map(p-e.yxy),map(p-e.yyx)));}\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    float time = iTime;\n    vec2 uv = (fragCoord/iResolution.xy-0.5)*2.;\n    uv.x*=iResolution.x/iResolution.y;\n    float bat2 = step(no(time*0.2),fract(time*2.));\n    float t= time*0.1;\n  vec3 e = vec3(0.,-28.,-7.);\n  vec3 r = normalize(vec3(uv,1.5));\n  float t2 = 3.1428;\n  e.xy *= rot(t2);\n  r.xy *= rot(t2);\n  e.xz*=rot(t);\n  r.xz *=rot(t);\n  \n  vec3 p = e;\n  float dd = 0.;\n  vec3 col = vec3(0.);\n  float ref = 1.;\n  vec3 n = vec3(0.);\n  for(int i=0;i<64;i++){\n    float d = map(p);\n    if(d<0.01){\n\n      break;\n      }\n    p+=r*d;\n    dd+=d;\n  }\n  float bat = step(0.5,fract(time*2.))*smoothstep(-0.7,0.7,sin(time*0.1));\n  float b1 = pow(fract(time*4.),1.)*bat;\n  \n  float b2 = mix(fract(time*40.)*no(time*0.2)*fract(time*0.01)*10.,\n  (smoothstep(-0.5,0.5,sin(time*4.))-no(time*50.))*(1.-bat)*fract(time),\n  bat2);\n                 \n   n = nor(p);\n  float zt = zcy;\n  float zt2 = zco;\n  float zt3 = zlu;\n  float zt4 =pri;\n  float zt5 = lit;\n  float zt6 = lpr;\n  float tile = 20.;\n  vec2 en = vec2(0.,0.1);\n  float c = 0.;\n  float bal =1.-(zt2*zt*(1.-zt3));\n  float spec =dot(n,-r);\n  c += pow(spec,mix(60.,mix(0.1,3.5,zt2),zt))*pow(b1,2.);\n  c *=max(mix(0.02,mix(0.09,0.12,smoothstep(25.,10.,p.y)),smoothstep(30.,29.5,p.y)),zco);\n  float bao = map(p+n);\n  float ao = mix(smoothstep(-7.,3., map(p+n*3.)),smoothstep(0.,1.,bao),zt2);\n float lig =  (smoothstep(18.,0.,zli)*0.1+smoothstep(10.,0.,zli)*0.2+smoothstep(5.,0.,zli)*0.4)*zt*max(0.2,(1.-zt2));\n  \n  c +=lig*b1;\n  //c += tex*0.05;\n  c *=ao;\n  col += c;\n  //col +=zt3;\n  col += zt5*0.15*step(0.5,b1);\n  float cbb = clamp(mix(zt6*0.1,smoothstep(-1.,1.,map(p+r)),1.-zt4),0.,1.);\n  vec3 copr = mix(vec3(cbb),3.*abs(1.-2.*fract(cbb*0.7+0.3+vec3(0.,-1./3.,1./3.)))-1.,cbb*0.2)*2.;\n  col *=zt4;\n  col +=copr*b2 ;\n  col += pow(spec,60.)*0.1*(1.-zt4);\n    vec3 col2 = ov(clamp(col,0.,1.),mix(vec3(0.5),vec3(hs(uv),hs(uv+162.236),hs(uv+487.236)),0.1));\n     float u = fragCoord.y/iResolution.y;\n    float ls = smoothstep(0.3,0.7,it(p.xz*0.4));\n    float bb =smoothstep(0.5,-0.5,u);\n    float bb2 =smoothstep(0.4,0.,u);\n    float m = clamp(ov(mix(mix(0.5,0.9,ls),mix(0.25,0.5,ls),bb2),bb),0.,1.);\n    fragColor = vec4(col2,m);\n}","name":"Buffer A","description":"","type":"buffer"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"XsXGR8","channel":0}],"code":"vec4 bl(vec2 uv){\n vec2 r  = iResolution.xy;\n    vec2 f = uv*r;\n    vec4 col = vec4(0.);\n    float bound = sqrt(64.);\n    float fac = mix(100.,mix(0.,2.,2.*distance(uv.y,0.3)),smoothstep(-1.,0.5,distance(uv.y,0.5)))*0.001;\n        for(float i = -.5*bound; i<=.5*bound; i++)\n        for(float j=-.5*bound; j<=.5*bound; j++)\n        {\n            col += texture(iChannel0,uv+vec2(i,j)*fac/max(bound, 1.));\n        }    col /= 64.;\nreturn col;\n}\nfloat ov(float a, float b){return mix(2.*a*b,1.-2.*(1.-a)*(1.-b),step(a,0.5));}\nvec3 ov(vec3 a, vec3 b){return mix(2.*a*b,1.-2.*(1.-a)*(1.-b),step(a,vec3(0.5)));}\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord/iResolution.xy;\n    fragColor = bl(uv);\n}","name":"Buffer B","description":"","type":"buffer"},{"inputs":[],"outputs":[],"code":"\nfloat rd(float t){return fract(sin(dot(floor(t),95.236))*7845.236);}\nfloat no(float t){return mix(rd(t),rd(t+1.),smoothstep(0.,1.,fract(t)));}\nvec2 mainSound( in int samp, float time )\n{\n\n   float ki = sin(\n       pow(fract(time*5.)+no(time*100.)*0.01,mix(0.001,1.,smoothstep(-0.5,0.5,sin(time*4.))))\n                 *(1000.+fract(time)*500.+no(time*50.)*5.))*2.;\nfloat bat = step(0.5,fract(time*2.))*smoothstep(-0.7,0.7,sin(time*0.1));\nfloat po1 = sin(pow(fract(time*4.),0.1)*800.)*(2.+fract(time)*2.);\nfloat pok = mix(ki,po1,bat);\n    float ba1 = step(0.5,fract(fract(time*0.01)*100.*fract(time)*10.));\n    vec2 tt = sin(time*1000.)*vec2(ba1,1.-ba1);\n    float bat2 = step(no(time*0.2),fract(time*2.));\n    vec2 ft = mix(tt,vec2(pok),bat2);\n    vec2 inif =ft*clamp(time*0.3,0.,1.);\n    \n    return vec2(inif*0.5);\n}","name":"Sound","description":"","type":"sound"}]}