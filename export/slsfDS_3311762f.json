{"ver":"0.1","info":{"id":"slsfDS","date":"1651424209","viewed":166,"name":"30 Minutes 4/13","username":"scry","description":"30 Second timelapse\nhttps://youtube.com/shorts/KzedtTjWeYM","likes":10,"published":1,"flags":0,"usePreview":0,"tags":["3d","reflective"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define time iTime*0.1\n#define pi 3.14159265\n#define deg pi/180.\n\nmat2 r2d(float a) {\n    return mat2(cos(a),sin(a),-sin(a),cos(a));\n}\n\nfloat sdBox(vec3 p, vec3 s) {\n    return max(abs(p.z)-s.z,max(abs(p.y)-s.y,abs(p.x)-s.x));\n}\n\nvec4 map(vec3 p) {\n    vec3 o = p;\n    p.z -= 1.;\n    p.xz *= r2d(time);\n    float d = length(p)-0.1;\n    p.yz *= r2d(-time*0.5);\n    d = min(d,abs(sdBox(p,vec3(.2)))-0.002);\n    d = max(d, -o.z+0.8125);\n    d = min(d,length(p)-0.13);\n    p.yz *= r2d(time);\n    d = min(d,abs(sdBox(p,vec3(1.)))-0.01);\n    d = max(d,-(length(o)-0.5));\n    d = min(d,abs(sdBox(p,vec3(2.5)))-0.01);\n    return vec4(p,d);\n}\n\nvec2 RM(vec3 ro, vec3 rd) {\n    float dO = 0.;\n    float ii = 0.;\n    for (int i=0;i<60;i++) {\n        vec3 p = ro+rd*dO;\n        float dS = map(p).w;\n        dO += dS;\n        ii += 0.01;\n        if (dO > 100. || dS < 0.0001) {break;}\n    }\n    return vec2(dO,ii);\n}\n\nvec3 colo(vec3 p, vec3 n, vec2 d) {\n    vec3 col = d.xxx*0.4;\n    col *= sin(vec3(0.3,0.35,0.1)+d.x*4.)*0.5+0.5;\n    //col *= sin(vec3(0.3,0.35,0.1)+d.x*40.)*0.5+0.5;\n    //col *= sin(vec3(0.3,0.35,0.1)+d.x*140.+time*40.)*0.5+0.5;\n    //col *= vec3(0.9*d.y,0.5-d.y*0.5,0.2+d.y*0.3);\n    col *= 2.-p.z*0.7-d.y;\n    col += n*0.03;\n    col *= 0.5;\n    //col += n.z*0.2;\n    return col;\n}\n\nvec3 calcNorm(vec3 p) {\n    vec2 h = vec2(0.001,0.);\n    return normalize(vec3(\n            map(p-h.xyy).w-map(p+h.xyy).w,\n            map(p-h.yxy).w-map(p+h.yxy).w,\n            map(p-h.yyx).w-map(p+h.yyx).w\n    ));\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord)\n{\n    vec2 uv = fragCoord.xy / iResolution.xy;\n    vec2 R = iResolution.xy;\n    float ar = R.x/R.y;\n    uv -= 0.5;\n    uv.x *= ar;\n    vec3 col = vec3(uv,0.);\n    vec3 ro = vec3(0.);\n    vec3 rd = normalize(vec3(uv,1.4));\n    vec2 d = RM(ro,rd);\n    vec3 p = ro+rd*d.x;\n    vec3 n = calcNorm(p);\n    col *= 0.;\n    col += colo(p,n,d);\n    float rl = 1.;\n    vec2 od = d;\n    vec3 op = p;\n    vec3 on = n;\n    for (int i=0;i<7;i++){\n        ro = p-n*0.003;\n        //rd = refract(rd,n,-0.2);\n        rd = reflect(rd,n);\n        d = RM(ro,rd);\n        p = ro+rd*d.x;\n        n = calcNorm(p);\n        col += colo(p,n,d)*rl;\n        //col += sin(col*1.2d.x*0.01)*0.5+0.5;\n        //col *= vec3(0.9*d.y,0.5-d.y*0.5,0.2+d.y*0.3);\n        rl *= 0.7;\n    }\n    \n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}