{"ver":"0.1","info":{"id":"tl33WN","date":"1576355518","viewed":587,"name":"scribbles video","username":"FabriceNeyret2","description":"Number of pens = res.x\nscribbles speed = brightness ( here, of red channel ).","likes":16,"published":3,"flags":32,"usePreview":0,"tags":["doodles","scribbles","graffitis"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// --- display\n\nvoid mainImage( out vec4 O, vec2 U )\n{\n    O = sqrt( texture(iChannel0, U/iResolution.xy) );  // to sRGB\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"XdfGRr","filepath":"/media/a/35c87bcb8d7af24c54d41122dadb619dd920646a0bd0e477e7bdc6d12876df17.webm","previewfilepath":"/media/ap/35c87bcb8d7af24c54d41122dadb619dd920646a0bd0e477e7bdc6d12876df17.webm","type":"video","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"// --- source\n\nvoid mainImage( out vec4 O, vec2 U )\n{\n    O = texture(iChannel0, U/iResolution.xy); O*=O;  // texture in flat RGB\n    O.a = length(O.rgb)/sqrt(3.);                    // brightness\n}","name":"Buffer A","description":"","type":"buffer"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"XsXGR8","channel":0}],"code":"// --- draw\n\n// --- antialiased line drawing ------ // https://www.shadertoy.com/view/llySRh\n#define S(d) smoothstep( .8/R.y, 0., d )                  // antialiased draw\n// segment with disc ends: seamless distance to segment\nfloat line(vec2 p, vec2 a,vec2 b) { \n    p -= a, b -= a;\n    float h = clamp(dot(p, b) / dot(b, b), 0., 1.);       // proj coord on line\n    p -=  b * h;\n    return dot(p,p);                                      // distÂ² to segment\n}\n\n\nvoid mainImage( out vec4 O, vec2 U )\n{\n    vec2 R = iResolution.xy;\n   \n    if (texture(iChannel0, .5/R).w != R.x ) {             // 1st frame or resize\n        if(U.y==.5) {                                     // init particles\n            float i = U.x/sqrt(R.x);\n            O.x = fract(i), O.y = i/sqrt(R.x), O.z = 1.;  // x,y, v\n            O.w = R.x;\n        }\n        return;    \n    }\n        \n                                                          // scribble motion\n#define V(V,x) cos( v*6.28* sign(mod(x,2.)-1.) * iTime + x + vec2(0,11)) *2.*v*V/R.y + cos(x+vec2(0,11))/R.y\n    float v= 3.;\n    \n    O = texture(iChannel0, U/R);\n    if(U.y==.5) {                                         // move paticles\n        O.xy = fract( O.xy + V(O.z,U.x) );                // speed prop to image value\n        O.z  = texture(iChannel1, O.xy).r;\n        return;\n    }\n    \n    float d = 1e5;\n    for (float i = .5; i < R.x; i++) {                    // draw particles trajectory\n        vec4 T = texture(iChannel0, vec2(i,.5)/R);\n        d = min(d, line( U/R, T.xy,  T.xy +  V(T.z,i) ) );\n   }\n    \n   O = .97*O + S(sqrt(d)) *texture(iChannel1,U/R);        // blend and fade\n}","name":"Buffer B","description":"","type":"buffer"}]}