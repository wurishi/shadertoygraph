{"ver":"0.1","info":{"id":"DsyBWR","date":"1698094010","viewed":46,"name":"A Square within a Square","username":"sylvain69780","description":"A square within a square","likes":0,"published":1,"flags":0,"usePreview":0,"tags":["square","formula","trigonometry"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"/*\n\n    We are looking for the size x of the inner box A rotated of angle an inside the box B of size L.\n    The outer square triangles have sides a = |x*sin(an)| and b = |x*cos(an)|\n    a + b = L\n    so x = L / (|sin(an)|+|cos(an)|)\n\n*/\n\nmat2 rot(float a) { float s = sin(a), c = cos(a); return mat2(c,s,-s,c);}\n\nfloat sdBox( in vec2 p, in vec2 b )\n{\n    vec2 d = abs(p)-b;\n    return length(max(d,0.0)) + min(max(d.x,d.y),0.0);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    const float boxSize = .8;\n    float t = iTime*5.;\n    vec2 uv = (2.0*fragCoord-iResolution.xy)/iResolution.y;\n    float sf = 1.5/iResolution.y; // smoothing factor\n    float cd = length(uv);\n    float an = (t-sin(t))/12.;\n    float innerboxSize = boxSize/(abs(sin(an))+abs(cos(an)));\n    float d = sdBox(uv,vec2(boxSize));\n    vec2 p = abs(uv*rot(an)); \n    float d2 = sdBox(p,vec2(innerboxSize));\n    float d3 = length(p-vec2(innerboxSize))-0.025;\n    vec3 col = .1*vec3(2,3,9);\n    col += .8*smoothstep(sf,-sf,abs(d)-0.005);\n    col += smoothstep(sf,-sf,abs(d2)-0.005);\n    col += smoothstep(sf,-sf,abs(d3)-0.005);\n    col *= cos(cd*.8);\n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}