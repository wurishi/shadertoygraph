{"ver":"0.1","info":{"id":"ll23WR","date":"1428264761","viewed":504,"name":"Troubled sky","username":"andregc","description":"Experiment with 2d sky ","likes":12,"published":1,"flags":0,"usePreview":0,"tags":["2dnoise","sky","lightning"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[],"code":"float rand(vec2 n) { \n\treturn fract(sin(dot(n, vec2(12.9898, 4.1414))) * 43758.5453);\n}\n\nfloat noise(vec2 n) {\n\tconst vec2 d = vec2(0.0, 1.0);\n\tvec2 b = floor(n), f = smoothstep(vec2(0.0), vec2(1.0), fract(n));\n\treturn mix(mix(rand(b), rand(b + d.yx), f.x), mix(rand(b + d.xy), rand(b + d.yy), f.x), f.y);\n}\n\nfloat ltTime = 0.;\nfloat fbm(vec2 n, vec2 center) {\n    vec2 dist = n - center;\n    float r = length(dist);\n    n *= 1.4;\n\n\tfloat total = 0.0, amplitude = 1.0;\n    float intencity = (2. - r) * noise(vec2(r*1. + iTime*0.8,n.x));\n    intencity = intencity * exp(-(ltTime-0.5)*(ltTime-0.5)*20.)*2.;//*noise(vec2(2.*iTime));\n    if (intencity < 0.) {\n        intencity = 0.;\n    }\n    \n\tfor (int i = 0; i <4; i++) {\n\t\t//total += noise(n + vec2(0., (amplitude)*iTime*0.8)) * amplitude;\n        float v = noise(n ) * amplitude;\n        v *= (1. + intencity * float(3-i)*1.);\n        total += v;\n        \n        \n        \n\t\tn += n;\n        //n.y += (amplitude)*iTime*0.8;\n        n.y += iTime*float(i+1)*0.2;\n\t\tamplitude *= 0.5;\n\t}\n\treturn total;\n}\n\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 uv = fragCoord.xy / iResolution.xy-vec2(0.5, 0.);\n\n    \n    \n    vec3 r=vec3(uv.x, uv.y, 1);\n    r *= 2./ uv.y;\n    //r.xz = uv;\n    \n    float fog = exp(-(r.z-3.)*0.2);\n    if (fog > 1.) {\n        fog = 1.;\n    }\n    vec4 fogColor = vec4(0.5, 0.8, 1.0, 1.);\n    \n    vec2 per = vec2(0.1, 0.12121);\n    vec2 rnd = per*iTime;\n    vec2 s1 = fract(rnd)/per;\n    vec2 s2 = (1.-fract(rnd))/per;\n    rnd = floor(rnd);\n    \n    float t1 = min(s1.x, s1.y);\n    float t2 = min(s2.x, s2.y);\n    ltTime = t1/(t1+t2);\n   \n    \n\n    float c = fbm(r.xz, vec2(rand(rnd), 3.+rand(rnd*1.21)*5.))/2.;\n    vec4 res = mix(vec4(0.8,0.8,1,0), vec4(0,0,1,0), c);\n  \n\n     res = mix(c*vec4(0.8,0.8,1,0), fogColor*0.3, 1.-fog)*0.8;\n    \n    \n\tfragColor = vec4(res);\n}","name":"","description":"","type":"image"}]}