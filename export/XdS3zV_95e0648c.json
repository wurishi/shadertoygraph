{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[],"code":"const float PI = 3.14159265359;\n\n\nvec4 quaternion(vec3 axis, float theta)\n{\n\treturn vec4(axis*sin(theta/2.0),cos(theta/2.0));\n}\n\nvec3 qtransform(vec4 q, vec3 v)\n{\n\treturn v+2.0*cross(cross(v,q.xyz)-q.w*v,q.xyz);\n}\n\nfloat shape2d(vec2 p)\n{\n\tfloat r = length(p.xy);\n\tfloat a = atan(p.y, p.x);\n\treturn 0.5*(r-(abs(mod(5.0*a/PI,2.0)-1.0)+0.8));\n    //return 0.3*(r-1.0+0.5*sin(5.0*a));\n\t//return 0.3*(sin(4.0*p.x)-p.y);\n\t//return 0.3*(r-1.0+0.5*sin(4.0*a+r*r));\n\t//return 0.3*(1.0+1.0*cos(a)-1.0*r);\n\t//return 0.5*(pow(p.x,2.0/3.0)+pow(p.y,2.0/3.0)-1.0);\n\t//return 0.5*(abs(p.x)+abs(p.y)-1.0);\n\t//return 0.5*(r-1.0);\n}\t\n\n\nfloat scene(vec3 p)\n{\n\tvec2 d = vec2(shape2d(p.xy), p.z*0.2);\n\treturn length(d)-0.05;\n}\n\nvec3 calcNormal(vec3 p)\n{\n\tvec3 eps = vec3(0.0001,0.0,0.0);\n\tvec3 nor = vec3(\n\t\tscene(p+eps.xyy)-scene(p-eps.xyy),\n\t\tscene(p+eps.yxy)-scene(p-eps.yxy),\n\t\tscene(p+eps.yyx)-scene(p-eps.yyx));\n\treturn normalize(nor);    \n}\n\nvec3 render(vec3 ro, vec3 rd)\n{\n\tvec3 col = vec3(1.0, 0.8, 0.2);\n\tfloat t = 0.0, d;\n\tvec3 pos = ro;\n\tfor(int i=0; i<64; ++i)\n\t{\n\t\td = scene(pos);\n\t\tt += d;\n\t\tpos = ro+t*rd;\n\t}\n\tif(abs(d) < 0.001)\n\t{\n\t\tvec3 nor = calcNormal(pos);\n\t\tfloat c = dot(normalize(vec3(1.0)),nor);\n\t\treturn c*col;\n\t}else{\n\t\treturn vec3(0.0, 0.1, 0.2);\n\t}\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 p = (fragCoord.xy*2.0-iResolution.xy)/iResolution.y;\n\tvec3 rd = normalize(vec3(p, -1.8));\n\tvec3 ro = vec3(0.0, 0.0, 4.0);\n\tvec4 q = quaternion(normalize(vec3(1.0)), iTime);\n\trd = qtransform(q, rd);\n\tro = qtransform(q, ro);\n    fragColor=vec4(render(ro, rd), 1.0);\n}","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"XdS3zV","date":"1390718018","viewed":288,"name":"Flower Form","username":"gaz","description":"transform from the torus","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["3d"],"hasliked":0,"parentid":"","parentname":""}}