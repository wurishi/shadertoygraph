{"ver":"0.1","info":{"id":"MtdSR4","date":"1478498052","viewed":414,"name":"2D wave sandbox","username":"rory618","description":"Drag the mouse to draw a solid wall. W to reset boundary and r to reset waves.","likes":19,"published":1,"flags":48,"usePreview":0,"tags":["procedural","2d","wave","multipass"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XdXGzn","filepath":"/media/a/3083c722c0c738cad0f468383167a0d246f91af2bfa373e9c5c094fb8c8413e0.png","previewfilepath":"/media/ap/3083c722c0c738cad0f468383167a0d246f91af2bfa373e9c5c094fb8c8413e0.png","type":"texture","channel":2,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 uv = fragCoord.xy / iResolution.xy;\n    vec4 t = texture(iChannel0, uv);\n\tfragColor = texture(iChannel2,t.yx*vec2(.04,.004) )+texture(iChannel1, uv);\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGRr","filepath":"/presets/tex00.jpg","previewfilepath":"/presets/tex00.jpg","type":"keyboard","channel":3,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"\nconst float KEY_W  = 87.5/256.0;\nconst float KEY_R  = 82.5/256.0;\n\nbool keyIsDown( float key ) {\n    return texture( iChannel3, vec2(key,0.25) ).x > .5;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n        \n    vec2 l = texture(iChannel0, (fragCoord-vec2(1.,0))/iResolution.xy).xy;\n    vec2 r = texture(iChannel0, (fragCoord+vec2(1.,0))/iResolution.xy).xy;\n    vec2 u = texture(iChannel0, (fragCoord-vec2(0,1.))/iResolution.xy).xy;\n    vec2 d = texture(iChannel0, (fragCoord+vec2(0,1.))/iResolution.xy).xy;\n    \n    vec2 t = texture(iChannel0, fragCoord/iResolution.xy).xy;\n        \n    t = mix(t,(l+r+u+d)/4.,.01);\n        \n\tfloat DL = l.x-t.x;\n\tfloat DR = r.x-t.x;\n\tfloat DU = u.x-t.x;\n\tfloat DD = d.x-t.x;\n    t.y += (DL+DR+DU+DD)/4.;\n    t.x += t.y;\n    \n    float f = 4.;\n    t = mix(t, vec2(sin(iTime*f), cos(iTime*f)), .5*exp(-.2*length(fragCoord-iResolution.xy/2.)));\n    \n    if(fragCoord.x<1. || fragCoord.y<1. || fragCoord.x>iResolution.x-1. || fragCoord.y>iResolution.y-1.){\n        t*=0.;\n    }\n    float v = min(min(fragCoord.x,fragCoord.y),min(iResolution.x-fragCoord.x,iResolution.y-fragCoord.y));\n    if(10.-v>0.){\n        t *= v/10.*.1+.9;\n    }\n    \n    if ( keyIsDown(KEY_R)) {\n        t *= 0.;\n    }\n    \n    t*=1.-.05*texture(iChannel1, fragCoord/iResolution.xy).x;\n    \n    fragColor = vec4(t.x,t.y,0,1);\n}","name":"Buf A","description":"","type":"buffer"},{"inputs":[{"id":"4dXGRr","filepath":"/presets/tex00.jpg","previewfilepath":"/presets/tex00.jpg","type":"keyboard","channel":3,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"XsXGR8","channel":0}],"code":"#define _lineSegment(a, b, c, d) lineSegment(fragColor, fragCoord, a, b, c, d);\n\nvoid lineSegment(inout vec4 fragColor, vec2 z, vec2 a, vec2 b, vec4 c,  float w){\n    float d = dot(z-mix(a,b,.5),b-a);\n    if(abs(d)<dot(a-b,a-b)/2.){\n    \td=length(cross(normalize(vec3(a-b,0.)),vec3(z-b,0.)));\n    } else {\n        d=min(length(z-b),length(z-a));\n    }\n    fragColor.xyz = mix(fragColor.xyz, c.xyz,c.w *clamp(w-d,0.,1.));\n}\n\nconst float KEY_W  = 87.5/256.0;\nconst float KEY_E  = 69.5/256.0;\n\n\nbool keyIsDown( float key ) {\n    return texture( iChannel3, vec2(key,0.25) ).x > .5;\n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    fragColor = texture(iChannel1, fragCoord/iResolution.xy);\n    vec4 mo = texture(iChannel1, vec2(0));\n    if(iMouse.w>0. && mo.w>0. && length(mo.xy-iMouse.xy)>3.){\n    \tif ( keyIsDown(KEY_E)) {\n        \t_lineSegment(iMouse.xy, mo.xy, vec4(0,0,0,1),5.);\n        } else {\n        \t_lineSegment(iMouse.xy, mo.xy, vec4(1),2.);\n        }\n    }\n    if ( keyIsDown(KEY_W)) {\n        fragColor *= 0.;\n    }\n    if (length(fragCoord)<1.){\n        if(length(mo.xy-iMouse.xy)>3.){\n        \tfragColor = iMouse;\n        } else {\n            fragColor = vec4(mo.xy,iMouse.zw);\n        }\n    }\n}","name":"Buf B","description":"","type":"buffer"}]}