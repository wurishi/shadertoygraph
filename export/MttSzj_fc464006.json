{"ver":"0.1","info":{"id":"MttSzj","date":"1480676115","viewed":287,"name":"Gold Fluid","username":"romax9lahin","description":"My first try in Raymarching.\n","likes":1,"published":1,"flags":0,"usePreview":0,"tags":["raymarching","raymarch","raycasting","raycast","sphere","fluid","3draycasting"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":" \n\tfloat hash(float x) { return fract(sin(x)*87369.39639); }\n\nfloat hash(vec2 x) { return hash(dot(x,vec2(71.,313.))); }\n\nfloat noise(vec2 x) \n{ \nvec2 F = floor(x), f = fract(x); \nvec2 e = vec2(1.0,0.0);  \t\nf *= f * (3.0 - 2.0 * f); \t\nreturn mix( \t\tmix(hash(F+e.yy), hash(F+e.xy), f.x), \t\tmix(hash(F+e.yx), hash(F+e.xx), f.x), f.y); \n}\n\nfloat fnoise(vec2 x) \n{ \t\nx += vec2(10.0); \t\nreturn (0.5 * noise(x)\t+ 0.25 * noise(x*1.97) \t+0.125 * noise(x*4.04) \t+ 0.0625 * noise(x*8.17)) ; \n}\n\nfloat addob(float oa, float ob)\n{\nreturn min(oa,ob);\n}\n\nfloat landspace(vec3 a)\n{\n    float t=iDate.r+iDate.g+iDate.b+iDate.a;\nreturn (a.y+noise(a.xz*1.5+vec2(t/6.0,t/9.0)))/0.1*(noise(a.xz+vec2(t/7.0))*0.5+0.5)-0.5;\n}\n\nfloat ball(vec3 a)\n{\nreturn length(a-vec3(0.0,0.5,0.0)) - 0.5;\n}\n\nfloat world(vec3 a) \n{ \t\nfloat plane = addob(landspace(a),ball(a));\n\nreturn plane; \n} \n\nvec3 wnormal(vec3 a)\n { \t\nvec2 e = vec2(.001, 0.); \n\tfloat w = world(a); \t\nreturn normalize(vec3( \t\tworld(a+e.xyy) - w, \t\tworld(a+e.yxy) - w, \t\tworld(a+e.yyx) - w)); \n}\n\nvec2 trace(vec3 O, vec3 D) \n{ \t\n    float t=iDate.r+iDate.g+iDate.b+iDate.a;\nfloat L = 0.0; \t\nfor (int i = 0; i < 32; i+=1) \n{ \t\nfloat d = world(O + D*L); \nL+=d;\nif(ball(O+D*L) < 0.001*L )\n{\nvec3 norm=wnormal(O+D*L);\nD=norm;\n/*O=-O; \nD=-D;*/\nL=L*sin(t/10.0);\n}\nif (d < 0.001*L) break; \n} \t\nreturn vec2(((O+D*L).y+0.5)*wnormal(O+D*L).z,L);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    float t=iDate.r+iDate.g+iDate.b+iDate.a;\n\nvec2 uv = gl_FragCoord.xy /iResolution.xy * 2.0 - 1.0; \t//gl_FragCoord.xy / iResolution.xy * 2.0 - 1.0;\n \t\nuv.x *= iResolution.x / iResolution.y; \t \t\n\nvec3 O = vec3(0.0, 0.0, 3.0); \t\n\nvec3 D = normalize(vec3(uv, -2.0)); \t \t\n\nvec2 path = trace(O, D); \t \t\nfloat p=min(1.0,max(0.0,path.x/2.0));\nvec3 skies=vec3(0.75,0.876,1.0)*(noise(uv.xy/2.0+vec2(t/6.0,t/8.0))*0.5+0.5);\nvec3 coll =mix(vec3(p*0.5+0.7,p*0.6+0.5,p*0.3+0.3),skies, min(1.0,max(0.0,path.y*0.2)));\n\nfragColor = vec4(coll.rgb,1.0); \n\n}","name":"Image","description":"","type":"image"}]}