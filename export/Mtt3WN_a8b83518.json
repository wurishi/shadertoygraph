{"ver":"0.1","info":{"id":"Mtt3WN","date":"1469423814","viewed":185,"name":"008 sphere marching schematic","username":"kakaxizhhgjh","description":"original: https://www.shadertoy.com/view/XsyGRW\nlearn a lot from hughsk's work","likes":9,"published":1,"flags":0,"usePreview":0,"tags":["sdf","spheremarching"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"float line_segment(vec2 p, vec2 a, vec2 b) {\n\tvec2 ab = b - a, ap = p - a;\n    return length(ap - ab * clamp(dot(ab, ap) / dot(ab, ab), 0.0, 1.0));\n}\n\nfloat circle(vec2 p, float r) {\n\treturn length(p) - r;\n}\n\nfloat sdf(vec2 p) {\n\treturn min(circle(p - vec2(cos(iTime)), 0.5), circle(p + vec2(sin(iTime), 0.0), 0.5));\n}\n\nfloat plot_edge(float d) {\n\treturn smoothstep(3.0 / iResolution.y, 0.0, abs(d));\n}\n\nfloat plot_solid(float d) {\n\treturn smoothstep(3.0 / iResolution.y, 0.0, max(0.0, d));\n}\n\nfloat plot_solid_with_blooming(float d) {\n\treturn 1.0 - clamp(d, 0.0, 1.0);\n}\n\nvec3 plot_contour(float d) {\n\tvec3 bg = mix(vec3(0.3, 0.8, 1.0), vec3(1.0, 0.8, 0.6), plot_solid_with_blooming(d));\n    bg = mix(bg, vec3(1.0, 0.44, 0.33), plot_solid(d));\n    bg = mix(bg, vec3(0.0), plot_edge(d));\n    bg -= vec3(0.1) * plot_edge(mod(d + 0.025, 0.05) - 0.025);\n    bg -= vec3(0.3) * plot_edge(mod(d + 0.1, 0.2) - 0.1);\n    return bg;\n}\n\nvec3 plot_trace(vec2 p) {\n\tvec2 ro = (iMouse.xy * 2.0 - iResolution.xy) / iResolution.y;\n    vec2 rd = normalize(-ro);\n    vec2 o = ro;\n    float bg = 0.0;\n    for(int i = 0; i < 20; ++i) {\n    \tfloat t = sdf(ro);\n        bg += pow(1.0 - bg, 3.0) * 0.8 * plot_solid(circle(p - ro, 0.015));\n        bg += pow(1.0 - bg, 3.0) * 0.2 * plot_solid(circle(p - ro, abs(t)));\n        bg += pow(1.0 - bg, 3.0) * 0.8 * plot_edge(circle(p - ro,abs(t)));\n        ro += rd * t;\n        if(abs(t) < 0.01) break;\n    }\n    bg += pow(1.0 - bg, 2.2) * 0.4 * plot_edge(line_segment(p, o, ro));\n    return vec3(bg);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n    vec2 uv = (fragCoord * 2.0 - iResolution.xy) / iResolution.y;\n    fragColor = vec4(plot_contour(sdf(uv)) - plot_trace(uv), 1.0);\n}","name":"Image","description":"","type":"image"}]}