{"ver":"0.1","info":{"id":"flGSzz","date":"1640049119","viewed":43,"name":"Yxy","username":"bazhenovc","description":"rgb to Yxy","likes":1,"published":1,"flags":0,"usePreview":0,"tags":["yxy"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dfGRn","filepath":"/media/a/8de3a3924cb95bd0e95a443fff0326c869f9d4979cd1d5b6e94e2a01f5be53e9.jpg","previewfilepath":"/media/ap/8de3a3924cb95bd0e95a443fff0326c869f9d4979cd1d5b6e94e2a01f5be53e9.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\nconst mat3 rgb2xyz = mat3(\n    0.4124564, 0.2126729, 0.0193339,\n    0.3575761, 0.7151522, 0.1191920,\n    0.1804375, 0.0721750, 0.9503041\n);\n\nconst mat3 xyz2rgb = mat3(\n     3.2404542, -0.9692660,  0.0556434,\n    -1.5371385,  1.8760108, -0.2040259,\n    -0.4985314,  0.0415560,  1.0572252\n);\n\nvec3 xyz2Yxy(vec3 xyz) {\n    float d = 1.0 / (xyz.x + xyz.y + xyz.z);\n    float x = xyz.x * d;\n    float y = xyz.y * d;\n    return vec3(xyz.y, x, y);\n}\n\nvec3 Yxy2xyz(vec3 Yxy) {\n    float x = Yxy.x * Yxy.y / Yxy.z;\n    float z = Yxy.x * (1.0 - Yxy.y - Yxy.z) / Yxy.z;\n    return vec3(x, Yxy.x, z);\n}\n\nfloat srgb2linear1(float channel) {\n    if (channel <= 0.04045)\n        return channel / 12.92;\n    else\n        return pow((channel + 0.055) / (1.0 + 0.055), 2.4);\n}\n\nvec3 srgb2linear(vec3 srgb) {\n    return vec3(\n        srgb2linear1(srgb.x),\n        srgb2linear1(srgb.y),\n        srgb2linear1(srgb.z)\n    );\n}\n\nfloat linear2srgb1(float channel) {\n    if(channel <= 0.0031308)\n        return 12.92 * channel;\n    else\n        return (1.0 + 0.055) * pow(channel, 1.0/2.4) - 0.055;\n}\n\nvec3 linear2srgb(vec3 linear) {\n    return vec3(\n        linear2srgb1(linear.x),\n        linear2srgb1(linear.y),\n        linear2srgb1(linear.z)\n    );\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n    vec2 uv = fragCoord/iResolution.xy;\n\n    vec3 rgb = srgb2linear(texture(iChannel0, uv).rgb);\n    vec3 xyz = rgb * rgb2xyz;\n    vec3 Yxy = xyz2Yxy(xyz);\n    \n    if (uv.x > 0.5) {\n        if (uv.x > 0.75) {\n            fragColor = vec4(linear2srgb(Yxy2xyz(Yxy) * xyz2rgb), 1.0);\n        } else {\n            fragColor = vec4(linear2srgb(rgb), 1.0);\n        }\n    } else {\n        fragColor = vec4(Yxy, 1.0);\n    }\n}\n","name":"Image","description":"","type":"image"}]}