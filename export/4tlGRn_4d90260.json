{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[{"channel":0,"type":"texture","id":"4dfGRn","filepath":"/media/a/8de3a3924cb95bd0e95a443fff0326c869f9d4979cd1d5b6e94e2a01f5be53e9.jpg","sampler":{"filter":"mipmap","wrap":"repeat","vflip":"false","srgb":"false","internal":"byte"}}],"code":"// This implementation uses GLSL code by ArKano22: \n// http://www.gamedev.net/topic/590070-glsl-droste/\n\nconst float TWO_PI = 3.141592*2.0;\n\n//ADJUSTABLE PARAMETERS:\nconst float Branches = 1.0;\nconst float scale = 0.5;\n\n//Complex Math:\nvec2 complexExp(in vec2 z){\n\treturn vec2(exp(z.x)*cos(z.y),exp(z.x)*sin(z.y));\n}\nvec2 complexLog(in vec2 z){\n\treturn vec2(log(length(z)), atan(z.y, z.x));\n}\nvec2 complexMult(in vec2 a,in vec2 b){\n\treturn vec2(a.x*b.x - a.y*b.y, a.x*b.y + a.y*b.x);\n}\nfloat complexMag(in vec2 z){\n\treturn float(pow(length(z), 2.0));\n}\nvec2 complexReciprocal(in vec2 z){\n\treturn vec2(z.x / complexMag(z), -z.y / complexMag(z));\n}\nvec2 complexDiv(in vec2 a,in vec2 b){\n\treturn complexMult(a, complexReciprocal(b));\n}\nvec2 complexPower(in vec2 a, in vec2 b){\n\treturn complexExp( complexMult(b,complexLog(a))  );\n}\n//Misc Functions:\nfloat nearestPower(in float a, in float base){\n\treturn pow(base,  ceil(  log(abs(a))/log(base)  )-1.0 );\n}\nfloat map(float value, float istart, float istop, float ostart, float ostop) {\n\t   return ostart + (ostop - ostart) * ((value - istart) / (istop - istart));\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ){\n\t\t\n\t//SHIFT AND SCALE COORDINATES TO <-1,1>\n\tvec2 uv=fragCoord.xy/iResolution.xy-.5;\n\tuv.y*=iResolution.y/iResolution.x;\n\n\t//ESCHER GRID TRANSFORM:\n\tfloat factor = pow(1.0/scale,Branches);\n\tuv= complexPower(uv, complexDiv(vec2( log(factor) ,TWO_PI), vec2(0.0,TWO_PI) ) ); \n\t\n\t//RECTANGULAR DROSTE EFFECT:\t\n\tfloat FT = fract(iTime);\n\tFT = log(FT+1.)/log(2.); \n\tuv *= 1.0+FT*(scale-1.0);\n\n     float npower = max(nearestPower(uv.x,scale),nearestPower(uv.y,scale));\n\tuv.x = map(uv.x,-npower,npower,-1.0,1.0);\n\tuv.y = map(uv.y,-npower,npower,-1.0,1.0);\n\t\n\t//UNDO SHIFT AND SCALE:\t\n\tfragColor =  texture(iChannel0,-uv*0.5+vec2(0.5));\t\t\n}","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"4tlGRn","date":"1417944193","viewed":847,"name":"Droste","username":"SCORPION","description":"Just tried to remake shader\nhttp://www.gamedev.net/topic/590070-glsl-droste/\nto Shadertoy","likes":12,"published":1,"flags":0,"usePreview":0,"tags":["droste"],"hasliked":0,"parentid":"","parentname":""}}