{"ver":"0.1","info":{"id":"lfdXDr","date":"1713818184","viewed":59,"name":"Fork sphere env b005t3r 960","username":"b005t3r","description":"sphere envmap","likes":1,"published":1,"flags":0,"usePreview":0,"tags":["sphere"],"hasliked":0,"parentid":"McdXDr","parentname":"sphere envmap test"},"renderpass":[{"inputs":[{"id":"XsX3zn","filepath":"/media/a/94284d43be78f00eb6b298e6d78656a1b34e2b91b34940d02f1ca8b22310e8a0.png","previewfilepath":"/media/ap/94284d43be78f00eb6b298e6d78656a1b34e2b91b34940d02f1ca8b22310e8a0.png","type":"cubemap","channel":0,"sampler":{"filter":"mipmap","wrap":"clamp","vflip":"false","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\nfloat sphIntersect( in vec3 ro, in vec3 rd, in vec4 sph )\n{\n\tvec3 oc = ro - sph.xyz;\n\tfloat b = dot( oc, rd );\n\tfloat c = dot( oc, oc ) - sph.w*sph.w;\n\tfloat h = b*b - c;\n\tif( h<0.0 ) return -1.0;\n\treturn -b - sqrt( h );\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{    \n\tvec2 p = (2.0*fragCoord-iResolution.xy) / iResolution.y;\n\n\tvec3 ro = vec3(2.0 * sin(iTime * 0.33), cos(iTime * 0.33), 4.0 );\n\tvec3 rd = normalize( vec3(p,-2.0) );\n\t\n    vec4 sph = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\n    vec3 col = vec3(0.0);\n\n    float tmin = 1e10;\n    \n    float t2 = sphIntersect( ro, rd, sph );\n    if( t2>0.0 && t2<tmin )\n    {\n        tmin = t2;\n        float t = t2;\n        vec3 pos = ro + t*rd;\n        vec3 nor = normalize( pos - sph.xyz );\n        \n        vec3 view = normalize( ro - pos );\n        \n        vec3 ref = view + 2.0 * ( dot( view, nor ) * nor - view );\n        \n        col = textureLod( iChannel0, nor, 0.0 ).xyz;\n\t}\n    \n    fragColor = vec4( col, 1.0 );\n}","name":"Image","description":"","type":"image"}]}