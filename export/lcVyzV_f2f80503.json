{"ver":"0.1","info":{"id":"lcVyzV","date":"1732123324","viewed":124,"name":"Line-Circle Intersection","username":"Bingle","description":"Both intersections between an unbounded line and a circle of a given radius. Line can be moved with the mouse","likes":4,"published":3,"flags":0,"usePreview":0,"tags":["math","line","intersection","circle"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"vec4 lineCircleIntersect(vec2 p1, vec2 p2, vec3 circle){\n    p1 -= circle.xy;\n    p2 -= circle.xy;\n    vec2 d = p2-p1;\n    float dr = length(d);\n    float D = p1.x*p2.y - p2.x*p1.y;\n    float disc = circle.z*circle.z * dr*dr - D*D;\n    if (disc<0.0){\n        return circle.xyxy; // No intersection, just return center of circle\n    }\n    float discSq = sqrt(disc);\n    float val1 = (d.y<0.0 ? -1.0 : 1.0)*d.x*discSq; // Idk what to name this\n    float val2 = abs(d.y)*discSq;\n    return vec4(\n        D*d.y+val1,-D*d.x+val2, // Intersection 1\n        D*d.y-val1,-D*d.x-val2  // Intersection 2\n    )/(dr*dr)+circle.xyxy;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ){\n    // Setup\n    vec2 circlePos = iResolution.xy*0.5+vec2(cos(iTime)*0.25*iResolution.x,0.0);\n    float circleRadius = iResolution.y*0.25+sin(iTime*2.68)*10.0;\n    \n    vec2 p1 = iResolution.xy*vec2(0.3,0.9);\n    vec2 p2 = iMouse.xy;\n    \n    // Math\n    \n    vec4 ints = lineCircleIntersect(p1,p2,vec3(circlePos,circleRadius));\n    \n    // Draw stuff\n    vec3 col = vec3(0.0);\n    \n    col = mix(vec3(1.0),col,clamp(abs(length(fragCoord-circlePos)-circleRadius)-1.0,0.0,1.0));\n    col = mix(vec3(0.0,0.0,1.0),col,clamp(abs(dot(normalize(p2-p1).yx*vec2(-1,1),fragCoord-p1))-2.0,0.0,1.0));\n    \n    if (ints != circlePos.xyxy){\n        col = mix(vec3(1.0,0.0,0.0),col,clamp(length(fragCoord-ints.xy)-8.0,0.0,1.0));\n        col = mix(vec3(1.0,0.0,0.0),col,clamp(length(fragCoord-ints.zw)-8.0,0.0,1.0));\n    }\n    \n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}