{"ver":"0.1","info":{"id":"fljSDG","date":"1628522197","viewed":238,"name":"Pattern process #2","username":"louis_C","description":"The main square is an interactive part, you can move the form to change the pattern.\n\nAs part of this project :     https://www.cosamentale.fr/frages-flux-of-generative-researches/ \n\nFirst part : ttps://www.shadertoy.com/view/stjSzc","likes":20,"published":1,"flags":0,"usePreview":0,"tags":["interactive"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"float map(float value, float min1, float max1, float min2, float max2) {\n  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\n}\nvec2 map(vec2 value, vec2 min1, vec2 max1, vec2 min2, vec2 max2) {\n  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\n}\nconst float threshold[16] = float[16](\n    1./16., 9./16., 3./16., 11./16., \n    13./16., 5./16., 15./16., 7./16., \n    4./16., 12./16., 2./16., 10./16.,\n    16./16., 8./16., 14./16., 6./16.);\n\nfloat dit2(int x, int y, float v)\n{\n    return step(threshold[4*y+x],v);\n}\nfloat smin(float a, float b, float k){ float h = clamp(0.5+0.5*(b-a)/k,0.,1.);\nreturn mix(b,a,h)-k*h*(1.-h);}\nfloat pi = 3.141592653589793;\nmat2 rot(float t){ float c = cos(t); float s = sin(t); return mat2(c,-s,s,c);}\nfloat bl(vec2 p ,vec2 b){vec2 q = abs(p)-b;\nreturn length(max(q,vec2(0.)))+min(0.,max(q.y,q.x));}\nfloat box(vec3 p ,vec3 b){vec3 q = abs(p)-b;\nreturn length(max(q,vec3(0.)))+min(0.,max(q.y,max(q.z,q.x)));}\nvec2 z1 ;\nvec3 map(vec3 p){\nfloat ft = 4.;\nfloat fo = (sin(p.y*pi*0.5)*0.5+0.5)*ft;\nint r = int(1.+floor(clamp(fo-1.,0.,ft))*2.);\nfloat tr = step(1.,fo);\nfloat td = 0.1*tr;\nvec2 pp = abs(map(iMouse.xy/iResolution.xy,vec2(0.29,0.5),vec2(1.,0.),vec2(0.),vec2(2.5,1.)));\nvec2 ppp = mix( vec2(0.),pp,step(pp.x,0.7)*step(pp.y,0.7));\np.xz += td;\nvec3 pr = p;\nfor(int i = 0 ; i <r ; i++){\npr.xz -= td;\npr.xz *= rot(pi*0.25);\npr = abs(pr);\n}\nfloat dr3 = min(pr.x,pr.z)/step(1.,fo);\nfor(int i = 0 ; i <r+1 ; i++){\np.xz -= td;\np.xz *= rot(pi*0.25);\np =abs(p);\n}\nvec3 re = vec3 (1.,0.,1.)*0.1;\nvec3 pg = p;\npg = mod(pg,re)-0.5*re;\nfloat d1 = length(pg.x);\nfloat d2 = length(pg.z);\nfloat d3 = min(d1,d2);\nfloat d4 = bl(p.xz-ppp,vec2(0.3)*0.2);\nz1 = pr.xz;\nreturn vec3(d4,dr3,d3);}\n\nfloat map2(vec3 p){\nvec2 ppp = abs(map(iMouse.xy/iResolution.xy,vec2(0.29,0.5),vec2(1.,0.),vec2(0.),vec2(2.5,1.)));\nvec2 pp2 = mix(vec2(0.),ppp,step(ppp.x,0.7)*step(ppp.y,0.7));\nvec3 pp = vec3(pp2.x,0.,pp2.y)*-1.;\nfloat fo = (sin(iTime*pi*0.5)*0.5+0.5)*4.;\nfloat t1 = step(1.,fo);\nfloat t2 = step(2.,fo);\nfloat t3 = step(3.,fo);\nfloat td = 0.1*t1;\np.xz += td;\nvec3 p1 = p; vec3 p2 = p; vec3 p3 = p; vec3 p4 = p;\n\np1.xz -= td;\np1.xz *= rot(pi*0.25*2.);\np1 = abs(p1);\nfor(int i = 0 ; i <2 ; i++){\np2.xz -= td;\np2.xz *= rot(pi*0.25);\np2.xz = abs(p2.xz);\n}\nfor(int i = 0 ; i <int(mix(2.,4.,t2)); i++){\np3.xz -= td;\np3.xz *= rot(pi*0.25);\np3.xz = abs(p3.xz);\n}\nfor(int i = 0 ; i <int(mix(2.,mix(4.,6.,t3),t2)) ; i++){\np4.xz -= td;\np4.xz *= rot(pi*0.25);\np4.xz = abs(p4.xz);\n}\nfloat fa = 0.8;\nfloat f1 = pow(1.,fa);float f2 = pow(2.,fa);float f3 =pow(3.,fa);\n\nfloat d1 = max(box(p1+pp,vec3(0.3)*vec3(0.2,pow(4.,fa),0.2)),-(length(p.y)-0.3*f3));\nfloat d2 = max(box(p2+pp,vec3(0.3)*vec3(0.2,pow(3.,fa),0.2)),-(length(p.y)-0.3*f2));\nfloat d3 = max(box(p3+pp,vec3(0.3)*vec3(0.2,f2,0.2)),-(length(p.y)-0.3*f1));\nfloat d4 = box(p4+pp,vec3(0.3)*vec3(0.2,f1,0.2));\nfloat ts = pow(clamp(sin(iTime*pi*0.5),0.,1.),2.)*0.2;\nfloat d5 = smin(smin(smin(d4,d3,ts),d2,ts),d1,ts)+ts*0.05;\nreturn d5;}\nvec3 nor (vec3 p){vec2 e = vec2(0.001,0.);return normalize(map2(p)-vec3(map2(p-e.xyy),map2(p-e.yxy),map2(p-e.yyx)));}\nvoid mainImage( out vec4 O, vec2 uu )\n{\n     vec2 uv = -1. + 2. *uu/iResolution.xy;\n    uv.x *= iResolution.x/iResolution.y;\n      float li = step(0.1,uv.x);\n    vec2 up = uv*mix(1.,4.,li)+vec2(0.75-li*3.2,li*-1.58);\n    float bf = bl(up,vec2(0.75+li*0.7));\n    vec3 fo = map(vec3(up.x,iTime,up.y));\n    vec3 d1 = smoothstep(0.,(0.0015+li*0.005)*(1080./iResolution.y),fo);\n    float c1 = mix(mix(step(0.25,distance(fract(z1.y*30.),0.5)),(max(max(d1.x,0.),step(1.,fract(iTime*0.25)))*mix(0.,1.,d1.z)),d1.y)*step(bf,-0.004-li*0.01),max(d1.y,mix(0.8,1.,step(0.05*(1.-li),bf))),step(0.,bf));\n    vec2 ur = uv*2.78-vec2(1.71,-1.10);\n    float zr = bl(ur,vec2(1.));\n    vec3 r = normalize(vec3(ur,5.));\n    vec3 p = vec3(0.,1.6,-5.);\n    float tt = -0.3;float t2 = iTime*0.5;\n    r.zy *= rot(tt);\n    r.xz *= rot(t2);\n    p.xz *= rot(t2);\n    float dd  = 0.;\n    for(int  i = 0 ; i < 100 ; i++){\n    if(zr>0.){break;}\n    float d = map2(p);\n    if(d>7.){dd = 7.;break;}\n    if(d<0.001){break;}\n    p += r*d;\n    dd += d;\n    }\n    float s = smoothstep(6.,4.6,dd);\n    vec3 n = nor(p);\n    float dao = 0.035;float dao2 = 5.;\n    float ao = pow(clamp(map2(p+n*dao)/dao,0.0,1.),0.5);\n    float ao2 = clamp(map2(p+n*dao2)/dao2,0.,1.);\n    float aof = ao2*mix(0.3,1.,ao)*s;\n      vec2 co = uu/2.;\n     float tm = 4.;\n    int cox = int(mod(co.x,tm));\n    int coy = int(mod(co.y,tm));\n    float r2 = mix(dit2(cox,coy,aof),aof,0.4);\n    float bs = bl(uv+-vec2(1.65,0.),vec2(0.02,0.75));\n    float sa = max(step(0.,bs),step(bs,-0.0051)*step(sin(iTime*pi*0.5),floor(uv.y*2.)/2.));\n    O = vec4 (c1*r2*vec3(0.905882,0.,0.22745)*sa,0.);\n    \n}\n\n","name":"Image","description":"","type":"image"}]}