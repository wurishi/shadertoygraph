{"ver":"0.1","info":{"id":"DssyWH","date":"1686795421","viewed":100,"name":"lightning beam","username":"sanxouo","description":"a basic lightning beam","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["lightningbeam"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XdXGzn","filepath":"/media/a/3083c722c0c738cad0f468383167a0d246f91af2bfa373e9c5c094fb8c8413e0.png","previewfilepath":"/media/ap/3083c722c0c738cad0f468383167a0d246f91af2bfa373e9c5c094fb8c8413e0.png","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"vec2 point(in int cellx, in int offset) {\n    ivec2 uv = ivec2(cellx, offset);\n    vec2 rnd = texelFetch(iChannel0, ((uv % 64) + 64) % 64, 0).rg;\n    \n    return vec2(cellx, 0) + 0.5 + rnd*1. - 0.5;\n}\n\nfloat dist(in vec2 point, in vec2 pos) {\n    return clamp(1. - 5.*distance(pos, point), 0.0, 1.0);\n}\n\nfloat cross2d(in vec2 a, in vec2 b) {\n    return a.x*b.y - a.y*b.x;\n}\n\nfloat lineDist(in vec2 p0, in vec2 p1, in vec2 pos) {\n    vec2 dir = p1 - p0;\n    vec2 n = normalize(vec2(-dir.y, dir.x));\n    \n    vec2 p = pos - p0;\n    \n    float d0 = dot(p1 - p0, pos - p0);\n    float d1 = dot(p0 - p1, pos - p1);\n    \n    if (d0 < 0.) {\n        return distance(p0, pos);\n    }\n    else if (d1 < 0.)  {\n        return distance(p1, pos);\n    }\n    else {\n        return d0 < 0. || d1 < 0. ? 1.0 : abs(dot(n, p));\n    }\n}\n\nfloat lightning(in vec2 uv, in int offset, in float factor) {\n    ivec2 cell = ivec2(floor(uv));\n    cell.y = 0;\n    vec2 coord = fract(uv);\n\n    vec2 p01 = point(cell.x - 1, offset);\n    vec2 p11 = point(cell.x, offset);\n    vec2 p21 = point(cell.x + 1, offset);\n    \n    float s = factor;\n    return clamp(1. - s*min(lineDist(p11, p01, uv), lineDist(p11, p21, uv)), 0.0, 1.0);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = (fragCoord - iResolution.xy / 2.) / iResolution.x * 25.;\n\n    vec3 col = vec3(0);\n    float s = 3.;\n    col += vec3(lightning(uv, int(floor(0.0 + iTime * s)) % 64, 20.));\n    col += vec3(lightning(uv, int(floor(-1. + iTime * s)) % 64, 10.));\n    col += vec3(lightning(uv, int(floor(-1. + iTime * s)) % 64, 5.));\n    col += vec3(lightning(uv, int(floor(10.     + iTime * s * 3.5135)) % 64, 12.));\n    col += vec3(lightning(uv, int(floor(10. -1. + iTime * s * 3.5135)) % 64, 5.));\n    col += vec3(lightning(uv, int(floor(20.     + iTime * s * 6.0135)) % 64, 12.));\n    col += vec3(lightning(uv, int(floor(20. -1. + iTime * s * 6.0135)) % 64, 5.));\n    col += vec3(lightning(uv, int(floor(30.     + iTime * s * 5.7135)) % 64, 12.));\n    col += vec3(lightning(uv, int(floor(30. -1. + iTime * s * 5.7135)) % 64, 5.));\n    \n    fragColor = vec4(col * vec3(0.5, 0.7, 1.0), 1.0);\n}\n\n","name":"Image","description":"","type":"image"}]}