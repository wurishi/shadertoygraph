{"ver":"0.1","info":{"id":"4lsXWM","date":"1437138397","viewed":347,"name":"cards surprise","username":"destroyboy","description":"cards demo","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["cards"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XdfGRn","filepath":"/media/a/e6e5631ce1237ae4c05b3563eda686400a401df4548d0f9fad40ecac1659c46c.jpg","previewfilepath":"/media/ap/e6e5631ce1237ae4c05b3563eda686400a401df4548d0f9fad40ecac1659c46c.jpg","type":"texture","channel":1,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"false","srgb":"false","internal":"byte"},"published":1},{"id":"Xsf3Rn","filepath":"/media/a/cbcbb5a6cfb55c36f8f021fbb0e3f69ac96339a39fa85cd96f2017a2192821b5.png","previewfilepath":"/media/ap/cbcbb5a6cfb55c36f8f021fbb0e3f69ac96339a39fa85cd96f2017a2192821b5.png","type":"texture","channel":0,"sampler":{"filter":"nearest","wrap":"clamp","vflip":"false","srgb":"false","internal":"byte"},"published":1}],"outputs":[],"code":"// card demo\n// card shape is drawn algorithmically using a stroke and rounded corners\n// nyan cat is animated just for the sake of having a texture\n// thanks to lq for the optimizations\n\n#define TEXTURE2 (false)\n#define NYAN (true)\n#define CARD_WIDTH ( 0.37 )\n#define BORDER_WIDTH ( 0.025 )\n#define CARD_HEIGHT ( 0.50 )\n#define CARD_COUNT (5)\n#define SPEED (1.5)\n\n#define PI (3.141592654)\n\n// p1 is pixel\n// card is center of card\n// frame is x offset for nyan cat frame\n// cat is whether to draw the cat\n// back is card background color\n\nvec4 drawCard( vec2 p1, vec2 card, float frame, bool cat, vec4 back )\n{\n    // p is vector from center of card to pixel\n    vec2 p  = p1 - card;\n    \n    vec2 b = 0.5*vec2(CARD_WIDTH,CARD_HEIGHT) - BORDER_WIDTH*2.0;\n\n    vec2 q = abs(p)-b;\n    float d = length(max(q,0.0));\n    if( d < BORDER_WIDTH )\n        d = max( q.x, q.y );\n    d = d - BORDER_WIDTH*2.0;\n\n    p.x -= -CARD_WIDTH*0.5-1.550+frame;\n    p.y -= -CARD_HEIGHT*0.5+0.05;\n    p.y *= 2.5;\n    p.x *= 0.5;\n    vec4 color = cat ? texture(iChannel0,p) : back;\n    color = mix( back, color, color.w );\n    color.xyz *= smoothstep( 1.0*BORDER_WIDTH, BORDER_WIDTH+0.003, -d );\n    color.w = smoothstep( 0.0, 0.003, d );\n    return color;\n}\n\nvec2 rotate_around_center(vec2 p0, vec2 center, float angle )\n{\n    return center + mat2(cos(angle),-sin(angle),sin(angle),cos(angle)) * (p0-center);\n}\n\nvec4 drawCardRotated( vec2 pixel, vec2 pos,float angle, float frame, bool cat, vec4 back )\n{\n\treturn drawCard(rotate_around_center(pixel,pos,angle),pos, frame, cat, back);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 p0 = (fragCoord.xy - 0.5*iResolution.xy) / iResolution.y;\n    float t = iTime*SPEED;\n    float state = fract(floor(t/PI)/4.0)*4.0;\n    float frame = floor(6.0*fract(t*2.0))*0.314;\n    float freqs[5];\n    freqs[0] = 0.37;\n    freqs[1] = 0.50;\n    freqs[2] = 0.60;\n    freqs[3] = 0.40;\n    freqs[4] = 0.80;\n    \n    fragColor = vec4(0.3,1.0,0.3,0.0);\n    \n    for ( int i = CARD_COUNT-1; i>=0; i-- )\n    {\n        vec4 color = i==0 ?\n            vec4(117.0/255.0,215.0/255.0,238.0/255.0,1.0) :\n            vec4((1.0+sin(t+float(i)))*0.5,float(i)*0.25,(1.0+sin(t*1.7+float(i)))*0.5,1.0);\n        \n        \n        float amplitude = 0.2+0.5*(1.0+sin(t*freqs[i]));\n        float speed = 2.0;\n\n        float par1 = 1.0-2.0*mod(float(i),2.0);\n        float par2 = 1.0-2.0*mod(float((i-1)/2),2.0);\n        \n        float angle = 0.0;\n        \n        if ( i == 0 )\n        {\n            angle = amplitude*PI*sin(speed*t);\n        }\n        else\n            angle = amplitude * 1.5 * PI * par1 * sin(speed*t);  \n\n        vec2 pos = i==0 ?\n            vec2(0.0,0.0) : \n            amplitude * sin(speed*t) * vec2(- par1*0.6, -par2 * 0.3);\n            \n\n        if( float(i-2) < state )\n        {\n            vec4 tmp = drawCardRotated(p0,pos,angle, frame, i != 0 && NYAN, color);\n            fragColor = mix( tmp, fragColor, tmp.w );\n        }\n    }\n}\n","name":"","description":"","type":"image"}]}