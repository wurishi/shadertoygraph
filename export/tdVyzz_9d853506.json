{"ver":"0.1","info":{"id":"tdVyzz","date":"1602216571","viewed":155,"name":"Mosaic_1","username":"bigt","description":"马赛克","likes":4,"published":1,"flags":0,"usePreview":0,"tags":["mosaic"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dfGRn","filepath":"/media/a/8de3a3924cb95bd0e95a443fff0326c869f9d4979cd1d5b6e94e2a01f5be53e9.jpg","previewfilepath":"/media/ap/8de3a3924cb95bd0e95a443fff0326c869f9d4979cd1d5b6e94e2a01f5be53e9.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    int useBorder = 1;\t\t\t\t\t// 是否使用马赛克边框\n    float borderSize = 1.0;\t\t\t\t// 马赛克边框大小(像素为单位)\n\tvec2 mosaicSize = vec2(20.0,20.0);\t// 马赛克大小(像素为单位)\n\n    // 利用 x / s * s的方式，将值划块\n    vec2 mosaicCoord = floor(fragCoord / mosaicSize) * mosaicSize;\n    vec2 uv = mosaicCoord/iResolution.xy;\n\tfragColor = texture(iChannel0, uv);\n\n    // Border\n    // 以 马赛克大小=80 为例\n    // (0,0)___(80,0)____(160,0)\n    // pixelOffset = 85(假设当前像素坐标是85,0) - 80(起点是80)\n\tvec2 pixelOffset = fragCoord - mosaicCoord; // 当前像素到起点的像素个数\n\tfloat isBorder = step(min(pixelOffset.x, pixelOffset.y), borderSize);\n    //vec3 borderColor =  pow(fragColor.rgb, vec3(2.0)) * vec3(isBorder);\n    vec3 borderColor =  vec3(0.2,0.2,0.2) * vec3(isBorder); // 边框的颜色\n    vec3 sceneColor = fragColor.rgb * vec3(1.0 - isBorder);\n\tfragColor = vec4(mix(fragColor.rgb, sceneColor + borderColor, float(useBorder)), 1.0);\n    // fragColor = vec4(borderColor, 1.0);\n}","name":"Image","description":"","type":"image"}]}