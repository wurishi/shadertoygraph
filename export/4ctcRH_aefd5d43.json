{"ver":"0.1","info":{"id":"4ctcRH","date":"1730312157","viewed":69,"name":"Hamster Kuwahara ","username":"starmole2","description":"painterly filter ","likes":1,"published":1,"flags":2,"usePreview":0,"tags":["filter","kuwahara"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4sf3zn","filepath":"/presets/webcam.png","previewfilepath":"/presets/webcam.png","type":"webcam","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"const vec3 lumadot = vec3(1.0); //vec3(1.2126, 0.7152, 0.0722);\n\nfloat sampleBox( vec2 uv, vec2 size, int m, out vec3 mean ) {\n    mean = vec3(0.0);\n    for ( int y=1; y<=m; y++ )\n        for ( int x=1; x<=m; x++ )\n            mean += texture(iChannel0, uv + size*vec2(x,y)).xyz;\n    float im = 1.0 / float(m*m);\n    mean *= im;\n    float variance = 0.0;\n    float meanluma = dot(mean, lumadot);\n    for ( int y=1; y<=m; y++ ) {\n        for ( int x=1; x<=m; x++ ) {\n            vec3 l = texture(iChannel0, uv + size*vec2(x,y)).xyz;\n            float d = dot(l, lumadot) - meanluma;\n            variance += d*d;\n        }\n    }\n    return variance; //*im\n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n    vec2 uv = fragCoord/iResolution.xy;\n    uv.x = 1.0 - uv.x;\n    int m = 10;\n    vec2 s = vec2(1.0)/(iResolution.xy);\n    \n    vec3 c0, c1, c2, c3;\n    float v0 = sampleBox(uv, vec2(-s.x,-s.y), m, c0);\n    float v1 = sampleBox(uv, vec2( s.x,-s.y), m, c1);\n    float v2 = sampleBox(uv, vec2( s.x, s.y), m, c2);\n    float v3 = sampleBox(uv, vec2(-s.x, s.y), m, c3);\n    \n    vec3 col = c0;\n    float v = v0; \n    if ( v1 < v ) { col = c1; v = v1; }\n    if ( v2 < v ) { col = c2; v = v2; }\n    if ( v3 < v ) { col = c3; v = v3; }\n    \n    float cr = 1.2;\n    float br = .5;\n    col = (col - vec3(.5)) * cr + vec3(br);\n    \n    //col = vec3(dot(col, lumadot) );\n   \n    // Output to screen\n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}