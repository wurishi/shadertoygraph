{"ver":"0.1","info":{"id":"NslSR7","date":"1618411073","viewed":111,"name":"Fork Playing ma kithy 995","username":"kithy","description":"3d marble texture ","likes":6,"published":1,"flags":0,"usePreview":0,"tags":["3d","fractal","volumetric"],"hasliked":0,"parentid":"MtX3Ws","parentname":"Playing marble"},"renderpass":[{"inputs":[],"outputs":[],"code":"#define ITR 32\n\nvec2 csqr(vec2 a){\n\treturn vec2(a.x*a.x-a.y*a.y,2.0*a.x*a.y);\n}\n\nmat2 rot(float a){\n\treturn mat2(cos(a),sin(a),-sin(a),cos(a));\n}\nvec2 iSphere(in vec3 ro,in vec3 rd,in vec4 sph){\n\tvec3 oc=ro-sph.xyz;\n\tfloat b=dot(oc,rd);\n\tfloat c=dot(oc,oc)-sph.w*sph.w;\n\tfloat h=b*b-c;\n\tif(h<0.0)return vec2(-1.0);\n\th=sqrt(h);\n\treturn vec2(-b-h,-b+h);\n}\n\nfloat map(in vec3 p){\n\t\n\tfloat res=0.0;\n\tvec3 c=p;\n\tfor(int i=0;i<10;i++){\n\t\tp.xz*=rot(iTime*0.2);\n\t\tp=0.7*abs(p)/dot(p,p)-0.7;\n\t\tp.yz=csqr(p.yz);\n\t\tp=p.zyx;\n\t\tres+=exp(-19.0*abs(dot(p,c)));\n\t}\n\treturn res/2.0;\n}\n\nvec3 raymarch(in vec3 ro,vec3 rd,vec2 tminmax){\n\tfloat t=tminmax.x;\n\tfloat dt=0.02;\n\tvec3 col=vec3(0.0);\n\tfloat c=0.0;\n\tfor(int i=0;i<ITR;i++){\n\t\tt+=dt*exp(-2.0*c);\n\t\tif(t>tminmax.y)break;\n\t\tvec3 pos=ro+t*rd;\n\n\t\tc=map(pos);\n\n\t\tcol=0.99*col+0.08*vec3(c*c);\n\t}\n\treturn col;\n}\n\nvoid mainImage(out vec4 fragColor,in vec2 fragCoord){\n\tvec2 uv=(2.0*fragCoord.xy-iResolution.xy)/iResolution.y;\n\n\tvec3 ro=vec3(1.0);\n\t\n\tvec3 ta=vec3(0.0);\n\tvec3 ww=normalize(ta-ro);\n\tvec3 uu=normalize(cross(ww,vec3(0.0,1.0,0.0)));\n\tvec3 vv=normalize(cross(uu,ww));\n\tvec3 rd=normalize(uv.x*uu+uv.y*vv+4.0*ww);\n\n\n\n\tvec2 tmm=iSphere(ro,rd,vec4(0.0,0.0,0.0,0.4));\n\n\tvec3 col=raymarch(ro,rd,tmm);\n\tif(tmm.x<0.0)col=vec3(0.0);\n\telse{\n\t\tvec3 nor=(ro+tmm.x*rd)/3.0;\n\t\tnor=reflect(rd,nor);\n\t\tfloat fre=pow(0.5+clamp(dot(nor,rd),0.0,1.0),2.0)*2.0;\n\t\tcol+=nor*fre;\n\t}\n\tcol=0.5*(log(1.0+col));\n\tcol=clamp(col,0.0,1.0);\n\tfragColor=vec4(col,1.0);\n\n}","name":"Image","description":"","type":"image"}]}