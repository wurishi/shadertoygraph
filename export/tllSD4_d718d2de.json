{"ver":"0.1","info":{"id":"tllSD4","date":"1563033651","viewed":185,"name":"Jigoku Temple","username":"sayachang_bot","description":"Jigoku Temple","likes":5,"published":1,"flags":0,"usePreview":0,"tags":["mandelbox"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"//uniform sampler2D backbuffer; \nconst float PI = 3.1415926;\nconst float EPS = .001;\n#define time iTime\nvec2 rot(vec2 p, float a){return vec2(p.x*cos(a)-p.y*sin(a),p.x*sin(a)+p.y*cos(a));}\nvec2 pmod(vec2 p,float m){\n    float a=PI/m-atan(p.y,p.x);\n    float r=2.*PI/m;\n    a=floor(a/r)*r;\n    return rot(p,a);\n}\n// https://docs.google.com/presentation/d/1j4t4mcLw8F1PfqvKP3P8meMJ5dWfDXkfb9lc63qOFVM/edit#slide=id.g238edbc4b4_0_2\nvec4 tglad(vec3 p)\n{\n\tvec3 q=vec3(mod(p,2.))-1.1;\n\tvec3 s=vec3(.01,2.+.3*cos(time),-.8+.35*sin(time));\n\tvec3 s2=vec3(1.2+.01*cos(time),9.+6.*sin(time),1.4*cos(time));\n\tvec3 scale=vec3(-PI);\n\tfor(int i=0;i<3;++i){\n\t\tq=clamp(q, -1., 1.)*1.99-q;\n\t\tq*=scale/clamp(dot(q,q),.33,1.);\n\t\tq+=s*.9;\n\t}\n\treturn vec4((length(max(abs(q)-s2,.0))-.06)/pow(PI,3.+EPS),q);\n}\nvec4 map(vec3 p){\n    vec3 q=p;\n    for(int i=0;i<3;++i){\n        q=abs(q)-1.5;\n        q.xy=pmod(q.xy,1.);\n        q.y-=.1;\n        q.yz=pmod(q.yz,-1.);\n        q*=.7;\n    }\n    vec4 d=tglad(q);\n    return vec4(d.x-.1,d.yzw);\n}\nvec3 norm(vec3 p){vec2 e=vec2(.01,.0);return .000001+map(p).x-vec3(map(p-e.xyy).x,map(p-e.yxy).x,map(p-e.yyx).x);}\n// https://www.shadertoy.com/view/3dXSDH\nfloat sss(vec3 p, vec3 r, float d) {return clamp(map(p+r*d).x*3.0,0.0,1.0);}\nfloat rnd(float x){return fract(sin(x+12.345)*98.765);}\nfloat dots(vec3 p, float j) {\n    p*=4.+sin(j);\n    p.x -= rnd(floor(p.y));\n    p*=PI;\n    return clamp(0.1-length(vec2(sin(p.x),cos(p.y))),0.0,1.0)*30.;\n}\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 p = (fragCoord.xy * 2.0 - iResolution.xy) / min(iResolution.x,iResolution.y);\n    vec3 col = vec3(0.0);\n    vec3 ro=vec3(-4.3*sin(.1*time),0.,-2.)\n    ,ta=ro-vec3(2.+sin(time),.8+cos(time),1.-sin(time))\n    ,up=vec3(0.,1.,.0);\n    ro.xy=rot(ro.xy,-1.3);\n    ta.yz=rot(ta.yz,-1.3);\n    vec3 fwd=normalize(ta-ro)\n    ,side=normalize(cross(up,fwd));\n    up=normalize(cross(fwd,side));\n    vec3 rd=normalize(p.x*side+p.y*up+fwd*4.2);\n    vec3 ray=ro,N;\n    int j=0;\n    for(int i=0;i<64;++i){\n        float d=map(ray).x;\n        if(d<EPS){N=norm(ray);break;}\n        j=i;\n        ray+=d*rd;\n    }\n    col=(clamp(abs(6.*fract(.06*length(map(ray).xyx)+vec3(.0,.6,.3))-3.),.0,1.)*1.8-1.)*.2;\n    col+=pow(1.-float(j)/32.,2.);\n    col*=pow(1.-dot(N,normalize(ray-ro)),2.);\n    col+=(sss(ray,rd,0.2)+sss(ray,rd,0.5)*0.5+sss(ray,rd,0.5)*0.5)*.2;\n    \n    for(int k=0;k<7;++k){\n        float dos=dots(.9*(ray-20.*rd)*rnd(float(k))*vec3(sin(.1*time),4.*cos(.3*time),-sin(1.3*time)),1.);\n        col+=vec3(.2*dos,.1*dos,.0);\n    }\n    \n    vec3 colb=mix(vec3(.2,.5,.3),vec3(.9,.4,.1),pow(.8+.5*dot(rd,normalize(vec3(-5.*sin(.5*time),5.1*cos(.5*time),-5.1*sin(time)))),3.));\n    col*=colb;\n    /*\n    float tw=fract(sin(.1*time));\n    colb=texture2D(backbuffer,.5*p+vec2(tw,.0)).rgb;\n    vec3 colb2=texture2D(backbuffer,ray.yz-vec2(.0,.5+tw)).rgb;\n    col=(1.2*col+.5*colb+.1*colb2);\n    */\n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}