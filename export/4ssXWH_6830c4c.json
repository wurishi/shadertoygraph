{"ver":"0.1","renderpass":[{"outputs":[{"channel":0,"id":"4dfGRr"}],"inputs":[],"code":"/* Compiled with Shaderforth: https://github.com/daeken/Shaderforth\n:globals\n\t@vec3 uniform =iResolution\n\t@float uniform =iTime\n\t@vec2 =op\n\t@vec3 =fragcolor\n\t@float =time\n;\n\n:m pi 3.14159 ;\n:m tau pi 2.0 * ;\n\n:m ~= - abs 0.01 <= ;\n:m !~= - abs 0.01 > ;\n\n:m p+ ( p v ) p cart-polar v + polar-cart ;\n:m p* ( p v ) p cart-polar v * polar-cart ;\n\n:m minmax ( $a $b ) [ a b min a b max ] ;\n\n: cart-polar ( p:vec2 -> vec2 ) [ p .y.x atan2 p length ]v ;\n: polar-cart ( p:vec2 -> vec2 ) [ p .x cos p .x sin ]v p .y * ;\n\n: closest-point-line ( a:vec2 b:vec2 point:vec2 -> vec2 )\n\tpoint a - =>pa\n\tb a - =>ba\n\tpa ba dot ba ba dot / 0.0 1.0 clamp =h\n\tba h * a +\n;\n\n:m closest-point-line-polar ( a b point )\n\t\ta cart-polar\n\t\tb cart-polar\n\t\tpoint cart-polar\n\tclosest-point-line polar-cart\n;\n\n: point-distance-line ( a:vec2 b:vec2 point:vec2 -> float )\n\tpoint a b point closest-point-line - length\n;\n\n: hsv-rgb ( hsv:vec3 -> vec3 )\n    hsv .x 60.0 / [ 0. 4. 2. ]v + 6. mod 3. - abs 1. - 0.0 1.0 clamp =>rgb\n    [ 1. 1. 1. ]v rgb hsv .y mix hsv .z *\n;\n\n: derive-pos ( p:vec2 v:vec2 a:vec2 t:float -> vec2 )\n\tp v t * +\n\ta 2. / t t * * +\n;\n\n:m gravity [ 0.0 -0.3 ]v ;\n\n:m noise ( s )\n\ttime 100.0 * s 211.0 * + fragCoord .x 1489.0 * cos fragCoord .y 1979.0 * cos + * sin 1.0 + 2.0 /\n;\n\n: smoke-trail ( ltime:float duration:float origin:vec2 fp:vec2 )\n\t[ ltime fragCoord .x + 1187. * sin ltime fragCoord .y + 1447. * sin ]v 10.0 / dup noise * =off\n\torigin fp op off - closest-point-line =lp\n\tlp op - length =d\n\t1.0 lp fp - length origin fp - length / -\n\tlp fp - length 0.0 0.1 clamp 30.0 * *\n\t\t1.0 time ltime - duration / 0.0 1.0 clamp - 3.0 *\n\t\t1.0\n\tduration 0.0 != select * =r\n\n\toff length noise 0.3 * 1.0 + =gn\n\t0.1 d - 0.0 1.0 clamp 5.0 / r * gn * 0.0 1.0 clamp =grey\n\t[ grey dup dup ]v fragcolor + =fragcolor\n;\n\n: spark ( ltime:float origin:vec2 vel:vec2 dur:float color:vec3 dia:float )\n\ttime ltime - =t\n\torigin vel gravity t derive-pos =fp\n\n\tvel origin + length noise =>n\n\n\tdia fp op - length - 900. dia * * =d\n\t{\n\t\td color 2.0 1.5 n - * * *\n\t\tdur t - 3.0 * 0.0 1.0 clamp *\n\t\tfragcolor + =fragcolor\n\t} d 0.0 > dur t > and when\n\n\t\tltime\n\t\t\t10.0\n\t\t\t3.0\n\t\tdur 100.0 == select\n\t\torigin\n\t\tfp\n\tsmoke-trail\n;\n\n:m shape ( ltime:float origin:vec2 vel:vec2 spokes:int color:vec3 )\n\tspokes float =fs\n\ttau fs / =ai\n\n\t{ ( i )\n\t\t{ break } i spokes == when\n\t\t\tltime\n\t\t\torigin\n\t\t\t[\n\t\t\t\ti float ai * ltime +\n\t\t\t\t0.4 ltime 2179. * i 1 + float 2287.0 * ltime + sin 100.0 * + sin 0.03 * +\n\t\t\t]v polar-cart\n\t\t\tltime 571.0 * sin 0.5 * 3.0 +\n\t\t\tcolor\n\t\t\t0.03\n\t\tspark\n\t} 10 times\n\n\t{\n\t\t[ ltime fragCoord .x + 1187. * sin ltime fragCoord .y + 1447. * sin ]v 10.0 / dup noise * =off\n\t\t1.0 origin op - off - length - 0.0 1.0 clamp 15.0 / 2.0 time ltime - - * off length noise * =grey\n\t\t[ grey dup dup ]v fragcolor + =fragcolor\n\t} time ltime - 2.0 <= when\n;\n\n: firework ( ltime:float origin:vec2 xvel:float spokes:int color:vec3 )\n\t3.0 =fuse\n\tltime 389.0 * sin 0.03 * 1.1 + =speed\n\n\t[ xvel speed ]v =vel\n\n\ttime ltime - =>t\n\n\t\t{ ltime origin vel 100.0 color 0.03 spark }\n\t\t{\n\t\t\torigin vel gravity fuse t min derive-pos =fp\n\t\t\tltime 6.0 origin fp smoke-trail\n\t\t\tltime fuse + fp vel spokes color shape\n\t\t}\n\tt fuse <= if\n\n\t{\n\t\tfragcolor color 2.0 / 0.2 t fuse - - * + =fragcolor\n\t} t fuse - 0.2 <= t fuse >= and when \n;\n\nfragCoord .xy iResolution .xy / dup =np 2.0 * 1.0 - 1.5 * [ 1.0 iResolution .y.x / ]v * =op\n\n[ 0. 0. 0. ]v =fragcolor\n\n:m steps 3.0 ;\n:m buffertime 10.0 ;\n\n: frame ( to:float )\n\tiTime to + =time\n\t{ ( i )\n\t\ti float steps / time floor buffertime - + =it\n\n\t\t{\n\t\t\t\tit\n\t\t\t\t[ it 11. * sin 0.25 * -1.5 ]v\n\t\t\t\tit 19. * sin 0.1 *\n\t\t\t\t5.0 it 2311. * sin 1.0 + 5.0 2.0 / * + int\n\t\t\t\t[\n\t\t\t\t\tit 197. * 360. mod\n\t\t\t\t\tit 2267. * sin abs\n\t\t\t\t\t0.8\n\t\t\t\t]v hsv-rgb\n\t\t\tfirework\n\t\t} it 1493. * sin 0.95 > it 0.0 >= and when\n\t} steps buffertime * int times\n;\n\n0.0 frame\n\n[\n\tfragcolor\n\t[ 29. 255. / 8. 255. / 64. 255. / ]v np .x iTime 10.0 / + sin 0.1 * 1.0 + *\n\t[ 0.0 0.0 0.0 ]v\n\t1.0 np .y dup * - mix +\n\t1.0\n]v\n =fragColor\n*/\n\nvec3 fragcolor;\nfloat time;\nvec2 op;\nvoid smoke_trail(float, float, vec2, vec2);\nvoid frame(float);\nvec2 cart_polar(vec2);\nvec2 polar_cart(vec2);\nvec3 hsv_rgb(vec3);\nvec2 closest_point_line(vec2, vec2, vec2);\nfloat point_distance_line(vec2, vec2, vec2);\nvoid firework(float, vec2, float, int, vec3);\nvoid spark(float, vec2, vec2, float, vec3, float);\nvec2 derive_pos(vec2, vec2, vec2, float);\nvoid smoke_trail(float ltime, float duration, vec2 origin, vec2 fp) {\n\tvec2 var_4 = (vec2(sin(((ltime) + ((gl_FragCoord).x)) * 1187.0), sin(((ltime) + ((gl_FragCoord).y)) * 1447.0))) / 10.0;\n\tvec2 off = (var_4) * (((sin((((time) * 100.0) + ((var_4) * 211.0)) * ((cos(((gl_FragCoord).x) * 1489.0)) + (cos(((gl_FragCoord).y) * 1979.0))))) + 1.0) / 2.0);\n\tvec2 lp = closest_point_line(origin, fp, (op) - (off));\n\tfloat d = length((lp) - (op));\n\tfloat r = ((1.0 - ((length((lp) - (fp))) / (length((origin) - (fp))))) * ((clamp(length((lp) - (fp)), 0.0, 0.1)) * 30.0)) * (((duration) != 0.0) ? ((1.0 - (clamp(((time) - (ltime)) / (duration), 0.0, 1.0))) * 3.0) : 1.0);\n\tfloat gn = ((((sin((((time) * 100.0) + ((length(off)) * 211.0)) * ((cos(((gl_FragCoord).x) * 1489.0)) + (cos(((gl_FragCoord).y) * 1979.0))))) + 1.0) / 2.0) * 0.3) + 1.0;\n\tfloat grey = clamp((((clamp(0.1 - (d), 0.0, 1.0)) / 5.0) * (r)) * (gn), 0.0, 1.0);\n\tfragcolor = (vec3(grey, grey, grey)) + (fragcolor);\n}\nvoid frame(float to) {\n\ttime = (iTime) + (to);\n\tfor(int temp_2 = 0; temp_2 < int(30.0); ++temp_2) {\n\t\tfloat it = ((float(temp_2)) / 3.0) + ((floor(time)) - 10.0);\n\t\tif(((sin((it) * 1493.0)) > 0.95) && ((it) >= 0.0)) {\n\t\t\tfirework(it, vec2((sin((it) * 11.0)) * 0.25, -1.5), (sin((it) * 19.0)) * 0.1, int(5.0 + (((sin((it) * 2311.0)) + 1.0) * 2.5)), hsv_rgb(vec3(mod((it) * 197.0, 360.0), abs(sin((it) * 2267.0)), 0.8)));\n\t\t}\n\t}\n}\nvec2 cart_polar(vec2 p) {\n\treturn vec2(atan((p).y, (p).x), length(p));\n}\nvec2 polar_cart(vec2 p) {\n\treturn (vec2(cos((p).x), sin((p).x))) * ((p).y);\n}\nvec3 hsv_rgb(vec3 hsv) {\n\treturn (mix(vec3(1.0, 1.0, 1.0), clamp((abs((mod((((hsv).x) / 60.0) + (vec3(0.0, 4.0, 2.0)), 6.0)) - 3.0)) - 1.0, 0.0, 1.0), (hsv).y)) * ((hsv).z);\n}\nvec2 closest_point_line(vec2 a, vec2 b, vec2 point) {\n\tfloat h = clamp((dot((point) - (a), (b) - (a))) / (dot((b) - (a), (b) - (a))), 0.0, 1.0);\n\treturn (((b) - (a)) * (h)) + (a);\n}\nfloat point_distance_line(vec2 a, vec2 b, vec2 point) {\n\treturn length((point) - (closest_point_line(a, b, point)));\n}\nvoid firework(float ltime, vec2 origin, float xvel, int spokes, vec3 color) {\n\tfloat fuse = 3.0;\n\tfloat speed = ((sin((ltime) * 389.0)) * 0.03) + 1.1;\n\tvec2 vel = vec2(xvel, speed);\n\tif(((time) - (ltime)) <= (fuse)) {\n\t\tspark(ltime, origin, vel, 100.0, color, 0.03);\n\t} else {\n\t\tvec2 fp = derive_pos(origin, vel, vec2(0.0, -0.3), min(fuse, (time) - (ltime)));\n\t\tsmoke_trail(ltime, 6.0, origin, fp);\n\t\tfloat fs = float(spokes);\n\t\tfloat ai = 6.28318 / (fs);\n\t\tfor(int temp_4 = 0; temp_4 < 10; ++temp_4) {\n\t\t\tif((temp_4) == (spokes)) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tspark((ltime) + (fuse), fp, polar_cart(vec2(((float(temp_4)) * (ai)) + ((ltime) + (fuse)), 0.4 + ((sin((((ltime) + (fuse)) * 2179.0) + ((sin(((float((temp_4) + 1)) * 2287.0) + ((ltime) + (fuse)))) * 100.0))) * 0.03))), ((sin(((ltime) + (fuse)) * 571.0)) * 0.5) + 3.0, color, 0.03);\n\t\t}\n\t\tif(((time) - ((ltime) + (fuse))) <= 2.0) {\n\t\t\tvec2 var_12 = (vec2(sin((((ltime) + (fuse)) + ((gl_FragCoord).x)) * 1187.0), sin((((ltime) + (fuse)) + ((gl_FragCoord).y)) * 1447.0))) / 10.0;\n\t\t\tvec2 off = (var_12) * (((sin((((time) * 100.0) + ((var_12) * 211.0)) * ((cos(((gl_FragCoord).x) * 1489.0)) + (cos(((gl_FragCoord).y) * 1979.0))))) + 1.0) / 2.0);\n\t\t\tfloat grey = (((clamp(1.0 - (length(((fp) - (op)) - (off))), 0.0, 1.0)) / 15.0) * (2.0 - ((time) - ((ltime) + (fuse))))) * (((sin((((time) * 100.0) + ((length(off)) * 211.0)) * ((cos(((gl_FragCoord).x) * 1489.0)) + (cos(((gl_FragCoord).y) * 1979.0))))) + 1.0) / 2.0);\n\t\t\tfragcolor = (vec3(grey, grey, grey)) + (fragcolor);\n\t\t}\n\t}\n\tif(((((time) - (ltime)) - (fuse)) <= 0.2) && (((time) - (ltime)) >= (fuse))) {\n\t\tfragcolor = (fragcolor) + (((color) / 2.0) * (0.2 - (((time) - (ltime)) - (fuse))));\n\t}\n}\nvoid spark(float ltime, vec2 origin, vec2 vel, float dur, vec3 color, float dia) {\n\tfloat t = (time) - (ltime);\n\tvec2 fp = derive_pos(origin, vel, vec2(0.0, -0.3), t);\n\tfloat d = ((dia) - (length((fp) - (op)))) * (900.0 * (dia));\n\tif(((d) > 0.0) && ((dur) > (t))) {\n\t\tfragcolor = (((d) * ((color) * (2.0 * (1.5 - (((sin((((time) * 100.0) + ((length((vel) + (origin))) * 211.0)) * ((cos(((gl_FragCoord).x) * 1489.0)) + (cos(((gl_FragCoord).y) * 1979.0))))) + 1.0) / 2.0))))) * (clamp(((dur) - (t)) * 3.0, 0.0, 1.0))) + (fragcolor);\n\t}\n\tsmoke_trail(ltime, ((dur) == 100.0) ? 10.0 : 3.0, origin, fp);\n}\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n\tvec2 var_0 = ((fragCoord).xy) / ((iResolution).xy);\n\tvec2 np = var_0;\n\top = ((((var_0) * 2.0) - 1.0) * 1.5) * (vec2(1.0, ((iResolution).y) / ((iResolution).x)));\n\tfragcolor = vec3(0.0, 0.0, 0.0);\n\tframe(0.0);\n\tfragColor = vec4((fragcolor) + (mix((vec3(0.113725490196, 0.0313725490196, 0.250980392157)) * (((sin(((np).x) + ((iTime) / 10.0))) * 0.1) + 1.0), vec3(0.0, 0.0, 0.0), 1.0 - (((np).y) * ((np).y)))), 1.0);\n}\nvec2 derive_pos(vec2 p, vec2 v, vec2 a, float t) {\n\treturn ((p) + ((v) * (t))) + (((a) / 2.0) * ((t) * (t)));\n}\n","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"4ssXWH","date":"1400209774","viewed":457,"name":"Ides of May","username":"daeken","description":"Quick shaderforth fireworks","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["shaderforth","fireworks"],"hasliked":0,"parentid":"","parentname":""}}