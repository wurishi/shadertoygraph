{"ver":"0.1","info":{"id":"ss3yzr","date":"1655885314","viewed":194,"name":"Checkerboard filtering","username":"ghd3079","description":"Checkerboard with kernel filtering\n\nInspired by Inigo Quilez's blog (https://iquilezles.org/articles/checkerfiltering/)","likes":3,"published":1,"flags":0,"usePreview":0,"tags":["antialiasing","checkerboard","filtering"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"struct Ray\n{\n    vec3 origin;\n    vec3 dir;\n};\n\nfloat checker(vec2 p, float size)\n{\n    vec2 q = sign(fract(p / size *.5) - .5);\n    return .5 - .5*q.x*q.y;\n}\n\nvec2 tri(vec2 p)\n{\n    vec2 q = fract(p * .5) - .5;\n    return 1. - 2. * abs(q);\n}\n\nfloat checkerFilter(vec2 p, float size)\n{\n    vec2 q = p / size;\n    vec2 w = max(abs(dFdx(q)), abs(dFdy(q))) + .001;\n    vec2 i = (tri(q+0.5*w)-tri(q-0.5*w))/w;\n    return .5 - .5*i.x*i.y;\n}\n\nfloat sdPlane(vec4 plane, Ray ray)\n{\n    plane.xyz = normalize(plane.xyz);\n    return -(plane.w + dot(plane.xyz, ray.origin)) / dot(plane.xyz, ray.dir);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = (fragCoord/iResolution.xy - .5) * 2.;\n    uv.x *= iResolution.x / iResolution.y;\n\n    // camera & ray\n    vec3 camPos = vec3(5. * cos(iTime / 5.), 3., 5. * sin(iTime / 5.));\n    vec3 rayOrigin = camPos;\n    vec3 up = vec3(0., 1., 0.);\n    vec3 front = normalize(-camPos);\n    vec3 right = cross(up, front);\n    up = cross(front, right);\n    vec3 rayDir = normalize(up*uv.y + right*uv.x + front);\n    \n    Ray ray;\n    ray.origin = rayOrigin;\n    ray.dir = rayDir;\n    \n    // plane\n    vec4 plane = vec4(0., 1., 0., 0.);\n    float t = sdPlane(plane, ray);\n    if(0. < t)\n    {\n        vec3 arrival = ray.origin + t*ray.dir;\n        float checker = checker(arrival.xz, 2.0);      // without filtering\n        //float checker = checkerFilter(arrival.xz, 1.5);  // with filtering\n        fragColor = vec4(pow(checker, .5));\n    }\n}","name":"Image","description":"","type":"image"}]}