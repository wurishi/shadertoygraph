{"ver":"0.1","info":{"id":"tsjBRy","date":"1590324859","viewed":847,"name":"spinning ","username":"louis_C","description":"doodeling","likes":48,"published":1,"flags":40,"usePreview":0,"tags":["raymarching","sound"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"vec3 bl(vec2 uv){\n vec2 r  = iResolution.xy;\n    vec2 f = uv*r;\n    vec3 col = vec3(0.);\n    float bound = sqrt(64.);\n        for(float i = -.5*bound; i<=.5*bound; i++)\n        for(float j=-.5*bound; j<=.5*bound; j++)\n        {\n            col += texture(iChannel0,uv+vec2(i,j)*mix(3.,12.,2.*abs(uv.y-.5))*exp(-abs(1.e-2*length(f.xy)/r.y-.5))/max(bound, 1.)/r.xy).xyz;\n        }\n    col /= 64.;\nreturn col;\n}\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n   \n    vec2 uv = fragCoord/iResolution.xy;\n\n  \n    vec3 t = smoothstep(vec3(-0.05,-0.1,-0.05),vec3(1.,1.,0.95),bl(uv));\n    //vec3 t = texture(iChannel0,uv).xyz;\n    fragColor = vec4(t,1.);\n}","name":"Image","description":"","type":"image"},{"inputs":[],"outputs":[{"id":"4dXGR8","channel":0}],"code":"vec3 ov(vec3 a, vec3 b){\n    return mix(2.*a*b,1.-2.*(1.-a)*(1.-b),step(a,vec3(0.5)));}\nfloat rd(vec2 uv ) { return fract(sin(dot(floor(uv),vec2(84.266,95.248)))*4587.236);}\nfloat hs(vec2 uv ) { return fract(sin(dot((uv),vec2(84.266,95.248)))*4587.236+iTime*5.);}\nfloat no(vec2 uv) {vec2 e=vec2(1.,0.);float a =rd(uv);\n  float b=rd(uv+e.xy);\n  float c=rd(uv+e.yx);\n  float d=rd(uv+e.xx);\n  vec2 h = smoothstep(0.,1.,fract(uv));\n  return mix(mix(a,b,h.x),mix(c,d,h.x),h.y);}\nfloat it(vec2 uv){float r=0.;float amp = 0.5;\n  for(int i =0; i < 5 ; i++){r += no(uv/amp)*amp;\n    amp*=0.5;}return r;}\n    float rd(float uv ) { return fract(sin(dot(floor(uv),95.236))*4587.236);}\n    float no(float t){return mix(rd(t),rd(t+1.),smoothstep(0.,1.,fract(t)));}\n    float it(float uv){float r=0.;float amp = 0.5;\n  for(int i =0; i < 4 ; i++){r += no(uv/amp)*amp;\n    amp*=0.5;}return r;}\nmat2 rot(float t){float c= cos(t);float s=sin(t);return mat2(c,s,-s,c);}\nfloat box (vec3 p, vec3 b){\n  vec3 q = abs(p)-b;\n  return length(max(vec3(0.),q))+min(max(q.x,max(q.y,q.z)),0.);\n}\nfloat cyl( vec3 p, float h, float r )\n{\n  vec2 d = abs(vec2(length(p.xy),p.z)) - vec2(h,r);\n  return min(max(d.x,d.y),0.0) + length(max(d,0.0));\n}\nfloat mat = 0.;\nfloat mata = 0.;\nfloat lit = 0.;\nfloat map(vec3 p) {\n  vec3 p2 = p;\n  p2 = abs(p);\n  vec3 p3 = p+vec3(0.,0.5,0.);\n  for (int i = 0 ;  i < 5 ; i ++ ) {\n    p3 -=0.2;\n    p3.xy *= rot (it(iTime*0.2)*10.);\n    p3.xz *= rot (it(iTime*0.2+15.236)*10.);\n    p3 = abs(p3);\n   \n  }\n  vec3 rp4 = vec3(0.8,0.,2.);\n  vec3 p4 = mod(p+vec3(-0.2,-1.9,0.)+0.5*rp4,rp4)-0.5*rp4;\n\n  float c1 = box(p2+vec3(0.,0.,-6.),vec3(6.,3.5,1.));\n  float c2 = box(p2+vec3(-5.,0.,0.),vec3(1.,3.5,6.));\n  float c3 = box(p2+vec3(0.,-3.-step(0.5,fract(p.x*5.))*0.2,0.),vec3(6.5,1.,6.5));\n  float c4 = length(p3)-0.2;\n  float c5 = box(p3,vec3(0.2));\n  float c6 = mix(c4,c5,smoothstep(0.7,1.,fract(iTime*2.5)));\n   \n  float sa = min(min(c1,c2),c3);\n  float el1 = box(p4,vec3(0.1,0.05,0.8));\n  float sf = min(sa,el1);\n\n  mat = c6;\n  mata = el1;\n\n  lit += 0.05/(0.05+el1); \n  return min(sf,c6);\n}\nvec3 nor (vec3 p) { vec2 e = vec2 (0.01,0.); return normalize(map(p)-vec3(map(p-e.xyy),map(p-e.yxy),map(p-e.yyx)));}  \nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord/iResolution.xy;\n    float time = iTime;\n    uv -= 0.5;\n  uv *=2.;\n  uv *= vec2(iResolution.x /iResolution.y, 1);\n  float t = (it(time*0.1)-0.5)*30.+time*0.1;\n\n  vec3 e = vec3(0.,-0.5,-3.5);\n  vec3 r = normalize(vec3(uv,1.6));\n  e.xz *= rot(t);\n  r.xz *= rot(t);\n  \nvec3 col = vec3(0.);\n  vec3 p = e;\n   float prod = 1.;\n  float dd = 0.;\n  float cli = mix(0.,1.,smoothstep(0.1,0.5,it(time*8.)));\n  for(int i = 0 ; i < 64 ; i ++ ){\n    float d = map(p);\n    if(dd>64.){dd=64.;break;}\n    if(d<0.001){\n        vec3 n = nor(p);\n      float br =smoothstep(0.1,0.,mat);\n      float pla =smoothstep(0.06,0.,mata)*smoothstep(-0.5,0.2,mata);\n      float lite = lit;\n      float li = (smoothstep(2.5,0.,mata)*0.5+smoothstep(0.5,0.,mata)*0.6)*smoothstep(0.,0.05,mata);\n      float bao = map(p+n);\n      float ao = mix(0.1,1.,smoothstep(-1.8,0.4,bao))*mix(0.95,1.,smoothstep(0.,1.,bao));\n      float ao2 = smoothstep(0.2,1.,bao);\n      float ao3 = smoothstep(0.,0.1,bao);\n      float sol = smoothstep(-2.,-1.97,p.y);\n      float plaf = smoothstep(2.,1.97,p.y);\n        float flati = smoothstep(-2.,-0.5,p.y);\n       vec3 bb = mix(vec3(0.07)*ao,mix(vec3(0.08,0.09,0.09),vec3(0.11,0.11,0.13),flati)*ao,sol*plaf);\n       float bs = clamp(dot(n,-r),0.,1.);\n       float spec = smoothstep(0.995,1.,bs)*ao2;\n      vec3 hb = mix(3.*(1.-2.*fract(bs*2.+vec3(0.,-1./3.,1./3.)))-1.,vec3(0.5),mix(0.6,1.,bs))+(1.-ao3)*0.8;\n      vec3 n2 = abs(n);\n      float bm = mix(it(p.xy)-it(p.xy+vec2(0.,0.01)),it(p.zy)-it(p.zy+vec2(0.,0.01)),n2.x);\n      col += (li*0.2*mix(0.9,1.,ao3)*mix(0.5,1.,plaf)+bm*0.5);\n      col += (pla*mix(vec3(0.8,0.7,0.6),vec3(1.),bs));\n      col += spec*br*ao2;\n      col += lite*0.01*cli;\n      col *=cli;\n      col += prod *bb*mix(vec3(1.),hb,br);\n      col = clamp(col,0.,1.);\n      \n     prod *=br*mix(0.1,1.,ao2)+(1.-sol)*(it(p.xz)*hs(p.xz)*0.03*ao);\n     //prod *=0.01;\n    if(prod<0.01){break;}\n    r = reflect(r,n);\n    d = 0.01;\n    }\n    \n    p += r*d;\n    dd +=d;\n  }\n \tvec3 colf = ov(col,mix(vec3(hs(uv),hs(uv),hs(uv)),vec3(0.5),0.97));\n    fragColor = vec4(colf,1.);\n}","name":"Buffer A","description":"","type":"buffer"},{"inputs":[],"outputs":[],"code":"float rd(float t) { return fract(sin(dot(floor(t),45.236))*4587.236);}\nfloat no(float t) {return mix(rd(t),rd(t+1.),smoothstep(0.,1.,fract(t)));}\nfloat it(float t){float r=0.;float amp= 0.5;\n for(int i =0; i < 4 ; i++){r += no(t/amp)*amp;\n    amp*=0.5;}return r;}\nvec2 mainSound( in int samp, float time )\n{\n    // A 440 Hz wave that attenuates quickly overt time\n     float bar = sin(pow(no(time*10000.)*it(time*0.2),sqrt(fract(time*2.5))));\n    float vt = it(time*100.)*distance(it(time*0.1),0.5);\n    return vec2( bar*0.2+vt);\n}","name":"Sound","description":"","type":"sound"}]}