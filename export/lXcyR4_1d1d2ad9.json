{"ver":"0.1","renderpass":[{"outputs":[{"channel":0,"id":"4dfGRr"}],"inputs":[],"code":"#define rot(a) mat2(cos(a + vec4(0, 3, 1, 0) * pi / 2.))\n#define H(a) fract(sin(dot(a, vec2(27.69, 32.47))) * 4375.5457)\n#define car(p) length(max(abs(p) - vec2(.16, .08), .0))\n#define t iTime\n#define pi acos(-1.)\n#define tau (pi * 2.)\n#define scale 1.59;\n\nvec4 draw( vec4 o, vec2 u, \n           float bID, float aID, \n           vec4 obj){\n           \n    float px = fwidth(u.x);\n\n    // car col\n    vec4 c1 = mod(aID, 3.) == 0. \n                ? vec4(.8, .4, .1, 0) : vec4(1);\n\n    vec4 c2 = mod(bID, 3.) == 0. \n                ? vec4(.6, .6, 0, 0) : vec4(.4);\n    \n    // bg\n    o = vec4(.025);\n    o = mix(o, o * .55, smoothstep(px, -px, abs(obj[0]) - .175));\n    \n    // road\n    float d = 80. * min(obj[1], obj[2]);\n    o = mix(o, o * .65, smoothstep(.05 + px, -px, obj[3] - .075));\n    o = mix(\n            o,\n            vec4(3, 4, 5, 0) / 40. \n                * d / (1. + d)\n                * (.08 * cos(4. * d) + 1.),\n            smoothstep(px, -px, obj[3])\n        );\n\n    // track1\n    o = mix(o, c1, smoothstep(px, -px, obj[1]));\n\n    // track2\n    o = mix(o, c2, smoothstep(px, -px, obj[2]));\n    \n    // posprod\n    return pow(o, vec4(.4545));\n}\n\nvoid truchet(vec2 u, out float d, out vec2 p, out vec2 id){\n    id = floor(u),\n     p = fract(u) - .5;\n          \n    if(H(id) > .5) \n        p.x = -p.x;\n        \n    d = min(length(p + .5), length(p - .5)) - .5;\n    p -= sign(p.x + p.y + .001) * .5;\n}\n\nvoid mainImage(out vec4 o, vec2 u) {\n    vec2 r = iResolution.xy;\n    u = (u - r / 2.) / r.y + tanh(vec2(cos(.3 * t), sin(.2 * t)) * 3.) * 2.4;\n    \n    vec4 obj;\n    vec2 p, id;\n\n    // bg\n    truchet(u * 10., obj[0], p, id);\n\n    // road\n    truchet(u, obj[3], p, id);\n    obj[3] = abs(obj[3]) - .15;\n    \n    // cars in road coord\n    float checker = mod(id.x + id.y, 2.) * 2. - 1.;\n    \n    p = vec2(\n            3. * checker * atan(p.x, p.y) / pi,\n            length(p) * 2. - .5\n        );\n    \n    if(H(id) < .5 ^^ checker > 0.)  p.y = 1. - p.y;\n\n    float a = p.x + .25 * cos(t * 7. + 7. * H(vec2(floor(p.x + 1.), floor(p.x))));// + t * 1.2;\n    float b = p.x - t * .4;\n    \n    obj[1] = car(vec2(fract(a) - .5 , p.y - .35)           );\n    obj[2] = car(vec2(fract(b) - .5, p.y - .65));\n    \n    // draw\n    o = draw(o, u, floor(b), floor(a), obj);\n    \n    if(iMouse.z > 0.)\n        o = mix(o, vec4(1, 0, 0, 0), checker * .1);\n}","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"lXcyR4","date":"1734777722","viewed":64,"name":"square truchet - conveyor belt","username":"Elsio","description":"Houve uma tentativa de fazer o mesmo com hexagonos https://www.shadertoy.com/view/l33yRH mas ainda sem muito sucesso. \n","likes":13,"published":1,"flags":0,"usePreview":0,"tags":["truchet","fork","detail"],"hasliked":0,"parentid":"M3dyRH","parentname":"Polar truchet - road 2 tracks"}}