{"ver":"0.1","info":{"id":"4sffRl","date":"1497391350","viewed":669,"name":"bump mapping","username":"adambene","description":"Bump mapping with directional and omnidirectional lighting.\nDirectional light comes in blue from the top left.\nClick anywhere to move the yellow omni light.","likes":19,"published":1,"flags":0,"usePreview":0,"tags":["bump","bumpmapping"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4sXGRn","filepath":"/media/a/95b90082f799f48677b4f206d856ad572f1d178c676269eac6347631d4447258.jpg","previewfilepath":"/media/ap/95b90082f799f48677b4f206d856ad572f1d178c676269eac6347631d4447258.jpg","type":"texture","channel":1,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4sf3Rr","filepath":"/media/a/ad56fba948dfba9ae698198c109e71f118a54d209c0ea50d77ea546abad89c57.png","previewfilepath":"/media/ap/ad56fba948dfba9ae698198c109e71f118a54d209c0ea50d77ea546abad89c57.png","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define PI 3.141592654\n#define t iTime\n#define light_height_dir 2.\n#define light_height_omni 1.5\n#define ambient .4\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 uv = fragCoord.xy / iResolution.xy;\n\n    float p = 1. / iResolution.x,\n          c = length(texture(iChannel0, uv).rgb),\n         cu = length(texture(iChannel0, uv + vec2(0, p)).rgb),\n         cr = length(texture(iChannel0, uv + vec2(p, 0)).rgb);\n    \n    vec3 n = normalize(cross(vec3(0, p, cu - c), vec3(p, 0, cr - c))),\n         l_dir = - normalize(vec3(\n             sin(-PI/4.),\n             cos(-PI/4.),\n             light_height_dir\n         )),\n    \t l_omni = vec3(\n             .5 + .5 * sin(t + PI),\n             .5 + .5 * cos(t + PI),\n             light_height_omni\n         );\n\n    if (iMouse.w > .5) {\n        // l_dir  = - normalize(vec3(vec2(.5, .5) - iMouse.xy / iResolution.xy, light_height_dir));\n        l_omni = vec3(iMouse.xy / iResolution.xy, light_height_omni);\n    }\n    \n    vec3 d = vec3(uv, 0) - l_omni;\n\n    // diffuse + ambient lights\n    vec4 color = 1. * vec4(.3, .3, 1., 0.) * dot(n, l_dir) + ambient\n               + 2. * vec4(1., 1., .3, 0.) * dot(n, normalize(d)) / (dot(d, d));\n    \n    if (length(uv-l_omni.xy) < .02) {\n    \tfragColor = vec4(1., 1., .3, 0.);\n        return;\n    }\n\t\n    fragColor = color * texture(iChannel1, uv);\n}","name":"Image","description":"","type":"image"}]}