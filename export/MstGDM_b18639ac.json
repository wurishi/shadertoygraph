{"ver":"0.1","info":{"id":"MstGDM","date":"1450216250","viewed":619,"name":"first raymarching test","username":"RenoM","description":"getting into 3d...","likes":26,"published":1,"flags":0,"usePreview":0,"tags":["raymarchingnoise"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4df3Rr","filepath":"/media/a/3871e838723dd6b166e490664eead8ec60aedd6b8d95bc8e2fe3f882f0fd90f0.jpg","previewfilepath":"/media/ap/3871e838723dd6b166e490664eead8ec60aedd6b8d95bc8e2fe3f882f0fd90f0.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[],"code":"#define EPS .003\n\nfloat fbm(vec3 p)\n{\n    p /= 50.;\n    mat2 m = mat2(.8,.6,-.6,.8);\n    vec2 q = p.xy + p.z + iTime / 1000.;\n    float f = .5 * texture(iChannel0, q).x; q *= m * 2.02;\n    f += .25 * texture(iChannel0, q).x; q *= m * 2.04;\n    f += .125 * texture(iChannel0, q).x; q *= m * 2.03;\n    f += .0625 * texture(iChannel0, q).x;\n    return f / .9375;\n}\n\nfloat map(vec3 p)\n{\n    float r = .8 + .2 * fbm(.5*p*fbm(p));\n\treturn length(p) - r;\n}\n\nvec3 normal(vec3 p)\n{\n    vec2 q = vec2(0, EPS);\n    return normalize(vec3(map(p + q.yxx) - map(p - q.yxx),\n                          map(p + q.xyx) - map(p - q.xyx),\n                          map(p + q.xxy) - map(p - q.xxy)));\n}\n\nvec3 shade(vec3 p, vec3 lp)\n{\n    vec3 n = normal(p),\n         rd = normalize(lp - p);\n    float f = max(.04, dot(n, rd));\n    return f * vec3(.3,.34,.13);\n}\n\nfloat march(vec3 ro, vec3 rd)\n{\n    float d, t = .0;\n    for(int i = 0; i < 64; i++)\n    {\n        d = map(ro + t * rd);\n        if(d < EPS || t > 10.) break;\n        t += d * .5;\n    }\n    return t;\n}\n\nvoid mainImage( out vec4 O, in vec2 U )\n{\n    vec2 R = iResolution.xy,\n         p = tan(.5236) * (U+U-R) / R.y;\n    \n    vec3 ro = vec3(0,0,-2),\n         rd = normalize(vec3(p,1)),\n         lp = vec3(2,7,-2);\n    \n    float t = march(ro, rd);\n    \n    vec3 c = shade(ro + t * rd, lp);\n    c *= 7. /  (1.+t*t);      \n    O.xyz = clamp(c,.0,1.);\n}","name":"","description":"","type":"image"}]}