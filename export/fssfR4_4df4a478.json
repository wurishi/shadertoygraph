{"ver":"0.1","info":{"id":"fssfR4","date":"1646423691","viewed":93,"name":"Mise en abyme+Thales","username":"natnatnat","description":"Mise en abyme+Thales (wip)","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["circles"],"hasliked":0,"parentid":"ftyXWy","parentname":"j2d"},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"const float PI = 3.14;\nconst float E = 2.71;\nconst float R0 = E/PI;\nconst vec4 B = vec4(0., 0., 0., 1.);\nconst vec2 C0 = vec2(0., 0.);\nconst float thickness = 0.003;\nconst float EDG0 = 0.002;\n\nvec2 rotZ(vec2 P, float A) {\n    float C = cos(A);\n    float S = sin(A);\n    vec2 FP = mat2(C, -S, S, C) * P;\n    return FP;\n}\n\nvec4 draw(vec2 U, float R, float A, vec2 C, int Z) {\n    float r = distance(U, C);\n\n    bool L = Z % 3 == 0;\n    //float EDG = EDG0/(float(Z) + 1.);\n    float EDG = EDG0;\n    vec2 PC = vec2(R * cos(A) + C.x, R * sin(A) + C.y);\n    vec2 PA = vec2(C.x - R, C.y);\n    vec2 PB = vec2(C.x + R, C.y);\n\n    vec3 CC = vec3(1. - smoothstep(thickness, thickness + EDG, abs(R - r)));\n    vec2 U1 = rotZ(vec2(U.x - PB.x, U.y - C.y), A/2.);\n    vec3 LC1 = vec3(1. - smoothstep(thickness, thickness + EDG, abs(U1.x)));\n    vec2 U2 = rotZ(vec2(U.x - PA.x, U.y - C.y), (A - PI)/2.);\n    vec3 LC2 = vec3(1. - smoothstep(thickness, thickness + EDG, abs(U2.x)));\n    vec3 LC3 = vec3(1. - smoothstep(thickness, thickness + EDG, abs(U.y - C.y)));\n\n    vec4 O = vec4(CC, 1.);\n    if (L) {\n        O += vec4(LC1, 1.) + vec4(LC2, 1.) + vec4(LC3, 1.);\n    }\n\n    return O;\n}\n\nvoid mainImage( out vec4 O, in vec2 u )\n{\n    vec2 Res = iResolution.xy;\n    vec2 U = ( 2. * u - Res.xy ) / Res.y;\n    O = vec4(0.);\n    float A = mod(iTime * E/PI + PI/2., 2. * PI);\n\n    //TODO: loop fake z\n    //U = U + (1./2.) * vec2(R0 * cos(A), R0 * sin(A));\n    //U *= 100./pow(iTime, 2.);\n\n    O += draw(U, R0, A, C0, 0);\n\n    float A2 = mod(A/2., PI/2.);\n    float NR = R0;\n    float PR = R0;\n    vec2 NC = C0;\n    vec2 PC;\n    for(int i=1; i < 5; i++) {\n        PR = NR;\n        PC = NC;\n        NR = (PR * (sin(A2) + cos(A2) - 1.));\n        float S = A < PI ? 1. : -1.;\n        NC = vec2(S * PR *(cos(A2) - sin(A2)) + PC.x, S * NR + PC.y);\n        O += float(i+1) * 0.9 * draw(U, NR, A, NC, i);\n    }\n}","name":"Image","description":"","type":"image"}]}