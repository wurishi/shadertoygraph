{"ver":"0.1","info":{"id":"Wd2XDm","date":"1554059382","viewed":310,"name":"(RE)fractor","username":"fabiovergani","description":"descent, refactor","likes":13,"published":1,"flags":0,"usePreview":0,"tags":["fract"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"/*\noriginal by mathmasterzach in 2018-09-28\nhttps://www.shadertoy.com/view/4tGczc\nrefactor by fabiovergani 2019-03-31\nhttps://www.shadertoy.com/view/Wd2XDm\n*/\n\nvec2 g(float n){\n\treturn vec2(\n\t\t  .01*sin(n*40.)+.03*sin(n*13.),\n\t\t  .03*cos(n*21.)+.08*cos(n*3.)+1.*n\n\t );\n}\n\nfloat f(vec3 p,int l){\n\t vec2 q=g(p.z);\n\t float m,s=1.,t=-max(abs(p.x+q.x),abs(p.y+q.y));\n\t p=fract(p)-.5;\n\t for(int i=1;i<l;++i){\n\t\t  s*=m=dot(p,p)*.7;\n\t\t  p/=m;\n\t\t  p.xy=fract(p.xy)-.5;\n\t\t  p=p.yzx;\n\t }\n\t s=clamp(.5+.5*((m=min(m,(length(p)-1.)*s))-t)/.05,.0,1.);\n\t return mix(t,m,s)+s*(1.-s)*.05;\n}\n\nfloat h(vec3 p){\n\t return min(\n\t\t  (\n\t\t\t\tmax(\n\t\t\t\t\t f(p,11),\n\t\t\t\t\t (\n\t\t\t\t\t\t  p.xy+=g(p.z),\n\t\t\t\t\t\t  .012-max(abs(p.x),abs(p.y))\n\t\t\t\t\t )\n\t\t\t\t)\n\t\t  ),\n\t\t  (\n\t\t\t\tp.y+=.01,\n\t\t\t\tmax(abs(p.x),abs(p.y))-.001\n\t\t  )\n\t );\n}\n\nvoid mainImage(out vec4 fragColor,in vec2 fragCoord){\n\n\t vec2 M=iMouse.xy,R=iResolution.xy,u=2.*(fragCoord/R)-1.;\n\n\t float c,X=M.x,Y=M.y,x=R.x,y=R.y,i=X/x,j=Y/y,l=128.+i*j,t=iTime/20.;\n\n\t R=vec2(i,j)*10.;\n\t u.x*=x/y;\n\n\t vec3 p=vec3(c,.1,c),\n\t o=vec3(-g(t),t),\n\t n=normalize(o),\n\t q=normalize(cross(n,p)),\n\t r=vec3(u.xy,1.5);\n\n\t vec4 k=vec4(1.,.6,.3,3.);\n\n\t p=vec3(R.x,R.y,c);\n\t r.yz*=mat2(c=cos(x=p.y),y=sin(x),-y,c);\n\t r.xy*=mat2(c=cos(x=p.z),y=sin(x),-y,c);\n\t r.xz*=mat2(c=cos(x=p.x),y=sin(x),-y,c);\n\n\t r=mat3(q,cross(q,n),n)*normalize(r);\n\n\t c=47.;\n\t M=vec2(i=t=.0,y=.0001);\n\t while(i<l){\n\t\t  if(x=h(p=o+r*t),x<y){break;};\n\t\t  t+=x*.5;\n\t\t  j=++i;\n\t };\n\t x=dot(\n\t\t  -r,\n\t\t  normalize(\n\t\t\t\tvec3(\n\t\t\t\t\t (r=M.yxx,h(p+r)-h(p-r)),\n\t\t\t\t\t (r=M.xyx,h(p+r)-h(p-r)),\n\t\t\t\t\t (r=M.xxy,h(p+r)-h(p-r))\n\t\t\t\t)\n\t\t  )\n\t )*.5+c*.01;\n\t fragColor=vec4(\n\t\t  mix(\n\t\t\t\tmix(\n\t\t\t\t\t n=k.xxx,\n\t\t\t\t\t clamp(abs(fract((c*f(p,6))+k.xyz)*6.-k.www)-n,.0,1.),\n\t\t\t\t\t 1.\n\t\t\t\t)*(x+pow(x,c)),\n\t\t\t\tr,\n\t\t\t\tj/l\n\t\t  ),1.\n\t );\n}","name":"Image","description":"","type":"image"}]}