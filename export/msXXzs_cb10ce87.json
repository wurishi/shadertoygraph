{"ver":"0.1","info":{"id":"msXXzs","date":"1669390841","viewed":303,"name":"[phreax] highway to hyperspace","username":"phreax","description":"Folding space for fun and profit.\n\nFractal version on https://www.shadertoy.com/view/dslSRf","likes":25,"published":1,"flags":96,"usePreview":0,"tags":["fft","spiral","multipass","zucconi"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n \n    vec2 uv = fragCoord.xy / iResolution.xy;\n\n    vec3 col = texture(iChannel0, uv).rgb;\n    \n    \n    fragColor = vec4(col, 1);\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"ltBXWm","filepath":"https://soundcloud.com/desert-trax/porangui-suenos-de-la-selva-2?si=d9d7eae009f64d008e572bc623f2e88d&utm_source=clipboard&utm_medium=text&utm_campaign=social_sharing","previewfilepath":"https://soundcloud.com/desert-trax/porangui-suenos-de-la-selva-2?si=d9d7eae009f64d008e572bc623f2e88d&utm_source=clipboard&utm_medium=text&utm_campaign=social_sharing","type":"musicstream","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":0}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"#define PI 3.141592\n#define TAU 2.*PI\n#define hue(v) ( .6 + .6 * cos( 6.3*(v) + vec3(0,23,21) ) )\n#define SIN(x) (sin(x)*.5+.5)\n#define BEND .8     \n#define rot(a) mat2(cos(a), sin(a), -sin(a), cos(a))\n#define COUNT 120.\n#define DISTORT 1.5\n#define COLOR 1.\n#define SPIRAL 3.\n\n//#define WATERCOLOR\n#define FFT 1.\n\n\nfloat tt, bass;\n\n// zucconis spectral palette https://www.alanzucconi.com/2017/07/15/improving-the-rainbow-2/\nvec3 bump3y (vec3 x, vec3 yoffset)\n{\n    vec3 y = 1. - x * x;\n    y = clamp((y-yoffset), vec3(0), vec3(1));\n    return y;\n}\n\nfloat bassFFT() {\n    int bandLimit = 5;\n    \n    float avg = 0.;\n    for(int i=0; i<bandLimit; i++) {\n        avg += texelFetch(iChannel1, ivec2(i, 0), 0).x;\n    }\n    return avg/float(bandLimit);\n}\n\n\nvec3 spectral_zucconi6(float x) {\n    x = fract(x);\n    const vec3 c1 = vec3(3.54585104, 2.93225262, 2.41593945);\n    const vec3 x1 = vec3(0.69549072, 0.49228336, 0.27699880);\n    const vec3 y1 = vec3(0.02312639, 0.15225084, 0.52607955);\n    const vec3 c2 = vec3(3.90307140, 3.21182957, 3.96587128);\n    const vec3 x2 = vec3(0.11748627, 0.86755042, 0.66077860);\n    const vec3 y2 = vec3(0.84897130, 0.88445281, 0.73949448);\n    return bump3y(c1 * (x - x1), y1) + bump3y(c2 * (x - x2), y2) ;\n}\n\n\nfloat triangle(vec2 uv, float w, float blur) {   \n  int N = 3;\n\n  // Angle and radius from the current pixel\n  float a = atan(uv.x,uv.y)+PI;\n  float r = TAU/float(N);\n\n  // Shaping function that modulate the distance\n  float d = 1.-cos(floor(.5+a/r)*r-a)*length(uv);\n  return smoothstep(blur, .0, abs(d)-w)*(0.4/blur);\n}\n\nvec3 spiral(vec2 uv, float z) {  \n\n    uv *= rot((z*TAU-.2*tt)*(SPIRAL*.3));\n\n    float soundMod = bass*FFT*(3.*sqrt(z)+.2);\n    float dist = DISTORT * sin(.5*PI+iMouse.x/640.*2.*PI);\n    uv *= 1.3*dist*sin(vec2(5)*uv.yx+.8*tt);\n\n    float blur = exp(-19.*z);\n    float luma = exp(-22.5*z);\n    return triangle(uv, 0.05, blur)*spectral_zucconi6(fract(2.*z+.2*tt+uv.x*.2+.4*bass*sqrt(z)*2.*FFT))*luma;\n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n \n    vec2 uv = (fragCoord - .5*iResolution.xy)/iResolution.y;\n\n    vec3 col = vec3(0);\n    vec4 tex = texture(iChannel0, fragCoord/iResolution.xy);\n    if (tex.a != iResolution.x) tex = vec4(0);\n    tt = iTime*.2;\n    \n    bass = bassFFT();\n\n    uv = abs(uv)-.15;\n    uv *= rot(2./8.*PI);\n    uv = abs(uv)-.15;\n  \n    uv *= 15.;\n\n    float s = 1./COUNT;\n    \n    for(float i=0.; i<1.; i+=s) {   \n        float z = fract(i-.1*tt);\n        float fade = smoothstep(1., .9, z);\n        vec2 UV = uv;\n        col += spiral(UV*z, z)*fade;\n        \n    }\n    col = pow(col, vec3(0.5));\n    #ifdef WATERCOLOR\n    col = 1.05-col;\n    col = pow(col, vec3(2.2));\n    col = clamp(col, vec3(0), vec3(1));\n    #endif\n    col = mix(col, tex.rgb, 0.9);\n    \n   \n   \n    // Output to screen\n    fragColor = vec4(col, iResolution.x);\n}","name":"Buffer A","description":"","type":"buffer"}]}