{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[],"code":"// monkey saddle by joates (Nov-2014)\n// see http://mathworld.wolfram.com/MonkeySaddle.html\n\n#define IS_BOXED\nconst float size = 0.45;\n\nfloat map( in vec3 p )\n{\n\t#ifdef IS_BOXED\n\t    vec3  d = abs(p) - size;\n\t\tfloat d1 = min(max(d.x,max(d.y,d.z)),0.0) + length(max(d,0.0));\n    #else\n\t    // sphere\n\t    float d1 = length(p) - size;\n    #endif\n\n    // saddle\n    float d2 = p.y*size - (p.x*p.x*p.x - 3.0*p.x*p.z*p.z);\n\n    return max(d1,d2);\n}\n\nvec3 calcNormal( in vec3 p ) {\n    vec2 e = vec2( 0.0001, 0.0 );\n    return normalize( vec3( map( p + e.xyy ) - map( p - e.xyy ),\n                            map( p + e.yxy ) - map( p - e.yxy ),\n                            map( p + e.yyx ) - map( p - e.yyx ) ) );\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n\tvec2 uv = -1.0 + 2.0*(fragCoord.xy/iResolution.xy);\n\tuv.x *= iResolution.x/iResolution.y;\n\n\tfloat time = iTime*0.1;\n\n    // view origin & direction\n\tvec3 ro = vec3( size );\n\tvec3 tp = vec3( 0.0 );\n    tp.y = -0.25*size;\n\n    // camera orbit\n    float m = iMouse.x * 0.02;\n    ro.x = cos(time+m)*length(ro);\n    ro.z = sin(time+m)*length(ro);\n\n    vec3 lit = vec3( 0.5773 );\n    vec3 col = vec3( 0.0 );\n    \n    // camera view\n\tvec3 cw = normalize( tp-ro );\n\tvec3 cp = vec3( 0.0, 1.0, 0.0 );\n\tvec3 cu = normalize( cross(cw, cp) );\n\tvec3 cv = normalize( cross(cu, cw) );\n\tvec3 rd = normalize( uv.x*cu + uv.y*cv + 1.5*cw );\n\n    float tmax = 200.0;\n    float h = 1.0;\n    float t = 0.0;\n    for( int i = 0; i < 100; i++ ) {\n        if( h < 0.0001 || t > tmax ) break;\n        h = map( ro + t*rd );\n        t += h;\n    }\n\n    if ( t < tmax ) {\n        vec3 pos = ro + t*rd;\n       \tvec3 nor = calcNormal( pos );\n\n       \tcol  = vec3( 1.0, 0.8, 0.5 ) * clamp( dot( nor, lit ), 0.0, 1.0 );\n       \tcol += vec3( 0.2, 0.3, 0.4 ) * clamp( nor.y, 0.0, 1.0 );\n       \tcol += vec3( 0.1, 0.1, 0.3 );\n    }\n        \n    fragColor = vec4( col, 1.0 );\n}","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"XsBXW3","date":"1416325735","viewed":195,"name":"monkey saddle","username":"joates","description":"raymarching a parametric surface. (rotate with mouse click+drag) if you comment out line #4 it looks a bit more like a (bicycle) saddle !!","likes":5,"published":1,"flags":0,"usePreview":0,"tags":["surface","parametric","monkey","saddle"],"hasliked":0,"parentid":"","parentname":""}}