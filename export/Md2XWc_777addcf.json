{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[{"channel":0,"type":"cubemap","id":"XsfGzn","filepath":"/media/a/585f9546c092f53ded45332b343144396c0b2d70d9965f585ebc172080d8aa58.jpg","sampler":{"filter":"linear","wrap":"clamp","vflip":"false","srgb":"false","internal":"byte"}}],"code":"// reference: http://www.photon.at/~werner/bh/gvsim.html\n\nvec3 bh=vec3(0.0);\nfloat bh_M=1.;\n\nvec3 eye=vec3(0.,0.,10.);\nvec3 up=vec3(0.,1.,0.);\nmat3 cam_mat;// camera -> world\nfloat tan_half_vfov=1.0;\n\nvoid setupCamera()\n{\n\tvec3 n=normalize(eye-bh);\n\tvec3 s=normalize(cross(up,n));\n\tvec3 t=cross(n,s);\n\tcam_mat[0]=s;\n    cam_mat[1]=t;\n    cam_mat[2]=n;\n}\n\nvec3 rot_y(vec3 v,float theta)\n{\n    float s=sin(theta),c=cos(theta);\n    return vec3(c*v.x+s*v.z,v.y,c*v.z-s*v.x);    \n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    setupCamera();\n    \n    vec2 iplane_size=2.*tan_half_vfov*vec2(iResolution.x/iResolution.y,1.);\n    vec2 ixy=(fragCoord.xy/iResolution.xy - 0.5)*iplane_size;\n    vec3 ray_dir=cam_mat*normalize(vec3(ixy.x,ixy.y,-1.));   \n   \n\tvec3 h2e=eye-bh; float l2_h2e=dot(h2e,h2e);\n    float d=length(cross(ray_dir,h2e));\n\tif(d>3.*bh_M)\n    {\n        // closest point\n        vec3 cp= eye+ray_dir*sqrt(l2_h2e-d*d);\n\t\t// bend\n\t\tfloat alpha=4.*bh_M/d;\n        ray_dir=normalize(ray_dir+tan(alpha)*normalize(bh-cp));\n        \n        fragColor=texture(iChannel0,rot_y(ray_dir,-0.2*iTime));\n    }\n    else\n        fragColor=vec4(0.);\n}","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"Md2XWc","date":"1416815948","viewed":711,"name":"a black hole","username":"jun","description":"lensing effect","likes":4,"published":1,"flags":0,"usePreview":0,"tags":["raytrace","gravitationallensing"],"hasliked":0,"parentid":"","parentname":""}}