{"ver":"0.1","info":{"id":"MttSWM","date":"1480297965","viewed":2091,"name":"image->neural net->glsl","username":"public_int_i","description":"neural net as 2d function","likes":15,"published":1,"flags":0,"usePreview":0,"tags":["image","neuralnet","gls"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"//Ethan Alexander Shulman 2016\n\n//I trained a small neural network(2 input neurons(screen position), 16 hidden sigmoid neurons, 3 output neurons(rgb pixel color)\n//on Bob Ross's painting http://usatunofficial.files.wordpress.com/2012/07/bob-ross.jpg\n\n//Trained in 10 minutes on a single CPU thread.\n\n//Here's the C# code used to generate the neuralNet function \n//https://bitbucket.org/Ethanss/ethans-neural-network/src/7c2411452b641b174284f3ff3b2079302d26999b/examples/ImageAsGLSL.cs?at=master&fileviewer=file-view-default\n\n\n\n\nfloat sigmoid(float val) {\n    return 1.0/(1.0+exp(-val));\n}\nfloat cclamp(float a, float b, float c) {\n    float v = clamp(a,b,c);\n    return step(v,v)*v;\n}\n\n\nvec3 neuralNet(vec2 uv) {float v15 = cclamp(sigmoid(5.411831+uv.y*-11.91184+uv.x*-1.315244),0.,1.);float v14 = cclamp(sigmoid(-.4272614+uv.y*-1.300066+uv.x*.3854047),0.,1.);float v13 = cclamp(sigmoid(1.172178+uv.y*-6.877174+uv.x*1.240258),0.,1.);float v12 = cclamp(sigmoid(-1.378101+uv.y*-3.50202+uv.x*.3209904),0.,1.);float v11 = cclamp(sigmoid(-1.214886+uv.y*-1.290572+uv.x*-3.677428),0.,1.);float v10 = cclamp(sigmoid(1.920443+uv.y*-6.617269+uv.x*13.86455),0.,1.);float v9 = cclamp(sigmoid(.824993+uv.y*-8.055938+uv.x*2.594832),0.,1.);float v8 = cclamp(sigmoid(-1.037635+uv.y*-2.39633+uv.x*-.8838552),0.,1.);float v7 = cclamp(sigmoid(-2.37094+uv.y*3.785925+uv.x*-.9092417),0.,1.);float v6 = cclamp(sigmoid(-.5908598+uv.y*-1.880669+uv.x*-.9889116),0.,1.);float v5 = cclamp(sigmoid(2.962406+uv.y*-6.819704+uv.x*.1064563),0.,1.);float v4 = cclamp(sigmoid(-2.026568+uv.y*-2.078303+uv.x*-3.227837),0.,1.);float v3 = cclamp(sigmoid(-1.006371+uv.y*-2.378002+uv.x*-.3130784),0.,1.);float v2 = cclamp(sigmoid(-.1747424+uv.y*-2.186413+uv.x*-1.257601),0.,1.);float v1 = cclamp(sigmoid(1.203758+uv.y*-3.8356+uv.x*-.3902127),0.,1.);float v0 = cclamp(sigmoid(-2.244155+uv.y*.344205+uv.x*1.734267),0.,1.);return vec3(cclamp((-1.0362+v15*-1.546179+v14*-1.697301+v13*-1.718116+v12*.7623456+v11*-.6607103+v10*.2260308+v9*.0108743+v8*-.9160372+v7*2.103807+v6*-.9302574+v5*4.020718+v4*-1.073401+v3*-.2865451+v2*-.2587532+v1*1.870897+v0*.6991503),0.,1.),cclamp((-.7245497+v15*-1.414699+v14*-1.690919+v13*-1.049628+v12*.0101781+v11*-.3798004+v10*.2846614+v9*-.080653+v8*-.9865436+v7*1.792479+v6*-1.091462+v5*3.527821+v4*-.7504909+v3*-.7442171+v2*-.0800185+v1*1.736853+v0*.2433586),0.,1.),cclamp((-.7010881+v15*-1.89076+v14*-2.172665+v13*-.8698674+v12*-.1239742+v11*.4502342+v10*.5065429+v9*-.0203068+v8*-2.336+v7*1.681096+v6*-1.861552+v5*3.941728+v4*-.7077529+v3*-2.642669+v2*.3261784+v1*2.993706+v0*-.5141986),0.,1.));}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 uv = fragCoord.xy / iResolution.xy;\n    uv.y = 1.0-uv.y;\n    \n\tfragColor = vec4(neuralNet(uv),1.);\n}","name":"Image","description":"","type":"image"}]}