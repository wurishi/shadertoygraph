{"ver":"0.1","info":{"id":"3tycWw","date":"1611089970","viewed":210,"name":"Minimal cellular particles","username":"illus0r","description":"Minimal cellular particles","likes":2,"published":3,"flags":32,"usePreview":0,"tags":["cellular"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void mainImage( out vec4 fragColor, vec2 FC ) {\n    fragColor = texelFetch(iChannel0,ivec2(FC),0);\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"#define R 8. // interaction radius\n#define C 1. // max speed\n#define r iResolution.xy\n#define t iTime\n\nfloat rnd(vec2 uv) {\nreturn fract(sin(dot(uv.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\nvoid mainImage( out vec4 o, in vec2 FC )\n{\nvec2 uv=FC.xy/r,p,v;\nvec4 n;\no*=0.;\nif(rnd(uv+t)<.01&&abs(uv.x-.5)<.01){o+=.5;return;}\nfor(float di=-C;di<=C;di++){\n  for(float dj=-C;dj<=C;dj++){\n    vec2 ij=vec2(di,dj);\n    vec2 uv_n = fract(uv+ij/r);\n    n=texture(iChannel0,uv_n);\n    if(length(n)==0.)continue;\n    p=n.rg-ij;\n    v=C*(n.ba*2.-1.);\n    if(p+v==fract(p+v)){\n      p=fract(p+v);\n      vec2 g_ij=ij;\n      for(float di=-R;di<=R;di++){\n        for(float dj=-R;dj<=+R;dj++){\n          vec2 ij=vec2(g_ij.x+di,g_ij.y+dj);\n          if(length(ij)>0.&&length(ij)<R){\n            vec2 uv_n=fract(uv+ij/r);\n            n=texture(iChannel0,uv_n);\n            if(length(n)==0.)continue; // empty\n            vec2 p_n = n.rg-ij;\n            float dist=distance(p,p_n);\n            v+=5.*normalize(p-p_n)/dist*dist;\n          }\n        }\n      }\n      if(length(v)>C)v=C*normalize(v);\n      o=vec4(p,v/C*.5+.5);\n      break;\n    }\n  }\n}\n}","name":"Buffer A","description":"","type":"buffer"}]}