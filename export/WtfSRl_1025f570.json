{"ver":"0.1","info":{"id":"WtfSRl","date":"1563826199","viewed":223,"name":"hypnosis VJ machine","username":"anclin","description":"hypnosis VJ machine","likes":7,"published":1,"flags":16,"usePreview":0,"tags":["vj","hypnosis","machine"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGRr","filepath":"/presets/tex00.jpg","previewfilepath":"/presets/tex00.jpg","type":"keyboard","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define BMP 120.\n\nconst int KEY_LEFT  = 37;\nconst int KEY_UP    = 38;\nconst int KEY_RIGHT = 39;\nconst int KEY_DOWN  = 40;\nconst int KEY_A  \t= 65;\nconst int KEY_B  \t= 66;\n\nfloat GetKeyDown(int keyCode) {\n    return texelFetch( iChannel0, ivec2(keyCode,0), 0 ).x;\n}\n\nfloat GetDistToLine(vec2 a, vec2 b, vec2 p) {\n    vec2 ab = b-a;\n    vec2 ap = p-a;\n    float t = dot(ap,ab)/dot(ab,ab);\n    t = clamp(t,0.,1.);\n    vec2 c = a + ab*t;\n    float d = length(p-c) - iTime*2.;\n    return d;\n}\n\nfloat sinStep(float v, float s) {\n    v = sin(v*2.*3.14)*.5+.5;\n    v = smoothstep(s,s+.2, v);\n    return v;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = (fragCoord.xy-.5*iResolution.xy)/iResolution.y;\n    uv *= 10.;//mod(floor(iTime * 2.04 / 2.), 20.) + 2.;\n    \n    // mirror xy\n    uv = mix(uv, abs(uv), GetKeyDown(KEY_RIGHT));\n    \n    // line 1\n    float off1 = cos(iTime*2.)*4.;\n    vec2 a1 = vec2(sin(iTime),cos(iTime))*mix(0.,4.+off1,cos(iTime)*.5+.5);\n    vec2 b1 = vec2(sin(iTime),cos(iTime))*mix(0.,-4.+off1,cos(iTime)*.5+.5);\n    float d1 = GetDistToLine(a1, b1, uv);\n    \n    // line 2\n    float off2 = sin(iTime*2.)*4.;\n    vec2 a2 = vec2(cos(iTime),sin(iTime))*mix(0.,-4.+off2,sin(iTime)*.5+.5);\n    vec2 b2 = vec2(cos(iTime),sin(iTime))*mix(0.,4.+off2,sin(iTime)*.5+.5);\n    float d2 = GetDistToLine(a2, b2, uv);\n\n    // distorion\n    float swirl = (sin(iTime+uv.y*.2)*.5+.5)*3.;\n    float d = mix(d1, d2, GetKeyDown(KEY_LEFT) * swirl);\n\n    d = mix(d1, d2, GetKeyDown(KEY_LEFT));\n    d = mix(mix(d1, d2, GetKeyDown(KEY_LEFT)),\n            mix(d2, d1, GetKeyDown(KEY_LEFT)),\n            swirl * GetKeyDown(KEY_B)\n           );\n\n    // sine blimping\n    float bpm = (BMP/60.)*pow(2., 1. * GetKeyDown(KEY_DOWN) + 2. * GetKeyDown(KEY_UP));\n\tfloat s = mix(.1, .9, 1.-abs(sin(iTime*3.14*bpm)*.5+.5));\n    d = sinStep(d,s);\n    \n    // second layer / screen\n    float dist = mix(0., 5., sin(iTime)*.5+.5);\n    float d3 = fract(GetDistToLine(vec2(0.,dist),vec2(0.,-dist),uv));\n\td = mix(d, sinStep(d3,s), d * GetKeyDown(KEY_A));\n    \n\n    \n    vec3 col = vec3(d);\n    \n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}