{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[],"code":"#define C  32.703\r\n#define CS 34.648\r\n#define D  36.708\r\n#define DS 38.891\r\n#define E  41.203\r\n#define F  43.654\r\n#define FS 46.249\r\n#define G  48.999\r\n#define GS 51.913\r\n#define A  55.0\r\n#define AS 58.270\r\n#define B  61.735\r\n#define _  0.0\r\n#define X  200.0\r\n    \r\n\r\nfloat cycle(float time,float duration){\r\n\tfloat t = duration-mod(time,duration);\r\n    t = t*(1.0/duration);\r\n    return clamp(t,0.0,1.0); \r\n} \r\n\r\n\r\n\r\nfloat tb303(float time, float note){\r\n\r\n    float s = abs(sin(time*2.0)+1.0)*0.2;\r\n \tfloat a = pow(cycle(time,1.0/4.0),0.3);   \r\n    \r\n    float osc = sin(note*4.40*time);\r\n    osc = pow(osc,pow(1000.0,s+(a*0.5)));\r\n  \tosc = clamp(osc*a,-1.0,1.0);    \r\n    return pow(osc,1.0); \r\n}\r\n\r\n\r\nfloat tb304(float time, float note){\r\n\r\n    float s = abs(sin(time*0.3+6.0)+1.0)*0.5;\r\n \tfloat a = cycle(time,1.0/4.0);   \r\n    \r\n    float osc = sin(note*4.40*time);\r\n    osc = pow(osc,pow(10000.0,clamp(s+(a*0.2),0.001,100.0)));\r\n  \tosc = clamp(osc*a,-1.0,1.0);    \r\n    return osc; \r\n}\r\n\r\n\r\nfloat pad(float time, float note){\r\n    float osc = smoothstep(-0.1,0.8,sin(note*4.35*time*6.0) * sin(note*4.40*time*4.0) * sin(note*4.40*time*6.0));\r\n  \tosc = smoothstep(-0.5,1.0,pow(osc,2.0));    \r\n    return osc; \r\n}\r\n\r\n\r\n\r\n\r\nfloat kick(float time, float note){\r\n    float a = clamp(1.0-time,0.0,1.0);\r\n    float osc = sin(pow(a,5.0)*1.0*note);\r\n    return osc*pow(a,2.0); \r\n}\r\n\r\n\r\nfloat hat(float time, float note){\r\n    float n = fract(sin(time * 110.082) * 19871.8972);\r\n    float a = clamp(1.0-time,0.0,1.0);\r\n  \tfloat osc = clamp(pow(n,1.0),-1.0,1.0)*pow(a,5.0+note);    \r\n    return osc; \r\n}\r\n\r\n\r\nfloat clap(float time, float note){\r\n    float n = fract(sin(time * 110.082 * note) * 19871.8972);\r\n    float a = clamp(1.0-time*0.5,0.0,1.0);\r\n  \tfloat osc = n*pow(a,3.0);\r\n    \t  osc *= (sin(a*a*note*10.0)*pow(a,3.0));\r\n    return clamp(osc,-1.0,1.0); \r\n}\r\n\r\n\r\n\r\n\r\n\r\nfloat pat(float time,float p1,float p2,float p3,float p4,float p5,float p6,float p7,float p8){\r\n    float t = mod(time,8.0);\r\n\tif(t>7.0) return p8;    \r\n\tif(t>6.0) return p7;    \r\n\tif(t>5.0) return p6;    \r\n\tif(t>4.0) return p5;    \r\n\tif(t>3.0) return p4;    \r\n\tif(t>2.0) return p3;    \r\n\tif(t>1.0) return p2;    \r\n\tif(t>0.0) return p1;    \r\n\treturn 0.0;\r\n}\r\n\r\n\r\nvec2 mainSound( in int samp,float time)\r\n{  \r\n\r\n    // Bass\r\n    float trans = pat(time*0.25,0.0,0.0,1.0,1.0,1.0,1.0,2.0,2.0);\r\n    float note  = pat(time,C,_,G,A,C,_,D,F);    \r\n    float bass  = tb303(time,note*trans);\r\n\r\n    // Pad\r\n    float trans1 = pat(time*0.25,1.0,1.0,0.5,0.5,1.0,1.0,2.0,2.0);\r\n    float note1  = pat(time,C,C,G,G,C,C,A,F);    \r\n    float pads    = pad(time,note1*trans1);\r\n\r\n    \r\n    // Synth\r\n    float trans2 = pat(time*0.25,1.0,1.34,1.0,1.0,2.0,2.0,1.0,1.0);\r\n    float note2  = pat(time*4.0,C,D,G,A,C*2.0,D*2.0,A*2.0,C*2.0);    \r\n    float synth  = tb304(time*2.0,note2*trans2)*0.2*sin(time);\r\n\r\n    \r\n\t// Drums    \r\n    float t16   = time*4.0;\r\n    float hats  = hat( mod(t16,1.0),pat(t16,C,C,_,X,X,A,_,X));\r\n    float kicks = kick(mod(t16,1.0),pat(t16,C,C,_,_,_,C,_,_));\r\n    float claps = clap(mod(t16,1.0),pat(t16,_,_,C,_,_,_,C,X));\r\n\r\n       \r\n    // Mix\r\n    vec2 drums = vec2(0.7,0.5)*hats + vec2(0.6,0.6)*kicks + vec2(0.2,0.5)*claps + vec2(0.1,0.2)*pads;\r\n    drums = smoothstep(-0.8,0.8,drums);\r\n    vec2 sound = vec2(0.3,0.3)*drums + vec2(0.7,0.5)*synth + vec2(0.3,0.4)*bass;\r\n    float vol = smoothstep(0.0,3.0,time)*smoothstep(60.0,50.0,time);;\r\n    return vec2(smoothstep(-1.0,1.0,sound))*vol;\r\n    \r\n}\r\n\r\n\r\n\r\n// visualize\r\n\r\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\r\n{\r\n\tvec2  uv = fragCoord.xy / iResolution.xy;\r\n    vec2  s = mainSound( 0, iTime+fragCoord.x*0.0001)-0.2;   \r\n    float c1 = smoothstep(0.2,-0.2,abs(s.x-uv.y-sin(iTime*1.24)*0.1));\r\n    float c2 = smoothstep(0.2,-0.2,abs(s.y-uv.y+sin(iTime*1.83)*0.1));\r\n    float v = 1.0-pow(abs(dot(uv.xx-0.5,uv.yy-0.5)),0.2);\r\n    vec3  col = vec3(0.7,1.5,0.3);\r\n    fragColor = vec4(col*(c1+c2)+v*col,1.0)*s.y*0.7;\r\n    \r\n}","name":"Image","description":"","type":"image"},{"outputs":[],"inputs":[],"code":"#define C  32.703\n#define CS 34.648\n#define D  36.708\n#define DS 38.891\n#define E  41.203\n#define F  43.654\n#define FS 46.249\n#define G  48.999\n#define GS 51.913\n#define A  55.0\n#define AS 58.270\n#define B  61.735\n#define _  0.0\n#define X  200.0\n    \n\nfloat cycle(float time,float duration){\n\tfloat t = duration-mod(time,duration);\n    t = t*(1.0/duration);\n    return clamp(t,0.0,1.0); \n} \n\n\n\nfloat tb303(float time, float note){\n\n    float s = abs(sin(time*2.0)+1.0)*0.2;\n \tfloat a = pow(cycle(time,1.0/4.0),0.3);   \n    \n    float osc = sin(note*4.40*time);\n    osc = pow(osc,pow(1000.0,s+(a*0.5)));\n  \tosc = clamp(osc*a,-1.0,1.0);    \n    return pow(osc,1.0); \n}\n\n\nfloat tb304(float time, float note){\n\n    float s = abs(sin(time*0.3+6.0)+1.0)*0.5;\n \tfloat a = cycle(time,1.0/4.0);   \n    \n    float osc = sin(note*4.40*time);\n    osc = pow(osc,pow(10000.0,clamp(s+(a*0.2),0.001,100.0)));\n  \tosc = clamp(osc*a,-1.0,1.0);    \n    return osc; \n}\n\n\nfloat pad(float time, float note){\n    float osc = smoothstep(-0.1,0.8,sin(note*4.35*time*6.0) * sin(note*4.40*time*4.0) * sin(note*4.40*time*6.0));\n  \tosc = smoothstep(-0.5,1.0,pow(osc,2.0));    \n    return osc; \n}\n\n\n\n\nfloat kick(float time, float note){\n    float a = clamp(1.0-time,0.0,1.0);\n    float osc = sin(pow(a,5.0)*1.0*note);\n    return osc*pow(a,2.0); \n}\n\n\nfloat hat(float time, float note){\n    float n = fract(sin(time * 110.082) * 19871.8972);\n    float a = clamp(1.0-time,0.0,1.0);\n  \tfloat osc = clamp(pow(n,1.0),-1.0,1.0)*pow(a,5.0+note);    \n    return osc; \n}\n\n\nfloat clap(float time, float note){\n    float n = fract(sin(time * 110.082 * note) * 19871.8972);\n    float a = clamp(1.0-time*0.5,0.0,1.0);\n  \tfloat osc = n*pow(a,3.0);\n    \t  osc *= (sin(a*a*note*10.0)*pow(a,3.0));\n    return clamp(osc,-1.0,1.0); \n}\n\n\n\n\n\nfloat pat(float time,float p1,float p2,float p3,float p4,float p5,float p6,float p7,float p8){\n    float t = mod(time,8.0);\n\tif(t>7.0) return p8;    \n\tif(t>6.0) return p7;    \n\tif(t>5.0) return p6;    \n\tif(t>4.0) return p5;    \n\tif(t>3.0) return p4;    \n\tif(t>2.0) return p3;    \n\tif(t>1.0) return p2;    \n\tif(t>0.0) return p1;    \n\treturn 0.0;\n}\n\n\nvec2 mainSound( in int samp,float time)\n{  \n\n    // Bass\n    float trans = pat(time*0.25,0.0,0.0,1.0,1.0,1.0,1.0,2.0,2.0);\n    float note  = pat(time,C,_,G,A,C,_,D,F);    \n    float bass  = tb303(time,note*trans);\n\n    // Pad\n    float trans1 = pat(time*0.25,1.0,1.0,0.5,0.5,1.0,1.0,2.0,2.0);\n    float note1  = pat(time,C,C,G,G,C,C,A,F);    \n    float pads    = pad(time,note1*trans1);\n\n    \n    // Synth\n    float trans2 = pat(time*0.25,1.0,1.34,1.0,1.0,2.0,2.0,1.0,1.0);\n    float note2  = pat(time*4.0,C,D,G,A,C*2.0,D*2.0,A*2.0,C*2.0);    \n    float synth  = tb304(time*2.0,note2*trans2)*0.2*sin(time);\n\n    \n\t// Drums    \n    float t16   = time*4.0;\n    float hats  = hat( mod(t16,1.0),pat(t16,C,C,_,X,X,A,_,X));\n    float kicks = kick(mod(t16,1.0),pat(t16,C,C,_,_,_,C,_,_));\n    float claps = clap(mod(t16,1.0),pat(t16,_,_,C,_,_,_,C,X));\n\n       \n    // Mix\n    vec2 drums = vec2(0.7,0.5)*hats + vec2(0.6,0.6)*kicks + vec2(0.2,0.5)*claps + vec2(0.1,0.2)*pads;\n    drums = smoothstep(-0.8,0.8,drums);\n    vec2 sound = vec2(0.3,0.3)*drums + vec2(0.7,0.5)*synth + vec2(0.3,0.4)*bass;\n    float vol = smoothstep(0.0,3.0,time)*smoothstep(60.0,50.0,time);;\n    return vec2(smoothstep(-1.0,1.0,sound))*vol;\n    \n}\n","name":"Sound","description":"","type":"sound"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":true,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"XdsXD2","date":"1407008966","viewed":548,"name":"Musicbox","username":"ztri","description":"Toying with the new sound features.","likes":15,"published":1,"flags":8,"usePreview":0,"tags":["music"],"hasliked":0,"parentid":"","parentname":""}}