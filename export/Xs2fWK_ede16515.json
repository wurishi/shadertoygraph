{"ver":"0.1","info":{"id":"Xs2fWK","date":"1502231960","viewed":676,"name":"Circle Limit IV","username":"rubelson","description":"M. C. Escher's \"Circle Limit IV\" in the movement\nMove the pressed mouse for zooming","likes":41,"published":1,"flags":0,"usePreview":0,"tags":["escher","tiling","hyperbolic","poincare","reproduction"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\nvec4 getPix(float tex_x, mat4 d)\n{\nfloat x_=0.;\n\nif(tex_x<4.)\t\tx_=d[0][0];\nelse if(tex_x<8.)\tx_=d[0][1];\nelse if(tex_x<12.)\tx_=d[0][2];\nelse if(tex_x<16.)\tx_=d[0][3];\nelse if(tex_x<20.)\tx_=d[1][0];\nelse if(tex_x<24.)\tx_=d[1][1];\nelse if(tex_x<28.)\tx_=d[1][2];\nelse if(tex_x<32.)\tx_=d[1][3];\nelse if(tex_x<36.)\tx_=d[2][0];\nelse if(tex_x<40.)\tx_=d[2][1];\nelse if(tex_x<44.)\tx_=d[2][2];\nelse if(tex_x<48.)\tx_=d[2][3];\nelse if(tex_x<52.)\tx_=d[3][0];\nelse if(tex_x<56.)\tx_=d[3][1];\nelse if(tex_x<60.)\tx_=d[3][2];\nelse if(tex_x<64.)\tx_=d[3][3];\n\nfloat mask = mod(tex_x, 4.);\nfloat tmp = 0.;\nif(mask==0.)\t\ttmp=mod(x_,16.)/16.;\nelse if(mask==1.)\ttmp=mod(floor(x_/16.),16.)/16.;\nelse if(mask==2.)\ttmp=mod(floor(x_/256.),16.)/16.;\nelse\t\t\ttmp=mod(floor(x_/4096.),16.)/16.;\nvec4 col=vec4(tmp,tmp,tmp,1.);\nreturn col;\n}\n\n\n\nvec4 getColor(float tex_x, float tex_y)\n{\nvec4 col=vec4(0.,0.,0.,1.);\nif(tex_y<10.){\nif(tex_y==0.)col=getPix(tex_x,mat4(61436.,65519.,34617.,5240.,52412.,56525.,61149.,65534.,6655.,16704.,13396.,47201.,34953.,22390.,26230.,20789.));\nif(tex_y==1.)col=getPix(tex_x,mat4(65019.,65535.,8639.,919.,52146.,52460.,60892.,65518.,7935.,4864.,8226.,35187.,22135.,30035.,8754.,24897.));\nif(tex_y==2.)col=getPix(tex_x,mat4(61433.,65534.,2303.,9521.,64544.,60911.,60875.,64989.,32767.,512.,8226.,22421.,17543.,9011.,4113.,4112.));\nif(tex_y==3.)col=getPix(tex_x,mat4(65524.,65263.,28671.,12288.,58688.,64476.,56254.,64989.,61439.,4096.,20497.,26216.,4422.,291.,0.,0.));\nif(tex_y==4.)col=getPix(tex_x,mat4(65474.,57343.,65534.,345.,49712.,64700.,51935.,61149.,65535.,4100.,21504.,25975.,8452.,12289.,52119.,48077.));\nif(tex_y==5.)col=getPix(tex_x,mat4(65077.,65535.,65518.,49151.,45094.,65467.,48639.,61147.,65535.,10.,34304.,17751.,36.,64914.,60927.,65535.));\nif(tex_y==6.)col=getPix(tex_x,mat4(45591.,65535.,61183.,61439.,56014.,65533.,57343.,60875.,65533.,46.,34832.,13143.,37378.,65535.,44287.,65534.));\nif(tex_y==7.)col=getPix(tex_x,mat4(88.,30803.,65533.,57069.,65484.,65535.,65535.,56508.,65533.,143.,26944.,4949.,65376.,65199.,44799.,65534.));\nif(tex_y==8.)col=getPix(tex_x,mat4(13942.,16.,65408.,52719.,61163.,65263.,65535.,56271.,65517.,223.,25920.,19.,65529.,60111.,45055.,65517.));\nif(tex_y==9.)col=getPix(tex_x,mat4(1401.,4978.,63232.,44511.,56814.,61150.,65534.,48383.,65229.,1535.,13632.,40962.,65247.,52223.,49151.,65500.));\n}\nelse if(tex_y<20.){\nif(tex_y==10.)col=getPix(tex_x,mat4(1384.,26244.,28673.,52191.,56798.,56781.,65519.,48895.,60892.,3327.,5168.,63745.,59823.,48639.,53245.,65499.));\nif(tex_y==11.)col=getPix(tex_x,mat4(5223.,18311.,4.,56296.,56798.,56780.,65262.,61439.,56779.,24574.,4928.,65345.,51967.,49150.,61420.,65499.));\nif(tex_y==12.)col=getPix(tex_x,mat4(13687.,1128.,16384.,60545.,52702.,56796.,60893.,65534.,52654.,53213.,288.,48593.,48636.,53229.,65515.,65243.));\nif(tex_y==13.)col=getPix(tex_x,mat4(25447.,40.,16707.,64004.,56815.,56524.,56780.,65517.,47839.,65228.,803.,43767.,52956.,65500.,65227.,65212.));\nif(tex_y==14.)col=getPix(tex_x,mat4(33366.,24580.,39631.,60533.,57071.,60893.,56796.,60893.,44543.,64972.,4106.,48894.,57308.,64971.,64973.,64957.));\nif(tex_y==15.)col=getPix(tex_x,mat4(33317.,49152.,60365.,56047.,61183.,52974.,52413.,52701.,57342.,56521.,20527.,60351.,61183.,60619.,64975.,64975.));\nif(tex_y==16.)col=getPix(tex_x,mat4(26149.,53249.,56268.,52462.,65535.,57071.,52429.,56540.,65245.,56237.,37022.,61390.,52221.,60862.,56527.,56543.));\nif(tex_y==17.)col=getPix(tex_x,mat4(22532.,53504.,48093.,60399.,65535.,61183.,56798.,52428.,56796.,48095.,51421.,56814.,56303.,56526.,60927.,52479.));\nif(tex_y==18.)col=getPix(tex_x,mat4(22804.,49152.,48350.,65005.,65535.,65535.,57070.,52685.,56780.,44781.,61130.,56782.,56255.,52222.,56830.,60653.));\nif(tex_y==19.)col=getPix(tex_x,mat4(22578.,40960.,52702.,65211.,65535.,65535.,61439.,56798.,52444.,61148.,57066.,64733.,56765.,48620.,53245.,65533.));\n}\nelse if(tex_y<30.){\nif(tex_y==20.)col=getPix(tex_x,mat4(14385.,20480.,52703.,43725.,65227.,65535.,65535.,56815.,52445.,60620.,56780.,65517.,64715.,49102.,61405.,65535.));\nif(tex_y==21.)col=getPix(tex_x,mat4(18978.,0.,52989.,52445.,43436.,65227.,65535.,61439.,56798.,48604.,48093.,53245.,47819.,57055.,65516.,65535.));\nif(tex_y==22.)col=getPix(tex_x,mat4(22530.,1.,57079.,52700.,52429.,43691.,60841.,65535.,61183.,48589.,61163.,48366.,48588.,65259.,22171.,51029.));\nif(tex_y==23.)col=getPix(tex_x,mat4(37889.,37.,57024.,56813.,56781.,48332.,39612.,56235.,61439.,52446.,64683.,52159.,52443.,64717.,5.,0.));\nif(tex_y==24.)col=getPix(tex_x,mat4(32769.,5.,61296.,57070.,60893.,56797.,56542.,43708.,56490.,48334.,64187.,56271.,60876.,64989.,11.,4352.));\nif(tex_y==25.)col=getPix(tex_x,mat4(29441.,2.,65492.,65535.,61167.,65262.,60910.,56797.,44236.,64714.,60877.,48382.,56797.,61165.,141.,28928.));\nif(tex_y==26.)col=getPix(tex_x,mat4(26113.,1.,64507.,65535.,65535.,65535.,65535.,65535.,56830.,48092.,65533.,52974.,60875.,65518.,1790.,25600.));\nif(tex_y==27.)col=getPix(tex_x,mat4(22544.,0.,55530.,65535.,65535.,65535.,65535.,61183.,61166.,48878.,61419.,61166.,60876.,57070.,28652.,33792.));\nif(tex_y==28.)col=getPix(tex_x,mat4(14129.,0.,64403.,65535.,65535.,43727.,13415.,4370.,8464.,52987.,40412.,60602.,56798.,65518.,64971.,8234.));\nif(tex_y==29.)col=getPix(tex_x,mat4(1089.,0.,25344.,35207.,9320.,1.,0.,0.,20480.,52719.,48364.,48093.,56798.,65534.,60620.,1775.));\n}\nelse if(tex_y<40.){\nif(tex_y==30.)col=getPix(tex_x,mat4(864.,4096.,3.,0.,0.,0.,272.,8448.,57859.,52972.,48125.,60620.,61166.,65535.,48335.,53229.));\nif(tex_y==31.)col=getPix(tex_x,mat4(897.,8192.,8195.,1.,8448.,4625.,578.,8721.,64002.,52714.,51949.,60876.,61166.,65535.,56559.,60604.));\nif(tex_y==32.)col=getPix(tex_x,mat4(114.,16384.,4099.,257.,13089.,258.,8192.,324.,65344.,56812.,51918.,56795.,65261.,65535.,65518.,48895.));\nif(tex_y==33.)col=getPix(tex_x,mat4(9.,28672.,4.,13108.,8739.,529.,17152.,1092.,57248.,56828.,48078.,56780.,60910.,65535.,61438.,65535.));\nif(tex_y==34.)col=getPix(tex_x,mat4(38.,29440.,12291.,13364.,8740.,528.,21808.,852.,40163.,65003.,57036.,56524.,57086.,61150.,61182.,53230.));\nif(tex_y==35.)col=getPix(tex_x,mat4(68.,37904.,12546.,21573.,17459.,290.,22097.,306.,52984.,57068.,60602.,56542.,52462.,48060.,61437.,53213.));\nif(tex_y==36.)col=getPix(tex_x,mat4(594.,34368.,17153.,22100.,13397.,35.,26469.,35.,57340.,52956.,56812.,57069.,61167.,52718.,65499.,65535.));\nif(tex_y==37.)col=getPix(tex_x,mat4(9541.,34385.,16672.,30548.,18023.,8210.,17237.,307.,65533.,61134.,61439.,65519.,33849.,61437.,65228.,65263.));\nif(tex_y==38.)col=getPix(tex_x,mat4(20737.,26471.,25616.,26470.,9574.,16386.,13684.,8209.,43743.,43691.,52683.,43963.,1.,59152.,64479.,56799.));\nif(tex_y==39.)col=getPix(tex_x,mat4(0.,14723.,25137.,26214.,4933.,20738.,17767.,12307.,52479.,52427.,56524.,52444.,2.,86.,48632.,61438.));\n}\nelse if(tex_y<50.){\nif(tex_y==40.)col=getPix(tex_x,mat4(1.,2384.,25616.,25958.,13126.,25089.,13926.,16404.,61439.,65262.,65262.,65006.,16649.,22373.,64560.,65243.));\nif(tex_y==41.)col=getPix(tex_x,mat4(3.,5952.,25104.,17765.,16949.,25347.,9320.,16405.,65535.,65535.,65535.,65279.,24623.,38518.,24618.,52445.));\nif(tex_y==42.)col=getPix(tex_x,mat4(70.,26144.,20992.,25956.,9542.,25089.,21864.,16421.,65535.,52446.,48332.,64972.,4271.,30549.,647.,22096.));\nif(tex_y==43.)col=getPix(tex_x,mat4(87.,38448.,16384.,30053.,12614.,33538.,22376.,17188.,43983.,52154.,56797.,65262.,1535.,21841.,14741.,8466.));\nif(tex_y==44.)col=getPix(tex_x,mat4(3.,42304.,17409.,30308.,9303.,33536.,30311.,12596.,56799.,60893.,65518.,65535.,24575.,25088.,34645.,30838.));\nif(tex_y==45.)col=getPix(tex_x,mat4(1.,38480.,8195.,21844.,9541.,25346.,26470.,4132.,61438.,65534.,61439.,56798.,65535.,4119.,33826.,30777.));\nif(tex_y==46.)col=getPix(tex_x,mat4(0.,33824.,8196.,26196.,9285.,33537.,22153.,323.,65531.,61439.,52172.,56797.,65534.,14559.,12561.,257.));\nif(tex_y==47.)col=getPix(tex_x,mat4(4097.,21025.,8196.,30291.,17750.,29203.,26489.,308.,65528.,43981.,60620.,65262.,61183.,65535.,52463.,52428.));\nif(tex_y==48.)col=getPix(tex_x,mat4(4096.,29489.,72.,26450.,13687.,16404.,26745.,36.,44786.,52667.,65245.,61183.,61436.,65534.,65535.,65535.));\nif(tex_y==49.)col=getPix(tex_x,mat4(3.,16914.,5492.,34644.,18022.,16386.,26503.,565.,61328.,61166.,61438.,52429.,65501.,60894.,61165.,65278.));\n}\nelse if(tex_y<60.){\nif(tex_y==50.)col=getPix(tex_x,mat4(5.,17425.,5735.,30256.,26231.,12306.,30599.,4932.,65312.,65535.,48351.,56796.,65518.,52447.,56797.,56797.));\nif(tex_y==51.)col=getPix(tex_x,mat4(8214.,21554.,14388.,25650.,39063.,8740.,25975.,13413.,63232.,57343.,52411.,61150.,65263.,56831.,56524.,52684.));\nif(tex_y==52.)col=getPix(tex_x,mat4(4407.,8465.,25735.,38689.,29560.,313.,22421.,5238.,40960.,43727.,56780.,65534.,60894.,61183.,52429.,56780.));\nif(tex_y==53.)col=getPix(tex_x,mat4(26487.,599.,31024.,6242.,4096.,825.,30818.,4660.,16384.,56527.,61149.,52991.,60892.,61439.,56798.,65245.));\nif(tex_y==54.)col=getPix(tex_x,mat4(21880.,18054.,41984.,52.,32.,599.,30529.,294.,16400.,61439.,65535.,52446.,65261.,65535.,56815.,65518.));\nif(tex_y==55.)col=getPix(tex_x,mat4(25362.,30563.,28691.,4.,99.,9109.,22352.,278.,8242.,65535.,53247.,60875.,65518.,65500.,61183.,20222.));\nif(tex_y==56.)col=getPix(tex_x,mat4(57288.,35164.,22.,4151.,871.,9633.,29744.,53.,12579.,65535.,44015.,65245.,56831.,65245.,65535.,975.));\nif(tex_y==57.)col=getPix(tex_x,mat4(25975.,39501.,4.,12561.,5786.,1424.,37648.,8261.,4404.,65535.,56476.,65533.,56527.,61421.,53247.,8453.));\nif(tex_y==58.)col=getPix(tex_x,mat4(323.,25169.,4.,29952.,5785.,10080.,33552.,20517.,4117.,48638.,56538.,65535.,60859.,52991.,1503.,8704.));\nif(tex_y==59.)col=getPix(tex_x,mat4(1718.,8836.,4.,18224.,9874.,14384.,29200.,21253.,37.,51692.,65499.,48895.,65259.,60639.,28.,8704.));\n}\nelse if(tex_y<70.){\nif(tex_y==60.)col=getPix(tex_x,mat4(17745.,13912.,2.,1104.,14208.,23072.,29472.,25349.,21.,61178.,65533.,52207.,65261.,60879.,2.,17456.));\nif(tex_y==61.)col=getPix(tex_x,mat4(25395.,14248.,0.,0.,23088.,22545.,37697.,29717.,309.,65526.,65535.,56509.,61422.,28652.,26928.,8480.));\nif(tex_y==62.)col=getPix(tex_x,mat4(26420.,10273.,0.,0.,22272.,22528.,41808.,29956.,4407.,65523.,57343.,60875.,52991.,2812.,22948.,8770.));\nif(tex_y==63.)col=getPix(tex_x,mat4(9266.,13317.,0.,0.,29440.,14081.,29986.,25363.,615.,65505.,44543.,65244.,52223.,13038.,18568.,22561.));\nif(tex_y==64.)col=getPix(tex_x,mat4(19233.,12437.,39520.,344.,16384.,5380.,18452.,34113.,854.,65456.,51919.,65500.,56527.,37247.,26729.,33298.));\nif(tex_y==65.)col=getPix(tex_x,mat4(52289.,9471.,65456.,48895.,4.,13316.,5906.,26144.,9334.,65392.,56493.,65517.,61118.,30748.,38776.,12836.));\nif(tex_y==66.)col=getPix(tex_x,mat4(8736.,3013.,65440.,65517.,959.,16419.,8770.,35393.,13159.,60960.,64986.,65535.,64987.,34629.,34153.,4937.));\nif(tex_y==67.)col=getPix(tex_x,mat4(43922.,10004.,65440.,60621.,28671.,0.,4624.,34947.,4936.,64256.,65534.,53247.,49131.,34163.,26215.,22135.));\nif(tex_y==68.)col=getPix(tex_x,mat4(29457.,5002.,65408.,56797.,65517.,7.,30032.,25992.,13638.,62723.,65535.,48639.,24557.,25942.,30054.,34679.));\nif(tex_y==69.)col=getPix(tex_x,mat4(4166.,23138.,65376.,52446.,65262.,127.,31168.,25975.,17494.,49169.,65535.,56047.,18941.,21335.,21588.,17783.));\n}\nelse if(tex_y<80.){\nif(tex_y==70.)col=getPix(tex_x,mat4(31948.,34592.,65333.,52463.,64988.,2047.,39216.,30855.,17238.,20497.,65535.,56783.,26623.,17238.,12852.,548.));\nif(tex_y==71.)col=getPix(tex_x,mat4(60911.,29703.,64774.,52719.,57053.,32767.,28928.,30873.,17495.,19.,65534.,61116.,18127.,4660.,4656.,0.));\nif(tex_y==72.)col=getPix(tex_x,mat4(61439.,24893.,62996.,56815.,61132.,65535.,636.,27011.,17493.,19.,61430.,65243.,9119.,292.,0.,29762.));\nif(tex_y==73.)col=getPix(tex_x,mat4(65263.,16525.,54168.,52719.,65244.,52991.,49134.,29461.,21862.,580.,57280.,65517.,4685.,1.,55906.,65535.));\nif(tex_y==74.)col=getPix(tex_x,mat4(64991.,8668.,33401.,52991.,65244.,61439.,65229.,14831.,26211.,12613.,65328.,65535.,41.,46592.,65535.,65535.));\nif(tex_y==75.)col=getPix(tex_x,mat4(64991.,4828.,13418.,57087.,65500.,61167.,56799.,61421.,22171.,4404.,63488.,65535.,6.,65493.,48639.,65534.));\nif(tex_y==76.)col=getPix(tex_x,mat4(65534.,16859.,9591.,57340.,65516.,60879.,53247.,60875.,48894.,9321.,49152.,57343.,45824.,65535.,48895.,65531.));\nif(tex_y==77.)col=getPix(tex_x,mat4(61437.,24811.,1639.,57336.,65533.,56799.,65518.,52175.,65246.,27887.,8212.,28670.,65408.,65517.,57343.,65483.));\nif(tex_y==78.)col=getPix(tex_x,mat4(53246.,28893.,1094.,57335.,61439.,52991.,61149.,53247.,56523.,65534.,925.,7923.,65531.,65213.,61439.,64956.));\nif(tex_y==79.)col=getPix(tex_x,mat4(53246.,24766.,599.,61176.,57087.,61438.,56779.,65535.,52174.,65261.,53247.,52118.,65535.,52191.,61439.,60365.));\n}\nreturn col;\n} \n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\nconst float n=6.; \nconst float v=4.;\n\nfloat pattern_width = 64.;\nfloat pattern_height = 80.;\n\nfloat r = iResolution.y / 2. - 10.;\nfloat mas = pattern_height / (sqrt(2.-sqrt(3.))*sqrt(3.)/2.);\n\nbool vert_move = true;\n\nvec4 col = vec4(.3, .5, .7, 1.);\n\nfloat tex_x,tex_y;\nfloat u1=0.,u2=0.;\nfloat rrk,rr,d,dk,c,s,u,uu;\nfloat ca,sa,k_1,k_2,rk5;\nfloat rxyk,rk,rk2,rmk,rmk0,xm,ym;\nfloat tt,tf,pn,r1k,r1,h,rnk1,rnk2,rn1,count,tmp,fz;\n\nfloat euc0,euc1,euc2,hyp0,hyp1,hyp2;\nvec2 kn,kn2,k0,k1,k2,k5,km,kk;\n\nfloat pi = 3.14159265;\n\nfloat per=10.;\nfloat kseq = 2. * mod(iTime,per)/per - 1.;\n\nk0 = iResolution.xy/2.;\n\nif (iMouse.z > 0.){\nfloat r_old=r;\nfloat iry=iResolution.y;\nr*=(iry+5.)/(iry+5.-abs(iMouse.y*2.-iry));\nk0.y+=(r-r_old)*sign(iry/2.-iMouse.y);\nmas = pattern_height / (sqrt(2.-sqrt(3.))*sqrt(3.)/2.);\n}\n\ntt=tan(pi/n);\ntf=tan(pi/v);\n\neuc0 = vert_move ? 0. : sqrt(1.-tf*tf*tt*tt);\nhyp0 = (1. - euc0) / (1. + euc0);\neuc1 = (1. - hyp0) / (1. + hyp0);\nu = pow((1. - euc1) / (1. + euc1), kseq);\nkn.x = (1. - u) / (1. + u);\n\neuc0 = vert_move ? sqrt((1.-tf*tf*tt*tt)/(tf*tf*(1.+tt*tt))) : 0.;\nhyp0 = (1. - euc0) / (1. + euc0);\neuc2 = (1. - hyp0) / (1. + hyp0);\nu = pow((1. - euc2) / (1. + euc2), kseq);\nkn.y = (1. - u) / (1. + u);\n\n\npn=2.*pi/n;\nr1k=tt*tt*(1.+tf*tf)/(1.-tt*tt*tf*tf);\nr1=sqrt(r1k);\nh=sqrt(r1k+1.);\nrnk1=dot(kn,kn);\nrn1=sqrt(rnk1);\nkn2=kn*2./(1.+rnk1);\nrnk2=dot(kn2,kn2);\nrk=1.;\nkk=(fragCoord.xy-k0)/r;\n\nrrk=dot(kk,kk);\n\nif(rrk<rk){\n\nrr=sqrt(rrk);\nd=(1.-rr)/(1.+rr);\ndk=d*d;\nif(rr!=0.) {c=kk.x/rr; s=kk.y/rr;}\nelse {c=1.; s=0.;}\nu=sqrt((rk-rnk1)*(rk-rnk1)+4.*rk*(kn.y*c-kn.x*s)*(kn.y*c-kn.x*s));\nca=(c*(rk-kn.x*kn.x+kn.y*kn.y)-2.*s*kn.x*kn.y)/u;\nsa=(s*(rk+kn.x*kn.x-kn.y*kn.y)-2.*c*kn.x*kn.y)/u;\ntmp=kn2.x*ca+kn2.y*sa;\nk_1=-tmp+sqrt(tmp*tmp-rnk2+rk);\nk_2=-tmp-sqrt(tmp*tmp-rnk2+rk);\nu=k_1*k_2*(dk-1.)/(dk*k_1-k_2);\nk5.x=kn2.x+u*ca; \nk5.y=kn2.y+u*sa; \nrk5=dot(k5,k5);\nif(rk5>rk) rk5=rk;\nuu=1./(1.+sqrt(rk-rk5));\nk1=k5*uu;\nrxyk=dot(k1,k1);\n\nrmk=rxyk;\nfor(float count_=0.; count_<20.; count_++)\n {\n count=count_;\n rmk0=rk;km=k1;\n for(float i=0.; i<n; i++)\n  {\n  float si = sin(2.*pi*i/n);\n  float ci = cos(2.*pi*i/n);\n  k2 = k1*mat2(ci,-si,si,ci);\n  float k_ = r1k / (k2.x*k2.x+(k2.y-h)*(k2.y-h));\n  k2.x *= k_;\n  k2.y = k_*(k2.y-h)+h;\n  rk2 = dot(k2,k2);\n  if(rk2<rmk0) {rmk0=rk2; km=k2*mat2(ci,si,-si,ci);}\n  }\n if(rmk0>rmk) break;\n rmk = rmk0; \n k1 = km;\n } \t\n\nu1 = sqrt(rmk);\nu2 = atan(k1.y,k1.x);\nif(u2<0.) u2 += 2.*pi;\n\nif(mod(count,2.)==0.) u2 += pn*0.5; \nelse u2 += pn*1.5;\t\t\n\nu2 -= 2. * pn * floor(u2 / (2. * pn)); \nif(u2 > pn) u2 = 2. * pn - u2;\n\ntex_x = mod(floor(u1*mas*sin(u2)),pattern_width);\ntex_y = mod(floor(u1*mas*cos(u2)),pattern_height);\n\ncol = getColor(tex_x,tex_y);\n}\n\nfragColor = col;\n}","name":"Image","description":"","type":"image"}]}