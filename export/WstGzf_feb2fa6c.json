{"ver":"0.1","info":{"id":"WstGzf","date":"1573416557","viewed":170,"name":"Fluid prototype","username":"qat","description":"fluid","likes":2,"published":1,"flags":32,"usePreview":0,"tags":["fluid"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XdX3Rn","filepath":"/media/a/52d2a8f514c4fd2d9866587f4d7b2a5bfa1a11a0e772077d7682deb8b3b517e5.jpg","previewfilepath":"/media/ap/52d2a8f514c4fd2d9866587f4d7b2a5bfa1a11a0e772077d7682deb8b3b517e5.jpg","type":"texture","channel":1,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec4 guy = texture(iChannel0, fragCoord/iResolution.xy);\n    guy = 0.5 + 0.5 * sin((guy.x) * vec4(10,9,8,0));\n    vec2 uv = fragCoord.xy / iResolution.xy;\n    vec2 a = texture(iChannel0,uv).xy;\n    vec3 c = texture(iChannel1, a).rgb;\n  \n    fragColor = guy;\n}\n  ","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    float dt = .2;\n    float K = .2;\n    float v = .255;\n\n    float S = K / dt;\n\n    vec2 UV = fragCoord/iResolution.xy;\n    vec2 C = fragCoord.xy;\n    \n    vec2 r = iResolution.xy;\n\tvec2 Step = 1.0/iResolution.xy;\n\n    vec4 FC = texture(iChannel0,UV);\n\tvec4 FR = texture(iChannel0,UV + vec2(Step.x,0.) );\n\tvec4 FL = texture(iChannel0,UV - vec2(Step.x,0.) );\n\tvec4 FT = texture(iChannel0,UV + vec2(0.,Step.y) );\n\tvec4 FD = texture(iChannel0,UV - vec2(0.,Step.y) );\n    \n    \n    vec3 UdX = (FR.xyz - FL.xyz)*0.5;\n    vec3 UdY = (FT.xyz - FD.xyz)*0.5;\n\n    \n    float Udiv = UdX.x + UdY.y ;\n   \n    \n    //density difference\n\tvec2 DdX = vec2(UdX.z, UdY.z);\n    \n\n\t//density\n\tFC.z-=dt*dot(vec3(DdX,Udiv),FC.xyz);\n\tFC.z=clamp(FC.z,0.5f,3.0f);\n    \n    \n    \n    //velocity\n\n    vec2 PdX = S*DdX;\n         // set boundary velocity\n    if(C.x<2.||C.x>r.x-2.||r.y-2.<C.y||C.y<2.){\n        PdX *= 0.;\n    }\n\n    vec2 Laplacian = FT.xy + FD.xy + FR.xy + FL.xy - 4.0*FC.xy;\n\n\tvec2 ViscosityForce = vec2(v)*Laplacian;\n    \n    //advection\n    vec2 Was = UV - dt * FC.xy * Step;\n\tFC.xy = texture(iChannel0,Was).xy;\n    \n    \n    \n    //mouse\n    vec2 newForce;\n    if (iMouse.z > 1. )\n    {\n        vec2 mouse = (UV - iMouse.xy*Step);\n        vec2 vv = clamp(vec2(mouse.xy)*4., -2., 2.);\n        newForce.xy += .001/dot(mouse,mouse)*vv;\n    }\n    \n    FC.xy += dt * (ViscosityForce - PdX + newForce.xy);\n    \n\t    \n   FC.y *= smoothstep(.5,.48,abs(UV.y-0.5)); //Boundaries\n    \n    FC = clamp(FC, vec4(vec2(-10), 0.5 , -10.), vec4(vec2(10), 3.0 , 10.));\n\n    // Output to screen\n    fragColor = vec4(FC);\n}","name":"Buffer A","description":"","type":"buffer"}]}