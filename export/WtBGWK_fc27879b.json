{"ver":"0.1","info":{"id":"WtBGWK","date":"1561047673","viewed":100,"name":"lord created IFS","username":"sayachang_bot","description":"tested IFS","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["ifs"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"const float PI = 3.1415926;\nconst float EPS = .001;\n\nvec3 hsv(float h, float s, float v){return ((clamp(abs(fract(h+vec3(0,2,1)/3.)*6.-3.)-1.,0.,1.)-1.)*s+1.)*v;}\n\nvec2 rot(vec2 p, float a){\n    return vec2(p.x*cos(a)-p.y*sin(a), p.x*sin(a)+p.y*cos(a));\n}\n\nvec3 rep(vec3 p, float a){\n    return mod(p-.5*a,a)-.5*a;\n}\n\nfloat dBox(vec3 p){\n    vec3 d = abs(rep(p,2.))-.15;\n    return length(max(d,0.0));\n}\n\nfloat indexer(float i){\n    return floor(8192.*i)/8.;\n}\n\nvec2 map(vec3 p){\n    vec3 q=p;\n    // use IFS\n    // https://qiita.com/kaneta1992/items/21149c78159bd27e0860\n    for(int i=0;i<10;++i){\n        q=abs(q)-1.3;\n        q.xy=rot(q.xy,4.9);\n        q.xz=rot(q.xz,-1.75);\n    }\n    float index = floor(indexer(q.x)+indexer(q.y)+indexer(q.z))/10.;\n    q.xy=rot(q.xy,iTime);\n    q.yz=rot(q.yz,iTime);\n    return vec2(dBox(q),index);\n}\n\nvec3 normal(vec3 p){\n    vec2 xy=vec2(EPS,.0);\n    return normalize(vec3(\n        map(p+xy.xyy).x-map(p-xy.xyy).x,\n        map(p+xy.yxy).x-map(p-xy.yxy).x,\n        map(p+xy.yyx).x-map(p-xy.yyx).x\n    ));\n    \n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 p = (fragCoord.xy * 2.0 - iResolution.xy) / iResolution.xy;\n    vec3 ro=vec3(0.,.0,-10.+mod(iTime,64.)*abs(sin(iTime/64.))), rd=normalize(vec3(p,1.8)), N;\n    ro.xy=rot(ro.xy, PI/2.+PI);\n    ro.xz=rot(ro.xz, PI/2.);\n    vec3 ray=ro;\n    vec2 d=vec2(EPS);\n    for(int i=0;i<32;++i){\n        d=map(ray);\n        if(d.x<EPS){\n            N=normal(ray);\n            break;   \n        }\n        ray+=d.x*rd;\n    }\n    \n    vec3 L=normalize(vec3(-1.));\n    float hl=.5+.5*max(0.,dot(N,L));\n    fragColor = vec4(hsv(EPS*d.y,.98,1.4)/ray.z+.88*hl, 1.);\n}","name":"Image","description":"","type":"image"}]}