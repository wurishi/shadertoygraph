{"ver":"0.1","info":{"id":"WdsBDs","date":"1589287584","viewed":728,"name":"20200512_hitech","username":"FMS_Cat","description":"ha","likes":22,"published":1,"flags":8,"usePreview":0,"tags":["sound"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"Xsf3zn","filepath":"/media/a/f735bee5b64ef98879dc618b016ecf7939a5756040c2cde21ccb15e69a6e1cfb.png","previewfilepath":"/media/ap/f735bee5b64ef98879dc618b016ecf7939a5756040c2cde21ccb15e69a6e1cfb.png","type":"texture","channel":0,"sampler":{"filter":"linear","wrap":"repeat","vflip":"false","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // no image\n    fragColor = vec4( 0.0, 0.0, 0.0, 0.0 );\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"Xsf3zn","filepath":"/media/a/f735bee5b64ef98879dc618b016ecf7939a5756040c2cde21ccb15e69a6e1cfb.png","previewfilepath":"/media/ap/f735bee5b64ef98879dc618b016ecf7939a5756040c2cde21ccb15e69a6e1cfb.png","type":"texture","channel":0,"sampler":{"filter":"linear","wrap":"repeat","vflip":"false","srgb":"false","internal":"byte"},"published":1}],"outputs":[],"code":"#define PI 3.141592654\n#define TAU 6.283185307\n#define BPM 190.0\n#define beat *60.0/BPM\n#define RANDOM_RESO 256.0\n\n#define saturate(i) clamp(i, 0.,1.)\n#define aSaturate(i) clamp(i, -1.,1.)\n#define linearstep(a,b,x) saturate(((x)-(a))/((b)-(a)))\n#define lofi(i,m) (floor((i)/(m))*(m))\n#define lofir(i,m) (floor((i)/(m)+0.5)*(m))\n#define saw(p) (2.*fract(p)-1.)\n#define pwm(x,d) (step(fract(x),(d))*2.0-1.0)\n#define tri(p) (1.-4.*abs(fract(p)-0.5))\n#define n2f(n) (440.0*pow(2.0,(n)/12.0))\n\nvec4 random4( float t ) {\n  return texture( iChannel0, lofi( t * vec2( 0.741, 0.891 ), 1.0 / RANDOM_RESO ) + 0.5 / RANDOM_RESO );\n}\n\nvec4 random4( vec2 v ) {\n  return texture( iChannel0, lofi( v, 1.0 / RANDOM_RESO ) + 0.5 / RANDOM_RESO );\n}\n\nvec2 aNoise2( float t ) {\n  return 1.0 - 2.0 * texture( iChannel0, t * vec2( 0.741, 0.891 ) ).xy;\n}\n\nvec2 wavetable( float freq, float time, float speed, float offset ) {\n  if ( time < 0.0 ) { return vec2( 0.0 ); }\n  float p = tri( freq * time );\n  return aNoise2( p * speed + offset );\n}\n\nvec2 kick( float t ) {\n  return aSaturate( 1.0 * vec2( exp( -10.0 * t ) * sin( TAU * (\n    50.0 * t - 6.0 * ( exp( -10.0 * t ) + exp( -80.0 * t ) + exp( -400.0 * t ) )\n  ) ) ) );\n}\n\nvec2 filterSaw( float freq, float time, float cutoff, float resonance ) {\n  if ( time < 0.0 ) { return vec2( 0.0 ); }\n  vec2 sum = vec2( 0.0 );\n  for ( int i = 1; i <= 32; i ++ ) {\n    float fi = float( i );\n    float cut = smoothstep( cutoff * 1.2, cutoff * 0.8, fi * freq );\n    cut += smoothstep( cutoff * 0.3, 0.0, abs( cutoff - fi * freq ) ) * resonance;\n    vec2 offset = vec2( -1.0, 1.0 ) * ( 0.1 * ( fi - 1.0 ) );\n    sum += sin( fi * freq * time * TAU + offset ) / fi * cut;\n  }\n  return sum;\n}\n\nvec2 mainSound( in int samp, float aTime ) {\n  vec2 dest = vec2( 0.0 );\n\n  // -- kick ---------------------------------------------------------------------------------------\n  float kickTime = mod( aTime, 1.0 beat );\n  float sidechain = linearstep( 0.0, 0.6 beat, kickTime );\n  {\n    dest += 0.5 * kick( kickTime );\n  }\n\n  // -- hihat --------------------------------------------------------------------------------------\n  {\n    float time = mod( aTime, 0.25 beat );\n    vec4 dice = random4( aTime - time );\n    float open = mix( 30.0, 200.0, dice.x );\n    float amp = 0.3 * exp( -open * time );\n    vec2 wave = wavetable( 20.0, time, 4.0, 0.0 );\n    dest += amp * wave;\n  }\n\n  // -- hihat --------------------------------------------------------------------------------------\n  {\n    float time = mod( aTime - 0.5 beat, 1.0 beat );\n    float amp = 0.3 * exp( -30.0 * time );\n    vec2 wave = wavetable( 100.0, time, 0.8, 0.0 );\n    dest += amp * wave;\n  }\n\n  // -- clap ---------------------------------------------------------------------------------------\n  {\n    float time = mod( aTime - 1.0 beat, 2.0 beat );\n    float amp = 0.1 + 0.2 * exp( -30.0 * time );\n    vec2 wave = wavetable( 14.0, time, 2.0, 0.0 );\n    if ( time < 0.5 beat ) {\n      dest += amp * wave;\n    }\n  }\n\n  // -- psysaw -------------------------------------------------------------------------------------\n  {\n    float time = mod( aTime, 0.25 beat );\n    float begin = aTime - time;\n    vec4 dice = random4( begin );\n    if ( time < ( 0.25 - dice.y * 0.2 ) beat ) {\n      float freq = 20.0 * sin( TAU * begin * 2.0 );\n      dest += 0.15 * saw( 20.0 * exp( -2.0 * fract( 10.0 * exp( -freq * time ) ) ) );\n    }\n  }\n\n  // -- bass ---------------------------------------------------------------------------------------\n  {\n    // float time = mod( aTime - 0.5 beat, 1.0 beat );\n    float time = mod( aTime, 0.25 beat );\n    float decay = exp( -20.0 * time );\n    float cutoff = mix( 100.0, 500.0, decay );\n    float noteI = 0.0;\n    float freq = n2f( -38.0 );\n    vec2 wave = filterSaw( freq, time + 0.004 * sin( TAU * 2.0 * freq * time ), cutoff, 1.0 );\n    dest += 0.4 * sidechain * decay * wave;\n  }\n\n  return aSaturate( dest );\n}","name":"Sound","description":"","type":"sound"}]}