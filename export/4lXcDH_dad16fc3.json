{"ver":"0.1","info":{"id":"4lXcDH","date":"1504551113","viewed":2464,"name":"Cathode","username":"nimitz","description":"Left: my algorithm, Middle: bilinear filtering, Right: nearest neighbor\n\nFor best results stand a few feet away form the screen.","likes":67,"published":1,"flags":32,"usePreview":0,"tags":["aa"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"//Cathode by nimitz (twitter: @stormoid)\n//2017 nimitz All rights reserved\n\n/*\n\tCRT simulation shadowmask style, I also have a trinitron version\n\toptimized for 4X scaling on a ~100ppi display.\n\n\tThe \"Scanlines\" seen in the simulated picture are only a side effect of the phoshor placement\n\tand decay, instead of being artificially added on at the last step.\n\n\tI have done some testing and it performs especially well with \"hard\" input such a faked\n\t(dither based) transparency and faked specular highlights as seen in the bigger sprite.\n\tA version tweaked and made for 4k displays could look pretty close to the real thing.\n*/\n\n//Phosphor decay\nfloat decay(in float d)\n{\n    return mix(exp2(-d*d*2.5-.3),0.05/(d*d*d*0.45+0.055),.65)*0.99;\n}\n\n//Phosphor shape\nfloat sqd(in vec2 a, in vec2 b)\n{\n    a -= b;\n    a *= vec2(1.25,1.8)*.905;\n    float d = max(abs(a.x), abs(a.y));\n    d = mix(d, length(a*vec2(1.05, 1.))*0.85, .3);\n    return d;\n}\n\nvec3 phosphors(in vec2 p, sampler2D tex)\n{   \n    vec3 col = vec3(0);\n    p -= 0.25;\n    p.y += mod(gl_FragCoord.x,2.)<1.?.03:-0.03;\n    p.y += mod(gl_FragCoord.x,4.)<2.?.02:-0.02;\n    \n\t//5x5 kernel (this means a given fragment can be affected by a pixel 4 game pixels away)\n    for(int i=-2;i<=2;i++)\n    for(int j=-2;j<=2;j++)\n    {\n        vec2 tap = floor(p) + 0.5 + vec2(i,j);\n\t\tvec3 rez = texture(tex, tap/iChannelResolution[0].xy).rgb; //nearest neighbor\n        \n\t\t//center points\n        float rd = sqd(tap, p + vec2(0.0,0.2));//distance to red dot\n\t\tconst float xoff = .25;\n        float gd = sqd(tap, p + vec2(xoff,.0));//distance to green dot\n        float bd = sqd(tap, p + vec2(-xoff,.0));//distance to blue dot\n\t\t\n        rez = pow(rez,vec3(1.18))*1.08;\n        rez.r *= decay(rd);\n        rez.g *= decay(gd);\n        rez.b *= decay(bd);\n\t\t\n        col += rez;\n    }\n    return col;\n}\n\nvec3 nearest(in vec2 p, sampler2D tex)\n{\n    p -= 0.25;\n    return texture(tex, (floor(p) + 0.5)/iChannelResolution[0].xy).rgb;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 p = fragCoord.xy/iResolution.xy;\n    vec2 f = fragCoord.xy;\n    \n    vec3 col = phosphors(fragCoord.xy/4.0, iChannel0);\n    if (f.y > 200.)\n        col = phosphors(fragCoord.xy/4.0 - vec2(0,30.), iChannel1);\n    \n    if (f.x > 265.)\n    {\n        col = texture(iChannel0, p/4. + vec2(-70./iResolution.x,0)).rgb;\n        if (f.y > 200.)\n            col = texture(iChannel1, p/4. - vec2(70, 30)/iResolution.xy).rgb;\n    }\n    \n    if (f.x > 530.)\n    {\n        col = nearest(fragCoord.xy/4.0 - vec2(137,0), iChannel0).rgb;\n        if (f.y > 200.)\n    \t\tcol = nearest(fragCoord.xy/4.0 - vec2(137,29), iChannel1).rgb;\n    }\n    \n    \n    col = min(col, smoothstep(0.,2., abs(f.x-266.0)));\n    col = min(col, smoothstep(0.,2., abs(f.x-531.)));\n    \n\tfragColor = vec4(col, 1.0);\n}","name":"Image","description":"","type":"image"},{"inputs":[],"outputs":[{"id":"4dXGR8","channel":0}],"code":"//Cathode by nimitz (twitter: @stormoid)\n//2017 nimitz All rights reserved\n\n#define A 0.0\n#define B 1.0\n#define C 2.0\n#define D 3.0\n#define E 4.0\n#define F 5.0\n#define G 6.0\n#define H 7.0\n#define I 8.0\n#define J 9.0\n#define K 10.0\n#define L 11.0\n#define M 12.0\n#define N 13.0\n#define O 14.0\n#define P 15.0\n\n\n#define Encode(a,b,c,d,e,f) (a+16.0*(b+16.0*(c+16.0*(d+16.0*(e+f*16.0)))))\n\n\n//Sprite render\nvec3 sprite(in ivec2 p) {\n\n    float sum = 0.;\n    \n    //Sprite data (3 blocks per line, allowing for a 16 color palette)\n    if (p.y == 0)\n    {\n        if(p.x <= 5) \t\tsum = Encode(N, N, N, N, N, N);\n        else if(p.x <= 11) \tsum = Encode(A, A, A, A, N, N);\n        else if(p.x <= 15) \tsum = Encode(N, N, N, N, A, A);\n    }\n    if (p.y == 1)\n    {\n        if(p.x <= 5) \t   \tsum = Encode(N, C, M, M, M, N);\n        else if(p.x <= 11) \tsum = Encode(A, A, A, A, N, M);\n        else if(p.x <= 15) \tsum = Encode(M, M, C, N, A, A);\n    }\n    if (p.y == 2)\n    {\n        if(p.x <= 5) \t   \tsum = Encode(A, N, M, M, M, N);\n        else if(p.x <= 11) \tsum = Encode(A, A, A, A, N, M);\n        else if(p.x <= 15) \tsum = Encode(M, M, N, A, A, A);\n    }\n    if (p.y == 3)\n    {\n        if(p.x <= 5) \t   \tsum = Encode(A, A, J, J, J, J);\n        else if(p.x <= 11) \tsum = Encode(A, A, A, A, J, J);\n        else if(p.x <= 15) \tsum = Encode(J, J, J, A, A, A);\n    }\n    if (p.y == 4)\n    {\n        if(p.x <= 5) \t   \tsum = Encode(A, A, J, I, I, I);\n        else if(p.x <= 11) \tsum = Encode(J, A, A, A, J, I);\n        else if(p.x <= 15) \tsum = Encode(I, I, J, A, A, A);\n    }\n    if (p.y == 5)\n    {\n        if(p.x <= 5) \t   \tsum = Encode(A, A, J, I, H, H);\n        else if(p.x <= 11) \tsum = Encode(I, J, J, J, J, I);\n        else if(p.x <= 15) \tsum = Encode(H, I, J, A, A, A);\n    }\n    if (p.y == 6)\n    {\n        if(p.x <= 5) \t   \tsum = Encode(A, A, J, I, H, H);\n        else if(p.x <= 11) \tsum = Encode(H, I, I, I, I, H);\n        else if(p.x <= 15) \tsum = Encode(H, I, J, A, A, A);\n    }\n    if (p.y == 7)\n    {\n        if(p.x <= 5) \t   \tsum = Encode(A, A, A, J, H, H);\n        else if(p.x <= 11) \tsum = Encode(H, H, H, H, H, H);\n        else if(p.x <= 15) \tsum = Encode(I, J, N, A, A, A);\n    }\n    if (p.y == 8)\n    {\n        if(p.x <= 5) \t   \tsum = Encode(A, A, A, J, H, B);\n        else if(p.x <= 11) \tsum = Encode(B, H, H, H, H, B);\n        else if(p.x <= 15) \tsum = Encode(B, J, B, N, A, A);\n    }\n    if (p.y == 9)\n    {\n        if(p.x <= 5) \t   \tsum = Encode(A, A, A, J, H, B);\n        else if(p.x <= 11) \tsum = Encode(B, H, H, H, H, B);\n        else if(p.x <= 15) \tsum = Encode(B, J, B, N, A, A);\n    }\n    if (p.y == 10)\n    {\n        if(p.x <= 5) \t   \tsum = Encode(A, A, A, F, J, I);\n        else if(p.x <= 11) \tsum = Encode(H, H, H, H, H, H);\n        else if(p.x <= 15) \tsum = Encode(I, B, B, N, A, A);\n    }\n    if (p.y == 11)\n    {\n        if(p.x <= 5) \t   \tsum = Encode(A, A, G, F, E, E);\n        else if(p.x <= 11) \tsum = Encode(I, H, G, G, H, I);\n        else if(p.x <= 15) \tsum = Encode(F, N, N, A, A, A);\n    }\n    if (p.y == 12)\n    {\n        if(p.x <= 5) \t   \tsum = Encode(A, A, G, E, E, E);\n        else if(p.x <= 11) \tsum = Encode(I, I, F, F, I, I);\n        else if(p.x <= 15) \tsum = Encode(E, G, A, A, A, A);\n    }\n    if (p.y == 13)\n    {\n        if(p.x <= 5) \t   \tsum = Encode(A, A, G, E, F, M);\n        else if(p.x <= 11) \tsum = Encode(M, M, M, M, M, E);\n        else if(p.x <= 15) \tsum = Encode(G, A, A, A, A, A);\n    }\n    if (p.y == 14)\n    {\n        if(p.x <= 5) \t   \tsum = Encode(A, G, E, F, F, G);\n        else if(p.x <= 11) \tsum = Encode(D, D, D, D, D, M);\n        else if(p.x <= 15) \tsum = Encode(M, A, A, A, A, A);\n    }\n    if (p.y == 15)\n    {\n        if(p.x <= 5) \t   \tsum = Encode(A, G, E, F, G, C);\n        else if(p.x <= 11) \tsum = Encode(N, N, N, N, N, N);\n        else if(p.x <= 15) \tsum = Encode(C, M, A, A, A, A);\n    }\n    if (p.y == 16)\n    {\n        if(p.x <= 5) \t   \tsum = Encode(A, G, E, F, G, N);\n        else if(p.x <= 11) \tsum = Encode(N, N, N, N, N, N);\n        else if(p.x <= 15) \tsum = Encode(N, C, M, A, A, A);\n    }\n    if (p.y == 17)\n    {\n        if(p.x <= 5) \t   \tsum = Encode(A, G, E, F, G, N);\n        else if(p.x <= 11) \tsum = Encode(N, D, D, D, D, N);\n        else if(p.x <= 15) \tsum = Encode(N, C, N, D, A, A);\n    }\n    if (p.y == 18)\n    {\n        if(p.x <= 5) \t   \tsum = Encode(A, G, G, G, G, C);\n        else if(p.x <= 11) \tsum = Encode(D, C, C, C, C, D);\n        else if(p.x <= 15) \tsum = Encode(C, N, N, D, A, A);\n    }\n    if (p.y == 19)\n    {\n        if(p.x <= 5) \t   \tsum = Encode(N, B, B, B, B, N);\n        else if(p.x <= 11) \tsum = Encode(B, N, C, C, N, B);\n        else if(p.x <= 15) \tsum = Encode(C, C, N, D, A, A);\n    }\n    if (p.y == 20)\n    {\n        if(p.x <= 5) \t   \tsum = Encode(N, N, N, N, B, N);\n        else if(p.x <= 11) \tsum = Encode(B, N, C, C, N, B);\n        else if(p.x <= 15) \tsum = Encode(C, D, N, D, A, A);\n    }\n    if (p.y == 21)\n    {\n        if(p.x <= 5) \t   \tsum = Encode(N, B, N, B, B, N);\n        else if(p.x <= 11) \tsum = Encode(B, B, D, D, B, B);\n        else if(p.x <= 15) \tsum = Encode(N, N, G, A, A, A);\n    }\n    if (p.y == 22)\n    {\n        if(p.x <= 5) \t   \tsum = Encode(N, B, B, N, N, N);\n        else if(p.x <= 11) \tsum = Encode(N, N, N, N, N, N);\n        else if(p.x <= 15) \tsum = Encode(N, N, G, A, A, A);\n    }\n    if (p.y == 23)\n    {\n        if(p.x <= 5) \t   \tsum = Encode(A, N, N, N, B, N);\n        else if(p.x <= 11) \tsum = Encode(N, N, N, N, N, N);\n        else if(p.x <= 15) \tsum = Encode(N, F, G, A, A, A);\n    }\n    if (p.y == 24)\n    {\n        if(p.x <= 5) \t   \tsum = Encode(A, A, N, B, B, N);\n        else if(p.x <= 11) \tsum = Encode(N, N, N, N, N, N);\n        else if(p.x <= 15) \tsum = Encode(E, F, G, A, A, A);\n    }\n    if (p.y == 25)\n    {\n        if(p.x <= 5) \t   \tsum = Encode(A, N, B, N, B, N);\n        else if(p.x <= 11) \tsum = Encode(E, L, B, B, L, E);\n        else if(p.x <= 15) \tsum = Encode(F, G, A, A, A, A);\n    }\n    if (p.y == 26)\n    {\n        if(p.x <= 5) \t   \tsum = Encode(A, N, N, A, N, N);\n        else if(p.x <= 11) \tsum = Encode(G, E, L, K, E, G);\n        else if(p.x <= 15) \tsum = Encode(G, A, A, A, A, A);\n    }\n    if (p.y == 27)\n    {\n        if(p.x <= 5) \t   \tsum = Encode(A, A, A, A, A, A);\n        else if(p.x <= 11) \tsum = Encode(A, G, G, G, G, A);\n        else if(p.x <= 15) \tsum = Encode(A, A, A, A, A, A);\n    }\n    \n    //p.x = int(fract(float(p.x)/6.)*6.);\n    if (p.x > 5) p.x -= 6;\n    if (p.x > 5) p.x -= 6;\n\n\t//decode\n    float g = mod( floor(sum/pow(16.0,float(p.x))), 16.0 );\n    \n    \n    //background\n    vec3 col = vec3(0.63,0.63,0.64)*0.5;\n    \n    \n    //palette\n    if (g > 12.) col = vec3(0);\n    else if (g > 11.) col = vec3(136./255., 88./255., 24./255.);\n    else if (g > 10.) col = vec3(216./255., 160./255., 56./255.);\n    else if (g > 9.) col = vec3(248./255., 216./255., 112./255.);\n    else if (g > 8.) col = vec3(32./255., 48./255., 136./255.);\n    else if (g > 7.) col = vec3(64./255., 128./255., 152./255.);\n    else if (g > 6.) col = vec3(128./255., 216./255., 200./255.);\n    else if (g > 5.) col = vec3(80./255., 0./255., 0./255.);\n    else if (g > 4.) col = vec3(176./255., 40./255., 96./255.);\n    else if (g > 3.) col = vec3(248./255., 64./255., 112./255.);\n    else if (g > 2.) col = vec3(248./255., 112./255., 104./255.);\n    else if (g > 1.) col = vec3(248./255., 208./255., 192./255.);\n    else if (g > 0.) col = vec3(248./255., 248./255., 248./255.);\n    \n    return col;\n}\n\nvec3 dither(in ivec2 p) {\n    vec3 col1 = vec3(.2,0.7,0.0)*0.75;\n    vec3 col2 = vec3(0.7,0.3,0.3)*1.1;\n    float g = mod(gl_FragCoord.x + gl_FragCoord.y,2.);\n    return mix(col1,col2, g);\n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 p = fragCoord;\n    vec3 col = sprite(ivec2(p)-ivec2(21,35));\n    //col = mix(col, dither(ivec2(p)), step(abs(p.x-30.),10.) * step(abs(p.y-30.),10.));\n    fragColor = vec4(col, 1.0);\n}","name":"Buffer A","description":"","type":"buffer"},{"inputs":[],"outputs":[{"id":"XsXGR8","channel":0}],"code":"//Cathode by nimitz (twitter: @stormoid)\n//2017 nimitz All rights reserved\n\n#define A 0.0\n#define B 1.0\n#define C 2.0\n#define D 3.0\n#define E 4.0\n#define F 5.0\n#define G 6.0\n#define H 7.0\n#define I 8.0\n#define J 9.0\n#define K 10.0\n#define L 11.0\n#define M 12.0\n#define N 13.0\n#define O 14.0\n#define P 15.0\n\n\n#define Encode(a,b,c,d,e,f) (a+16.0*(b+16.0*(c+16.0*(d+16.0*(e+f*16.0)))))\n\n\n//Sprite render\nvec3 sprite(in ivec2 p) {\n\n    float sum = 0.;\n    \n    //Sprite data (3 blocks per line, allowing for a 16 color palette)\n    if (p.y == 0)\n    {\n        if(p.x <= 5) \t\tsum = Encode(A, A, A, A, A, A);\n        else if(p.x <= 11) \tsum = Encode(A, A, B, B, B, B);\n        else if(p.x <= 17) \tsum = Encode(B, A, A, A, A, A);\n        else if(p.x <= 23) \tsum = Encode(B, B, B, C, B, B);\n        else if(p.x <= 29) \tsum = Encode(B, A, A, A, A, A);\n        //else if(p.x <= 35) \tsum = Encode(A, A, A, A, A, A);\n    }\n    if (p.y == 1)\n    {\n        if(p.x <= 5) \t\tsum = Encode(A, C, C, C, C, C);\n        else if(p.x <= 11) \tsum = Encode(C, B, C, D, D, C);\n        else if(p.x <= 17) \tsum = Encode(C, C, B, C, C, B);\n        else if(p.x <= 23) \tsum = Encode(C, E, E, C, D, C);\n        else if(p.x <= 29) \tsum = Encode(C, B, B, A, A, A);\n        //else if(p.x <= 35) \tsum = Encode(A, A, A, A, A, A);\n    }\n    if (p.y == 2)\n    {\n        if(p.x <= 5) \t\tsum = Encode(C, F, G, E, E, G);\n        else if(p.x <= 11) \tsum = Encode(G, C, C, D, D, D);\n        else if(p.x <= 17) \tsum = Encode(D, C, C, C, D, C);\n        else if(p.x <= 23) \tsum = Encode(G, G, F, C, M, D);\n        else if(p.x <= 29) \tsum = Encode(C, B, C, B, A, A);\n        //else if(p.x <= 35) \tsum = Encode(A, A, A, A, A, A);\n    }\n    if (p.y == 3)\n    {\n        if(p.x <= 5) \t\tsum = Encode(C, F, F, G, G, F);\n        else if(p.x <= 11) \tsum = Encode(C, B, C, D, H, D);\n        else if(p.x <= 17) \tsum = Encode(D, D, C, D, D, E);\n        else if(p.x <= 23) \tsum = Encode(F, F, I, C, I, D);\n        else if(p.x <= 29) \tsum = Encode(C, B, D, C, A, A);\n        //else if(p.x <= 35) \tsum = Encode(A, A, A, A, A, A);\n    }\n    if (p.y == 4)\n    {\n        if(p.x <= 5) \t\tsum = Encode(A, C, I, I, F, D);\n        else if(p.x <= 11) \tsum = Encode(D, B, B, C, D, D);\n        else if(p.x <= 17) \tsum = Encode(D, D, D, D, M, C);\n        else if(p.x <= 23) \tsum = Encode(I, I, G, G, C, M);\n        else if(p.x <= 29) \tsum = Encode(D, B, D, C, A, A);\n        //else if(p.x <= 35) \tsum = Encode(A, A, A, A, A, A);\n    }\n    if (p.y == 5)\n    {\n        if(p.x <= 5) \t\tsum = Encode(A, A, C, C, D, M);\n        else if(p.x <= 11) \tsum = Encode(C, C, D, B, C, D);\n        else if(p.x <= 17) \tsum = Encode(D, C, D, C, C, B);\n        else if(p.x <= 23) \tsum = Encode(E, G, F, I, F, C);\n        else if(p.x <= 29) \tsum = Encode(G, C, M, B, A, A);\n        //else if(p.x <= 35) \tsum = Encode(A, A, A, A, A, A);\n    }\n    if (p.y == 6)\n    {\n        if(p.x <= 5) \t\tsum = Encode(A, A, A, A, C, C);\n        else if(p.x <= 11) \tsum = Encode(E, C, D, D, B, B);\n        else if(p.x <= 17) \tsum = Encode(B, B, B, H, H, D);\n        else if(p.x <= 23) \tsum = Encode(B, F, I, C, C, I);\n        else if(p.x <= 29) \tsum = Encode(F, C, C, A, A, A);\n        //else if(p.x <= 35) \tsum = Encode(A, A, A, A, A, A);\n    }\n    if (p.y == 7)\n    {\n        if(p.x <= 5) \t\tsum = Encode(A, A, A, A, C, G);\n        else if(p.x <= 11) \tsum = Encode(F, C, C, D, B, C);\n        else if(p.x <= 17) \tsum = Encode(C, H, D, B, H, H);\n        else if(p.x <= 23) \tsum = Encode(D, B, B, G, F, C);\n        else if(p.x <= 29) \tsum = Encode(C, A, A, A, A, A);\n        //else if(p.x <= 35) \tsum = Encode(A, A, A, A, A, A);\n    }\n    if (p.y == 8)\n    {\n        if(p.x <= 5) \t\tsum = Encode(A, A, A, A, C, F);\n        else if(p.x <= 11) \tsum = Encode(F, E, C, B, B, B);\n        else if(p.x <= 17) \tsum = Encode(E, C, D, B, C, C);\n        else if(p.x <= 23) \tsum = Encode(C, D, D, C, C, A);\n        //else if(p.x <= 29) \tsum = Encode(A, A, A, A, A, A);\n        //else if(p.x <= 35) \tsum = Encode(A, A, A, A, A, A);\n    }\n    if (p.y == 9)\n    {\n        if(p.x <= 5) \t\tsum = Encode(A, A, A, A, C, F);\n        else if(p.x <= 11) \tsum = Encode(F, E, C, J, J, B);\n        else if(p.x <= 17) \tsum = Encode(B, E, E, G, E, C);\n        else if(p.x <= 23) \tsum = Encode(C, C, C, A, A, A);\n        //else if(p.x <= 29) \tsum = Encode(A, A, A, A, A, A);\n        //else if(p.x <= 35) \tsum = Encode(A, A, A, A, A, A);\n    }\n    if (p.y == 10)\n    {\n        if(p.x <= 5) \t\tsum = Encode(A, A, A, A, C, F);\n        else if(p.x <= 11) \tsum = Encode(G, E, C, H, J, J);\n        else if(p.x <= 17) \tsum = Encode(B, D, D, D, D, C);\n        else if(p.x <= 23) \tsum = Encode(C, A, A, A, A, A);\n        //else if(p.x <= 29) \tsum = Encode(A, A, A, A, A, A);\n        //else if(p.x <= 35) \tsum = Encode(A, A, A, A, A, A);\n    }\n    if (p.y == 11)\n    {\n        if(p.x <= 5) \t\tsum = Encode(A, A, A, A, C, F);\n        else if(p.x <= 11) \tsum = Encode(G, E, C, H, H, J);\n        else if(p.x <= 17) \tsum = Encode(B, M, M, D, C, C);\n        else if(p.x <= 23) \tsum = Encode(H, C, A, A, A, A);\n        //else if(p.x <= 29) \tsum = Encode(A, A, A, A, A, A);\n        //else if(p.x <= 35) \tsum = Encode(A, A, A, A, A, A);\n    }\n    if (p.y == 12)\n    {\n        if(p.x <= 5) \t\tsum = Encode(A, A, A, A, C, G);\n        else if(p.x <= 11) \tsum = Encode(F, G, E, C, H, J);\n        else if(p.x <= 17) \tsum = Encode(B, M, I, M, C, C);\n        else if(p.x <= 23) \tsum = Encode(J, C, A, A, A, A);\n        //else if(p.x <= 29) \tsum = Encode(A, A, A, A, A, A);\n        //else if(p.x <= 35) \tsum = Encode(A, A, A, A, A, A);\n    }\n    if (p.y == 13)\n    {\n        if(p.x <= 5) \t\tsum = Encode(A, A, A, A, A, B);\n        else if(p.x <= 11) \tsum = Encode(F, G, G, C, J, B);\n        else if(p.x <= 17) \tsum = Encode(M, I, I, I, C, J);\n        else if(p.x <= 23) \tsum = Encode(C, C, C, A, A, A);\n        //else if(p.x <= 29) \tsum = Encode(A, A, A, A, A, A);\n        //else if(p.x <= 35) \tsum = Encode(A, A, A, A, A, A);\n    }\n    if (p.y == 14)\n    {\n        if(p.x <= 5) \t\tsum = Encode(A, A, A, A, A, B);\n        else if(p.x <= 11) \tsum = Encode(F, I, G, C, J, B);\n        else if(p.x <= 17) \tsum = Encode(M, I, I, I, C, J);\n        else if(p.x <= 23) \tsum = Encode(C, E, E, C, C, C);\n        //else if(p.x <= 29) \tsum = Encode(A, A, A, A, A, A);\n        //else if(p.x <= 35) \tsum = Encode(A, A, A, A, A, A);\n    }\n    if (p.y == 15)\n    {\n        if(p.x <= 5) \t\tsum = Encode(A, A, A, A, A, B);\n        else if(p.x <= 11) \tsum = Encode(F, I, G, E, J, B);\n        else if(p.x <= 17) \tsum = Encode(D, M, M, I, B, H);\n        else if(p.x <= 23) \tsum = Encode(C, G, G, E, E, E);\n        else if(p.x <= 29) \tsum = Encode(C, C, C, C, A, A);\n        //else if(p.x <= 35) \tsum = Encode(A, A, A, A, A, A);\n    }\n    if (p.y == 16)\n    {\n        if(p.x <= 5) \t\tsum = Encode(A, A, B, A, A, B);\n        else if(p.x <= 11) \tsum = Encode(C, F, G, J, B, B);\n        else if(p.x <= 17) \tsum = Encode(C, C, D, B, H, C);\n        else if(p.x <= 23) \tsum = Encode(F, F, F, F, G, G);\n        else if(p.x <= 29) \tsum = Encode(E, D, C, E, C, C);\n        else if(p.x <= 35) \tsum = Encode(C, A, A, A, A, A);\n    }\n    if (p.y == 17)\n    {\n        if(p.x <= 5) \t\tsum = Encode(A, A, B, B, A, B);\n        else if(p.x <= 11) \tsum = Encode(H, C, E, J, C, F);\n        else if(p.x <= 17) \tsum = Encode(G, G, B, H, J, C);\n        else if(p.x <= 23) \tsum = Encode(C, C, G, I, F, F);\n        else if(p.x <= 29) \tsum = Encode(D, M, E, G, E, C);\n        else if(p.x <= 35) \tsum = Encode(E, C, A, A, A, A);\n    }\n    if (p.y == 18)\n    {\n        if(p.x <= 5) \t\tsum = Encode(A, B, L, K, B, A);\n        else if(p.x <= 11) \tsum = Encode(B, H, H, C, F, G);\n        else if(p.x <= 17) \tsum = Encode(J, I, E, B, C, A);\n        else if(p.x <= 23) \tsum = Encode(A, A, C, C, C, C);\n        else if(p.x <= 29) \tsum = Encode(H, E, G, F, C, C);\n        else if(p.x <= 35) \tsum = Encode(E, C, A, A, A, A);\n    }\n    if (p.y == 19)\n    {\n        if(p.x <= 5) \t\tsum = Encode(A, B, L, K, B, A);\n        else if(p.x <= 11) \tsum = Encode(B, C, C, G, F, F);\n        else if(p.x <= 17) \tsum = Encode(G, G, J, C, A, A);\n        else if(p.x <= 23) \tsum = Encode(A, A, A, A, A, A);\n        else if(p.x <= 29) \tsum = Encode(C, C, F, I, F, G);\n        else if(p.x <= 35) \tsum = Encode(C, C, A, A, A, A);\n    }\n    if (p.y == 20)\n    {\n        if(p.x <= 5) \t\tsum = Encode(B, K, L, L, K, B);\n        else if(p.x <= 11) \tsum = Encode(G, C, E, G, I, B);\n        else if(p.x <= 17) \tsum = Encode(G, G, E, B, A, A);\n        else if(p.x <= 23) \tsum = Encode(A, A, A, A, A, A);\n        else if(p.x <= 29) \tsum = Encode(A, A, C, G, E, C);\n        else if(p.x <= 35) \tsum = Encode(C, A, A, A, A, A);\n    }\n    if (p.y == 21)\n    {\n        if(p.x <= 5) \t\tsum = Encode(A, C, K, K, L, B);\n        else if(p.x <= 11) \tsum = Encode(E, C, C, E, H, B);\n        else if(p.x <= 17) \tsum = Encode(G, E, B, B, B, B);\n        else if(p.x <= 23) \tsum = Encode(A, A, A, A, A, A);\n        else if(p.x <= 29) \tsum = Encode(A, A, A, C, F, C);\n        else if(p.x <= 35) \tsum = Encode(G, C, A, A, A, A);\n    }\n    if (p.y == 22)\n    {\n        if(p.x <= 5) \t\tsum = Encode(A, A, C, C, K, L);\n        else if(p.x <= 11) \tsum = Encode(C, C, C, K, E, B);\n        else if(p.x <= 17) \tsum = Encode(C, C, J, J, J, H);\n        else if(p.x <= 23) \tsum = Encode(B, A, A, A, A, A);\n        else if(p.x <= 29) \tsum = Encode(A, A, A, C, F, C);\n        else if(p.x <= 35) \tsum = Encode(E, G, C, A, A, A);\n    }\n    if (p.y == 23)\n    {\n        if(p.x <= 5) \t\tsum = Encode(A, A, A, A, C, C);\n        else if(p.x <= 11) \tsum = Encode(H, J, H, C, C, C);\n        else if(p.x <= 17) \tsum = Encode(J, J, J, H, C, C);\n        else if(p.x <= 23) \tsum = Encode(A, A, A, A, A, A);\n        else if(p.x <= 29) \tsum = Encode(A, A, A, A, C, F);\n        else if(p.x <= 35) \tsum = Encode(C, F, C, A, A, A);\n    }\n    if (p.y == 24)\n    {\n        if(p.x <= 5) \t\tsum = Encode(A, A, A, A, A, A);\n        else if(p.x <= 11) \tsum = Encode(C, J, J, J, J, J);\n        else if(p.x <= 17) \tsum = Encode(H, H, C, C, A, A);\n        else if(p.x <= 23) \tsum = Encode(A, A, A, A, A, A);\n        else if(p.x <= 29) \tsum = Encode(A, A, A, A, C, I);\n        else if(p.x <= 35) \tsum = Encode(C, C, A, A, A, A);\n    }\n    if (p.y == 25)\n    {\n        if(p.x <= 5) \t\tsum = Encode(A, A, A, A, A, A);\n        else if(p.x <= 11) \tsum = Encode(C, J, J, J, H, H);\n        else if(p.x <= 17) \tsum = Encode(H, H, H, C, A, A);\n        else if(p.x <= 23) \tsum = Encode(A, A, A, A, A, A);\n        else if(p.x <= 29) \tsum = Encode(A, A, A, A, A, C);\n        //else if(p.x <= 35) \tsum = Encode(A, A, A, A, A, A);\n    }\n    if (p.y == 26)\n    {\n        if(p.x <= 5) \t\tsum = Encode(A, A, A, A, A, A);\n        else if(p.x <= 11) \tsum = Encode(A, C, C, J, J, J);\n        else if(p.x <= 17) \tsum = Encode(H, H, C, A, A, A);\n        //else if(p.x <= 23) \tsum = Encode(A, A, A, A, A, A);\n        //else if(p.x <= 29) \tsum = Encode(A, A, A, A, A, A);\n        //else if(p.x <= 35) \tsum = Encode(A, A, A, A, A, A);\n    }\n    if (p.y == 27)\n    {\n        if(p.x <= 5) \t\tsum = Encode(A, A, A, A, A, A);\n        else if(p.x <= 11) \tsum = Encode(A, A, A, C, C, C);\n        else if(p.x <= 17) \tsum = Encode(C, C, A, A, A, A);\n        //else if(p.x <= 23) \tsum = Encode(A, A, A, A, A, A);\n        //else if(p.x <= 29) \tsum = Encode(A, A, A, A, A, A);\n        //else if(p.x <= 35) \tsum = Encode(A, A, A, A, A, A);\n    }\n    \n    //p.x = int(fract(float(p.x)/6.)*6.);\n    if (p.x > 5) p.x -= 6;\n    if (p.x > 5) p.x -= 6;\n    if (p.x > 5) p.x -= 6;\n    if (p.x > 5) p.x -= 6;\n    if (p.x > 5) p.x -= 6;\n\n\t//decode\n    float g = mod( floor(sum/pow(16.0,float(p.x))), 16.0 );\n    \n    \n    //background\n    vec3 col = vec3(0.63,0.63,0.64)*0.5;\n    \n    \n    //palette\n    //if (g > 12.) col = vec3(0);\n    if (g > 11.) col = vec3(200./255., 168./255., 104./255.);\n    else if (g > 10.) col = vec3(136./255., 64./255., 0./255.);\n    else if (g > 9.) col = vec3(208./255., 112./255., 0./255.);\n    else if (g > 8.) col = vec3(248./255., 240./255., 176./255.);\n    else if (g > 7.) col = vec3(248./255., 248./255., 232./255.);\n    else if (g > 6.) col = vec3(192./255., 160./255., 112./255.);\n    else if (g > 5.) col = vec3(208./255., 144./255., 64./255.);\n    else if (g > 4.) col = vec3(248./255., 216./255., 128./255.);\n    else if (g > 3.) col = vec3(136./255., 80./255., 16./255.);\n    else if (g > 2.) col = vec3(128./255., 96./255., 48./255.);\n    else if (g > 1.) col = vec3(72./255., 40./255., 0./255.);\n    else if (g > 0.) col = vec3(24./255., 16./255., 8./255.);\n    \n    return col;\n}\n\nvec3 dither(in ivec2 p) {\n    vec3 col1 = vec3(.5,0.2,.7);\n    vec3 col2 = vec3(0.7,0.2,0.5);\n    float g = mod(gl_FragCoord.x + gl_FragCoord.y,2.);\n    return mix(col1,col2, g);\n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 p = fragCoord;\n    p += vec2(0.0, -5.0);\n    vec3 col = sprite(ivec2(p)-ivec2(15,10));\n    //col = mix(col, dither(ivec2(p)-ivec2(30,7)), step(abs(p.x-60.),7.) * step(abs(p.y-25.),7.));\n    fragColor = vec4(col, 1.0);\n}","name":"Buffer B","description":"","type":"buffer"}]}