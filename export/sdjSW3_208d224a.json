{"ver":"0.1","info":{"id":"sdjSW3","date":"1621179639","viewed":62,"name":"Heart Marching","username":"kithy","description":"3d heart repeat.\nOriginal:http://glslsandbox.com/e#39397.0","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["raymarching","distancefunction","heart"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"//Original:http://glslsandbox.com/e#39397.0\n\n#define MAX_STEPS 24\n\nmat2 rot(float a){\n\tfloat s=sin(a);\n\tfloat c=cos(a);\n\treturn mat2(c,-s,s,c);\n}\n\nfloat sdHeart(vec3 p){\n\treturn sqrt(p.x*p.x+2.25*p.y*p.y+p.z*p.z+pow(p.x*p.x+0.1125*p.y*p.y,0.33)*p.z)-1.0;\n}\n\nfloat mainDist(vec3 p){\n\tp.zy*=rot(90.0);\n\t//p.xy*=rot(iTime*0.1);\n\tp=mod(p,8.0)-4.0;\n\t\n\treturn sdHeart(p);\n}\n\nvec3 genNormal(vec3 p){\n\tfloat EPS=0.001;\n\treturn normalize(vec3(\n\t\tmainDist(p+vec3(EPS,0.0,0.0))-mainDist(vec3(-EPS,0.0,0.0)),\n\t\tmainDist(p+vec3(0.0,EPS,0.0))-mainDist(vec3(0.0,-EPS,0.0)),\n\t\tmainDist(p+vec3(0.0,0.0,EPS))-mainDist(vec3(0.0,0.0,-EPS))\n\t\t));\n}\n\nvoid mainImage(out vec4 fragColor,in vec2 fragCoord){\n\tvec2 p=(2.0*fragCoord.xy-iResolution.xy)/iResolution.y;\n\tvec3 cPos=vec3(0.0,0.0,2.5-iTime);\n\tvec3 cDir=vec3(0.0,0.0,-1.0);\n\tvec3 cUp=vec3(0.0,1.0,0.0);\n\tvec3 cSide=cross(cDir,cUp);\n\tfloat targetDepth=1.0;\n\tvec3 ray=normalize(cSide*p.x+cUp*p.y+cDir*targetDepth);\n\tfloat dist=0.0;\n\tfloat rLen=0.0;\n\tvec3 rPos=cPos;\n\n\tvec4 col=vec4(0.0,0.0,0.0,1.0);\n\n\tfor(int i=0;i<MAX_STEPS;i++){\n\t\tdist=mainDist(rPos);\n\t\trLen+=dist;\n\t\trPos=cPos+ray*rLen;\n\t}\n\tif(abs(dist)<0.001){\n\t\tvec3 normal=genNormal(rPos);\n\t\tvec3 light=normalize(vec3(1.0));\n\t\tfloat diff=max(dot(normal,light),0.9);\n\n\t\tcol=vec4(vec3(diff*1.0,diff*0.01,diff*0.01),1.0);\n\t\t\n\t}\n\tfragColor=col;\n}","name":"Image","description":"","type":"image"}]}