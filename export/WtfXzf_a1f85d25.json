{"ver":"0.1","info":{"id":"WtfXzf","date":"1563692105","viewed":1276,"name":"Spaghetti Ink","username":"Kali","description":"Experimental raymarching of a fractal.","likes":63,"published":1,"flags":0,"usePreview":0,"tags":["raymarching","fractal","experimental"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define mouse (iMouse.xy/iResolution.xy-.5)\nconst float det=.003;\nconst float maxdist=30.;\nfloat l=0.;\nmat2 rotm;\nvec3 basecol=vec3(.5,.5,1.);\n\nmat3 lookat(vec3 dir, vec3 up){\n    dir=normalize(dir);vec3 rt=normalize(cross(dir,normalize(up)));\n    return mat3(rt,cross(rt,dir),dir);\n}\n\nmat2 rot2D(float a) {\n    a=radians(a);\n\tfloat s=sin(a);\n    float c=cos(a);\n    return mat2(c,s,-s,c);\n}\n\n\nfloat de(vec3 p) {\n    p.xz*=rot2D(mouse.x*360.);\n    p=abs(5.-mod(p+5.,10.));\n    float md=100.;\n    float s=1.25;\n    float sc=1.;\n    vec3 pc;\n\tvec3 mp=vec3(100.);\n    float rot=sin(iTime*.1)*20.;\n    for (int i=0; i<8; i++) {\n        p.xy=abs(p.xy); \n        p=p*s-1./sc;\n        sc*=s;\n        p.xz*=rotm;\n        p.yz*=rot2D(30.+rot);\n        float d=length(p.xz+sin(p.y)*.5)-.2/sc;\n\t\tmp=min(mp,abs(p));\n        if (d<md) {\n        \tmd=d;\n\t\t\tpc=p;\n        }\n    }\n    l=mod(pc.y*.05-iTime*.1,.5)*2.;\n    return md/sc;\n}\n\nvec3 march(vec3 from, vec3 dir) {\n\tvec3 p, col=vec3(0.);\n    float totdist=0., d;\n    for (int i=0; i<100; i++) {\n    \tp=from+totdist*dir;\n        d=de(p);\n    \ttotdist+=max(det,d);\n        if (totdist>maxdist||length(col)>.3) break;\n        col+=max(0.,det-d)*l;\n    }\n\tcol=.96-col*2.5*vec3(3.,2.,1.);\n    return col;\n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv=fragCoord/iResolution.xy-.5;\n    uv.x*=iResolution.x/iResolution.y;\n    rotm=rot2D(-90.);\n    vec3 dir=normalize(vec3(uv,.7));\n    vec3 from=vec3(1.,2.,-5.);\n    from.xz*=rot2D(iTime*3.);\n    from.yz*=rot2D(iTime);\n    dir=lookat(-from,vec3(.5,1.,0.))*dir;\n\tvec3 col=march(from, dir);   \n\tcol=mix(vec3(1.),col,min(1.,iTime*.2));\n    col=min(col,1.-smoothstep(.85,1.,abs(1.-mod(uv.y*60.,2.)))*.4);\n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}