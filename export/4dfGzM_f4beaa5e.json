{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[],"code":"float time;\n\nvec3 rotate(vec3 r, float v){ return vec3(r.x*cos(v)+r.z*sin(v),r.y,r.z*cos(v)-r.x*sin(v));}\n\n\nvec3 blob(float i){ \n\t\n\tfloat t   = max(0.0,time+(time*(mod(i,10.0)*0.1)));\n\tvec3  s   = vec3(sin(i*1.02),(mod(t*0.2+i*0.01+sin(i)*30.0,1.0)-0.5)*13.0,sin(i*0.1));\n\t\t  s  *= 1000.0;\n\tfloat f   = s.y+1000.0;\n\tfloat f1  = min(f,0.0)-abs(sin(abs(max(f,0.0)*0.0009)))*clamp(1.0-f/3000.0,0.0,1.0)*3000.0*mod(i*0.2,1.0);\n\tfloat f2  = s.y-f1;\n\tvec3  m  = s + s*f2*0.0004;\n\tvec3  ss = vec3(m.x,f1,m.z);\n\treturn ss;\n\t}\n\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ){\n\n\ttime        = iTime*0.3;\n\n\tfloat BALL_SIZE = 0.9999;\n\tfloat BLEND_DEPTH = 200.0;\n\tfloat BLEND_BALL = 0.004;\n\t\n    vec2  uv     = fragCoord.xy/(iResolution.xx*0.5)-vec2(1.0,iResolution.y/iResolution.x);\n\tfloat rot    = sin(time)*0.5+iMouse.x*0.01;\n    vec3  ray1   = rotate(-normalize(vec3(uv.x,uv.y-0.3,1.0)),rot);\n    vec3  campos = rotate(vec3(0.0,-3000.0,7000.0),rot);\n\tvec3  blobpos= vec3(0.0);\n\t\t\n\t\t\n    float i = 0.0;\n    float cl = 0.0;  \n\tfloat ca = 0.0;\n    vec3  cp = vec3(0.0);\n\tfloat cd = 99999.9;    \n\n\tfloat ii = 0.0;\n\t\n    for(int i=0;i<100;i++){\n        \n\t\tblobpos = blob(ii);\n\t\t\n        vec3  vect  = blobpos-campos;\n        float vectm = length(vect);     \n        vec3  vectn = vect/vectm;\n\t\t\n        float d = dot(ray1,vectn);\n\t\tfloat c = BALL_SIZE/d;\n\t\tfloat w = (smoothstep(-BLEND_DEPTH,0.0,cd-vectm) * smoothstep(c-BLEND_BALL,c,d));\n\t\t\n\t\tcd = mix(cd,vectm,w);\n\t\tcp = mix(cp,blobpos,w);\n\t\tcl = mix(cl,d,w);\n\n\t\tii ++;\n\t\t\n\t};\n    \n\n\tfloat a = dot(ray1, cp-campos );\n\tvec3  contact = campos+ray1*a;\n\tvec3  norm = normalize(cp-contact);\t\n\tfloat dist = length(cp-contact);\t\n\n\tfloat cut   = clamp(smoothstep(0.80,0.99,cl)-pow(smoothstep(400.0,0.0,dist),1.0),0.0,1.0);\n\tfloat angle = dot(norm,vec3(0.0,0.8,0.2));\n\t\n\tfloat sha  = smoothstep(-0.3,-0.5,angle)*0.5;\n\tfloat hil  = smoothstep(0.6,0.8,angle);\n\tfloat sha2 = smoothstep(1.0,0.0,max(0.0,-contact.y))*smoothstep(0.40,0.98,cl);\n\t\n\tvec3 backcol = vec3(0.25,0.35,0.4)-sha2*0.15+smoothstep(0.0,0.4,ray1.y-0.1)*0.4;\n\t\n\tvec3 blobcol = vec3(0.3,0.4,0.45);\n\t\t blobcol = mix(blobcol,vec3(0.0,0.0,0.05),sha); \n\t\t blobcol = mix(blobcol,vec3(1.0),hil); \n\n\tfragColor = vec4(sqrt(mix(backcol,blobcol,cut))-dot(uv,uv)*0.4,1.0);\n    \n    \n}\n\n","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"4dfGzM","date":"1365107834","viewed":2887,"name":"Waterfall","username":"ztri","description":"Falling water thing","likes":50,"published":1,"flags":0,"usePreview":0,"tags":["metaballs"],"hasliked":0,"parentid":"","parentname":""}}