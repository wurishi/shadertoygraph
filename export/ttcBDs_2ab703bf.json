{"ver":"0.1","info":{"id":"ttcBDs","date":"1613678655","viewed":829,"name":"Refactoring Blackpool","username":"evvvvil","description":"Refactoring Blackpool - Result of improvised live code session on Twitch\nLIVE SHADER CODING, SHADER SHOWDOWN STYLE, EVERY TUESDAYS 20:00 Uk time:\nhttps://www.twitch.tv/evvvvil_","likes":25,"published":3,"flags":0,"usePreview":0,"tags":["demoscene","glow","alien","city","scifi","cut","lazer","network","structure","industrial","building","extrusion","brutalist","modernist"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// Refactoring Blackpool - Result of an improvised live coding session on Twitch\n// LIVE SHADER CODING, SHADER SHOWDOWN STYLE, EVERY TUESDAYS 20:00 Uk time: \n// https://www.twitch.tv/evvvvil_\n\n// \"One day kids, I'll refactor Blackpool\" - Le Corbusier \n\nvec2 z,v,e=vec2(.00035,-.00035);float t,tt,b,g=0.,gg=0.;vec3 np,pp,po,no,al,ld,cp,op;\nfloat bo(vec2 p, vec2 b ){ p= abs(p)-b;return length(max(p,0.))+min(max(p.x,p.y),0.);}\nfloat box(vec3 p, vec3 b ){ p= abs(p)-b;return max(max(p.x,p.y),p.z);}\nmat2 r2(float r){return mat2(cos(r),sin(r),-sin(r),cos(r));}\nfloat ex(vec3 p,float sdf,float h){vec2 w=vec2(sdf,abs(p.y)-h);return min(max(w.x,w.y),0.0)+length(max(w,0.0));}\nvec2 mp( vec3 p)\n{\n  op=p;\n  p.x=mod(p.x-tt*0.7,20.)-10.;\n  np=vec3(p.xz*.5,1.0);\n  pp=p-vec3(0,3,0);  \n  pp.xz=mod(pp.xz,5.)-2.5;\n  pp.yz*=r2(.785);\n  vec2 h=vec2(1000,6),t=vec2(1000,5);  \n  float cutBox=box(pp,vec3(2.0,1.5,2.5));    \n  for(int i=0;i<4;i++){\n    b=float(i);\n    np.xy=abs(np.xy)-2.0;    \n    np.xy*=r2(.785*(b+1.));\n    np*=1.8;\n    np.y=abs(np.y)-1.5;         \n    t.x=min(t.x,ex(p,max(bo(np.xy,vec2(5,.2))/np.z*2.0,-cutBox),1.0+b*.5)); \n    t.x=abs(t.x)-.02*max(sin(p.y*10.),0.1)-.04*clamp(sin(np.x*2.5),.1,.5); \n    h.x=min(h.x,ex(p,bo(np.xy,vec2(5.,0.01))/np.z*2.0,.25+b*.5-0.1*cos(op.x*1.3+1.5)));    \n    t.x=max(t.x,abs(p.y)-0.3-b*.5);     \n  } \n  h.x=max(h.x,-cutBox+.1);    \n  g+=0.1/(0.1+h.x*h.x*(1.-sin(op.x*1.3)*.9)*1600.);    \n  cp=vec3(np.xy,p.y*2.);\n  h.x=min(h.x,box(cp+vec3(-5.,2,0),vec3(1.7,1,5.+sin(p.x*.7)))/np.z*2.);\n  float part=length(cos(cp.yz*20.));   \n  part=max(part,p.y-1.5);\n  gg+=0.1/(0.1+part*part*12.);\n  t.x=min(t.x,part);\n  t=t.x<h.x?t:h;\n  return t;\n}\nvec2 tr( vec3 ro, vec3 rd)\n{\n  vec2 h,t=vec2(.1);\n  for(int i=0;i<128;i++){\n    h=mp(ro+rd*t.x);\n    if(t.x<.0001||t.x>20.) break;\n    t.x+=h.x;t.y=h.y;\n  }\n  if(t.x>20.) t.y=0.;\n  return t;\n}\n#define a(d) clamp(mp(po+no*d).x/d,0.,1.)\n#define s(d) smoothstep(0.,1.,mp(po+ld*d).x/d)\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n  vec2 uv=(fragCoord.xy/iResolution.xy-0.5)/vec2(iResolution.y/iResolution.x,1);\n  tt=mod(iTime,62.82);\n  vec3 ro=vec3(10.,2.9-sin(tt*.2)*.8,-4.+ceil(cos(tt*.2))*8.+cos(tt*0.4)*2.),\n  cw=normalize(vec3(0,-6,0)-ro),cu=normalize(cross(cw,vec3(0,1,0))),\n  cv=normalize(cross(cu,cw)),rd=mat3(cu,cv,cw)*normalize(vec3(uv,.5)),co,fo;  \n  co=fo=vec3(.18,.16,.2)-length(uv)*.25;\n  ld=normalize(vec3(.2,.4,-.3));  \n  z=tr(ro,rd);t=z.x;\n  if(z.y>0.){    \n    po=ro+rd*t;\n    no=normalize(e.xyy*mp(po+e.xyy).x+\n    e.yyx*mp(po+e.yyx).x+\n    e.yxy*mp(po+e.yxy).x+\n    e.xxx*mp(po+e.xxx).x);\n    no-=0.3*ceil(abs(sin(cp*10.))-.1);no=normalize(no);\n    al=mix(vec3(0.4),vec3(0.0,0.15,0.75 ),cp.y*.5);\n    if(z.y>5.) al=vec3(1.2);\n    float dif=max(0.,dot(no,ld)),\n    fr=pow(1.+dot(no,rd),4.),\n    sp=pow(max(dot(reflect(-ld,no),-rd),0.),40.);\n    co=mix(sp+al*(a(.12)+.2)*(dif+s(2.)),fo,min(fr,0.4));    \n    co=mix(fo,co,exp(-.0007*t*t*t));\n  }\n  fragColor = vec4(pow(co+g*.1*vec3(.1,.2,.7)+gg*.05*vec3(.4,.1,.1),vec3(.65)),1);\n}","name":"Image","description":"","type":"image"}]}