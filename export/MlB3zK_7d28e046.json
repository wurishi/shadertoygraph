{"ver":"0.1","info":{"id":"MlB3zK","date":"1430310934","viewed":143,"name":"002 Dynamic Ebbinghaus Illusion","username":"nmarsden","description":"Press the 'space bar' to break the illusion\n\nMore info about the illusion is at http://illusionoftheyear.com/2014/the-dynamic-ebbinghaus/\n","likes":3,"published":1,"flags":16,"usePreview":0,"tags":["2d","illusion"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGRr","filepath":"/presets/tex00.jpg","previewfilepath":"/presets/tex00.jpg","type":"keyboard","channel":0,"sampler":{"filter":"nearest","wrap":"clamp","vflip":"false","srgb":"false","internal":"byte"},"published":1}],"outputs":[],"code":"const float PI = 3.141592;\nconst float PI2 = 2.0 * PI;\n\nconst float MIDDLE_CIRCLE_RADIUS = 0.08;\n\nconst vec2 MIDDLE_CIRCLE_START_POS = vec2(-MIDDLE_CIRCLE_RADIUS*6.0, MIDDLE_CIRCLE_RADIUS*6.0);\n\nconst vec2 MIDDLE_CIRCLE_END_POS = vec2(MIDDLE_CIRCLE_START_POS.x + (MIDDLE_CIRCLE_RADIUS*12.0), MIDDLE_CIRCLE_START_POS.y - (MIDDLE_CIRCLE_RADIUS*12.0));\n\nconst float OUTER_CIRCLE_RADIUS_MIN = 0.5 * MIDDLE_CIRCLE_RADIUS;\nconst float OUTER_CIRCLE_RADIUS_MAX = 2.0 * MIDDLE_CIRCLE_RADIUS;\nconst float MARKER_RADIUS = 0.005;\n\nconst vec3 BACKGROUND_COLOUR = vec3(1.0, 1.0, 1.0);\nconst vec3 CIRCLE_COLOUR     = vec3(0.1, 0.1, 0.1);\nconst vec3 MARKER_COLOUR     = vec3(1.0, 1.0, 0.0);\nconst vec3 LINE_COLOUR       = vec3(0.8, 0.8, 1.0);\n\nbool keyToggle( int ascii ) \n{\n\treturn (texture(iChannel0, vec2((0.5 + float(ascii)) / 256.0, 0.75)).x > 0.0);\n}\n\nfloat draw_circle( vec2 uv, vec2 center, float radius ) \n{\n    vec2 p1 = uv - center;\n    \n    return step(sqrt(dot(p1, p1)), radius);\n}\n\nfloat draw_horizontal_line( vec2 uv, vec2 start_point, vec2 end_point, float line_width )\n{\n    if (uv.x < min(start_point.x, end_point.x) || uv.x > max(start_point.x, end_point.x)) {\n        return 0.0;\n    }\n    if (uv.y >= (start_point.y - line_width*0.5) && uv.y <= (start_point.y + line_width*0.5)) {\n        return 1.0;\n    }\n    return 0.0;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 uv = fragCoord.xy / iResolution.xy;\n    vec2 p = (uv * 2.0) - 1.0;\n    p.x *= iResolution.x / iResolution.y;\n    float t = iTime;\n\n    float anim = 0.5 * sin(t) + 0.5;\n        \n    vec2 offset = mix(MIDDLE_CIRCLE_START_POS, MIDDLE_CIRCLE_END_POS, anim);\n    \n    float outer_circle_radius = mix(OUTER_CIRCLE_RADIUS_MIN, OUTER_CIRCLE_RADIUS_MAX, anim);\n\n    vec3 black = vec3(0.0, 0.0, 0.0);\n    \n    vec3 c = black;\n\n    // check keyboard\n    bool showLines = keyToggle(32); // space bar\n\n    // draw middle circle\n    c +=  mix(CIRCLE_COLOUR * draw_circle(p, offset, MIDDLE_CIRCLE_RADIUS), black, ceil(c));\n    \n    // draw outer circles\n    for (float a = 0.0; a<=PI2; a += PI2/6.0) \n    {\n        vec2 center = vec2(cos(a), sin(a));\n        center *= (MIDDLE_CIRCLE_RADIUS + (outer_circle_radius * 2.0));\n        center += offset;\n\n        // draw marker\n        if (a < PI && a > PI/2.0) {\n\t\t    c +=  mix(MARKER_COLOUR * draw_circle(p, center, MARKER_RADIUS), black, ceil(c));\n        }\n    \t// draw outer circle\n\t    c +=  mix(CIRCLE_COLOUR * draw_circle(p, center, outer_circle_radius), black, ceil(c));\n    }\n\n    if (showLines) \n    {\n    \t// draw lines to break the illusion\n        float x1 = MIDDLE_CIRCLE_START_POS.x;\n        float x2 = MIDDLE_CIRCLE_END_POS.x;\n        for (float y=MIDDLE_CIRCLE_END_POS.y; y <= MIDDLE_CIRCLE_START_POS.y; y += MIDDLE_CIRCLE_RADIUS*4.0) \n        {\n            c += mix(LINE_COLOUR * draw_circle(p, vec2(x1, y), MIDDLE_CIRCLE_RADIUS), black, ceil(c));\n            c += mix(LINE_COLOUR * draw_horizontal_line(p, vec2(x1, y), vec2(x2, y), MIDDLE_CIRCLE_RADIUS*2.0), black, ceil(c));\n            c += mix(LINE_COLOUR * draw_circle(p, vec2(x2, y), MIDDLE_CIRCLE_RADIUS), black, ceil(c));\n        }\n    }\n    \n    c = mix(BACKGROUND_COLOUR, c, ceil(c));\n    \n    c = mix(c, vec3(dot(c,vec3(.33))),.5);\n    \n    fragColor = vec4(c, 1.0);\n}\n","name":"","description":"","type":"image"}]}