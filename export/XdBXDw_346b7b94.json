{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[{"channel":0,"type":"texture","id":"XdXGzn","filepath":"/media/a/3083c722c0c738cad0f468383167a0d246f91af2bfa373e9c5c094fb8c8413e0.png","sampler":{"filter":"mipmap","wrap":"repeat","vflip":"false","srgb":"false","internal":"byte"}}],"code":"float s = 2.;\nfloat t = 1.;\nfloat gt;\n\nfloat h1(vec2 p) {\n    return texture(iChannel0, p.xy*.04).z;\n}\n\nfloat h(vec2 p) {\n    return \n        h1(p) - 0.5*h1(p*2.) + 0.25*h1(p*4.) - 0.125*h1(p*8.) + 0.06*h1(p*16.) - 0.03*h1(p*32.) + 0.015*h1(p*64.)\n        ;\n}\n\nfloat df(vec3 p) {\n    return p.y - h(p.xz);\n}\n\nmat3 rotationXY( vec2 angle ) {\n\tvec2 c = cos( angle );\n\tvec2 s = sin( angle );\n\treturn mat3(\n\t\tc.y      ,  0.0, -s.y      ,\n\t\ts.y * s.x,  c.x,  c.y * s.x,\n\t\ts.y * c.x, -s.x,  c.y * c.x\n\t);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\t{\ngt = 10. + iTime * .1;\n\n\tvec2 p2=(fragCoord.xy/iResolution.xy)*2.0-1.0;\n    vec2 m=iMouse.yx/iResolution.yx*2.-1.;\n    m.y = -m.y;\n    mat3 rot = rotationXY(m+vec2(1.,0.0));\n\tvec3 dir = rot * normalize(vec3(p2*vec2(1.77,1.0),3.0));\t\t// screen ratio (x,y) fov (z)\n\tvec3 o = vec3(0.0, 0.0, gt);\n    o.y = h1(o.xz) + .2;\n\tvec3 hit;\n\tfloat t=0.0, k;\n\tfor(int i=0;i<48;i++) {\n        hit=o+dir*t;\n\t\tk=df(hit);\n\t\tt+=k*.3;\n\t}\n    vec2 e=vec2(-0.01, 0.0);\n    vec3 n = normalize(vec3(k-df(hit+e.xyy), k-df(hit+e.yxy), k-df(hit+e.yyx)));\n    //vec3 tex = vec3( texture(iChannel0, hit.xz*4.0) );\n    float dent =  h(hit.xz*128.)*3.-1.5;// tex.r * hit.y;\n    float dif = max(0.,dot(n,-dir));\n    n = rotationXY(vec2(0.0,dent)) * n;\n    dif += max(0.,dot(n,-dir));\n    dif *= 0.5;\n    //float fre = 0.5 + pow(dif, 4.0);\n    vec3 c = vec3(.6,.5,.4) * dif;\n    vec3 fogc = vec3(.7,.8,.9) * (1.0+dir.y);//(1.2-max(0.0,-dir.y));\n    //c = max(vec3(0.0), c);\n    c *= min(1.2, .25+hit.y* 2.);\n    c = mix(c, fogc, min(1.0,length(o-hit)*0.75*max(1.0,-hit.y*2.)));\n    fragColor = vec4(c,1.0);\n}","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"XdBXDw","date":"1412519568","viewed":198,"name":"mountainous","username":"yonatan","description":"mouse = pan","likes":3,"published":1,"flags":0,"usePreview":0,"tags":["raymarching"],"hasliked":0,"parentid":"","parentname":""}}