{"ver":"0.1","info":{"id":"ft33Rn","date":"1635548214","viewed":440,"name":"Pencil star","username":"sinvec","description":"My first attempt at repeating a real colored pencil. Based on my previos works.","likes":32,"published":1,"flags":0,"usePreview":1,"tags":["2d","star","paint","pencil","geometry","isometric","drawing"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGzn","filepath":"/media/a/0c7bf5fe9462d5bffbd11126e82908e39be3ce56220d900f633d58fb432e56f5.png","previewfilepath":"/media/ap/0c7bf5fe9462d5bffbd11126e82908e39be3ce56220d900f633d58fb432e56f5.png","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define PI 3.14159\n#define R iResolution.xy\n#define s(v,l) smoothstep(l/R.y,0.,v) // AA\n#define ro(a) (mat2(cos(a),sin(a),-sin(a),cos(a))) // 2d rotation matrix\n\n#define C /255.\n\nfloat fbm(vec2 p){\n    return texture(iChannel0, p*.001).x*.533 +\n           texture(iChannel0, p*.01).x*.267 +\n           texture(iChannel0, p*.3).x*.133 +\n           texture(iChannel0, p*.5).x*.067; \n}\n\nfloat pencil_hatching(vec2 u, vec3 p) {\n    u *= p.x;\n    vec2 o = u; \n    u.x *= p.y;\n    u+= (fbm(u)-.5)*p.z;\n    float col = sin(u.x);\n    u.x += u.y * 2.;\n    col *= sin(u.x);\n    return col * .5 + .5;\n}\n\nfloat watercolor (vec2 p) {\n       p*=8.;\n       vec2 q = vec2(0.);\n       q.x = fbm(p);\n       q.y = fbm( p + vec2(1.0));\n       vec2 r = vec2(0.);\n       r.x = fbm( p + 1.0*q + vec2(1.7,9.2));\n       r.y = fbm( p + 1.0*q + vec2(8.3,2.8));\n       float f = fbm(p+r);\n       return clamp(f,0.,1.);\n}\n\n\nfloat pencil_texture (vec2 u) {\n    vec2 o = u;\n    float col = watercolor(o*ro(+1.35)*10.);\n    col *= pencil_hatching(u+vec2(2.15, 0.), vec3(90.,9., 8.));\n    col *= pencil_hatching(u+vec2(3.15, 0.), vec3(80.,7., 8.));\n    col += pencil_hatching(u+vec2(3.15, 0.), vec3(15.,7., 4.));\n    col *= watercolor(o*ro(-2.95)*1.)*.7;\n    col = mix(col, 1., 1.-texture(iChannel0, u*10.).x*2.);\n    return col;\n}\n \n\nfloat lineseg(in vec2 p, in vec2 a, in vec2 b){\n    vec2 ba = b-a, pa = p-a;\n    float h = clamp(dot(pa,ba)/dot(ba,ba), 0., 1.);\n    return length(pa-h*ba);\n}\n\n\nvoid mainImage( out vec4 O, in vec2 E )\n{\n    vec2 u = (E - R*.5)/R.y;\n\n    vec3 col = vec3(.9);\n    \n    col = mix(col, col*.7, texture(iChannel0, u*5.).x*.5);\n    col += texture(iChannel0, (u+vec2(.125,.382))*5.).x*.6;\n\n    const float r = .02;\n    const float a = r * PI;\n    const float b = a * 1.2;\n    const float h = r / (sqrt(5.) - 1.);\n    const float t36 = tan(PI / 5.0);\n    const float s72 = sin(PI / 2.5);\n    const float c72 = cos(PI / 2.5);\n    const float t72 = s72 / c72; \n    const float s54 = sin(PI / (10. / 3.));\n    const float c54 = cos(PI / (10. / 3.));\n    \n    const vec3[5] scs = vec3[5](\n        vec3(176. C,224. C,230. C), // powderblue\n        vec3( 65. C,105. C,225. C), // royalblue\n        vec3(135. C,206. C,250. C), // lightskyblue\n        vec3(100. C,149. C,237. C), // cornflowerblue\n        vec3(135. C,206. C,235. C)  // skyblue\n    );\n    \n    float d, outline = 999.;\n    vec2 area;\n    vec2 p1, p2, p3, p4, p5, p6, p7;\n    \n    u -= (vec2(fbm(u*16.), fbm(u*16. + .35)) - .5) * .008;\n\n    for (float i = 0.; i < 5.; i++) {\n    \n        area = vec2(999.);\n    \n        p1 = vec2(0., -r);\n        p2 = vec2((a + h + r) / t36, a + h);\n        p3 = p2 + vec2(- b / t72, b);\n        p4 = vec2((a / s72) * s54, - r - (a / s72) * c54);\n        p5 = vec2((a / s72 + b / s72) * s54, - r - (a / s72 + b / s72) * c54);\n        p6 = vec2((p3.y - (p4.y - p4.x * t36))/t36, p3.y);\n        p7 = vec2((p2.y - (p5.y - p5.x * t36))/t36, p2.y);\n    \n        d = lineseg(u, p1, p2);\n        area.y = min(area.y, d);\n    \n        d = lineseg(u, p2, p3);\n        area.y = min(area.y, d);\n    \n        d = lineseg(u, p4, p6);\n        area = min(area, d);\n    \n        d = lineseg(u, p3, p6);\n        area.y = min(area.y, d);\n    \n        d = lineseg(u, p5, p7);\n        area.x = min(area.x, d);\n    \n        d = lineseg(u, p6, p7);\n        area.x = min(area.x, d);\n        \n        outline = min(min(outline, area.x), area.y);\n        \n        d = lineseg(u, p1, p4);\n        area.y = min(area.y, d);\n\n        d = lineseg(u, p4, p5);\n        area.x = min(area.x, d);\n        \n        area.x *= sign(3.5 - sign(u.y - mix(p1.y, p5.y, (u.x - p1.x) / (p5.x - p1.x)))\n                           - sign(mix(p4.y, p6.y, (u.x - p4.x) / (p6.x - p4.x)) - u.y)\n                           - sign(mix(p7.y, p6.y, (u.x - p7.x) / (p6.x - p7.x)) - u.y)\n                           - sign(u.y - mix(p5.y, p7.y, (u.x - p5.x) / (p7.x - p5.x))));\n        area.y *= sign(2.5 - sign(u.y - mix(p2.y, p3.y, (u.x - p2.x) / (p3.x - p2.x)))\n                           - sign(mix(p6.y, p3.y, (u.x - p6.x) / (p3.x - p6.x)) - u.y)\n                           - sign(u.y - mix(p4.y, p6.y, (u.x - p4.x) / (p6.x - p4.x))))\n                * sign(3.5 - sign(u.y - mix(p4.y, p6.y, (u.x - p4.x) / (p6.x - p4.x)))\n                           - sign(u.y - mix(p1.y, p5.y, (u.x - p1.x) / (p5.x - p1.x)))\n                           - sign(mix(p2.y, p3.y, (u.x - p2.x) / (p3.x - p2.x)) - u.y)\n                           - sign(mix(p2.y, p1.y, (u.x - p2.x) / (p1.x - p2.x)) - u.y)); \n        \n        col = mix(col, mix(scs[int(mod(i, 5.))], vec3(1.), pencil_texture(u*ro(-PI/(10./3.)))*1.), s(area.y, 1.5));\n        col = mix(col, mix(scs[int(mod(i + 3., 5.))], vec3(1.), pencil_texture(u*ro(-PI/(10./3.)))*1.), s(area.x, 1.5));\n        \n        u *= ro(PI / 2.5);\n    }\n    \n    col = mix(col, mix(vec3(.1),col,1.-texture(iChannel0, u*10.).x), s(outline-.001, 1.5));\n   \n\n    O = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}