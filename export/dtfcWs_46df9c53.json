{"ver":"0.1","info":{"id":"dtfcWs","date":"1691334060","viewed":45,"name":"rigid body equation1","username":"pik","description":"simulation,1 rigid","likes":1,"published":1,"flags":32,"usePreview":0,"tags":["simulation","impulse"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define rot(a) mat2(cos(a),sin(a),-sin(a),cos(a))\n#define PI 3.141592\n\nfloat B(vec2 p){\n    vec2 q=abs(p)-vec2(0.005,0.08);\n    return length(max(q,0.))+min(max(q.x,q.y),0.);\n}\n//https://iquilezles.org/articles/distfunctions2d/\nfloat T( in vec2 p, in float r )\n{\n    const float k = sqrt(3.0);\n    p.x = abs(p.x) - r;\n    p.y = p.y + r/k;\n    if( p.x+k*p.y>0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;\n    p.x -= clamp( p.x, -2.0*r, 0.0 );\n    return -length(p)*sign(p.y);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord/iResolution.xy;\n    vec3 col=vec3(0.2);\n    vec2 pos=texture(iChannel0,uv).xy;\n    float f=length(uv-pos);\n    col=mix(col,vec3(1.,0.,0.),sqrt(smoothstep(0.05,0.,f)));\n    vec2 q=uv;\n    q=uv-vec2(0.5,0.1);\n    q*=rot(-2.*PI*iMouse.x/iResolution.x+PI);\n    float b=step(B(q),0.)+step(T(q-vec2(0.,0.08),0.03),0.);\n    col=mix(col,vec3(0.,1.,1.),b);\n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"#define dt 0.01\n#define rot(a) mat2(cos(a),sin(a),-sin(a),cos(a))\n#define PI 3.141592\nconst float v0=0.1;\nconst float e=1.;\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord/iResolution.xy;\n    vec4 p=texture(iChannel0,uv);\n    mat2 i=rot(2.*PI*iMouse.x/iResolution.x-PI);\n    vec2 f=vec2(0.,0.5);\n    f*=i;\n    if(iFrame<5){\n        p.xy=vec2(0.5,0.5);\n    }\n    if(max(p.x,p.y)<1. && min(p.x,p.y)>0.){\n        p.zw+=f*dt;\n        p.xy+=p.zw*dt;\n    }\n    else if(p.x>1. || p.x<0.){\n        p.zw=reflect(p.zw,vec2(-sign(p.x-0.5),0.));\n        p.zw*=e;\n        p.xy+=p.zw*dt;\n    }\n    else if(p.y>1. || p.y<0.){\n        p.zw=reflect(p.zw,vec2(0.,-sign(p.y-0.5)));\n        p.zw*=e;\n        p.xy+=p.zw*dt;\n    }\n    fragColor=p;\n}","name":"Buffer A","description":"","type":"buffer"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"XsXGR8","channel":0}],"code":"#define dt 0.01\n#define rot(a) mat2(cos(a),sin(a),-sin(a),cos(a))\n#define PI 3.141592\nconst float v0=0.1;\nconst float e=1.;\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord/iResolution.xy;\n    vec4 p=texture(iChannel0,uv);\n    mat2 i=rot(2.*PI*iMouse.x/iResolution.x-PI);\n    vec2 f=vec2(0.,0.5);\n    f*=i;\n    if(iFrame<5){\n        p.xy=vec2(0.5,0.5);\n    }\n    if(max(p.x,p.y)<1. && min(p.x,p.y)>0.){\n        p.zw+=f*dt;\n        p.xy+=p.zw*dt;\n    }\n    else if(p.x>1. || p.x<0.){\n        p.zw=reflect(p.zw,vec2(-sign(p.x-0.5),0.));\n        p.zw*=e;\n        p.xy+=p.zw*dt;\n    }\n    else if(p.y>1. || p.y<0.){\n        p.zw=reflect(p.zw,vec2(0.,-sign(p.y-0.5)));\n        p.zw*=e;\n        p.xy+=p.zw*dt;\n    }\n    fragColor=p;\n}","name":"Buffer B","description":"","type":"buffer"}]}