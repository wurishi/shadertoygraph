{"ver":"0.1","info":{"id":"4ltXRr","date":"1477772351","viewed":1277,"name":"Mandelsmoke","username":"metabog","description":"I warped a mandelbrot set around in weird ways, then layered it and you get this mandelsmoke! It's very expensive though... if you set NSMOKES to 1 you will see the weird mandelbrot. ","likes":20,"published":1,"flags":0,"usePreview":0,"tags":["fractal","mandelbrot","smoke"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"//Complex Exponentiation - Source: http://mathworld.wolfram.com/ComplexExponentiation.html\nvec2 powC( vec2 Z, vec2 W)\n{\n    float arg = atan(Z.y / Z.x);\n    float a = exp( -W.y*arg )*pow( dot(Z,Z), W.x/4.0 ); //wihtout scaling animation\n    float b = W.x*arg + 0.5*W.y*log( dot(Z,Z) );\n    \n    return a*vec2(cos(b), sin(b));    \n} \n\nvec2 cmult(vec2 q1, vec2 q2) {\n    return vec2\n        ( q1.x * q2.x - q1.y * q2.y\n        , q1.x * q2.y + q1.y * q2.x\n        );\n}\n\nfloat smoke(vec2 uv,float param)\n{\n   float frac = 1.0;\n    vec2 z = vec2(0.0,0.0);\n    vec2 c = uv;\n    \n    float timefact = cos(iTime*0.25+param*0.001);\n    vec2 constant = (powC(cos(c),vec2(33.8-param*0.01,10.8)));\n    for(int i=0; i<20; i++)\n    { \n        //this is like the mandelbrot set function but with a bunch of random modifications\n        //I think lots of the bits can be removed and it won't look much different!\n        z = cmult(sin(z-c),cos(z*z + vec2(param))-c) + timefact*1.0*z \n            + constant;\n        \n        if(length(z)>2.0)\n        {  \n            frac = float(i)/20.0;\n            break;\n        }\n    }\n    \n    return frac;\n}\n\n#define NSMOKES 40\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    \n    vec2 uv = fragCoord.xy / iResolution.xy;\n    uv -= vec2(0.5,0.5);\n    uv*=2.0;\n    \n    //this bit calculates the warped mandelbrot with various offsets, then overlays them \n    //iwth 0.0225 multiplier for each layer\n    float smokes = 0.0;\n    for(int i =0; i<NSMOKES; i++)\n    {\n        smokes+=(smoke(uv,float(i)*30.0))*(1.0/float(NSMOKES));\n    }\n    \n\tfragColor = vec4(1.0)*smokes;\n}","name":"Image","description":"","type":"image"}]}