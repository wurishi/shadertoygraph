{"ver":"0.1","info":{"id":"tlSXDm","date":"1566073217","viewed":137,"name":"rawrscope line rendering","username":"rytone","description":"https://gitlab.com/rytone/rawrscope","likes":3,"published":1,"flags":0,"usePreview":0,"tags":["2d"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XdfGzn","filepath":"/media/a/894a09f482fb9b2822c093630fc37f0ce6cfec02b652e4e341323e4b6e4a4543.mp3","previewfilepath":"/media/ap/894a09f482fb9b2822c093630fc37f0ce6cfec02b652e4e341323e4b6e4a4543.mp3","type":"music","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"const float THICKNESS = 2.5;\n\nconst int SAMPLES = 8;\n\nfloat segment_distance(vec2 v, vec2 w, vec2 p) {\n    float l2 = length(w - v);\n    l2 *= l2;\n    float t = clamp(dot(p - v, w - v) / l2, 0.0, 1.0);\n    vec2 projection = v + t * (w - v);\n    return distance(p, projection);\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord) {\n    float WINDOW_WIDTH = iChannelResolution[0].x;\n    \n    float center = floor(fragCoord.x / iResolution.x * WINDOW_WIDTH) / WINDOW_WIDTH;\n\n    // sufficiently large number\n    float dist = 10000.0;\n    \n    for (int i = 0; i < SAMPLES; i += 1) {\n        float lx = center + float(i - SAMPLES / 2) / WINDOW_WIDTH;\n        float rx = center + float(i + 1 - SAMPLES / 2) / WINDOW_WIDTH;\n        \n        vec2 l_sample = vec2(lx, texture(iChannel0, vec2(lx, 1.0)).r) * iResolution.xy;\n        vec2 r_sample = vec2(rx, texture(iChannel0, vec2(rx, 1.0)).r) * iResolution.xy;\n        \n        float sd = segment_distance(l_sample, r_sample, fragCoord);\n        dist = min(dist, sd);\n    }\n    \n    dist -= THICKNESS / 2.0;\n    \n    // lazy distance visualization\n    // fragColor = vec4(pow(sin(dist / 10.0) * 0.5 + 0.5, 50.0));\n    \n    fragColor = vec4(vec3(pow(clamp(0.5 - dist, 0.0, 1.0), 1.0 / 2.2)), 1.0);\n}","name":"Image","description":"","type":"image"}]}