{"ver":"0.1","info":{"id":"XdGGz1","date":"1453271033","viewed":1334,"name":"Trembling Characters","username":"gaz","description":"3d","likes":29,"published":1,"flags":32,"usePreview":0,"tags":["3d"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define FAR  5.0\n\nstruct Quad {vec3 a, b, c, d;};\n    \nvec4 castRay(in vec3 ro, in vec3 rd, in Quad q)\n{\n    float z = FAR;\n    vec3 p = vec3(0.0);\n    vec3 n = cross(q.c-q.a, q.b-q.a);\n    float t = dot(q.a-ro, n)/dot(rd, n);\n    if ( t > 0.0 )\n\t{\n    \tp = ro + rd * t;\n        if (dot(cross(q.b-q.a, n), p-q.a) > 0.0) \n        if (dot(cross(q.c-q.b, n), p-q.b) > 0.0) \n        if (dot(cross(q.d-q.c, n), p-q.c) > 0.0)\n        if (dot(cross(q.a-q.d, n), p-q.d) > 0.0)\n        {\n            z = t;\n        }\n    }\n    return vec4(p,z);\n}\n\nvec2 getUV(in vec3 p, in Quad q)    \n{\n\tvec3 ap = p-q.a, bp = p-q.b, dp = p-q.d;\n    vec3 ab = q.b-q.a, ad = q.d-q.a;\n    float x0 = dot(bp, ab);\n    float x1 = dot(ap, ab);\n\tfloat y0 = dot(dp, ad);\n    float y1 = dot(ap, ad);\n    return vec2(x0/(x0-x1), y0/(y0-y1));\n}\n\nQuad genQuad(in vec3 p)\n{\n    vec3 a = vec3(-1.0, 1.0, 0.0) * 0.5;\n    return Quad(p + a.yyz, p + a.xyz, p + a.xxz, p + a.yxz);\n}\n\nfloat hash(in float n)\n{\n    return fract(sin(n) * 43758.5453);\n}\n\nvec3 motion(in float id)\n{\n    vec3 p = vec3(id * 0.55-2.1, 0.0, -1.0);\n    if (mod(iTime,5.0) > 4.0)\n    {\n        float s = hash(floor(iTime)*453.125);\n        p = vec3(id * 0.3, 0.0, -1.0);\n        p.xy += 2.0*vec2(hash(s*453.789)-0.8,hash(s*288.455)-0.5); \n    }\n    if (mod(iTime,3.0) > 2.0)\n    {\n        float s = hash(floor(iTime)*234.123);\n        return p + vec3(\n            0.5*(hash(id+s+2.0125)-0.5),\n            0.8*(hash(id+s+4.1257)-0.5),\n            3.0*(hash(id+s+0.4478)-0.5));\n    }\n    return p;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 p = (2.0*fragCoord.xy-iResolution.xy)/iResolution.y;\n    vec3 rd = normalize(vec3(p, -2.0));\n\tvec3 ro = vec3(0.0, 0.0, 2.0);\n    vec3 col = vec3(0.35*p.y*p.y);\n    float z = FAR;\n    for (float i = 0.0; i < 9.0; i++)\n    {\n        Quad q = genQuad(motion(i));\n    \tvec4 d = castRay(ro, rd, q);\n    \tif (z > d.w)\n    \t{\n        \tvec2 uv = getUV(d.xyz, q);\n            uv += vec2(mod(i, 5.0), floor(i / 5.0));\n            uv *= 0.3 * iResolution.y/iResolution.xy;\n            vec4 im = texture(iChannel0, uv);\n            if (im.a > 0.5)\n            {\n            \tcol =im.rgb;\n            \tz = d.w;\n            }\n    \t}\n    } \n    fragColor = vec4(col, 1.0);\n    //fragColor = texture(iChannel0, fragCoord/iResolution.xy);\n}\n","name":"Image","description":"","type":"image"},{"inputs":[],"outputs":[{"id":"4dXGR8","channel":0}],"code":"// https://www.shadertoy.com/view/MsyGzz\nfloat width;\nvec2 size;\n\nfloat line(in vec2 p, in vec2 a, in vec2 b)\n{\n    a *= size, b *= size;\n    vec2 pa = p-a, ba = b-a;\n    float h = clamp(dot(pa, ba)/dot(ba, ba), 0.0, 1.0);\n    float d = length(pa-ba*h);\n    return  d-width;\n}\n\nfloat char_S(in vec2 p)\n{\n    float res = 1.0;\n    res=min(res,line(p,vec2(17.0,18.0),vec2(15.0,20.0)));\n    res=min(res,line(p,vec2(15.0,20.0),vec2(12.0,21.0)));\n    res=min(res,line(p,vec2(12.0,21.0),vec2(8.0,21.0)));\n    res=min(res,line(p,vec2(8.0,21.0),vec2(5.0,20.0)));\n    res=min(res,line(p,vec2(5.0,20.0),vec2(3.0,18.0)));\n    res=min(res,line(p,vec2(3.0,18.0),vec2(3.0,16.0)));\n    res=min(res,line(p,vec2(3.0,16.0),vec2(4.0,14.0)));\n    res=min(res,line(p,vec2(4.0,14.0),vec2(5.0,13.0)));\n    res=min(res,line(p,vec2(5.0,13.0),vec2(7.0,12.0)));\n    res=min(res,line(p,vec2(7.0,12.0),vec2(13.0,10.0)));\n    res=min(res,line(p,vec2(13.0,10.0),vec2(15.0,9.0)));\n    res=min(res,line(p,vec2(15.0,9.0),vec2(16.0,8.0)));\n    res=min(res,line(p,vec2(16.0,8.0),vec2(17.0,6.0)));\n    res=min(res,line(p,vec2(17.0,6.0),vec2(17.0,3.0)));\n    res=min(res,line(p,vec2(17.0,3.0),vec2(15.0,1.0)));\n    res=min(res,line(p,vec2(15.0,1.0),vec2(12.0,0.0)));\n    res=min(res,line(p,vec2(12.0,0.0),vec2(8.0,0.0)));\n    res=min(res,line(p,vec2(8.0,0.0),vec2(5.0,1.0)));\n    res=min(res,line(p,vec2(5.0,1.0),vec2(3.0,3.0)));\n    return res;\n}\n\nfloat char_H(in vec2 p)\n{\n    float res = 1.0;\n    res=min(res,line(p,vec2(4.0,21.0),vec2(4.0,0.0)));\n    res=min(res,line(p,vec2(18.0,21.0),vec2(18.0,0.0)));\n    res=min(res,line(p,vec2(4.0,11.0),vec2(18.0,11.0)));\n    return res;\n}\n\nfloat char_A(in vec2 p)\n{\n    float res = 1.0;\n    res=min(res,line(p,vec2(9.0,21.0),vec2(1.0,0.0)));\n    res=min(res,line(p,vec2(9.0,21.0),vec2(17.0,0.0)));\n    res=min(res,line(p,vec2(4.0,7.0),vec2(14.0,7.0)));\n    return res;\n}\n\nfloat char_D(in vec2 p)\n{\n    float res = 1.0;\n    res=min(res,line(p,vec2(4.0,21.0),vec2(4.0,0.0)));\n    res=min(res,line(p,vec2(4.0,21.0),vec2(11.0,21.0)));\n    res=min(res,line(p,vec2(11.0,21.0),vec2(14.0,20.0)));\n    res=min(res,line(p,vec2(14.0,20.0),vec2(16.0,18.0)));\n    res=min(res,line(p,vec2(16.0,18.0),vec2(17.0,16.0)));\n    res=min(res,line(p,vec2(17.0,16.0),vec2(18.0,13.0)));\n    res=min(res,line(p,vec2(18.0,13.0),vec2(18.0,8.0)));\n    res=min(res,line(p,vec2(18.0,8.0),vec2(17.0,5.0)));\n    res=min(res,line(p,vec2(17.0,5.0),vec2(16.0,3.0)));\n    res=min(res,line(p,vec2(16.0,3.0),vec2(14.0,1.0)));\n    res=min(res,line(p,vec2(14.0,1.0),vec2(11.0,0.0)));\n    res=min(res,line(p,vec2(11.0,0.0),vec2(4.0,0.0)));\n    return res;\n}\n\nfloat char_E(in vec2 p)\n{\n    float res = 1.0;\n    res=min(res,line(p,vec2(4.0,21.0),vec2(4.0,0.0)));\n    res=min(res,line(p,vec2(4.0,21.0),vec2(17.0,21.0)));\n    res=min(res,line(p,vec2(4.0,11.0),vec2(12.0,11.0)));\n    res=min(res,line(p,vec2(4.0,0.0),vec2(17.0,0.0)));\n    return res;\n}\n\nfloat char_R(in vec2 p)\n{\n    float res = 1.0;;\n    res=min(res,line(p,vec2(4.0,21.0),vec2(4.0,0.0)));\n    res=min(res,line(p,vec2(4.0,21.0),vec2(13.0,21.0)));\n    res=min(res,line(p,vec2(13.0,21.0),vec2(16.0,20.0)));\n    res=min(res,line(p,vec2(16.0,20.0),vec2(17.0,19.0)));\n    res=min(res,line(p,vec2(17.0,19.0),vec2(18.0,17.0)));\n    res=min(res,line(p,vec2(18.0,17.0),vec2(18.0,15.0)));\n    res=min(res,line(p,vec2(18.0,15.0),vec2(17.0,13.0)));\n    res=min(res,line(p,vec2(17.0,13.0),vec2(16.0,12.0)));\n    res=min(res,line(p,vec2(16.0,12.0),vec2(13.0,11.0)));\n    res=min(res,line(p,vec2(13.0,11.0),vec2(4.0,11.0)));\n    res=min(res,line(p,vec2(11.0,11.0),vec2(18.0,0.0)));\n    return res;\n}\n\nfloat char_T(in vec2 p)\n{\n    float res = 1.0;\n    res = min(res,line(p,vec2(11.0,21.0),vec2(11.0,0.0)));\n    res = min(res,line(p,vec2(4.0,21.0),vec2(18.0,21.0)));\n    return res;\n}\n\nfloat char_O(in vec2 p)\n{\n    float res = 1.0;\n    res=min(res,line(p,vec2(9.0,21.0),vec2(7.0,20.0)));\n    res=min(res,line(p,vec2(7.0,20.0),vec2(5.0,18.0)));\n    res=min(res,line(p,vec2(5.0,18.0),vec2(4.0,16.0)));\n    res=min(res,line(p,vec2(4.0,16.0),vec2(3.0,13.0)));\n    res=min(res,line(p,vec2(3.0,13.0),vec2(3.0,8.0)));\n    res=min(res,line(p,vec2(3.0,8.0),vec2(4.0,5.0)));\n    res=min(res,line(p,vec2(4.0,5.0),vec2(5.0,3.0)));\n    res=min(res,line(p,vec2(5.0,3.0),vec2(7.0,1.0)));\n    res=min(res,line(p,vec2(7.0,1.0),vec2(9.0,0.0)));\n    res=min(res,line(p,vec2(9.0,0.0),vec2(13.0,0.0)));\n    res=min(res,line(p,vec2(13.0,0.0),vec2(15.0,1.0)));\n    res=min(res,line(p,vec2(15.0,1.0),vec2(17.0,3.0)));\n    res=min(res,line(p,vec2(17.0,3.0),vec2(18.0,5.0)));\n    res=min(res,line(p,vec2(18.0,5.0),vec2(19.0,8.0)));\n    res=min(res,line(p,vec2(19.0,8.0),vec2(19.0,13.0)));\n    res=min(res,line(p,vec2(19.0,13.0),vec2(18.0,16.0)));\n    res=min(res,line(p,vec2(18.0,16.0),vec2(17.0,18.0)));\n    res=min(res,line(p,vec2(17.0,18.0),vec2(15.0,20.0)));\n    res=min(res,line(p,vec2(15.0,20.0),vec2(13.0,21.0)));\n    res=min(res,line(p,vec2(13.0,21.0),vec2(9.0,21.0)));\n    return res;\n}\n\nfloat char_Y(in vec2 p)\n{\n    float res = 1.0;\n    res=min(res,line(p,vec2(1.0,21.0),vec2(9.0,11.0)));\n    res=min(res,line(p,vec2(9.0,11.0),vec2(9.0,0.0)));\n    res=min(res,line(p,vec2(17.0,21.0),vec2(9.0,11.0)));\n    return res ;\n}\n\nvec3 hsv(in float h, in float s, in float v)\n{\n  return mix(vec3(1),clamp((abs(fract(h+vec3(3,2,1)/3.)*6.-3.)-1.),0.,1.),s)* v;\n}\n\nfloat deChar(in vec2 p, in float t)\n{\n    if (t < 0.5)      return char_S(p);\n    else if (t < 1.5) return char_H(p);\n    else if (t < 2.5) return char_A(p);\n    else if (t < 3.5) return char_D(p);\n    else if (t < 4.5) return char_E(p);\n    else if (t < 5.5) return char_R(p);\n    else if (t < 6.5) return char_T(p);\n    else if (t < 7.5) return char_O(p);\n    else if (t < 8.5) return char_Y(p);\n    return 1.0;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 p = fragCoord / iResolution.y;\n    float pitch = 0.3;\n    if (p.x > pitch*5.0+0.01 || p.y > pitch*2.0+0.01) discard; \n    vec4 col = vec4(0.0);    \n    /*\n    col = mix(col, vec4(1.0), smoothstep(0.005, 0.0, abs(p.y-pitch*1.0)));\n    col = mix(col, vec4(1.0), smoothstep(0.005, 0.0, abs(p.y-pitch*2.0)));\n    col = mix(col, vec4(1.0), smoothstep(0.005, 0.0, abs(p.x-pitch*1.0)));\n    col = mix(col, vec4(1.0), smoothstep(0.005, 0.0, abs(p.x-pitch*2.0)));\n    col = mix(col, vec4(1.0), smoothstep(0.005, 0.0, abs(p.x-pitch*3.0)));\n    col = mix(col, vec4(1.0), smoothstep(0.005, 0.0, abs(p.x-pitch*4.0)));\n    col = mix(col, vec4(1.0), smoothstep(0.005, 0.0, abs(p.x-pitch*5.0)));\n    */    \n\twidth = 0.005;\n\tsize = vec2(0.008);\n    vec2 offset = vec2(0.06);\n    p -= offset;\n    const float colorCount = 8.0;\n    for(float i = 0.0; i < colorCount; i++)\n    {\n        vec3 c = hsv(i / colorCount,0.65, 0.85);\n    \tfor(float j = 0.0; j < 9.0; j++)\n    \t{\n        \tvec2 q = p - vec2(mod(j, 5.0),floor(j/5.0)) * pitch;\n            vec2 s = vec2(i+30.0, j+15.0) * iTime;\n            q.x += 0.035*(fract(sin(dot(s, vec2(53.86,22.83)))*326.87)-0.5);\n            q.y += 0.035*(fract(sin(dot(s, vec2(27.06,57.84)))*846.83)-0.5);\n            col.rgb += c * smoothstep(0.001, 0.0, deChar(q,j));\n    \t}\n    }\n    if (any(greaterThan(col.rgb, vec3(0.0)))) col.a = 1.0;\n    fragColor = clamp(col, 0.0, 1.0);\n}","name":"Buf A","description":"","type":"buffer"}]}