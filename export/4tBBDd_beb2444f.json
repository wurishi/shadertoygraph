{"ver":"0.1","info":{"id":"4tBBDd","date":"1517511451","viewed":275,"name":"simple raymarch terrain flight","username":"alex7900","description":"I'm learning about the magical world of ray marching\n\nThe terrain outline relies on rounding errors, so it may or may not look right different devices...","likes":5,"published":1,"flags":0,"usePreview":0,"tags":["terrain","raymarch","fog"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"const vec3 eye = vec3(-5.8, -5.35, 10);\nconst float FOV = 180.0;\nconst float FD = 40.0;\n\nfloat nse(vec2 v){\n\treturn sin(v.y*5.0)*cos(v.x*2.56)*sin(sin(v.y*2.18)*cos(v.x*1.16))/0.65;\n}\nfloat dts(vec3 eye, vec3 mdir, float depth, float e, float time) {\n\tfor (int i = 0; i < 255; i++) {\n\t\tvec3 ptgr = (eye + depth * mdir) + vec3(0,0,3);\n\t\tvec2 o = vec2(-time,-time);\n\t\tfloat h = nse((ptgr.xy+o) * 0.1)/2.0;\n\t\tfloat b = h+nse((ptgr.xy+o) * 0.7) / 5.0;\n\t\tfloat w = clamp(0.5+0.5*(b-h)/0.3, 0.0, 1.0 );\n\t\tfloat sm = mix( b, h, w ) - 0.3*w*(1.0-w);\n\t\tfloat dist = min(1.0, dot(ptgr,vec3(0.5,0.5,0.5)) + sm);\n\t\tif (dist < 0.000001)\n\t\t\treturn depth;\n\t\tdepth += dist;\n\t\tif (depth >= e)\n\t\t\treturn e;\n\t}\n\treturn e;\n}\nvoid mainImage(out vec4 fragColor, in vec2 fc){\n    vec2 fragCoord = vec2(fc.x/iResolution.x, fc.y/iResolution.y);\n    vec2 scr = vec2(1);\n    float t = iTime;\n\tvec3 f = normalize(vec3(0.25,1.0,-4.0) - eye+vec3(cos(t)/2.0,-sin(t)/2.0,0.0));\n\tvec3 s = normalize(cross(f, vec3(0.0,0.0,1.0)));\n\tvec3 u = cross(s, f);\n\tfloat dist = dts(eye, (\n\t\tmat4(vec4(s, 0.0),vec4(u, 0.0),vec4(-f, 0.0),vec4(0.0, 0.0, 0.0, 1.0))\n\t\t*vec4(normalize(vec3(fragCoord - scr / 2.0, -scr.y / tan(radians(73.0+FOV) / 2.0))), 0.0)\n\t).xyz, 1.0, 100.0, t*3.0);\n    if (dist > 100.0){\n        fragColor = vec4(1.0);\n    }\n\tvec4 ret = vec4(vec4(0.1,0.1,0.1,1)-vec4(0.0,0.0,0.0,smoothstep(0.0, FD, dist)))/1.0+(fragCoord.y/3.0);\n\tfragColor = vec4(1.0,0.9,0.9,1.0)-vec4(vec3(0.2)+ret.rgb*3.0*ret.a,0.0);\n}\n","name":"Image","description":"","type":"image"}]}