{"ver":"0.1","info":{"id":"3s3yzN","date":"1600521719","viewed":264,"name":"Ray Casting Floor/Ceiling Test","username":"LilBensson","description":"I'm currently thinking about making a ray casting engine for an upcoming school project. I've done ray casting before, but not with floor/ceiling textures. So this has been an intersesting little test!","likes":1,"published":1,"flags":0,"usePreview":0,"tags":["test","raycast"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XsX3Rn","filepath":"/media/a/92d7758c402f0927011ca8d0a7e40251439fba3a1dac26f5b8b62026323501aa.jpg","previewfilepath":"/media/ap/92d7758c402f0927011ca8d0a7e40251439fba3a1dac26f5b8b62026323501aa.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"const float FOV = 3.1415 / 4.5;\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 realUV = (fragCoord.xy - 0.5*iResolution.xy)/iResolution.y;\n    vec2 uv = realUV;\n    \n    // Ray angle\n    float angle = uv.x * FOV + iTime*0.1;\n    \n    // Ceiling\n    if(uv.y > 0.0)\n    {\n        //uv.y = pow(uv.y*2.0, (sin(iTime) + 1.0) * 0.5 + 1.0);\n        uv.y *= uv.y * (sin(iTime)+1.0);\n        \n        //angle += iTime * 0.3;\n    }\n    \n    // Pixel distance in the map\n    float dist = 1.0 / ((abs(uv.y) + 0.001) * cos(uv.x * FOV * 1.0));\n    \n    // Get floor/ceiling coordinates\n    vec2 floorUV = vec2(cos(angle), sin(angle)) * dist;\n    //vec2 id = floor(floorUV);\n    //floorUV = fract(floorUV); // This seems to cause some weird aliasing issues?\n    \n    // Get texture\n    vec3 col = texture(iChannel0, floorUV).rgb;\n    \n    // Fog\n    col *= pow(abs(uv.y*2.0), 0.7);\n    \n    // If uv.y and realUV.y are \"disagreeing\",\n    // then this row of pixels is just staring into the infinite\n    col *= uv.y * realUV.y < 0.0 ? 0.0 : 1.0;\n    \n    // Output to screen\n    fragColor = vec4(col, 1.0);\n}","name":"Image","description":"","type":"image"}]}