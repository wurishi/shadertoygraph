{"ver":"0.1","info":{"id":"WsGXzK","date":"1574370179","viewed":142,"name":"discard & double buffers","username":"Maddig","description":"The original shader was flickery because the buffer swapping forced it to draw to different buffers on each frame. This version does not flicker.","likes":2,"published":1,"flags":32,"usePreview":0,"tags":["double","buffer","discard"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// Fork of https://www.shadertoy.com/view/Wd2GzV\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    fragColor = texelFetch(iChannel0,ivec2(fragCoord),0);\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    float t = iTime;\n    \n    // absolute position\n    vec2 U = ( 2.*fragCoord - iResolution.xy ) / iResolution.y;\n    \n    // relative position\n    vec2 P = vec2(cos(t+sin(5.0*t)),sin(t/0.5) );\n    \n    // I don't really know how this works but this seems to affect\n    // more than one thing so it's hard to position stuff idk\n    float l = length(P-U);\n    \n    int index = int(float(iFrame % (3 * 5)) / 5.0);\n    \n    // sample texture from last buffer\n    fragColor = texelFetch(iChannel0,ivec2(fragCoord),0);\n    // draw circle if pixel not drawn to yet, keep already drawn stuff\n    \n    fragColor[index] = float((l<.1 && fragColor.rgb == vec3(0.0))\n                             || fragColor[index] == 1.0);\n    \n    // this is assuming that buffers are initialised to rgb = 0.0?\n    // if not then maybe there could be a conditional initialisation on 1st frame idk\n}","name":"Buffer A","description":"","type":"buffer"}]}