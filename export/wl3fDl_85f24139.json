{"ver":"0.1","info":{"id":"wl3fDl","date":"1613734781","viewed":1024,"name":"erotic line","username":"louis_C","description":"I wanted to try to make reflective material with roughness in raymarching.","likes":44,"published":1,"flags":40,"usePreview":0,"tags":["raymarching","sound","formant","roughness"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void mainImage( out vec4 fragColor, in vec2 fragCoord ){\nvec2 uv = fragCoord/iResolution.xy;\nfloat m = texture(iChannel0,uv).a;\n    float b = sqrt(64.);\n    vec3 c = vec3(0.);vec3 c2 = vec3(0.);\n    float d = m;\n    for(float  i = -0.5*b; i<=0.5*b ;i +=1.)\n    for(float  j = -0.5*b;j<=0.5*b ;j +=1.){\n    c += texture(iChannel0,uv+vec2(i,j)*d).xyz;\n    }\n    c /=64.;\n    c = clamp(c,0.,1.);\n    fragColor =vec4(c,0.);}","name":"Image","description":"","type":"image"},{"inputs":[],"outputs":[],"code":"/*\n Formant Synthesizer of Wouter van Nifterick https://www.shadertoy.com/view/XdXXWl\n*/\n\n#define PI 3.1415926535897932384626433832795\n#define PI2 PI*2.0\nfloat hs(float t){return fract(sin(dot(t,45.))*7845.236);}\nfloat rd(float t){return fract(sin(dot(floor(t),45.))*7845.236);}\nfloat no(float t){return mix(rd(t),rd(t+1.),smoothstep(0.,1.,fract(t)));}\nfloat fm(float t) { float r; float a=0.5; for(int  i = 0 ; i < 4 ; i++){\nr += no(t/a)*a;a*=0.5;}return r;}\n\nfloat ga(float t){\nfloat tt = fract(t*5.);\nfloat d1 =smoothstep(0.11,0.1,distance(0.5,tt));\nreturn d1;\n}\n\nfloat s ( float t){\nfloat d1;float t2 = t;float a=1.;\nfor(int  i = 1 ; i < 10 ; i++){\nfloat it = float(i);\nfloat tt = t -it*0.03;\nd1 = max(d1,(ga(tt)/(it*0.5))*mix(0.,2.,fm(tt*100.)));\n}\nd1-=0.5;\nd1 *= 0.5;\nfloat d2 = ga(t);\nreturn d1;}\nfloat formant(float pitch, float freq, float time)\n{   \n    \n    time += 0.07;\n    time = mod( time, PI / pitch);    \n    return  sin((2.0*PI)*freq*time)*exp(-30.0*time);\n\n}\n\n\nfloat s(float pitch, vec4 f, float time)\n{\n  return (\n    formant(pitch,f.x, time)*1.00+\n    formant(pitch,f.y, time)*0.96+\n    formant(pitch,f.z, time)*0.90+\n    formant(pitch,f.w, time)*0.85\n  ) * .25;\n}\n\nstruct Frame\n{\n  float time;\n  vec4 formants;\n};\n  \nfloat tau = PI*2.0;\nfloat ki (float t){\nfloat time = t;\n    float ft = fract(time*0.5);\nfloat ta = sin(sin(time*0.1)*0.1*\npow(mix(ft,1.-ft,step(0.5,fract(time*0.25))),1.5))\n*sin(time*0.1)*180.;\nreturn hs(fract(time)*2000.)*0.3*smoothstep(0.5,1.,fract(abs(ta)*0.5));\n}\nfloat ec (float t){\nfloat d1;float t2 = t;float a=1.;\nfor(int  i = 1 ; i < 30 ; i++){\nfloat it = float(i);\nfloat tt = t -it*0.05;\nd1 = max(d1,(ki(tt)/(it*0.5)));\n}\nd1-=0.5;\nd1 *= 0.5;\n\nreturn d1;}\nvec2 mainSound( in int samp,float time)\n{\n    float sb = s(time);\n    float sp = floor(pow(fract(time*0.1),0.25)*10.)*0.1+0.1; \n    //float sp = 3.;\n    float ts = ec(time);\n    float t = mod(time*sp,sp);\n     #define f(tm,amp) if(t>tm*sp) pitch=amp*3.;\n    float pitch ;\nf(0.02,197.);\nf(0.03,200.);\nf(0.04,201.);\nf(0.05,203.);\nf(0.06,204.);\nf(0.07,206.);\nf(0.08,208.);\nf(0.09,210.);\nf(0.1,211.);\nf(0.11,209.);\nf(0.12,207.);\nf(0.13,205.);\nf(0.14,205.);\nf(0.15,207.);\nf(0.16,208.);\nf(0.17,206.);\nf(0.18,208.);\nf(0.19,212.);\nf(0.2,215.);\nf(0.21,218.);\nf(0.22,220.);\nf(0.23,220.);\nf(0.24,220.);\nf(0.25,221.);\nf(0.26,221.);\nf(0.27,220.);\nf(0.28,221.);\nf(0.29,222.);\nf(0.3,228.);\nf(0.31,233.);\nf(0.32,240.);\nf(0.33,246.);\nf(0.34,254.);\nf(0.35,261.);\nf(0.36,268.);\nf(0.37,275.);\nf(0.38,281.);\nf(0.39,286.);\nf(0.4,290.);\nf(0.41,290.);\nf(0.42,308.);\nf(0.43,320.);\nf(0.44,320.);\nf(0.45,316.);\nf(0.46,313.);\nf(0.47,312.);\nf(0.48,308.);\nf(0.49,301.);\nf(0.5,294.);\nf(0.51,283.);\nf(0.52,271.);\nf(0.53,266.);\nf(0.54,266.);\nf(0.55,266.);\nf(0.56,266.);\nf(0.57,266.);\nf(0.58,266.);\nf(0.59,225.);\nf(0.6,224.);\nf(0.61,225.);\nf(0.62,229.);\nf(0.63,225.);\nf(0.64,221.);\nf(0.65,218.);\nf(0.66,211.);\nf(0.67,205.);\nf(0.68,202.);\nf(0.69,201.);\nf(0.7,200.);\nf(0.71,200.);\nf(0.72,199.);\nf(0.73,200.);\nf(0.74,200.);\nf(0.75,197.);\nf(0.76,194.);\nf(0.77,188.);\nf(0.78,184.);\nf(0.79,177.);\nf(0.8,172.);\nf(0.81,162.);\nf(0.82,158.);\nf(0.83,153.);\nf(0.84,148.);\nf(0.85,144.);\nf(0.86,139.);\nf(0.87,136.);\nf(0.88,134.);\nf(0.89,132.);\nf(0.9,130.);\nf(0.91,130.);\nf(0.92,130.);\nf(0.93,130.);\nf(0.94,131.);\nf(0.95,133.);\nf(0.96,133.);\nf(0.97,131.);\nf(0.98,129.);\nf(0.99,127.);\nf(1.,127.);\nf(1.01,130.);\nf(1.02,134.);\nf(1.03,135.);\nf(1.04,136.);\n    float amp = 0.0;\n    #define fmt(tm,v) if(t>tm*sp)samp=s(pitch,v,t);\n   \n    Frame frames[162];\nframes[ 0] = Frame(0.027,vec4(831.,1333.,3069.,4445.));\nframes[ 1] = Frame(0.034,vec4(780.,1327.,3117.,4361.));\nframes[ 2] = Frame(0.04,vec4(766.,1330.,2869.,4273.));\nframes[ 3] = Frame(0.046,vec4(740.,1335.,2640.,4197.));\nframes[ 4] = Frame(0.052,vec4(729.,1341.,2592.,4249.));\nframes[ 5] = Frame(0.059,vec4(720.,1339.,2566.,4249.));\nframes[ 6] = Frame(0.065,vec4(704.,1333.,2489.,4160.));\nframes[ 7] = Frame(0.071,vec4(680.,1323.,2440.,4131.));\nframes[ 8] = Frame(0.077,vec4(660.,1314.,2411.,4155.));\nframes[ 9] = Frame(0.084,vec4(623.,1267.,2334.,4237.));\nframes[ 10] = Frame(0.09,vec4(589.,1230.,2276.,4446.));\nframes[ 11] = Frame(0.096,vec4(571.,1243.,2241.,4612.));\nframes[ 12] = Frame(0.102,vec4(523.,1239.,2081.,4878.));\nframes[ 13] = Frame(0.109,vec4(489.,1235.,2021.,4970.));\nframes[ 14] = Frame(0.115,vec4(471.,1226.,1970.,5398.));\nframes[ 15] = Frame(0.121,vec4(446.,1202.,1829.,5398.));\nframes[ 16] = Frame(0.127,vec4(443.,1206.,1769.,5398.));\nframes[ 17] = Frame(0.134,vec4(552.,1286.,2911.,5398.));\nframes[ 18] = Frame(0.14,vec4(621.,1344.,2981.,5398.));\nframes[ 19] = Frame(0.146,vec4(629.,1369.,2951.,5398.));\nframes[ 20] = Frame(0.152,vec4(571.,1354.,2944.,5398.));\nframes[ 21] = Frame(0.159,vec4(480.,1298.,2923.,3641.));\nframes[ 22] = Frame(0.165,vec4(464.,1310.,2743.,3103.));\nframes[ 23] = Frame(0.171,vec4(483.,1317.,2173.,3230.));\nframes[ 24] = Frame(0.177,vec4(508.,1238.,3125.,3230.));\nframes[ 25] = Frame(0.184,vec4(542.,1220.,2868.,3230.));\nframes[ 26] = Frame(0.19,vec4(511.,1203.,2519.,3230.));\nframes[ 27] = Frame(0.196,vec4(465.,1160.,1918.,3230.));\nframes[ 28] = Frame(0.202,vec4(459.,1133.,1688.,3230.));\nframes[ 29] = Frame(0.209,vec4(492.,1159.,1674.,3230.));\nframes[ 30] = Frame(0.215,vec4(461.,1169.,1653.,3230.));\nframes[ 31] = Frame(0.221,vec4(463.,1218.,1639.,4153.));\nframes[ 32] = Frame(0.227,vec4(475.,1261.,1657.,4088.));\nframes[ 33] = Frame(0.234,vec4(489.,1285.,1691.,4083.));\nframes[ 34] = Frame(0.24,vec4(532.,1300.,1740.,4078.));\nframes[ 35] = Frame(0.246,vec4(593.,1304.,1769.,4093.));\nframes[ 36] = Frame(0.252,vec4(650.,1317.,1857.,4147.));\nframes[ 37] = Frame(0.259,vec4(719.,1316.,1957.,4180.));\nframes[ 38] = Frame(0.265,vec4(773.,1326.,2115.,4180.));\nframes[ 39] = Frame(0.271,vec4(793.,1319.,2263.,4172.));\nframes[ 40] = Frame(0.277,vec4(816.,1320.,2360.,4142.));\nframes[ 41] = Frame(0.284,vec4(830.,1323.,2424.,4093.));\nframes[ 42] = Frame(0.29,vec4(840.,1321.,2469.,4020.));\nframes[ 43] = Frame(0.296,vec4(857.,1319.,2475.,3934.));\nframes[ 44] = Frame(0.302,vec4(865.,1319.,2478.,3998.));\nframes[ 45] = Frame(0.309,vec4(867.,1317.,2543.,4048.));\nframes[ 46] = Frame(0.315,vec4(872.,1340.,2556.,4026.));\nframes[ 47] = Frame(0.321,vec4(871.,1364.,2565.,3990.));\nframes[ 48] = Frame(0.327,vec4(874.,1391.,2589.,4112.));\nframes[ 49] = Frame(0.334,vec4(886.,1415.,2620.,4116.));\nframes[ 50] = Frame(0.34,vec4(893.,1435.,2666.,3988.));\nframes[ 51] = Frame(0.346,vec4(896.,1429.,2608.,4031.));\nframes[ 52] = Frame(0.352,vec4(901.,1398.,2537.,4070.));\nframes[ 53] = Frame(0.359,vec4(876.,1429.,2592.,4154.));\nframes[ 54] = Frame(0.365,vec4(857.,1462.,2627.,4146.));\nframes[ 55] = Frame(0.371,vec4(848.,1495.,2636.,4068.));\nframes[ 56] = Frame(0.377,vec4(833.,1533.,2655.,4062.));\nframes[ 57] = Frame(0.384,vec4(826.,1602.,2634.,3957.));\nframes[ 58] = Frame(0.39,vec4(828.,1642.,2619.,3723.));\nframes[ 59] = Frame(0.396,vec4(824.,1511.,2565.,3637.));\nframes[ 60] = Frame(0.402,vec4(796.,1397.,2598.,3601.));\nframes[ 61] = Frame(0.409,vec4(696.,1404.,2764.,3592.));\nframes[ 62] = Frame(0.415,vec4(467.,1497.,3206.,4342.));\nframes[ 63] = Frame(0.421,vec4(438.,1603.,3158.,4559.));\nframes[ 64] = Frame(0.427,vec4(508.,1640.,3115.,4622.));\nframes[ 65] = Frame(0.434,vec4(598.,1622.,3143.,4611.));\nframes[ 66] = Frame(0.44,vec4(667.,1613.,3160.,4465.));\nframes[ 67] = Frame(0.446,vec4(691.,1699.,3122.,4473.));\nframes[ 68] = Frame(0.452,vec4(694.,1761.,3077.,4752.));\nframes[ 69] = Frame(0.459,vec4(690.,1760.,3025.,4720.));\nframes[ 70] = Frame(0.465,vec4(689.,1735.,3027.,4695.));\nframes[ 71] = Frame(0.471,vec4(679.,1774.,2965.,4682.));\nframes[ 72] = Frame(0.477,vec4(660.,1905.,2946.,4741.));\nframes[ 73] = Frame(0.484,vec4(639.,2035.,2786.,4635.));\nframes[ 74] = Frame(0.49,vec4(613.,2224.,2485.,4624.));\nframes[ 75] = Frame(0.496,vec4(585.,2267.,2433.,4574.));\nframes[ 76] = Frame(0.502,vec4(535.,2339.,2356.,4570.));\nframes[ 77] = Frame(0.509,vec4(496.,2175.,2421.,4559.));\nframes[ 78] = Frame(0.515,vec4(472.,2285.,2530.,4540.));\nframes[ 79] = Frame(0.521,vec4(471.,2122.,2591.,4500.));\nframes[ 80] = Frame(0.527,vec4(471.,1265.,2527.,4457.));\nframes[ 81] = Frame(0.534,vec4(444.,2582.,4468.,4457.));\nframes[ 82] = Frame(0.54,vec4(344.,2572.,4042.,4457.));\nframes[ 83] = Frame(0.546,vec4(293.,2079.,2911.,4388.));\nframes[ 84] = Frame(0.552,vec4(1602.,2682.,4516.,4388.));\nframes[ 85] = Frame(0.559,vec4(1575.,1697.,3197.,4605.));\nframes[ 86] = Frame(0.565,vec4(1281.,1704.,3401.,4605.));\nframes[ 87] = Frame(0.571,vec4(1222.,1678.,3226.,4605.));\nframes[ 88] = Frame(0.577,vec4(1261.,1485.,3121.,4954.));\nframes[ 89] = Frame(0.584,vec4(1349.,1683.,2619.,4908.));\nframes[ 90] = Frame(0.59,vec4(455.,1948.,3089.,5164.));\nframes[ 91] = Frame(0.596,vec4(434.,1957.,3585.,5164.));\nframes[ 92] = Frame(0.602,vec4(436.,1595.,3485.,5164.));\nframes[ 93] = Frame(0.609,vec4(431.,1207.,3563.,5164.));\nframes[ 94] = Frame(0.615,vec4(436.,1119.,3423.,4071.));\nframes[ 95] = Frame(0.621,vec4(439.,1051.,3839.,3951.));\nframes[ 96] = Frame(0.627,vec4(433.,1077.,3447.,4239.));\nframes[ 97] = Frame(0.634,vec4(433.,1106.,3390.,4246.));\nframes[ 98] = Frame(0.64,vec4(433.,1123.,3605.,4075.));\nframes[ 99] = Frame(0.646,vec4(439.,1132.,3448.,4250.));\nframes[ 100] = Frame(0.652,vec4(457.,1146.,3457.,4226.));\nframes[ 101] = Frame(0.659,vec4(510.,1161.,3710.,4012.));\nframes[ 102] = Frame(0.665,vec4(604.,1217.,3628.,4065.));\nframes[ 103] = Frame(0.671,vec4(655.,1230.,3318.,4107.));\nframes[ 104] = Frame(0.677,vec4(662.,1222.,3284.,4091.));\nframes[ 105] = Frame(0.684,vec4(685.,1228.,3391.,4042.));\nframes[ 106] = Frame(0.69,vec4(771.,1256.,3889.,4294.));\nframes[ 107] = Frame(0.696,vec4(787.,1284.,3900.,4405.));\nframes[ 108] = Frame(0.702,vec4(807.,1315.,3887.,4405.));\nframes[ 109] = Frame(0.709,vec4(845.,1369.,3880.,4405.));\nframes[ 110] = Frame(0.715,vec4(825.,1384.,3850.,4405.));\nframes[ 111] = Frame(0.721,vec4(766.,1369.,2591.,3815.));\nframes[ 112] = Frame(0.727,vec4(792.,1404.,2257.,3774.));\nframes[ 113] = Frame(0.734,vec4(867.,1446.,1948.,3738.));\nframes[ 114] = Frame(0.74,vec4(937.,1178.,1513.,3648.));\nframes[ 115] = Frame(0.746,vec4(952.,1540.,3456.,3648.));\nframes[ 116] = Frame(0.752,vec4(1012.,1570.,3424.,3648.));\nframes[ 117] = Frame(0.759,vec4(1040.,1583.,3364.,3648.));\nframes[ 118] = Frame(0.765,vec4(1026.,1598.,3308.,3648.));\nframes[ 119] = Frame(0.771,vec4(1012.,1622.,3257.,3648.));\nframes[ 120] = Frame(0.777,vec4(974.,1667.,3286.,3648.));\nframes[ 121] = Frame(0.784,vec4(884.,1690.,3321.,3648.));\nframes[ 122] = Frame(0.79,vec4(758.,1711.,3308.,3648.));\nframes[ 123] = Frame(0.796,vec4(708.,1738.,2940.,3396.));\nframes[ 124] = Frame(0.802,vec4(672.,1720.,2549.,3578.));\nframes[ 125] = Frame(0.809,vec4(641.,1804.,2607.,3444.));\nframes[ 126] = Frame(0.815,vec4(627.,1880.,2455.,3307.));\nframes[ 127] = Frame(0.821,vec4(639.,1954.,2358.,3291.));\nframes[ 128] = Frame(0.827,vec4(630.,1985.,2683.,3409.));\nframes[ 129] = Frame(0.834,vec4(588.,2033.,2680.,3735.));\nframes[ 130] = Frame(0.84,vec4(567.,1950.,2847.,3803.));\nframes[ 131] = Frame(0.846,vec4(570.,1991.,2822.,3856.));\nframes[ 132] = Frame(0.852,vec4(551.,2372.,2821.,4013.));\nframes[ 133] = Frame(0.859,vec4(518.,2566.,2609.,4316.));\nframes[ 134] = Frame(0.865,vec4(497.,2568.,2929.,4235.));\nframes[ 135] = Frame(0.871,vec4(489.,2567.,2887.,4069.));\nframes[ 136] = Frame(0.877,vec4(476.,2504.,2966.,3926.));\nframes[ 137] = Frame(0.884,vec4(458.,2504.,3179.,3921.));\nframes[ 138] = Frame(0.89,vec4(442.,2501.,3008.,4153.));\nframes[ 139] = Frame(0.896,vec4(425.,2488.,3057.,4215.));\nframes[ 140] = Frame(0.902,vec4(423.,2672.,2883.,4117.));\nframes[ 141] = Frame(0.909,vec4(421.,2539.,2744.,4159.));\nframes[ 142] = Frame(0.915,vec4(403.,2411.,2950.,4256.));\nframes[ 143] = Frame(0.921,vec4(375.,2434.,2954.,4352.));\nframes[ 144] = Frame(0.927,vec4(355.,2540.,2700.,4452.));\nframes[ 145] = Frame(0.934,vec4(340.,1981.,2716.,4564.));\nframes[ 146] = Frame(0.94,vec4(316.,1795.,2803.,4378.));\nframes[ 147] = Frame(0.946,vec4(306.,1947.,2791.,4364.));\nframes[ 148] = Frame(0.952,vec4(308.,1906.,2937.,4346.));\nframes[ 149] = Frame(0.959,vec4(294.,2040.,3019.,4607.));\nframes[ 150] = Frame(0.965,vec4(292.,1964.,2971.,4816.));\nframes[ 151] = Frame(0.971,vec4(290.,2099.,2843.,4781.));\nframes[ 152] = Frame(0.977,vec4(281.,2190.,2864.,4671.));\nframes[ 153] = Frame(0.984,vec4(261.,2115.,3023.,4597.));\nframes[ 154] = Frame(0.99,vec4(248.,2246.,2940.,4503.));\nframes[ 155] = Frame(0.996,vec4(252.,2361.,2986.,4444.));\nframes[ 156] = Frame(1.002,vec4(284.,2053.,3094.,4515.));\nframes[ 157] = Frame(1.009,vec4(268.,2130.,3157.,4622.));\nframes[ 158] = Frame(1.015,vec4(255.,2327.,3114.,4619.));\nframes[ 159] = Frame(1.021,vec4(259.,2242.,3179.,4574.));\nframes[ 160] = Frame(1.027,vec4(2240.,3210.,4752.,4574.));\nframes[ 161] = Frame(1.034,vec4(1369.,2352.,4016.,4574.));\n\n    float slide=.0;\n    \n    Frame v,w;\n    vec4 n = frames[0].formants;\n    vec4 k;\n    for(int i=1;i<162;i++)\n    {\n        float nt = frames[i+1].time;\n        float pt = frames[i-1].time;\n        if(t>frames[i].time*sp)\n        {\n\n            k = frames[i].formants;\n            k += n*slide;\n            k /= slide+1.0;           \n            amp=s(pitch,k,t);\n            n = k;\n\n        }\n    }\n\n    #define a(tm,amp) if(t>tm*sp) intensity=amp;\n    // adjust overall intensity curve\n    float intensity; \na(0.045,0.35);\na(0.056,0.35);\na(0.066,0.35);\na(0.077,0.35);\na(0.088,0.35);\na(0.098,0.34);\na(0.109,0.34);\na(0.12,0.33);\na(0.13,0.31);\na(0.141,0.3);\na(0.152,0.29);\na(0.162,0.29);\na(0.173,0.29);\na(0.184,0.3);\na(0.194,0.32);\na(0.205,0.33);\na(0.216,0.34);\na(0.226,0.35);\na(0.237,0.35);\na(0.248,0.34);\na(0.258,0.34);\na(0.269,0.35);\na(0.28,0.35);\na(0.29,0.35);\na(0.301,0.35);\na(0.312,0.35);\na(0.322,0.35);\na(0.333,0.35);\na(0.344,0.36);\na(0.354,0.36);\na(0.365,0.36);\na(0.376,0.36);\na(0.386,0.35);\na(0.397,0.33);\na(0.408,0.29);\na(0.418,0.27);\na(0.429,0.29);\na(0.44,0.31);\na(0.45,0.32);\na(0.461,0.32);\na(0.472,0.32);\na(0.482,0.31);\na(0.493,0.3);\na(0.504,0.29);\na(0.514,0.26);\na(0.525,0.22);\na(0.536,0.15);\na(0.546,0.08);\na(0.557,0.07);\na(0.568,0.11);\na(0.578,0.16);\na(0.589,0.23);\na(0.6,0.26);\na(0.61,0.28);\na(0.621,0.29);\na(0.632,0.3);\na(0.642,0.31);\na(0.653,0.31);\na(0.664,0.3);\na(0.674,0.31);\na(0.685,0.31);\na(0.696,0.32);\na(0.706,0.32);\na(0.717,0.32);\na(0.728,0.32);\na(0.738,0.32);\na(0.749,0.33);\na(0.76,0.33);\na(0.77,0.32);\na(0.781,0.32);\na(0.792,0.31);\na(0.802,0.31);\na(0.813,0.3);\na(0.824,0.29);\na(0.834,0.29);\na(0.845,0.29);\na(0.856,0.28);\na(0.866,0.28);\na(0.877,0.28);\na(0.888,0.28);\na(0.898,0.28);\na(0.909,0.27);\na(0.92,0.26);\na(0.93,0.25);\na(0.941,0.24);\na(0.952,0.22);\na(0.962,0.21);\na(0.973,0.2);\na(0.984,0.19);\na(0.994,0.16);\na(1.005,0.15);\na(1.016,0.14);\n\n   \n    amp *=intensity;\n     \n    vec2 vox = amp*vec2(pow(no(time*0.5),1.5)*0.75)+sb+ts;\n    return vox;         \n} ","name":"Sound","description":"","type":"sound"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"float hs(vec3 p){return fract(sin(dot(p,vec3(45.,956.,124.)))*7845.236);}\nfloat rd(vec3 p){return fract(sin(dot(floor(p),vec3(45.,956.,124.)))*7845.236);}\nfloat no (vec3 p){vec3 f = floor(p); p = smoothstep(0.,1.,fract(p));\nvec3 se = vec3(45.,95.,457.);vec4 v1 = dot(f,se)+vec4(0.,se.y,se.z,se.y+se.z);\nvec4 v2 = mix(fract(sin(v1)*4587.236),fract(sin(v1+se.x)*4587.236),p.x);\nvec2 v3 = mix(v2.xz,v2.yw,p.y);\nreturn mix(v3.x,v3.y,p.z);}\nfloat no (vec2 p){vec2 f = floor(p); p = smoothstep(0.,1.,fract(p));\nvec2 se = vec2(45.,457.);vec2 v1 = dot(f,se)+vec2(0.,se.y);\nvec2 v2 = mix(fract(sin(v1)*4587.236),fract(sin(v1+se.x)*4587.236),p.x);\nreturn mix(v2.x,v2.y,p.y);}\nfloat it (vec2 p){ float r = 0.; float a = 0.5;for(int  i = 0 ; i < 4 ; i++){\nr += no(p/a)*a;a*=0.5;}return r;}\nfloat rd (float t){return fract(sin(dot(floor(t),45.))*7845.);}\nfloat no(float t){return mix(rd(t),rd(t+1.),smoothstep(0.,1.,fract(t)));}\nmat2 rot(float t) {float c = cos(t); float s = sin(t); return mat2(c,-s,s,c);}\nfloat cap (vec3 u, vec3 a, vec3 b) {vec3 ua= u-a; vec3 ba=b-a;\nfloat h = clamp(dot(ua,ba)/dot(ba,ba),0.,1.);\nreturn length(ua-ba*h);}\nfloat cap (vec2 u, vec2 a, vec2 b) {vec2 ua= u-a; vec2 ba=b-a;\nfloat h = clamp(dot(ua,ba)/dot(ba,ba),0.,1.);\nreturn length(ua-ba*h);}\nfloat smin(float d1,float d2,float k){float h = clamp(0.5+0.5*(d2-d1)/k,0.,1.);\nreturn mix(d2,d1,h)-k*h*(1.-h);}\nfloat smax(float d1,float d2,float k){float h = clamp(0.5-0.5*(d2+d1)/k,0.,1.);\nreturn mix(d2,-d1,h)+k*h*(1.-h);}\nfloat bl (vec2 p, vec2 b){vec2 q = abs(p)-b;\nreturn length(max(vec2(0.),q))+min(0.,max(q.x,q.y));}\nfloat zb = 0.;\nfloat map(vec3 p){\nvec3 ps = p;\nvec3 pf = p ;\nvec3 pt = p;\nfloat l1 = 100.;\nvec3 bs = vec3(0.,-3.5,0.);\nfloat ta = mix(1.5,.3,smoothstep(0.,8.,abs(p.y)));\nfloat ft = fract(iTime*0.5);\nfloat t = sin(sin(iTime*0.1)*0.1*pow(mix(ft,1.-ft,step(0.5,fract(iTime*0.25))),1.5))*sin(iTime*0.1)*180.;\np.xy *= rot(p.y*sin(iTime)*0.2);\np.xz *= rot(p.y*sin(iTime+0.5)*0.2);\nvec3 p2 = p;\nvec3 p3 = p;\nfloat l2 = 1000.;float l3 = 1000.;\np2.xz *= rot(3.14);\nfor(int i = 0 ; i <5 ; i++){\nfloat ip = float(i);\nvec3 v0 = vec3(sin(ip-1.+t),sin(ip-1.+t),cos(ip-1.+t)*0.5)*2.;\nvec3 v1 = vec3(sin(ip+t),sin(ip+t),cos(ip +t)*0.5)*2.;\nbs +=vec3(0.,1.5,0.);\nv0 +=bs-vec3(0.,0.75,0.);\nv1 += bs+vec3(0.,0.75,0.);\nl1 = min(l1,cap(p,v0,v1)-ta);\nl1 = min(l1,cap(p2,v0,v1)-ta*0.5);\nl1 = min(l1,cap(p3,v0,v1)-ta*0.25);\nl3 = min(l3,length(ps+v0*vec3(2.,1.,2.))-0.3);\n}\nzb = 1.;\nfloat r1 =  min(l1,l2);\nfloat r2 = r1-hs(p)*0.003;\nfloat r3 = min(r2,l3);\nfloat s = dot(ps,vec3(0.,1.,0.))+4.;\n\nif(r2<min(s,l3)){zb = 0.;}\nreturn min(r3,s);}\nfloat map2 (vec3 p){\nfloat s = dot(p,vec3(0.,1.,0.))+4.;\nreturn s;\n}\nfloat map(float value, float min1, float max1, float min2, float max2) {\n  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\n}\nvec3 nor(vec3 p){ vec2 e =vec2(0.01,0.); return normalize(map(p)-vec3(map(p-e.xyy),map(p-e.yxy),map(p-e.yyx)));}\nvec3 ov(vec3 a,vec3 b){ return mix(2.*a*b,1.-2.*(1.-a)*(1.-b),step(0.5,a));}\nfloat ev (vec3 r ,float bl ) {\nfloat ta = mod(iTime,floor(fract(0.1)*10.));\n//vec2 po = vec2(abs(r.y-0.2)+ta,r.x-r.z)*0.7;\nreturn smoothstep(0.5+bl,0.5,pow(length(r.x-r.z),-smoothstep(0.,1.8,length(r.y-0.2))*0.51+0.8))\n* smoothstep(0.5+bl,0.5,pow(length(r.y-0.2),-smoothstep(0.,2.,length(r.x-r.z))*0.51+0.8));\n//max(smoothstep(0.2,0.205,length(po)),smoothstep(0.165,0.16,length(po)))*\n//smoothstep(0.10,0.105,length(po));}\n}\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv =-1.+2.*fragCoord/iResolution.xy;\n     uv.x *= iResolution.x/iResolution.y;\n     float time = iTime;\n    vec3 p = vec3(0.,-1.,-7.);\n    vec3 r = normalize(vec3(uv,1.));\n    r.xz *= rot(sin(time)*0.1);\n    r.zy *= rot(cos(time)*0.1);\n    vec3 p2 = p;\n    vec3 r2 = r;\n    float dd;\n    float ref = 1.;\n     vec3 n =vec3(0.);\n     float mf = zb;\n     float mf2 = 0.;float mf3 = 0.;\n    const float md = 12.;\n \n    for(int i =0;i<48;i++){\n    float d = map(p);\n    if(dd>md){dd=md;break;}     \n    if(d<0.001){\n   \n    mf = zb;\n    ref *= mf;\n    n = nor(p);\n    if(ref<0.01){break;}\n   // mf3 = zc;\n    mf2 = zb; \n    r =reflect(r,n);\n    d = 0.01;    \n    }\n    p += r*d;\n    dd +=d;\n    }\n    \n    float dd2 ;\n    for(int j = 0 ; j < 7 ; j++){      \n    float d2 = map2(p2);   \n    //if(dd2>md){dd2 = md;break;}\n    if(d2<0.01){break;}\n    p2 += r2*d2;\n    dd2 += d2;\n    }\n    vec2 e = vec2(0.01,0.);\n    vec2 pt  = p2.xz*1.5;\n    float tex = smoothstep(0.3,0.7, it(pt));\n    float tex2 = smoothstep(0.3,0.7, it(pt+e.xy));\n    float tex3 = smoothstep(0.3,0.7, it(pt+e.yx));\n    vec3 tn = normalize(vec3(tex-tex2,0.2,tex-tex3));\n    vec3 n2 = n +tn*mf2;\n    float s = smoothstep(md-1.,7.,dd);\n    float s2 = smoothstep(md-1.,7.,dd2);\n    float s3 = max(s,s2);\n    float s4 =  max(smoothstep(md-1.,md-2.,dd),smoothstep(md-1.,md-2.,dd2));\n    float ta = smoothstep(0.3,0.7,fract(time*5.));\n    float dao = 0.2;\n    float ao = max(mix(0.8,1.,clamp(map(p+n2*dao)/dao,0.,1.)),0.);\n    float dss = 1.5;\n    float ss = clamp(map(p+r*dss)/dss,0.,1.)*(1.-mf);\n    float dr = clamp(dot(n2,-r2),0.,1.);\n    float fres = pow(1.-dr,0.5);\n    float spec = pow(dr,10.);\n    float spec2 = pow(dr,100.);\n    float r1 = pow(((fres*0.5+spec*0.3+spec2*0.02)*ao+ss*0.2),0.5);\n    float vaf = (1.-mf)*(1.-mf2*0.5);  \n    float vt = step(0.5,fract(time*5.));\n    float va2 =ev(r,0.01)*vt;\n    float va3 = mix(-1.,dot(n,vec3(1.,0.,1.)),vt);\n    float sat  = mix(0.,mix(0.2,0.,ao)+mix(0.05,0.2,smoothstep(-4.,5.,p.y+p.z*0.5))+ss*0.1+ss*0.05,vaf)*0.8+(-1.*va3)*0.13;\n    float val  = mix(va2*0.5,mix(0.9,0.4,smoothstep(-4.,5.,p.y+p.z*0.5))+mix(-0.15,0.1,va3),vaf)*ao+fres*0.2+(spec2*0.1+spec*0.1)*(1.-mf)+ss*0.2+clamp(va3,0.,1.)*0.5;\n    float hue  = clamp(p.y*-0.09*(1.-mf)+0.8+mix(0.1,0.,ao),0.6,1.)+mf*0.3;\n    vec3 c1 = mix(vec3(1.),3.*abs(1.-2.*fract(hue+vec3(0.,-1./3.,1./3.)))-1.,sat)*val;\n    vec3 c2 = mix(vec3(va2),c1,s3);\n    c2 = clamp(c2,0.,1.);\n   float hl = pow((c2.x+c2.y+c2.z)/3.,10.);\n    float m = mf2*mix(0.0001,0.0009,1.-tex)*mix(0.,1.,length(uv.y))*8.+(pow(length(uv.y),2.)*0.002+0.0001)*(1080./iResolution.y);\n   \n    fragColor = vec4(c2,m);\n}","name":"Buffer A","description":"","type":"buffer"}]}