{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[],"code":"const int maxiter = 128;\nconst int color_maxiter = 64;\n\n// Complex multiplication.\nvec2 cmul(vec2 u, vec2 v)\n{\n\treturn vec2(u.x * v.x - u.y * v.y,\n\t\t\t\tu.x * v.y + u.y * v.x);\n}\n\n// Returns a color for an iteration number.\nvec3 color(int iter)\n{\n\tfloat a = float(iter) / float(color_maxiter);\n\treturn (0.3 + a) * vec3(0.3, 0.3, 1.);\n}\n\n// Returns the iteration number when the sequence escapes\n// the 2-radius circle. Returns 0 if the sequence remains\n// in the circle for all iterations.\nint mandelbrot_iters(vec2 p)\n{\n\tvec2 z = p;\n\tint it = 0;\n\tfor (int i = 1; i < maxiter; ++i) {\n\t\tz = cmul(z, z) + p;\n\t\tif (length(z) > 2.) {\n\t\t\tit = i;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn it;\n}\n\n// Calculates the color in 4 points (pixel_pos + (+-0.25, +-0.25))\n// and sets the fragment color to the avg of the non-black colors.\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 mouse = (iMouse.xy - 0.5 * iResolution.xy) / iResolution.y;\n\tvec3 col = vec3(0., 0., 0.);\n\tfloat non_black_samples = 0.;\n\tfor (int i = 0; i < 4; ++i) {\n\t\tfloat phi = float(i) * 1.57079632679;\n\t\tvec2 pos_px = fragCoord.xy + 0.25 * (cos(phi), sin(phi));\n\t\tvec2 pos = (pos_px - 0.5 * iResolution.xy) / iResolution.y;\n\t\tpos *= 0.55 + 0.45 * sin(iTime);\n\t\tpos += mouse;\n\t\t\n\t\tint iter = mandelbrot_iters(pos);\n\t\t\n\t\tif (iter != 0) {\n\t\t\tcol += color(iter);\n\t\t\tnon_black_samples += 1.;\n\t\t}\n\t}\n\tcol /= max(1., non_black_samples);\n\tfragColor = vec4(col, 1.0);\n}","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"ldjGzh","date":"1383916106","viewed":152,"name":"Yet another Mandelbrot set","username":"vtan","description":"A Mandelbrot set with basic multisampling. You can move the fractal with the mouse if the left button is down.","likes":0,"published":1,"flags":0,"usePreview":0,"tags":["fractal","mandelbrot"],"hasliked":0,"parentid":"","parentname":""}}