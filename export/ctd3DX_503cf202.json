{"ver":"0.1","info":{"id":"ctd3DX","date":"1683241254","viewed":93,"name":"Fork Feedback Tunnel","username":"mehow_one","description":"Always wanted to explore that effect.\nTrying to add some filtering to it in an attempt of reducing the zoom blur ","likes":6,"published":1,"flags":32,"usePreview":0,"tags":["feedback","psychadelic"],"hasliked":0,"parentid":"tljGWG","parentname":"Feedback Tunnel"},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"float saturate (float x) {\n    return min(1.0, max(0.0,x));\n}\n\nvec3 irri(float hue) {\n  return .5+ .5 *cos(( 9.*hue)+ vec3(0,23.,21.));\n}\n\nvec3 TurboColormap(in float x) {\n  const vec4 kRedVec4 = vec4(0.13572138, 4.61539260, -42.66032258, 132.13108234);\n  const vec4 kGreenVec4 = vec4(0.09140261, 2.19418839, 4.84296658, -14.18503333);\n  const vec4 kBlueVec4 = vec4(0.10667330, 12.64194608, -60.58204836, 110.36276771);\n  const vec2 kRedVec2 = vec2(-152.94239396, 59.28637943);\n  const vec2 kGreenVec2 = vec2(4.27729857, 2.82956604);\n  const vec2 kBlueVec2 = vec2(-89.90310912, 27.34824973);\n  \n  x = saturate(x);\n  vec4 v4 = vec4( 1.0, x, x * x, x * x * x);\n  vec2 v2 = v4.zw * v4.z;\n  return vec3(\n    dot(v4, kRedVec4)   + dot(v2, kRedVec2),\n    dot(v4, kGreenVec4) + dot(v2, kGreenVec2),\n    dot(v4, kBlueVec4)  + dot(v2, kBlueVec2)\n  );\n}\n\nfloat dim(float x) {\n\treturn -4. * pow(x - .5, 2.) + 1.;    \n}\n\nvec3 turbo(float x) {\n    return TurboColormap(x) * dim(x);\n}\n\nvoid mainImage( out vec4 o, in vec2 i )\n{\n\to = texelFetch(iChannel0,ivec2(i),0);\n    \n    // linear -> gamma\n    o.rgb = pow( o.rgb, vec3(1./2.2) );\n    o.rgb = vec3(irri(dim(o.r*1.)+iTime*.5)*.25+.75);\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4sf3Rn","filepath":"/media/a/0a40562379b63dfb89227e6d172f39fdce9022cba76623f1054a2c83d6c0ba5d.png","previewfilepath":"/media/ap/0a40562379b63dfb89227e6d172f39fdce9022cba76623f1054a2c83d6c0ba5d.png","type":"texture","channel":1,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"float desaturate(vec3 color)\n{\n    return (min(color.r, min(color.g, color.b)) + max(color.r, max(color.g, color.b))) * 0.5;\n}\nmat2 rotate(float _angle){\n    return mat2(cos(_angle),-sin(_angle),\n                sin(_angle),cos(_angle));\n}\nfloat sdBox( in vec2 p, in vec2 b )\n{\n    vec2 d = abs(p)-b;\n    return length(max(d,0.0)) + min(max(d.x,d.y),0.0);\n}\n\n#define R aspect.x/aspect.y\n\nvoid mainImage( out vec4 o, in vec2 i )\n{\n    // read previous frame with a perspective twist\n    vec2 aspect = iResolution.xy/sqrt(iResolution.x*iResolution.y);\n    vec2 uv = (i/iResolution.xy-.5)*aspect;\n    vec3 ray = normalize(vec3(uv,1));\n\n    // adjust camera rotation\n    \n    \n\t// position camera (position of <0,0,-1> and 0 rotation = direct image)\n    vec3 camPos = vec3(vec2(-0.0,0.0),-1.0);\n    float t = (-0.015-camPos.z)/ray.z;\n    vec3 pos = camPos + ray*t;\n    uv = pos.xy;\n    \n    o = texture(iChannel0,uv/aspect+.5)*.985;\n    //o.rgb = filtering(uv/aspect+.5,aspect)*.99;\n    //o = vec4(NearestTextureSample(uv/aspect+.5),1.);\n    \n    vec3 col = vec3(1.);//sin(iTime*0.25*vec3(1,1.1382,1.618)*3.)*.725+.25;\n    vec2 p = vec2(sin(iTime*2.)*4.,cos(iTime*3.15)*1.)*.0125;\n    \n    float mask = sdBox( p+uv*rotate(sin(iTime*.5)*3.14153),vec2(0.05,0.10));\n    float r = 0.005/R;\n    o.rgb = mix( o.rgb, col, smoothstep(r,r-0.0005, mask ));\n\t\n    o.rgb = clamp(o.rgb,0.,1.);\n    //o.rgb = clamp(vec3(desaturate(o.rgb)),0.,1.);\n}","name":"Buffer A","description":"","type":"buffer"}]}