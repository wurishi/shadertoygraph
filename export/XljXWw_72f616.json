{"ver":"0.1","info":{"id":"XljXWw","date":"1444182626","viewed":152,"name":"HelloRay","username":"shittingduck","description":"Just a hello world test","likes":1,"published":1,"flags":0,"usePreview":0,"tags":["test"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[],"code":"#define PI 3.1415926536\n\nfloat iSphere( in vec3 ro, in vec3 rd, in vec4 sph )\n{\n\tvec3 oc = ro - sph.xyz;\n\tfloat b = 2.0*dot( oc, rd);\n\tfloat c = dot(oc, oc) - sph.w*sph.w;\n\tfloat h = b*b - 4.0 * c;\n\n\tif(h < 0.0) return -1.0;\n\n\tfloat t = (-b - sqrt(h))/2.0;\n\treturn t;\n\n}\n\nvec3 nSphere( in vec3 pos, in vec4 sph )\n{\n\treturn (pos - sph.xyz)/sph.w;\n}\n\nfloat iPlane( in vec3 ro, in vec3 rd )\n{\n\treturn -ro.y/rd.y;\n}\n\nvec3 nPlane( in vec3 pos )\n{\n\treturn vec3(0.0, 1.0, 0.0);\n}\n\nvec4 sph1 = vec4(0.0, 1.0, 0.0, 1.0);\n\nfloat intersect( in vec3 ro, in vec3 rd, out float resT )\n{\n\tresT = 1000.0;\n\tfloat id = -1.0;\n\tfloat tsph = iSphere( ro, rd, sph1 ); // intersect with a sphere\n\tfloat tpla = iPlane( ro, rd ); // intersect with a plane\n\n\tif(tsph > 0.0)\n\t{\n\t\tid = 1.0;\n\t\tresT = tsph;\n\t}\n\tif(tpla > 0.0 && tpla < resT)\n\t{\n\t\tid = 2.0;\n\t\tresT = tpla;\n\t}\n\n\treturn id;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec3 light = normalize( vec3( 0.57703) );\n\n    float xo = (iMouse.x * 2.0 / iResolution.x - 1.0) * PI;\n\tfloat yo = (0.5 - (iMouse.y / iResolution.y)) * 4.0 + 2.01;\n    \n    vec3 eye = vec3(cos(xo) * 5.0, yo, sin(xo) * 5.0);\n    vec3 lookat = vec3(0.0, 0.0, 0.0);\n    \n    vec2 uv = (fragCoord.xy * 2.0 - iResolution.xy) / iResolution.xx;\n\n\tvec3 forward = normalize(lookat - eye);\n\tvec3 up = vec3(0.0, 1.0, 0.0);\n\t\n\tvec3 right = cross(up, forward);\n\tup = cross(forward, right);\n    \n    vec3 ro = eye;\n    vec3 rd = normalize(right * uv.x + up * uv.y + forward);\n\n\tfloat t;\n\tfloat id = intersect(ro, rd, t);\n\n\tvec3 col = vec3(0.5);\n\tif(id > 0.5 && id < 1.5)\n\t{\n\t\t// we hit the sphere\n\t\tvec3 pos = ro + t*rd;\n\t\tvec3 nor = nSphere( pos, sph1 );\n\t\tfloat dif = clamp(dot( nor, light ), 0.0, 1.0);\n\n\t\tfloat ao = 0.5 + 0.5*nor.y;\n\t\tcol = vec3(0.9, 0.8, 0.6)*dif*ao + vec3(0.1,0.2,0.4)*ao;\n\t}\n\telse if( id > 1.5)\n\t{\n\t\t// we hit the plane\n\t\tvec3 pos = ro + t*rd;\n\t\tvec3 nor = nPlane( pos );\n\t\tfloat dif = clamp( dot(nor, light), 0.0, 1.0 );\n\n\t\tfloat amb = smoothstep( 0.0, 2.0 * sph1.w, length(pos.xz - sph1.xz) );\n\t\tcol = vec3(amb*0.7);\n\n\t}\n\tcol = sqrt(col);\n\tfragColor = vec4(col, 1.0);\n}","name":"","description":"","type":"image"}]}