{"ver":"0.1","info":{"id":"wtjSWh","date":"1565786900","viewed":718,"name":"Simple ripples","username":"aschrein","description":"ripples","likes":19,"published":1,"flags":32,"usePreview":1,"tags":["ripples"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XdX3Rn","filepath":"/media/a/52d2a8f514c4fd2d9866587f4d7b2a5bfa1a11a0e772077d7682deb8b3b517e5.jpg","previewfilepath":"/media/ap/52d2a8f514c4fd2d9866587f4d7b2a5bfa1a11a0e772077d7682deb8b3b517e5.jpg","type":"texture","channel":1,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"vec2 grad(vec2 coord)\n{\n    float stepx = 1.0;\n    float stepy = 1.0;\n    vec2 l00 = texture(iChannel0, (coord + vec2(-stepx, -stepy)) / iResolution.xy).x * vec2(-stepx, -stepy);\n    vec2 l01 = texture(iChannel0, (coord + vec2(stepx, -stepy)) / iResolution.xy).x * vec2(stepx, -stepy);\n    vec2 l10 = texture(iChannel0, (coord + vec2(stepx, stepy)) / iResolution.xy).x * vec2(stepx, stepy);\n    vec2 l11 = texture(iChannel0, (coord + vec2(-stepx, stepy)) / iResolution.xy).x * vec2(-stepx, stepy);\n    return (l00 + l01 + l10 + l11) * 0.5;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    float r = texture(iChannel0, fragCoord/iResolution.xy).x;\n    r = clamp(r, -10.0, 10.0) / 20.0 + 0.5;\n    vec2 g = grad(fragCoord);\n        vec3 normal = normalize(cross(vec3(1.0, 0.0, g.x), vec3(0.0, 1.0, g.y)));\n        vec3 color = texture(iChannel1, (fragCoord + 30.0 * normal.xy)/iResolution.xy).xyz;\n    vec3 wpos = vec3(fragCoord/iResolution.xy, 0.0);\n    vec3 cam_pos = vec3(0.5, 0.5, 10.0);\n    vec3 ray_dir = normalize(wpos - cam_pos);\n    vec3 light_pos = vec3(0.1, 0.8, 1.0);\n    vec3 l = normalize(light_pos - wpos);\n    vec3 refl = reflect(ray_dir, normal);\n    \n    float phong_spec = pow(clamp(dot(refl, l), 0.0, 1.0), 256.0);\n    \n    if (fragCoord.x < iResolution.x * 0.33333)\n    {\n        fragColor = vec4(color + vec3(phong_spec), 1.0);\n    }\n    else if (fragCoord.x < iResolution.x * 0.66666)\n    {\n        fragColor = vec4(normal * 0.5 + 0.5, 1.0);\n    }\n    else\n    {\n        fragColor = vec4(r, r, r, 1.0);\n    }\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"float laplace(vec2 coord)\n{\n    float stepx = 1.0;\n    float stepy = 1.0;\n    float l00 = texture(iChannel0, (coord + vec2(-stepx, -stepy)) / iResolution.xy).x;\n    float l01 = texture(iChannel0, (coord + vec2(stepx, -stepy)) / iResolution.xy).x;\n    float l10 = texture(iChannel0, (coord + vec2(stepx, stepy)) / iResolution.xy).x;\n    float l11 = texture(iChannel0, (coord + vec2(-stepx, stepy)) / iResolution.xy).x;\n    return (l00 + l01 + l10 + l11) * 0.25 - texture(iChannel0, coord / iResolution.xy).x;\n}\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy ,vec2(192.9898,78.233))) * 43758.5453);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    float offset = 0.0;\n    float rand_step = 5.0;\n    vec2 cell_center = 2.0 * rand_step * floor(fragCoord / rand_step / 2.0) + vec2(rand_step, rand_step);\n    if (iTime < 10.0)\n    {\n        if (length(fragCoord.xy - iResolution.xy * 0.5) < 8.0 )\n        {\n            offset = 1.0 * sin(2.0 * iTime);\n        }\n        if (length(fragCoord.xy - iResolution.xy * vec2(0.2, 0.5)) < 4.0 )\n        {\n            offset = 0.5 * sin(4.0 * iTime);\n        }\n        if (length(fragCoord.xy - iResolution.xy * vec2(0.8, 0.5)) < 4.0 )\n        {\n            offset = 0.45 * sin(1.0 * iTime);\n        }\n    }\n    else if (rand(\n        \n        \t\t\tcell_center / iResolution.xy +\n        \t\t\trand(vec2(iTime * 777.0, -iTime))\n    \t\t\t) > 0.996\n            )\n    {\n        float l = length(\n               fragCoord - cell_center\n              );\n        if (l < rand_step)\n        \toffset = -0.7 * pow((rand_step - l) / rand_step, 2.0);\n    }\n    vec2 cur_val = texture(iChannel0, fragCoord / iResolution.xy).xy;\n    float lap = laplace(fragCoord);\n    cur_val.y += lap;\n    float clamp_val = 100.0;\n   \tfragColor = vec4(clamp(cur_val.x + cur_val.y * 0.2 + offset, -clamp_val, clamp_val),\n                     clamp(cur_val.y * 0.99, -clamp_val, clamp_val), 0.0, 1.0);\n}","name":"Buffer A","description":"","type":"buffer"}]}