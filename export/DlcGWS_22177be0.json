{"ver":"0.1","info":{"id":"DlcGWS","date":"1683040704","viewed":57,"name":"Basic ray marching (sphere)","username":"tolgacan","description":"Implementation of the basic ray marching algorithm to render a sphere","likes":1,"published":1,"flags":0,"usePreview":0,"tags":["raymarching","sphere"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"vec3 bgColor = vec3(0.7,0.8,1.0);\nfloat width = 3.46;\nfloat height = 1.95;\nvec3 bottomleft = vec3(-1.73,-0.973,1.0);\nfloat eps = 0.02;\nvec3 sc = vec3(0,0,2); // sphere center\nfloat radius = 1.0;    // sphere radius\nvec3 sphereColor = vec3(0.5,1.0,1.0);\nvec3 light = vec3(-3,5,-3); // light position\n\nvec3 rayd = vec3(0,0,1);\n\n// sphere signed distance function\nfloat dist(vec3 sc, float r, vec3 p) {\n    return distance(sc,p)-r;\n}\n\nvec3 raymarch() {\n    vec3 p = vec3(0,0,0); // start pos of ray marching\n    float dt = 0.01; // fixed ray marching steps\n    float sd; // signed distance of current pos to sphere surface\n    float last_sd;\n    sd = dist(sc,radius,p);\n    last_sd = sd;\n    while (sd>eps && last_sd>=sd) {\n        p = p+rayd*dt;\n        last_sd = sd;\n        sd = dist(sc,radius,p);\n    }\n    if (sd<=eps) return p; // intersection detected\n    else return vec3(0,0,0); // no intersection\n}\n\nvec3 computeColor(vec3 p) {\n    vec3 n = normalize(p-sc);\n    vec3 l = normalize(light-p);\n    return max(dot(n,l),0.0)*sphereColor; // diffuse color\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // Normalized pixel coordinates (from 0 to 1)\n    vec2 uv = fragCoord/iResolution.xy;\n    \n    rayd = bottomleft+vec3(uv.x*width,uv.y*height,0.0);\n\n    // change light position\n    light.x = light.x*cos(iTime);\n    light.y = light.y*sin(iTime);\n\n    vec3 col = bgColor;\n    \n    vec3 p = raymarch();\n    \n    if (distance(p,vec3(0,0,0))>0.1) // check for intersection\n        col = computeColor(p);\n\n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}