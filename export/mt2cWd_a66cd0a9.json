{"ver":"0.1","info":{"id":"mt2cWd","date":"1692471456","viewed":84,"name":"Cotonetes ","username":"Elsio","description":"desc","likes":13,"published":1,"flags":0,"usePreview":0,"tags":["fosforos"],"hasliked":0,"parentid":"dljcDt","parentname":"Harpoon"},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define res iResolution.xy\n#define rot(a) mat2 (cos(a), sin(a), -sin(a), cos(a))\n#define wmod(s, w) mod(s ,w) - w/2.\n#define discr(p, s) floor(p / s) * s\n#define PI atan(.0, -1.)\n#define T  iTime * 4.\n\nfloat slength(vec2 p){\n    float k = 15.;\n    p = abs(p);\n    return pow(\n              pow(p.x, k) \n            + pow(p.y, k), 1./k);\n}\n\nfloat smin(float a, float b){\n    float t = 50.;\n    return -log(\n        exp(t * -a) + exp(t * -b)) / t;\n}\n\n\nvec3 distort(vec3 p){\n    float umaDose = .8;\n    p.yx *=  rot(umaDose * dot(vec2(cos(T), sin(T)), p.xz));\n    return p;\n}\n\nvec3 rotate(vec3 p){\n    p.xy *=  rot(T * .04);\n    p.xz *=  rot(T * .07);\n    return p;\n}\n\n\nfloat map(vec3 p){\n    p = distort(p);\n    p = rotate(p);\n    \n    // form\n    float a = PI/4.;\n\n    float h = 1.;\n        h = min(h, length(p.xy)); \n        h = min(h, length(p.xz)); \n        h = min(h, length(p.zy)); \n        \n        //h = min(h, length(cos(a) * p.xz + sin(a) * p.xy)); //\n        //h = min(h, length(cos(a) * p.yx + sin(a) * p.yz)); //\n        //h = min(h, length(cos(a) * p.zy + sin(a) * p.zx)); //\n        \n        h = min(h, length(cos(a) * p.xz + sin(a) * p.yx)); \n        h = min(h, length(cos(a) * p.yx + sin(a) * p.zy)); \n        h = min(h, length(cos(a) * p.zx - sin(a) * p.xy)); // \n        h = min(h, length(cos(a) * p.yz + sin(a) * p.zx)); //\n        \n        h = max(h, length(p) - .4);\n        \n    float d = 1.;\n    d = smin(d, length(abs(p) - vec3(0)) - .07);\n    //d = smin(d, length(abs(p) - vec3(.45, .45, 0) / sqrt(2.)));\n    //d = smin(d, length(abs(p) - vec3(0, .45, .45) / sqrt(2.)));\n    //d = smin(d, length(abs(p) - vec3(.45, 0, .45) / sqrt(2.)));\n\n    d = smin(d, length(abs(p) - vec3(.45) / sqrt(3.)));\n\n    d = smin(d, length(abs(p) - vec3(.45, 0,0)));\n    d = smin(d, length(abs(p) - vec3(0, .45, 0)));\n    d = smin(d, length(abs(p) - vec3(0, 0, .45)));\n    return smin(d - .05, h - .01);\n}\n\nvoid mainImage(out vec4 O, vec2 u){\n    // resolution\n    vec2 uv = (u - .5*res)/res.y;\n\n    // camera\n    vec3 ro = vec3(0, 0, -1.),\n         rd = normalize(vec3(uv, 1));\n         \n         \n    // raymarch\n    float s, i, d, far = 2.;\n    while(i++ < 600.) {\n        s = map(ro + d * rd);\n        d += s * .5;\n        if(d > far || abs(s) < .01) break;\n    }\n\n    vec3 col;\n\n    if(d < far) {\n        // normal\n        vec2 e = vec2(.01, 0);\n        vec3 p = ro + rd * d,\n             n = normalize(\n                 map(p) - vec3(\n                     map(p-e.xyy), \n                     map(p-e.yxy),\n                     map(p-e.yyx)));\n                     \n                     \n\n        // light\n        float a = T * .5;\n        vec3 lightPos = vec3(sin(a), cos(a), -1);\n        \n        if (true){\n            col += .75 \n            * smoothstep(\n                -.1, .1, dot(normalize(p), reflect(rd, n)) + 1.) \n            * smoothstep(\n                .0,  .8, dot(reflect(rd, n), normalize(lightPos))) \n            * clamp(dot(n, rd) + 1., 0., 1.)\n            ;\n        }\n        \n        //col = pow(col, vec3(.7));\n\n    }\n    \n    else{\n        // background\n        col = mix(vec3(.75), vec3(1,0,0), smoothstep(0., .005, length(uv) - .5));\n    }\n    \n    O = vec4(col, 1);\n}\n\n\n\n/*\n    relateds\n    \n    Lisergico\n    https://www.shadertoy.com/view/md3czS\n    \n    Cotonetes \n    https://www.shadertoy.com/view/mt2cWd\n    \n    Tijolos \n    https://www.shadertoy.com/view/mdSBWy\n    \n    Bioluminescencia\n    https://www.shadertoy.com/view/cd3yRB\n\n*/\n","name":"Image","description":"","type":"image"}]}