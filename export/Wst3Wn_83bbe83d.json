{"ver":"0.1","info":{"id":"Wst3Wn","date":"1568214480","viewed":328,"name":"roadToHell","username":"foran","description":"roadToHell","likes":21,"published":1,"flags":0,"usePreview":0,"tags":["roadtohell"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"float obj(vec3 p)\n{\n  vec3 pp = p;\n  pp.z = mod(p.x, 110.)-55.;//  структура\n  float d=  -abs(p.x-1.)+63.;\n  return d;\n}\n\nfloat obj2(vec3 p)\n{\n  float d = length(p.xy-vec2(1.+cos(p.z),0.+sin(p.z)))-.21;//  толщина спирали  .21\n  return d;\n}\n\nfloat map(vec3 p)\n{\n  float d = dot(cos(p.xyz), sin(p.zxy))+1.;\n  d += cos(p.z*10.)*.1;\n  d = min(d, obj(p));\n  d = min(d, obj2(p));\n\n  return d*.8;//  глубина .8\n}\n\nvec3 normal(vec3 p)\n{\n  vec3 n;\n  vec2 eps = vec2(0.01,0.);\n  n.x = map(p) - map(p+eps.xyy);\n  n.y = map(p) - map(p+eps.yxy);\n  n.z = map(p) - map(p+eps.yyx);\n\n  return normalize(n);\n}\n\nmat2 rotate(float v)\n{\n  float a = cos(v);\n  float b = sin(v);\n  return mat2(a,b,-b,a);\n}\n\nvec3 raymarch(vec3 ro, vec3 rd)\n{\n  vec3 p = ro;\n\n  for(int i=0; i<64; i++)\n  {\n    float d = map(p);\n    p += rd * d;\n  }\n\n  return p;\n}\n\nvec3 shade( vec3 ro, vec3 rd, vec3 p, vec3 n)//  color\n{\n  vec3 ld = normalize(vec3(.1,1.,-.5));\n  vec3 col = vec3(0.);\n\n  col = vec3(1.) * max(0., dot(n,ld))*.43;//                              яркость белого света .3\n  col+=mix(vec3(0.7882, 0.098, 0.1529),vec3(0.0902, 0.8196, 1.0),rd.y)*length(p-ro)*.05;//  цвет градиента по rd.y\n\n  return col;\n}\n\nvoid mainImage(out vec4 fragColor,in vec2 fragCoord)\n{\n  vec2 uv=vec2(fragCoord.x/iResolution.x,fragCoord.y/iResolution.y);\n  uv-=.5;\n  uv/=vec2(iResolution.y/iResolution.x,1);\n  \n    vec3 ro = vec3(1.,0.,-iTime);//  -iTime туда, +iTime обратно\n    vec3 rd = normalize(vec3(uv*2.,-1.));//  uv*2 растянуть, -1. расширить\n    vec3 p = raymarch(ro,rd);//  рэймарш\n    vec3 n = normal(p);\n    vec3 col = shade(ro, rd, p, n);//  цвет градиента и свет\n\n  vec4 out_color=vec4(1.);\n  out_color = vec4(col, 1.);\n  fragColor=vec4(out_color);\n}","name":"Image","description":"","type":"image"}]}