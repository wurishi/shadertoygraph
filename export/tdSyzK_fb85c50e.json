{"ver":"0.1","info":{"id":"tdSyzK","date":"1586945329","viewed":181,"name":"moss","username":"nexor","description":"Space resets the screen.","likes":5,"published":1,"flags":48,"usePreview":0,"tags":["reactiondiffusion"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"nearest","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void mainImage(out vec4 fragColor, vec2 fragCoord)\n{\n    vec3 col = vec3(.0);\n    \n    {\n        col += dot(vec3(0.2126,.7152,.0722),texture(iChannel0,fragCoord/iResolution.xy).rgb);\n        col *= vec3(.2,.9,.1);\n     //   col*=.3;\n    }\n    col = pow(col,vec3(1./1.5));\n \tfragColor = vec4(col,1.);   \n}","name":"Image","description":"","type":"image"},{"inputs":[],"outputs":[],"code":"#define time iTime\n#define resolution iResolution.xy\n\n#define replim(x,n,a,b) ((p)-(n)*clamp(round(p/n),(a),(b)))\n#define fetch(pass,uv) texelFetch(pass,ivec2(mod(vec2(uv),(res))),0)\n\n#define pi 3.14159\n\nfloat box(vec2 p, vec2 s)\n{\n    p=abs(p)-s;\n    return length(max(p,0.))+min(0.,max(p.x,p.y));\n}\n\nfloat circle(vec2 p,float r)\n{\n    return length(p)-r;\n}\n\nfloat sdArc( in vec2 p, in vec2 sca, in vec2 scb, in float ra, float rb )\n{\n    p *= mat2(sca.x,sca.y,-sca.y,sca.x);\n    p.x = abs(p.x);\n    float k = (scb.y*p.x>scb.x*p.y) ? dot(p.xy,scb) : length(p.xy);\n    return sqrt( dot(p,p) + ra*ra - 2.0*ra*k ) - rb;\n}\n\nvec2 laplace(out vec2 prev, sampler2D pass, vec2 res)\n{\n    vec2 lap=vec2(0.);\n    ivec2 fc = ivec2(gl_FragCoord.xy);\n    ivec3 off = ivec3(-1.,0.,1.);\n    vec2 w = vec2(.2,.05);\n    \n    lap += fetch(pass,fc+off.xx).xy*w.y;\n    lap += fetch(pass,fc+off.xy).xy*w.x;\n    lap += fetch(pass,fc+off.xz).xy*w.y;\n    lap += fetch(pass,fc+off.yx).xy*w.x;\n    prev = fetch(pass,fc+off.yy).xy;\n    lap += fetch(pass,fc+off.yz).xy*w.x;\n    lap += fetch(pass,fc+off.zx).xy*w.y;\n    lap += fetch(pass,fc+off.zy).xy*w.x;\n    lap += fetch(pass,fc+off.zz).xy*w.y;\n    lap += -prev;\n    \n    return lap;\n}\n\n","name":"Common","description":"","type":"common"},{"inputs":[{"id":"4dXGzn","filepath":"/media/a/0c7bf5fe9462d5bffbd11126e82908e39be3ce56220d900f633d58fb432e56f5.png","previewfilepath":"/media/ap/0c7bf5fe9462d5bffbd11126e82908e39be3ce56220d900f633d58fb432e56f5.png","type":"texture","channel":1,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4dXGRr","filepath":"/presets/tex00.jpg","previewfilepath":"/presets/tex00.jpg","type":"keyboard","channel":2,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"vec4 get_params(vec2 p, out float dt)\n{\n    \n\tfloat A = .8;\n\tfloat B = .2;\n\tfloat F = 0.08;\n\tfloat K = 0.06;\n    \n    dt = 1.;\n    \n    return clamp(vec4(A,B,F,K),0.,1.);   \n}\n\nfloat letterS(vec2 p)\n{\n \tfloat d=1e3;\n    float ta=pi*.25;\n    float tb=pi*.75;\n    p.y*=1.5;\n    vec2 a=vec2(sin(ta),cos(ta));\n    vec2 b=vec2(sin(tb),cos(tb));\n    p.y-=.05;\n    d=sdArc(p,a,b,.05,.002);\n    ta+=pi;\n    a=vec2(sin(ta),cos(ta));\n    p.y-=-.1;\n    return min(d,sdArc(p,a,b,.05,.002));\n}\n\nfloat letterM(vec2 p)\n{\n \tfloat d=1e3;\n    float e=1e3;\n    \n    float t=pi*.5;\n    vec2 a=vec2(sin(t),cos(t));\n    p.y*=.85;\n    vec2 q=p;\n    p.x=abs(p.x)-.05;\n    d=sdArc(p,a,a,.05,.002);\n    e=box(q-vec2(-.1,.0),vec2(.001,.055));\n    q.x=abs(q.x-.05)-.05;\n    q.y-=-.0255;\n    e=min(e,box(q,vec2(.001,.03)));\n    return min(d,e);\n}\n\nfloat seed(vec2 p)\n{\n    float d = 1e3;\n    \n    d=min(d,letterM(p-vec2(-.215,.0)));\n    d=min(d,abs(circle(p,.05)-.015));\n    d=min(d,letterS(p-vec2(.15,.0)));\n    d=min(d,letterS(p-vec2(.3,.0)));\n    \n    return smoothstep(.015,.0,d);\n    \n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord.xy/resolution;\n    vec2 p = (fragCoord.xy-.5*resolution)/resolution.y;\n    \n    vec3 col = vec3(0.);\n    float space = texelFetch(iChannel2,ivec2(32,1),0).x;\n    \n    if(iFrame < 10)\n    {\n        col.rg = vec2(1.,seed(p));\n    }\n    else if(space > .0)\n    {\n     \tcol.rg = vec2(1.,seed(p));\n    }\n    else\n    {\n        vec2 mouse = (iMouse.xy-.5*resolution)/resolution.y;\n        vec2 click = (iMouse.zw-.5*resolution)/resolution.y;\n        \n        if(iMouse.z >.0)\n        {\n        //    col += smoothstep(.01,.0,circle(p-(mouse-click),smoothstep(.0,1.,length(p-mouse))*.1));\n        }\n        \n        vec2 curr = vec2(0.);\n        vec2 prev = vec2(0.);\n        vec2 lap = laplace(prev,iChannel0,resolution);\n        float dt = 0.;\n        vec4 pms = get_params(p, dt);\n        float da=pms.x,db=pms.y;\n        float f=pms.z, k=pms.w;\n        \n        float pr = prev.x*prev.y*prev.y;\n        \n        curr.x = da * lap.x - pr + f * (1.-prev.x);\n        curr.y = db * lap.y + pr - (k + f) * prev.y;\n   \n        curr = prev + curr*dt;\n        \n        col += vec3(curr.xy,step(curr.x,curr.y));\n        col = clamp(col,.0,1.);\n        //col *= smoothstep(.7,.5,length(p));\n    }\n    \n    \n    fragColor = vec4(col,1.);\n}","name":"Buffer A","description":"","type":"buffer"}]}