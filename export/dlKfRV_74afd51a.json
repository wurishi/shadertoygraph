{"ver":"0.1","info":{"id":"dlKfRV","date":"1714013389","viewed":41,"name":"转得头晕","username":"lbl","description":"void","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["3d"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XsfGzn","filepath":"/media/a/585f9546c092f53ded45332b343144396c0b2d70d9965f585ebc172080d8aa58.jpg","previewfilepath":"/media/ap/585f9546c092f53ded45332b343144396c0b2d70d9965f585ebc172080d8aa58.jpg","type":"cubemap","channel":0,"sampler":{"filter":"mipmap","wrap":"clamp","vflip":"false","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"struct Cam\n{\n    vec3 pos,dir;\n    vec3 r,u;\n}cam;\n\nvoid mainImage( out vec4 fragcolor, in vec2 C )\n{\n    vec2 uv=(C-.5*iResolution.xy)/iResolution.y;\n    vec3 center = vec3(0.,0.,0.);\n    float r = 1.;\n    float t = fract(iTime/4.) * 2. * 3.14159;\n    cam.pos = vec3(12.*cos(t),0.,3.*sin(t)); \n    cam.dir = normalize(center-cam.pos);\n    cam.r   = cross(vec3(0,1,0),cam.dir);\n    cam.u   = cross(cam.dir,cam.r);\n    vec3 o = cam.pos-center;\n    vec3 d = vec3(uv.x * cam.r+uv.y*cam.u+1.*cam.dir);\n    float a = dot(d,d),\n          b = 2.*dot(o,d),\n          c = dot(o,o)-r*r,\n          delta = b*b - 4.*a*c,\n          k;\n    if(delta<0.) {\n        fragcolor = texture(iChannel0,d);\n    }else {\n        k=(-b-sqrt(delta))/(2.*a);\n        vec3 p = cam.pos + k*d;\n        vec3 dirLight =  vec3(0.,1.,.3);\n        vec3 normal=(p-center)/r;\n        vec3 ambient = vec3(.8,.7,.7)*.12;//环境光\n        vec3 diffuse = dot(dirLight,normal) * vec3(.5,.8,.9);\n        fragcolor = vec4(min( ambient + diffuse,1.),1.);\n   }\n}\n","name":"Image","description":"","type":"image"}]}