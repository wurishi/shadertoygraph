{"ver":"0.1","info":{"id":"stKSR3","date":"1641167091","viewed":180,"name":"ImageProcessing Sample _Sharpen","username":"dhayward","description":"ImageProcessing Sample Sharpen","likes":2,"published":1,"flags":2,"usePreview":0,"tags":["webcam"],"hasliked":0,"parentid":"NtyXWW","parentname":"ImageProcessing Sample _Blur"},"renderpass":[{"inputs":[{"id":"4sf3zn","filepath":"/presets/webcam.png","previewfilepath":"/presets/webcam.png","type":"webcam","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// https://www.shadertoy.com/new\n//\n\nvec3 alterPixel (vec3 pixel, vec3 bluredPixel, float sharpenAmount)\n{\n    return pixel + (pixel-bluredPixel)*sharpenAmount;\n\n    //pixel.rgb = 1.0 - pixel.rgb;\n    //pixel.rgb = pow(pixel.rgb,vec3(2.0));\n    return bluredPixel;\n}\n\nfloat rand(vec2 co)\n{\n   return fract(sin(dot(co.xy,vec2(12.9898,78.233))) * 43758.5453)*2.0 - 1.0;\n}\n\nvec4 textureWithBlur( sampler2D s, vec2 pNorm, vec2 blur)\n{\n    vec4 c = vec4(0.0);\n    int maxcount=30, maxtry = 50, trycount=0, count = 0;\n    while (count < maxcount)\n    {\n        trycount++;\n        float dx = rand(pNorm + iTime + float(2*count));\n        float dy = rand(pNorm + iTime + float(2*count+1));\n        \n        vec2 delta = vec2(dx,dy);\n        \n        if (trycount>maxtry && dx*dx + dy*dy > 1.0)\n           continue;\n        c += texture(s, pNorm + blur*delta);\n        count ++;\n    }\n    \n    c /= float(maxcount);;\n    \n    return c;\n}\n\nvec3 DrawSlider (vec2 pos, vec2 mouse, vec3 rgb)\n{\n    if (pos.x>0.05 && pos.y>0.07)\n        return rgb;\n\n    if (abs(pos.y - mouse.y)<0.01 && pos.x<0.05)\n        return vec3(1.0);\n    if (abs(pos.x - mouse.x)<0.006 && pos.y<0.07)\n        return vec3(1.0);\n        \n    return rgb * 0.5;\n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 mouse = iMouse.xy / iResolution.xy;\n\tvec2 pos = fragCoord.xy / iResolution.xy;\n    \n    vec4 c = texture(iChannel0,pos);\n    \n    float blurAmount = 20.0 * mouse.y;\n    float sharpenAmount = mouse.x;\n    \n    vec2 blurDims = blurAmount / iResolution.xy;\n    vec4 bc = textureWithBlur( iChannel0, pos, blurDims);\n\n    //c = c + (c-bc)*mix(1.0,2.0,mouse.x);\n    c.rgb = alterPixel(c.rgb, bc.rgb, sharpenAmount);\n    c.rgb = DrawSlider(pos, mouse, c.rgb);\n\n\tfragColor = c;\n}","name":"Image","description":"","type":"image"}]}