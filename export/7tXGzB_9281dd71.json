{"ver":"0.1","info":{"id":"7tXGzB","date":"1636558559","viewed":146,"name":"2x voronoi with texture input","username":"ZachSaucier","description":"Fork of https://www.shadertoy.com/view/ss2XRz\n\nVersion with UI for input and mouse interaction: https://codepen.io/ZachSaucier/pen/RwVaajJ","likes":7,"published":1,"flags":0,"usePreview":0,"tags":["2d","voronoi","animation"],"hasliked":0,"parentid":"sts3RN","parentname":"Double voronoi with noise"},"renderpass":[{"inputs":[{"id":"Xdf3zn","filepath":"/media/a/85a6d68622b36995ccb98a89bbb119edf167c914660e4450d313de049320005c.png","previewfilepath":"/media/ap/85a6d68622b36995ccb98a89bbb119edf167c914660e4450d313de049320005c.png","type":"texture","channel":1,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"Xsf3zn","filepath":"/media/a/f735bee5b64ef98879dc618b016ecf7939a5756040c2cde21ccb15e69a6e1cfb.png","previewfilepath":"/media/ap/f735bee5b64ef98879dc618b016ecf7939a5756040c2cde21ccb15e69a6e1cfb.png","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define AA (20./iResolution.y)\n\nfloat smin( float a, float b, float k ){\n    float h = clamp( 0.5+0.5*(b-a)/k, 0.0, 1.0 );\n    return mix( b, a, h ) - k*h*(1.0-h);\n}\n\nvec3 hsv2rgb(vec3 c) {\n  // Íñigo Quílez\n  // https://www.shadertoy.com/view/MsS3Wc\n  vec3 rgb = clamp(abs(mod(c.x*6.+vec3(0.,4.,2.),6.)-3.)-1.,0.,1.);\n  rgb = rgb * rgb * (3. - 2. * rgb);\n  return c.z * mix(vec3(1.), rgb, c.y);\n}\n\nvec2 hash2( vec2 p )\n{\n\treturn textureLod( iChannel0, (p+0.5)/256.0, 0.0 ).xy;\n}\n\nvec3 voronoi( in vec2 x )\n{\n    vec2 n = floor(x);\n    vec2 f = fract(x);\n\n    //----------------------------------\n    // first pass: regular voronoi\n    //----------------------------------\n\tvec2 mg, mr;\n\n    float md = 8.0;\n    for( int j=-1; j<=1; j++ )\n    for( int i=-1; i<=1; i++ )\n    {\n        vec2 g = vec2(float(i),float(j));\n        vec2 o = 0.5 + 0.5*sin( iTime + 6.2831*hash2( n + g ) );\n        vec2 r = g + o - f;\n        float d = dot(r,r);\n\n        if( d<md )\n        {\n            md = d;\n            mr = r;\n            mg = g;\n        }\n    }\n\n    //----------------------------------\n    // second pass: distance to borders\n    //----------------------------------\n    md = 8.0;\n    for( int j=-2; j<=2; j++ )\n    for( int i=-2; i<=2; i++ )\n    {\n        vec2 g = mg + vec2(float(i),float(j));\n        vec2 o = 0.5 + 0.5*sin( iTime + 6.2831*hash2( n + g ) );\n        vec2 r = g + o - f;\n\n        if( dot(mr-r,mr-r)>0.00001 )\n        md = smin( md, dot(0.5*(mr+r), normalize(r-mr)), .2);\n    }\n\n    return vec3( md, n + mg );\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = (2. * fragCoord - iResolution.xy)/iResolution.y;\n    uv *= 4.7;\n    uv.y -= .5;\n    \n    vec4 size = texture(iChannel1, uv);\n    \n    vec3 vor = voronoi(uv);\n    vec3 vor2 = voronoi(vec2(size.r, length(uv)) * vec2(48., 4.));\n    //vor -= vor2 - vor;\n    vor += min(vor, vor2);\n    //vor += max(vor, vor2);\n    fragColor = .1 + vec4(hsv2rgb(vec3(atan(vor.y, vor.z), 0.7, 0.9)), 1.)\n              * smoothstep(.02 + AA, .02, distance(1. - fract(pow(size.r, .25)), vor.x));\n    //fragColor = size;\n}","name":"Image","description":"","type":"image"}]}