{"ver":"0.1","info":{"id":"tsyczm","date":"1602483783","viewed":173,"name":"Line Light Trick","username":"luosiri","description":"Simple line light trick","likes":6,"published":1,"flags":0,"usePreview":0,"tags":["2d"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define PI 3.1415926\nstruct LineLight{\n    float range;\n    vec2 p0;\n    vec2 p1;\n    vec3 color;\n};\n\nvec2 Rotate(vec2 vec,float r){    \n    \n    float s = sin(r);\n    float c = cos(r);\n\n    //center rotation matrix\n    mat2 rMatrix = mat2(c, -s, s, c);\n    rMatrix *= 0.5;\n    rMatrix += 0.5;\n    return vec * rMatrix;\n}\n    \nvec3 SampleLight(LineLight light,vec2 pos){\n    vec2 l = light.p1 - light.p0;\n\tfloat t = dot(normalize(pos - light.p0) , normalize(l));\n    t = max(t,0.0);\n    float d = (length(pos - light.p0) * t) / length(l);\n    d = clamp(d,0.0,1.0);\n    vec2 closerP = mix(light.p0 , light.p1, vec2(d,d));\n    float il = 1.0 - clamp(length(closerP - pos) / light.range,0.0,1.0);\n    il = pow(il,4.0);\n    vec2 ax = Rotate(normalize(l),PI );\n    il *= abs(max(0.0,dot(normalize(ax) , normalize(pos - closerP)))) ;\n    return vec3(il,il,il);\n}\n    \nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // Normalized pixel coordinates (from 0 to 1)\n    vec2 uv = fragCoord/iResolution.xy;\n\t//\n    LineLight light;\n    light.p0 = vec2(0.7,0.2);\n    light.p1 = vec2(0.9,0.2);\n    light.range = 1.6;\n    light.color = vec3(1,1,1);\n    // Time varying pixel color\n    vec3 col = SampleLight(light,uv * vec2(iResolution.x/iResolution.y,1));\n\t\n    //col = mix(vec3(0,col.x,1.0-col.x),vec3(col.x,1.0-col.x,0),col.x)*2.0;\n    // Output to screen\n    fragColor = vec4(col,1.0);\n}","name":"Image","description":"","type":"image"}]}