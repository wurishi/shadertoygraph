{"ver":"0.1","info":{"id":"4fj3zz","date":"1703761911","viewed":53,"name":"Mouse-lit sphere effect","username":"KaleyGoode","description":"Click/drag the canvas to alter the light origin.\nTo have the light follow the mouse: mouse-down in the canvas; drag outside, release mouse; hover over canvas.","likes":1,"published":1,"flags":0,"usePreview":0,"tags":["lighting","sphere","specular","ambient"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"/* mouse-lit sphere.\nClick the canvas to alter the light origin.\n\nFrom code lumps I wrote for lumpylumpy.com\n*/\n#define  pi 3.14159265359\n#define tau (2.*pi)\n\n#define frame(v) (3.*(v-.5*R)/min(R.x,R.y))\n#define gold vec3(.9,.7,.3)\n\n#define Unsigned(x) (.5*(x+1.)) //   Signed Unit Interval [-1,1] to Unsigned UI [ 0,1]\n#define Upper3(n, t) (pow(clamp(n*(t-1.)+1.,0.,1.),3.)) // if n=5, the upper fifth is spread out to [0,1]. That result is then cubed and returned.\n#define atan2(y, x) ((abs(x) < 0.00001) ? tau*sign(y) : atan(y,x))\n\nvoid mainImage(out vec4 O, vec2 U) {\n  vec2  R = iResolution.xy,\n        d = frame(U),\n        m = frame(iMouse.xy),\n        M = abs(m); \n  float r = length(d),\n        z = sqrt(abs(1.-dot(d,d)));\n  vec3  o = vec3(.5 + .5*(dot(m,d)+z)/(M.x + M.y +1.));\n  float a = atan2(m.y, m.x) - atan2(d.y, d.x) - .25*pi; // Adjusted because the original lighting is top left\n  d = r*vec2(sin(a), cos(a)); // Vector to the light (the mouse cursor)\n  float x = d.x, // x,y are Unsigned Unit Intervals [0,1]\n        y =-d.y, // Get the third coordinate using a spherical model\n  ambient  = Upper3( 5., Unsigned(( 2.*x     +6.*z)/ 7. ))  // take the Upper fifth and spread it\n           + Upper3( 3., Unsigned((    x+4.*y+6.*z)/ 8.5)), // take the Upper third and spread it\n  specular = Upper3(15., Unsigned((-6.*x-3.*y+9.*z)/11.7))\n           + Upper3(17., Unsigned((-3.*x-6.*y+9.*z)/11.3)),\n  antialias = fwidth(r);\n  vec3 marble = clamp(specular+gold*ambient+smoothstep(1.-antialias,1.+antialias,r),0.,1.);\n  o = r<1. ? (o*marble) : min(o,marble);\n  O = vec4(o, 1.);\n}","name":"Image","description":"","type":"image"}]}