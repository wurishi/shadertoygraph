{"ver":"0.1","info":{"id":"lljSzK","date":"1445098863","viewed":118,"name":"linear local approximation","username":"yultan","description":"first shader =D\nclick to zoom\ndifferentiable function = local line if zoomed enough","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["2d","zoom","functions"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[],"code":"//TODO get rid of poorly tuned parameters\n\nfloat f(float x)\n{\n    float t=x/1.0;\n    return sin(t)*cos(2.0*t);\n    //return cos(t);\n    //return t*t-t*t*t;\n}\n\nvec3 drawRec( vec3 incolor , vec2 center, vec2 p, vec2 offsets, float scale, vec3 color ) {\n    vec3 outcolor = incolor;\n    vec2 dd = abs(p-center)-offsets;\n    float d = min(max(dd.x,dd.y),0.0) + length(max(dd,0.0));\n    outcolor += color*exp(-150.0*d*d*scale);\n    return outcolor;\n}\n\nvec3 drawLin( vec3 incolor , vec2 start, vec2 stop, vec2 p,  float scale , vec3 color) {\n    vec3 outcolor = incolor;\n    float t = dot(p-start,stop-start)/(length(stop-start)*length(stop-start));\n    float d =length(p-(start+min(max(t,0.0),1.0)*(stop-start)))*scale;\n    outcolor += color*exp(-1.0*d*d);\n    return outcolor;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord.xy / iResolution.x;\n    float ic = length(iMouse.xy-fragCoord.xy);\n    uv-=0.5*vec2(1.0,iResolution.y/iResolution.x);\n    vec3 color = vec3(1.0);\n    color = vec3(length(uv));\n    float sig = 0.005;\n    \n    float xx = 20.0*(iMouse.x/iResolution.x-0.5)+5.0;\n    float yy = 0.15*f(xx);\n    \n    if(uv.x >0.0 && uv.y>0.0) {\n        uv.x*=pow(0.5,4.0);\n        uv.x-=(0.515-iMouse.x/iResolution.x);\n        uv.y*=pow(0.5,4.0);\n        uv.y-=-yy+0.009;\n        sig/=pow(2.0,4.0);\n    }\n        \n    if(uv.x >0.0 && uv.y<0.0 && fragCoord.y/iResolution.y<0.5) {\n        uv.x*=pow(0.5,8.0);\n        uv.x-=(0.501-iMouse.x/iResolution.x);\n        uv.y*=pow(0.5,8.0);\n        uv.y-=-yy-0.0005;\n        sig/=pow(2.0,8.0);\n    }\n    \n    float x = 20.0*uv.x+5.0;\n    float y = 20.0*uv.y;\n    float t = (uv.y-0.15*f(x))/sig;\n    \n    float tt = length(vec2(x,y)-vec2(xx,20.0*yy));\n    color = vec3(1.0,0.0,0.0)*exp(-0.69*t*t);\n    \n    if(iMouse.x>0.0 || iMouse.y>0.0){\n        //if(fragCoord.x/iResolution.x<0.5){            \n            //color+=vec3(exp(-0.0005*tt*tt/(sig*sig)));            \n        //}\n        color = drawRec(color,vec2(xx,20.0*yy),vec2(x,y),vec2(0.4,0.30),1.0,vec3(0.0,1.0,0.0));\n        \n        if( fragCoord.x/iResolution.x>0.5 )\n        {\n            color = drawRec(color,vec2(xx,20.0*yy),vec2(x,y),vec2(0.028,0.020),128.0,vec3(0.0,0.0,1.0));\n        }\n        else{\n            if(mod(x+0.05,1.0)<25.0*sig && abs(y)<50.0*sig ) { color=vec3(1.0); }\n    \t\tif(mod(y+0.05,1.0)<25.0*sig && abs(x)<50.0*sig ) { color=vec3(1.0); }\n        }\n        \n        color = drawLin(color,vec2(0.71,0.72),vec2(0.5,0.5),fragCoord/iResolution.xy,128.0,vec3(0.0,0.0,1.0));\n        color = drawLin(color,vec2(0.77,0.72),vec2(1.0,0.5),fragCoord/iResolution.xy,128.0,vec3(0.0,0.0,1.0));\n        \n        if(0.05*xx+0.275<0.5) {\n            color = drawLin(color,vec2(0.05*xx+0.275,1.75*yy+0.475),vec2(0.5,0.5),fragCoord/iResolution.xy,128.0,vec3(0.0,1.0,0.0));\n        }\n        if(0.05*xx+0.235<0.5) {\n            color = drawLin(color,vec2(0.05*xx+0.235,1.75*yy+0.525),vec2(0.5,1.0),fragCoord/iResolution.xy,128.0,vec3(0.0,1.0,0.0));\n        }\n\n    }      \n    if(abs(x)<10.0*sig){ color=vec3(1.0); }\n    if(abs(y)<10.0*sig){ color=vec3(1.0); }\n\n    \n    \n    fragColor = vec4(color,1.0);\n}\n","name":"Image","description":"","type":"image"}]}