{"ver":"0.1","info":{"id":"wsfXWN","date":"1551283097","viewed":215,"name":"screw field","username":"gyabo","description":"screw.","likes":6,"published":1,"flags":0,"usePreview":0,"tags":["raymarching"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define time iTime\n\nfloat map(vec3 p) {\n\tfloat t = 10.0 + dot(p, vec3(0, 1, 0));\n\tfloat ti = time * 0.1;\n\tfloat tir = floor(ti);\n\tfloat tif = fract(ti);\n\tvec3 tp = p;\n\tfor(int i = 0 ; i < 3; i++) {\n\t\tp = tp;\n\t\tp.x += 1.0;\n\t\tt = min(t, length(mod(p.xz, 2.0) - 1.0) - 0.12);\n\t\tp.x += sin(p.y * 40.0 - time * 15.0) * 0.1;\n\t\tp.z += cos(p.y * 40.0 - time * 15.0) * 0.1;\n\t\tt = min(t, length(mod(p.xz, 2.0) - 1.0) - 0.1);\n\t\ttp = tp.zxy;\n\t}\n\t\n\treturn t;\n}\n\nvec2 rot(vec2 p, float a) {\n\tfloat c = cos(a);\n\tfloat s = sin(a);\n\t\n\treturn vec2(\n\t\tp.x * c - p.y * s,\n\t\tp.x * s + p.y * c);\n\t\t\n}\n\n\nvec3 getnor(vec3 p) {\n\tvec2 dd = vec2(0.01, 0.0);\n\tvec3 kn = vec3(0.0);\n\tkn.x = map(p) - map(p + dd.xyy);\n\tkn.y = map(p) - map(p + dd.yxy);\n\tkn.z = map(p) - map(p + dd.yyx);\n\treturn normalize(kn);\n\t\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n\tvec2 uv = ( fragCoord.xy / iResolution.xy ) * 2.0 - 1.0;\n\tuv.x *= iResolution.x / iResolution.y;\n\tfloat ti = time * 0.1;\n\tvec3 pos = vec3(ti, ti, ti) * 5.0;\n\tvec3 dir = normalize(vec3(uv, 1.0));\n\t\n\tfloat tir = floor(ti);\n\tfloat tif = fract(ti);\n\tfloat tism = smoothstep(0.01, 0.5, tif);\n\n\tdir.xy = rot(dir.xy, tism + tir);\n\tdir.xz = rot(dir.xz, tism + tir);\n\n\t\n\tfloat t = 0.0;\n\tfor(int i = 0 ; i < 256; i++) {\n\t\tfloat tm = map(pos + dir * t);\n\t\tif(tm < 0.01) break;\n\t\tt += tm * 0.2;\n\t}\n\tvec3 ip = pos + dir * t;\n\tvec3 L = normalize(vec3(1,2,3));\n\tvec3 V = normalize(ip);\n\tvec3 N = getnor(ip);\n\tvec3 H = normalize(V + N);\n\tfloat D = max(0.1, dot(L, N));\n\tfloat S = pow(max(0.1, dot(L, H)), 32.0);\n\tfragColor = vec4(D * S * vec3(1,2,10) + vec3(3,2,1) * vec3(pow(t, 2.0)) * 0.002 + map(ip + 0.01), 1.0);\n    fragColor.xyz = pow(fragColor.xyz, vec3(1.0 / 1.3));\n}\n","name":"Image","description":"","type":"image"}]}