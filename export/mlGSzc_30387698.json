{"ver":"0.1","info":{"id":"mlGSzc","date":"1686251251","viewed":93,"name":"sierpinski shader","username":"OogaAndBooga","description":"my 1st shader. change the mode variable for diffrent effects","likes":2,"published":1,"flags":0,"usePreview":0,"tags":["sierpinski"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define PI 3.1415926535897932384626433832795\n\nvec2 algebra(in vec4 l) {\n    float a = (l.w - l.y) / (l.z - l.x);\n    float b = l.y - a * l.x;\n    return vec2(a, b);\n}\n\nvec2 intersect( vec4 a,  vec4 b) {\n    vec2 l1 = algebra(a);\n    vec2 l2 = algebra(b);\n    \n    float x = (l2.y - l1.y) / (l1.x - l2.x);\n    float y = x * l1.x + l1.y;\n    \n    return vec2(x, y);\n}//xyzw\n\nfloat random (vec2 st) {\n    return fract(sin(dot(st.xy,\n                         vec2(12.9898,78.233)))*\n        43758.5453123);\n}\n\nfloat ws( float e[4], int len) {\n    float d = 0.;\n    for(int i = 0; i < len; i += 2) {\n        if(i / 2 % 2 == 1)\n            d += sin(e[i]) * e[i + 1];\n        else\n            d += sin(e[i]) * e[i + 1];\n    }\n    return d;\n}\n\nvec2 squarescale(vec2 a){\n    vec2 i = iResolution.xy;\n    return vec2((a.x - .5) * i.y / i.x + .5, a.y); \n}\n\nvec2 sierpinski(vec2 a, vec2 b, vec2 c, vec2 p, float iter) {\n    vec4 ab = vec4(a, b);\n    vec4 bc = vec4(b, c);\n    vec4 ca = vec4(c, a);\n    \n    vec2 eab = algebra(ab);\n    vec2 ebc = algebra(bc);\n    vec2 eca = algebra(ca);\n    \n    vec4 ap = vec4(a, p);\n    vec2 ai = intersect(ap, bc);\n    float kab = distance(a, p) / distance(a, ai);\n    \n    vec4 bp = vec4(b, p);\n    vec2 bi = intersect(bp, ca);\n    float kbc = distance(b, p) / distance(b, bi);\n    \n    vec4 cp = vec4(c, p);\n    vec2 ci = intersect(cp, ab);\n    float kca = distance(c, p) / distance(c, ci);\n    \n    float rez = pow(2.0, iter); //exponent determines resolutution\n    int q = int(kab * rez);\n    int r = int(kbc * rez);\n    int t = int(kca * rez);\n    \n    return vec2(\n        float(bool(q&t&r)), \n        float(0.0 <= kab && kab < 1.0 && 0.0 <= kbc && kbc <= 1.0 && 0.0 <= kca && kca < 1.0)\n    );\n}\n\nfloat iter = 4.; // resolution, if integer sierpinskini emerges\n\nint MODE = 3;\nbool TRIPPY = true;\nbool TBACKGROUND = false;\nbool MAKESQUARE = true;\nbool PINK = false;\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord )\n{\n    // Normalized pixel coordinates (from 0 to 1)\n    vec2 uv = fragCoord/iResolution.xy;\n\n    vec2 a = vec2(0.05, 0.10001);\n    vec2 b = vec2(0.5, 0.94);\n    vec2 c = vec2(0.95, 0.1);\n    \n     if(MODE == 1) {\n        a += vec2(0., ws(float[](iTime, 0.1, -iTime *4., 0.05), 4));\n        b += vec2(0.2*(smoothstep(-0.7,0.7,sin(iTime * 3.)) - 0.7),0);\n        c += vec2(0.,0.);\n    }\n    else if(MODE == 2){\n        a += vec2(0.1 * random(vec2(0., float(int(iTime) % 3))), 0.2*random(vec2(0., float(int(iTime) % 4))));\n        b += vec2(0.1 * random(vec2(0., float(int(iTime + 1.) % 3))), 0.1*random(vec2(0., float(int(iTime) % 10))));\n        c += vec2(0.15 * random(vec2(0., float(int(iTime) % 4))), 0.19*random(vec2(0., float(int(iTime * .5) % 10))));\n    }\n    else if(MODE == 3) {\n        float t = iTime * .5, r = 0.2, s = 0.3;\n        vec2 ro = vec2(r * cos(t), r * sin(t)) + vec2(.5);\n        float tr = iTime * -0.5;\n        a = ro + s * vec2(cos(0.+tr), sin(0.+tr));\n        b = ro + s * vec2(cos(PI*2./3.+tr), sin(PI*2./3.+tr));\n        c = ro + s * vec2(cos(PI*4./3.+tr), sin(PI*4./3.+tr));\n    }\n    else if(MODE == 4) {\n        a = vec2(.5);\n        float t = iTime;\n        b = a + vec2(cos(t-PI/.3),sin(t-PI/.3)) * ((t / 2. / PI) - floor(t / 2. / PI) + 1.);\n        c = a + vec2(cos(t-PI*2./.3),sin(t-PI*2./.3)) * ((t / 2. / PI) - floor(t / 2. / PI) + 1.);\n    }\n    \n    if(MAKESQUARE) {\n        a = squarescale(a);\n        b = squarescale(b);\n        c = squarescale(c);\n    }\n    \n    if(TRIPPY) {\n        iter += .5 + .5*sin(iTime * .4);\n    }\n    \n    vec3 e = vec3(0.);\n    vec3 f = vec3(1.);\n    vec3 bkg = vec3(0.133,0.867,0.302);\n    \n    if(PINK) {\n         e = vec3(0.976,0.302,0.843);\n         f = vec3(0.820,0.259,0.867);\n         bkg = vec3(0.729,0.043,0.957);\n    }\n    \n    vec2 i = sierpinski(a, b, c, uv, iter);\n    if(i.y == 1. || TBACKGROUND)\n        fragColor = vec4(i.x*f + float(!bool(i.x))*e, 1.);\n    else\n        fragColor = vec4(bkg, 1.0);\n}","name":"Image","description":"","type":"image"}]}