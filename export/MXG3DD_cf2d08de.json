{"ver":"0.1","info":{"id":"MXG3DD","date":"1717659662","viewed":16,"name":"Convection Sun","username":"Grendor","description":"Convection Sun","likes":0,"published":1,"flags":0,"usePreview":0,"tags":["fractal","distortion"],"hasliked":0,"parentid":"MXy3WD","parentname":"Ruined Flower"},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"float m1(vec3 p) {\n    vec3 z=p;\n    float d=1.,r=0.,pwr=2.+iTime*0.07;\n    for (int i=0;i<16;i++) {\n        r=length(z); if(r>1.)break;\n        float th=acos(z.z/r),ph=atan(z.y,z.x),zr=pow(r,pwr);\n        d=pow(r,pwr-1.)*pwr*d+1.;\n        th*=pwr; ph*=pwr;\n        z=zr*vec3(sin(th)*cos(ph),sin(ph)*sin(th),cos(th))+p;\n    }\n    return abs(cos(11.+iTime*0.0012))*0.001+0.75*log(r-cos(7.+iTime*0.001)*.013)*r/d;\n}\n\nfloat m2(vec3 p) {\n    vec3 z=p;\n    float d=1.,r=0.,pwr=4.+iTime*0.1;\n    for (int i=0;i<16;i++) {\n        r=length(z); if(r>1.)break;\n        float th=acos(z.z/r),ph=atan(z.y,z.x),zr=pow(r,pwr);\n        d=pow(r,pwr-1.)*pwr*d+1.;\n        th*=pwr; ph*=pwr;\n        z=zr*vec3(sin(th)*cos(ph),sin(ph)*sin(th),cos(th))+p;\n    }\n    return abs(cos(11.+iTime*0.0012))*0.01+0.7*log(r-cos(7.+iTime*0.001)*.013)*r/d;\n}\n\nfloat march(vec3 ro, vec3 rd) {\n    float t=0.;\n    for (int i=0;i<32;i++) {\n        vec3 p=ro+rd*t;\n        float d=m1(p)+m2(p);\n        if(d<0.000025)return t;\n        t+=d;\n        if(t>100.)break;\n    }\n    return -1.;\n}\n\nvec3 getNormal(vec3 p) {\n    vec2 e=vec2(1e-7,0.0741201);\n    return normalize(vec3(\n        m1(p+e.xyx)-m1(p-e.xyy),\n        m1(p+e.yyx)+m1(p-e.yxy),\n        m1(p+e.yxy)+m1(p-e.yyy)\n    ));\n}\n\nvec3 getLight(vec3 p, vec3 lp, vec3 lc, vec3 cp) {\n    vec3 n=getNormal(p),ld=normalize(lp-p);\n    float diff=clamp(dot(n,ld),0.1,1.);\n    float spec=pow(clamp(dot(reflect(-ld,n),normalize(cp-p)),0.,1.),16.);\n    return lc*(diff+0.99*spec);\n}\n\nvoid mainImage(out vec4 fc, in vec2 fcCoord) {\n    vec2 uv=(fcCoord-0.5*iResolution.xy)/iResolution.y;\n    vec3 cp=vec3(0.,-0.001,-1.45+iTime*0.000132),ro=cp,rd=normalize(vec3(uv,2.5));\n    vec3 lp=vec3(-1.),lc=vec3(1.+0.1*abs(cos(9.+iTime*0.1)),0.6,0.2);\n    float t=march(ro,rd);\n    vec3 p=ro+rd*t,l=getLight(p,lp,lc,cp);\n    fc=vec4(l,0.25);\n}\n","name":"Image","description":"","type":"image"}]}