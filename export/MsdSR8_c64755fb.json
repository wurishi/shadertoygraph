{"ver":"0.1","info":{"id":"MsdSR8","date":"1457786314","viewed":354,"name":"i32 (n)weyl tnoise","username":"MBR","description":"2 integer vers of triangle distribution","likes":6,"published":1,"flags":0,"usePreview":0,"tags":["trianglenoise"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// LICENSE: http://unlicense.org/\n\n// Math background: http://marc-b-reynolds.github.io/math/2016/02/24/weyl.html\n// Hash function:   http://marc-b-reynolds.github.io/math/2016/03/29/weyl_hash.html\n\n// requires 32-bit integer support: \n//  the 2-to-1 hash could be replaced with another tech and\n//  then you could uses the MLCG to monkeypatch the second sample. \n\n#if 0\n#define W0 0x3504f333\n#define W1 0xf1bbcdcb\n#else\n#define W0 0x8df6f819\n#define W1 0x9df5f0b3\n#endif\n\n#define MLCG 741103597\n\n// Weyl sequence (WIP - constants are no good)\n// 2D integer -> ~triangle distribution\nfloat weyl_tnoise(in ivec2 c)\n{\n  c = ivec2(W0,W1)*c + ivec2(c.y,c.x);  // Weyl\n    \n  int u0  = MLCG*c.x*c.y;  // combine partial and mix with MLCG\n  int u1  = MLCG*u0;       // second sample is next in MLCG sequence\n    \n  // with unsigned bit ops would be:\n  // return scale * float((u0>>9)+(u1>>9));\n  \n  float f = float(u0)+float(u1);\n    \n  return f*(1.0/8589934592.0)+0.5;\n}\n\n\n// nested Weyl sequence\n// 2D integer -> ~triangle distribution\nfloat nweyl_tnoise(in ivec2 c)\n{\n  // nested Weyl\n  c = ivec2(W0,W1)*c*c + ivec2(c.y,c.x);\n    \n  // same comments as above\n  int   u0 = MLCG*c.x*c.y;\n  int   u1 = MLCG*u0; \n  float f  = float(u0)+float(u1);\n    \n  return f*(1.0/8589934592.0)+0.5;\n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n  int   c = int(fragCoord.x) - int(0.5*iResolution.x);\n  ivec2 p = ivec2(fragCoord.xy+0.5*vec2(iResolution.xy));\n  float r = 0.0;\n    \n  if (c < 0)\n    r = weyl_tnoise(p);\n  else if (c > 1)\n    r = nweyl_tnoise(p);\n    \n  fragColor = vec4(vec3(r),1.0);\n}","name":"Image","description":"","type":"image"}]}