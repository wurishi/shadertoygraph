{"ver":"0.1","info":{"id":"lldcRr","date":"1531382408","viewed":520,"name":"light shafts","username":"greenbird10","description":"simulate sun shafts in sea","likes":5,"published":1,"flags":0,"usePreview":0,"tags":["light"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[],"outputs":[{"id":"4dfGRr","channel":0}],"code":"//by greenbird10\n#define S(a, b, c) smoothstep(a,b,c)\n\nfloat random (in vec2 st) {\n    return fract(sin(dot(st.xy,\n                         vec2(12.9898,78.233)))*\n        43758.5453123);\n}\nvec2 random2(vec2 st){\n    st = vec2( dot(st,vec2(127.1,311.7)),\n              dot(st,vec2(269.5,183.3)) );\n    return -1.0 + 2.0*fract(sin(st)*43758.5453123);\n}\n\n// Value Noise by Inigo Quilez - iq/2013\n// https://www.shadertoy.com/view/lsf3WH\nfloat noise(vec2 st) {\n\tvec2 i = floor(st);\n\tvec2 f = fract(st);\n\tvec2 u = f*f*(3.0-2.0*f);\n\treturn mix( \n        mix( dot( random2(i + vec2(0.0,0.0) ), f - vec2(0.0,0.0) ),\n             dot( random2(i + vec2(1.0,0.0) ), f - vec2(1.0,0.0) ), u.x),\n        mix( dot( random2(i + vec2(0.0,1.0) ), f - vec2(0.0,1.0) ),\n             dot( random2(i + vec2(1.0,1.0) ), f - vec2(1.0,1.0) ), u.x), u.y);\n}\n\nfloat fbm(vec2 n) {\n\tfloat total = 0.0, amplitude = 1.0;\n\tfor (int i = 0; i < 5; i++) \n\t{\n\t\ttotal += noise(n) * amplitude; \n\t\tn += n;\n\t\tamplitude *= 0.5; \n\t}\n\treturn total;\n} \n\nfloat dis(vec2 a){\n\treturn sqrt(a.x * a.x + a.y * a.y);\n}\n\n#define AA 5.0\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 st = fragCoord.xy/iResolution.xy;\n\tst -= 0.5;\n\tst.x *= iResolution.x/iResolution.y;\n    vec2 _st = st;\n    float angle = 0.18;\n    st = vec2(st.x * cos(angle) - st.y * sin(angle), \n              st.x * sin(angle) + st.y * cos(angle));\n\n\t\n    float u_time = iTime;    \n\t\n\tvec3 shaft;\n    float mask = 0.;\n    for(float i = 0.; i < AA; ++i) {\n    \tmask += 1./AA * fbm(vec2(st.x*2. + i/AA + u_time/40., st.y/8.));\n        mask += 1./AA * fbm(vec2(st.x*2. - 1000. - i/AA - u_time/40., st.y/4.));\n    }\n    mask *= _st.y + 0.5;\n    mask = pow(clamp(2.5*mask, 0., 1.), 0.8);\n    mask = pow(mask, 1.5);\n    \n    vec3 water = vec3(12., 82., 142.)/255.;\n    vec3 light = vec3(0.93, 0.98, 0.9);\n    shaft = mix(water, light, mask);\n\t\n\tfragColor = vec4( shaft, 1.0 ); \n\n}","name":"Image","description":"","type":"image"}]}