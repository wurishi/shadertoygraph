{"ver":"0.1","info":{"id":"ldcBz4","date":"1524194483","viewed":587,"name":"Web of Lines","username":"rory618","description":"normally distributed points connected by lines. R to reset","likes":27,"published":1,"flags":48,"usePreview":0,"tags":["graph","greyscale","stochastic","routing"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4sXGR8","filepath":"/media/previz/buffer02.png","previewfilepath":"/media/previz/buffer02.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4sXGR8","filepath":"/media/previz/buffer02.png","previewfilepath":"/media/previz/buffer02.png","type":"buffer","channel":2,"sampler":{"filter":"mipmap","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"void mainImage( out vec4 o, in vec2 i )\n{\n    vec2 uv = i/R.xy;\n    o = exp(-vec4(length(texture(iChannel0, uv).xy*R.xy-i)/30.));\n    o =pow(texture(iChannel1,uv),vec4(.8))/(pow(textureLod(iChannel2,vec2(uv),100.)*3.,vec4(.8)));\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"nearest","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XdfGR8","filepath":"/media/previz/buffer03.png","previewfilepath":"/media/previz/buffer03.png","type":"buffer","channel":1,"sampler":{"filter":"nearest","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"XdfGR8","channel":0}],"code":"void mainImage( out vec4 o, in vec2 i )\n{\n    o = vec4(0);\n    vec2 s = floor(i/vec2(w,h))*vec2(w,h)/R.xy;\n    \n    for(int a = 0; a < i1; a++){\n        vec4 r = hash44(vec4(i,F,a));\n        vec4 p = texture(iChannel0,r.xy);\n        float l = length(p.xy*R.xy-i);\n        o.zw =mix(o.zw,p.xy,step(l,length(o.zw*R.xy-i)));\n        //if(l < length(o.zw*R.xy-i)){\n        //    o.zw = p.xy;\n        //}\n    }\n    \n    for(int a = 0; a < i1; a++){\n        vec4 r = hash44(vec4(F,i,-a));        \n        r.z = sqrt(-2.*log(r.z));\n        r.w *= 6.28318;\n        r.zw = r.z*vec2(cos(r.w),sin(r.w))*10.;\n        vec4 p = texture(iChannel1,(i+r.zw)/R.xy);//sample random nearby points\n        float l = length(p.zw*R.xy-i);\n        o.xy =mix(o.xy,p.zw,step(l,length(o.xy*R.xy-i)));\n        //if(l < length(o.xy*R.xy-i)){\n        //    o.xy = p.zw;\n        //}\n    }\n    \n}","name":"Buffer D","description":"","type":"buffer"},{"inputs":[{"id":"4dXGRr","filepath":"/presets/tex00.jpg","previewfilepath":"/presets/tex00.jpg","type":"keyboard","channel":2,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":0,"sampler":{"filter":"nearest","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4sXGR8","filepath":"/media/previz/buffer02.png","previewfilepath":"/media/previz/buffer02.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4sXGR8","channel":0}],"code":"void lineSegment(inout vec4 fragColor, vec2 z, vec2 a, vec2 b, vec4 c,  float w){\n    \n    z -= a; b -= a;                        // go to A referential\n    float q = dot(z, b) / dot(b, b) ;      // projection of P on line AB: normalized ordinate\n    b *= clamp(q, 0., 1.);                 // point on segment AB closest to P \n\n    \n    fragColor += vec4(c.xyz,1) * c.w*clamp(w-length( z - b),0.,1.);\n}\nvoid mainImage( out vec4 o, in vec2 i )\n{\n    vec2 uv = i/R.xy;\n    o = texture(iChannel1,uv);\n    vec2 pp = vec2(0);\n    for(int a = 0; a <i2; a++){\n        vec4 r = hash44(vec4(i,F,a));//Transform this uniform random into a normal distribution\n        r.z = sqrt(-2.*log(r.z));\n        r.w *= 6.28318;\n        r.zw = r.z*vec2(cos(r.w),sin(r.w))*65.;\n        vec4 p = texture(iChannel0,(i+r.xy)/R.xy);//sample random nearby points\n        //o += 1./(1.+exp(2.*length(p.xy*R.xy-i))); //add a gaussian to the accumulated image from the particle \n    \tif(p.xy!=vec2(0)&&p.zw!=vec2(0))\n            lineSegment(o,i,p.xy*R.xy,p.zw*R.xy,vec4(1,1,1,.1),1.);\n        pp=p.xy;\n    }\n    if ( texture( iChannel2, vec2(82.5/256.0,0.25) ).x > .5) {\n        o *= 0.;\n    }\n}","name":"Buffer C","description":"","type":"buffer"},{"inputs":[{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":1,"sampler":{"filter":"nearest","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XdfGR8","filepath":"/media/previz/buffer03.png","previewfilepath":"/media/previz/buffer03.png","type":"buffer","channel":0,"sampler":{"filter":"nearest","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"XsXGR8","channel":0}],"code":"void mainImage( out vec4 o, in vec2 i )\n{\n    o = vec4(0);\n    vec2 s = floor(i/vec2(w,h))*vec2(w,h)/R.xy;\n    \n    //Randomly search for particles that are within this WxH block\n    for(int a = 0; a < i1; a++){\n        vec4 r = hash44(vec4(i,F,-a));        \n        r.z = sqrt(-2.*log(r.z));\n        r.w *= 6.28318;\n        r.zw = r.z*vec2(cos(r.w),sin(r.w))*60.;\n        vec4 p = texture(iChannel0,(i+r.zw)/R.xy);//sample random nearby points\n        float l = length(p.xy*R.xy-i);\n        if(l < length(o.zw*R.xy-i)){\n            o.zw = p.xy;\n        }\n    }\n    \n    for(int a = 0; a < i1; a++){\n        vec4 r = hash44(vec4(i,a,F));        \n        r.z = sqrt(-2.*log(r.z));\n        r.w *= 6.28318;\n        r.zw = r.z*vec2(cos(r.w),sin(r.w))*5.;\n        vec4 p = texture(iChannel1,(i+r.zw)/R.xy);//sample random nearby points\n        float l = length(p.zw*R.xy-i);\n        if(l < length(o.xy*R.xy-i)){\n            o.xy = p.zw;\n        }\n    }\n}","name":"Buffer B","description":"","type":"buffer"},{"inputs":[{"id":"4dXGRr","filepath":"/presets/tex00.jpg","previewfilepath":"/presets/tex00.jpg","type":"keyboard","channel":2,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"\n\nvoid mainImage( out vec4 o, in vec2 i )\n{\n    vec2 uv = i/R.xy;\n    vec4 r = hash44(vec4(floor(i/v),F,iMouse.x));\n        r.xz = sqrt(-2.*log(r.xz));\n        r.yw *= 6.28318;\n        r.zw = r.z*vec2(cos(r.w),sin(r.w))*5.;\n        r.xy = r.x*vec2(cos(r.y),sin(r.y))*5.;\n    o = texture(iChannel0,uv);\n    if(iFrame<3 || texture( iChannel2, vec2(82.5/256.0,0.25) ).x > .5){\n        o.xy = .5 + r.xy/R.xy*R.y/16.;\n    }\n    o.zw /= 1.001;\n    //o.xy = fract(o).xy;\n    o.xy += o.zw/R.xy + .00*sin(float(iFrame)/50.)/R.xy;\n    //o.zw += .01*vec2(sin(o.y*10.),cos(o.x*10.))/1e3;\n\n}","name":"Buffer A","description":"","type":"buffer"},{"inputs":[],"outputs":[],"code":"#define R iResolution\n#define F iFrame\nvec4 hash44(vec4 p4)\n{\n\tp4 = fract(p4  * vec4(.1031, .1030, .0973, .1099));\n    p4 += dot(p4, p4.wzxy+19.19);\n    return fract((p4.xxyz+p4.yzzw)*p4.zywx);\n}\nfloat w = 16.;\nfloat h = 16.;\nfloat v = 20.;   //increase for fewer particles drawn better. Decrease all the way to 1 for iResolution.x*iResolution.y total number of particles\nint i1 = 6;    //number of iterations for fisrt and second drawing/search stages\nint i2 = 40;\t//more runs slower, but the particles are more visible","name":"Common","description":"","type":"common"}]}