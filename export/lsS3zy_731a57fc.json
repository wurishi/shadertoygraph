{"ver":"0.1","renderpass":[{"outputs":[],"inputs":[],"code":"float time;\n\nfloat de(vec3 p)\n{\n\tfloat inner_sphere_scale = 0.7;\n\tfloat s=4.0;\n\tfloat t=fract(time/0.6);\n\tfloat scale=pow(inner_sphere_scale, -t);\n\tfloat d=1e4;\n\t\n\tfor(int i = 0; i < 5; i += 1)\n\t{\n\t\tvec3 z=p/scale,az=abs(z),w=z;\n\t\t\n\t\tif(az.x>az.y && az.x>az.z)\n\t\t\tw/=w.x*sign(w.x);\n\t\telse if(az.y>az.x && az.y>az.z)\n\t\t\tw/=w.y*sign(w.y);\n\t\t\telse\n\t\t\t\tw/=w.z*sign(w.z);\n\t\t\t\n\t\t\tw=normalize(floor(w*s+vec3(0.5)))*0.4;\n\t\t\n\t\td=min(d,(distance(z,w) - 0.02*min(1.0, (float(i) + 1.0 - t) / 1.5))*scale);\n\t\tscale*=inner_sphere_scale;\n\t}\n\t\n\treturn d;\n}\n\nmat3 rotateXMat(float a)\n{\n\treturn mat3(1.0, 0.0, 0.0, 0.0, cos(a), -sin(a), 0.0, sin(a), cos(a));\n}\n\nmat3 rotateYMat(float a)\n{\n\treturn mat3(cos(a), 0.0, -sin(a), 0.0, 1.0, 0.0, sin(a), 0.0, cos(a));\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\ttime=iTime+10.63;\n\t\n\tmat3 m=rotateXMat(time*0.5)*rotateYMat(time*0.7);\n\t\n\tvec2 p=fragCoord.xy/iResolution.xy*2.0-vec2(1.0);\n\tp.x*=iResolution.x/iResolution.y;\n\tvec3 ro=m*vec3(0.0,0.0,0.4);\n\tvec3 rd=m*normalize(vec3(p, -2.0));\n\t\n\tfloat t=0.0;\n\t\n\tfor(int i=0;i<120;i+=1)\n\t{\n\t\tfloat d=de(ro+rd*t);\n\t\tif(abs(d)<1e-4)\n\t\t\tbreak;\n\t\tt+=d;\n\t}\n\t\n\tvec3 rp=ro+rd*t;\n\t\n\tvec3 col=mix(vec3(1.0,1.0,0.5),vec3(1.0,0.5,0.25)*0.1,pow(abs(rd.y),0.5));\n\t\n\tif(t<20.0)\n\t{\n\t\tfloat e=1e-3, c=de(rp);\n\t\tvec3 n=normalize(vec3(de(rp+vec3(e,0.0,0.0))-c,de(rp+vec3(0.0,e,0.0))-c,de(rp+vec3(0.0,0.0,e))-c));\n\t\t\n\t\tcol=mix(vec3(0.0),vec3(1.7,0.6,0.2)*5.0*mix(0.6,1.0,(0.5+0.5*cos(time*30.0))),\n\t\t\t\tpow(0.5+0.5*cos(rp.x*50.0+sin(rp.y*10.0)*3.0+cos(rp.z*4.0)),3.0));\n\t\t\n\t\tcol*=vec3(mix(0.3,2.0,0.5+0.5*dot(n,rd)));\n\t\t\n\t\tcol+=vec3(pow(clamp(0.5+0.5*dot(n,rd),0.0,1.0),2.0))*0.6;\n\t\t\n\t\tvec3 l=normalize(vec3(1.0,1.0,-1.0)-rp);\n\t\tvec3 h=normalize(normalize(l)+normalize(-rd));\n\t\t\n\t\tcol+=vec3(pow(clamp(0.5+0.5*dot(h,n),0.0,1.0),80.0))*0.7;\n\t}\n\t\n\tcol+=(0.03+cos(time*7.0)*0.01)*mix(vec3(0.1,0.5,0.0)*0.3,vec3(1.2,0.7,0.1),0.5+0.5*cos(p.y*0.3+sin(p.x*0.1+time)*6.0)*sin(p.y));\n\t\n\tfragColor.rgb=sqrt(col);\n}\n","name":"Image","description":"","type":"image"}],"flags":{"mFlagVR":false,"mFlagWebcam":false,"mFlagSoundInput":false,"mFlagSoundOutput":false,"mFlagKeyboard":false,"mFlagMultipass":false,"mFlagMusicStream":false},"info":{"id":"lsS3zy","date":"1389988894","viewed":1933,"name":"Pearls of Magma","username":"fizzer","description":"Just an experiment with lots of spheres and a never-ending zoom into the center of chaos.","likes":25,"published":1,"flags":0,"usePreview":0,"tags":["procedural","raymarching","spheres","hot","bright","cyclezoom"],"hasliked":0,"parentid":"","parentname":""}}