{"ver":"0.1","info":{"id":"XtXBRS","date":"1512168352","viewed":139,"name":"Moiré Circular","username":"Kushulain","description":"moiré","likes":7,"published":1,"flags":32,"usePreview":0,"tags":["moire","moirage"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"#define zoom 0.2\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 uv = fragCoord.xy / iResolution.xy;\n    \n    uv -= 0.5;\n    uv *= max(1.0 - pow((iTime * 0.025),3.0),zoom);\n    uv += 0.5;\n\n\tfragColor = texture( iChannel0, vec2(uv.x,uv.y) );\n    \n    \n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dXGR8","channel":0}],"code":"\n#define PI 3.1415\n#define raysCountMin 0.0\n#define raysCountMax 80555.0\n#define pixelCountMin 1440.0\n#define pixelCountMax 6000.0\n#define softness 1.0\n#define speed 1000.0\n#define modFrame 60.0\n\nfloat GetMoireValueAt(vec2 coord, float timeShift)\n{\n    \n    float rv = 0.0;\n    float animatedRayCount = sin(iTime*speed + PI * timeShift) * 0.5 + 0.5;\n    animatedRayCount = mix(raysCountMin,raysCountMax,animatedRayCount);\n    //animatedRayCount = sqrt(iTime/80000.0)*80000.0;\n    //animatedRayCount = (floor(iTime*30.0)/30.0)*150.0;\n    float timeAccelerated = pow(iTime,1.09);\n    animatedRayCount = 0.0 + speed*(floor((timeAccelerated+timeShift)*modFrame)/modFrame);\n    // -> cool animatedRayCount = 80000.0 + (floor(iTime*30.0)/30.0)*5.0;\n    //animatedRayCount *= 1.0+iTime;\n    \n    \n    rv = (((atan(-coord.x,coord.y) + PI * 0.5) / (PI)));\n    rv *= animatedRayCount;\n    rv = abs((mod(rv, 2.0) - 1.0));\n    rv = smoothstep(0.0,softness,rv);\n    \n    return rv;\n}\n\nfloat SA(float x)\n{\n    return sin(x) * 0.5 + 0.5;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 uv = fragCoord.xy / iResolution.xy;\n    vec2 sampleUV = uv;\n    \n    uv -= vec2(0.5,0.5);\n    \n    //uv.x = abs(uv.x);\n    uv.x = 0.5+(uv.x);\n    \n   // uv.x = abs(uv.x);\n    vec2 uv2 = uv;\n    uv2.x = 1.0-(uv.x);\n    \n    float pixCount = mix(pixelCountMin,pixelCountMax,SA(iTime));\n    //uv = floor(uv*pixCount)/pixCount;\n    \n    vec4 col = vec4(0.0,0.0,0.0,1.0);\n    col.r = GetMoireValueAt(uv,0.0);\n    col.g = GetMoireValueAt(uv,0.005);\n    col.b = GetMoireValueAt(uv,-0.002);\n    \n    vec4 col2 = vec4(0.0,0.0,0.0,1.0);\n    col2.r = GetMoireValueAt(uv2,0.0);\n    col2.g = GetMoireValueAt(uv2,0.005);\n    col2.b = GetMoireValueAt(uv2,-0.002);\n    \n    \n    \n    col *= sqrt(1.0-sampleUV.x);\n    col2 *= sqrt(sampleUV.x);\n    \n    col = max(col,col2);\n    //col = col*col2;\n    \n\tvec4 oldCol = texture( iChannel0, vec2(sampleUV.x,sampleUV.y) );\n    float beatMix = pow((sin(iTime * 5.0) * 0.5 + 0.5),8.0);\n    vec4 mixedCol = (col-0.49)*9.0; //contrast\n    mixedCol = mix(oldCol,mixedCol,beatMix+0.03); //lowpass\n    \n\tfragColor = mixedCol;\n}","name":"Buf A","description":"","type":"buffer"}]}