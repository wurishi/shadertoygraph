{"ver":"0.1","info":{"id":"XfVczG","date":"1732029479","viewed":222,"name":"Image 51","username":"wyatt","description":"An attempt to recreate Rosalind Franklin's Image 51 of the DNA double helix x-ray diffraction pattern\n\nAdjusting parameter \"N\" in buffer B changes the pitch angle of the DNA double helix and the resulting \"X\" angle","likes":18,"published":3,"flags":32,"usePreview":0,"tags":["rosalindfranklin"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"Main {\n    if (iFrame > 1000) discard;\n    Q = 1e1*vec4(dot(A(U),A(U))/float(iFrame));\n   \n    Q *= smoothstep(0.,-100.,length(U-.5*R)-.5*R.y);\n       Q = .8-Q;\n    Q += .2*noise(U).x;\n    \n   \n\n}","name":"Image","description":"","type":"image"},{"inputs":[],"outputs":[],"code":"#define R iResolution.xy\n#define A(U) texture(iChannel0,(U)/R)\n#define B(U) texture(iChannel1,(U)/R)\n#define Main void mainImage(out vec4 Q, in vec2 U)\n#define pi 3.141592653589793238462643383279502884197\n#define co(x) cos(mod(x,2.*pi))\n#define si(x) sin(mod(x,2.*pi))\nvec4 hash44 (vec4 p4) {\n\tp4 = fract(p4  * vec4(.1031, .1030, .0973, .1099));\n    p4 += dot(p4, p4.wzxy+33.33);\n    return fract((p4.xxyz+p4.yzzw)*p4.zywx);\n}\nvec4 noise (vec2 U) {\n    vec2 f = floor(U);\n    vec2 c = ceil(U);\n    vec4 _00 = pow(hash44(vec4(f,f)),vec4(1,3,3,3));\n    vec4 _01 = pow(hash44(vec4(f.x,c.y,f.x,c.y)),vec4(1,3,3,3));\n    vec4 _10 = pow(hash44(vec4(c.x,f.y,c.x,f.y)),vec4(1,3,3,3));\n    vec4 _11 = pow(hash44(vec4(c,c)),vec4(1,3,3,3));\n    vec4 _0 = mix(_00,_01,fract(U.y));\n    vec4 _1 = mix(_10,_11,fract(U.y));\n    return mix(_0,_1,fract(U.x));\n}\nvec4 opElongate( in vec3 p, in vec3 h )\n{\n    vec3 q = abs(p)-h;\n    return vec4( max(q,0.0), min(max(q.x,max(q.y,q.z)),0.0) );\n}\nfloat sdCappedCylinder( vec3 p, vec2 h )\n{\n  vec2 d = abs(vec2(length(p.xy),p.z)) - h;\n  return min(max(d.x,d.y),0.0) + length(max(d,0.0));\n}\nfloat roundBox(vec3 p, vec3 b , float r) {\n    vec4 w = opElongate( p, .5*b );\n    return w.w+sdCappedCylinder( w.xyz, vec2(r,.5*b.z) ) ;\n}\nfloat roundBox(vec2 p, vec2 b, float r) {\n    return roundBox(vec3(p,0),vec3(b,1),r);\n}\nfloat subtract (float a, float b) {\n    return max(a,-b);\n}","name":"Common","description":"","type":"common"},{"inputs":[{"id":"4dXGR8","filepath":"/media/previz/buffer00.png","previewfilepath":"/media/previz/buffer00.png","type":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":"XsXGR8","filepath":"/media/previz/buffer01.png","previewfilepath":"/media/previz/buffer01.png","type":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"XsXGR8","channel":0}],"code":"Main {\n    Q = B(U);\n    #define M 200.\n    #define x .2\n    #define L 1000.\n    #define N .06\n    vec2 u = 10000.*(U-.5*R)/R.y;\n    for (float j = 0.; j < M; j++) {\n    \n        float i = (mod(float(iFrame),M)*M+j)/M;\n    \n        float k = 0.;\n        float m = 0.;\n    \n    \n        {\n            vec3 v = vec3(sin(N*i*2.*pi)+k,(i-.5*M),cos(N*i*2.*pi)+m);\n\n            float l = length(vec3(u,L)-v)+length(v);\n\n\n            Q.xy += 1./l*vec2(cos(x*2.*pi*l),sin(x*2.*pi*l));\n       }\n       {\n            vec3 v = vec3(sin(1.5+N*i*2.*pi)+k,(i-.5*M),cos(1.5+N*i*2.*pi)+m);\n\n            float l = length(vec3(u,L)-v)+length(v);\n\n\n\n            Q.xy += 1./l*vec2(cos(x*2.*pi*l),sin(x*2.*pi*l));\n       }\n    }\n    \n\n}","name":"Buffer B","description":"","type":"buffer"}]}