{"ver":"0.1","info":{"id":"MdyfDR","date":"1528281431","viewed":397,"name":"Gameboy Classic post-effect","username":"jilski","description":"Blendable post effect that simulates the screen of the classic Nintendo GameBoy.","likes":3,"published":1,"flags":0,"usePreview":0,"tags":["2d","video","retro","post","effect","gameboy","pixels","nintendo","games","lcd","dmg"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"Xdf3Rn","filepath":"/media/a/e81e818ac76a8983d746784b423178ee9f6cdcdf7f8e8d719341a6fe2d2ab303.webm","previewfilepath":"/media/ap/e81e818ac76a8983d746784b423178ee9f6cdcdf7f8e8d719341a6fe2d2ab303.webm","type":"video","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"/*\n\n\tNintendo GameBoy Classic (DMG) Post-Effect\n\tWritten by jilski for the strangeness project (http://strangeness.jilski.com)\n\tJune 2018\n\n\tStrangeness is a monthly live music & visuals concert experience taking place in Berlin.\n\tWhile acoustic instruments are the musical core of the show - which resolves\n\taround space and retro 8-bit video games - the projection into the room is handled\n\tby a sound analysis and video synthesis system based on the Vulkan API and lots of shaders.\n\tIt all reacts to the music and is supposed to make sense.\n\n\tThis effect depends on the live music volume and other parameters. This has been\n\tsimplified for Shadertoy. I left \"blend_factor\" and loudness in as dummies, as well as\n\tpix_size.\n\n\tSince I've taken a lot of inspiration from shaders on this side and am using some\n\tre-written variations for my own show so I thought it'd be very fair to give back\n\ta bit.\n\n\tYeah and you're all invited to strangeness.\n*/\n\nvec3 rgb(int r, int g, int b)\n{\n  return vec3(float(r)/256.,float(g)/256.,float(b)/256.);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n  // blend_factor goes from 0 to 1\n  // here's a curve to show the effect of transitioning\n  float blend_factor = 1.0-pow(0.5+0.5*cos(iTime/10.0),2.0);\n    \n  // originally, this is the volume of the music... not sure how to get the volume of the video playback... so it's a stud\n  float loudness = cos(iTime/0.5);\n    \n  // original gameboy dmg resolution: 160*144\n  float pix_size = 8.0;\n\n\n  // i took pictures of my own gameboy classic and measured the rgb then adjusted to taste and memory :D\n  vec3 palette[4] = vec3[](rgb(180,210,46), rgb(155,195,40), rgb(108,151,35), rgb(54,112,30));\n  vec3 line = palette[0]*1.6; // line are the lines between pixels. they are brighter.\n    \n  vec2 coord = fragCoord/iResolution.xy;\n\n  vec2 resolution = vec2(iResolution.x/pix_size,iResolution.y/pix_size);\n\n  vec2 uv = mix(coord,(floor(coord*resolution) / resolution),blend_factor);\n  vec2 pix = uv * resolution;\n\n  vec3 orig = texture(iChannel0,uv).rgb;\n  vec3 col = line;\n  vec2 line_width = vec2(1.0/iResolution.x,1.0/iResolution.y);\n    \n  vec2 pix_thresh = mix(vec2(0.),line_width,blend_factor);\n  \n  bool is_pixel = (coord.x-uv.x) > pix_thresh.x && (coord.y-uv.y) > pix_thresh.y;\n    \n  // good old times when some pixel columns were broken. remember? :D\n  bool is_not_broken = int(pix.x) != int(resolution.x)-2\n      && (int(pix.x) != int(resolution.x)-4 || fract(4.0*sin(iTime/10.))>0.95) && int(pix.x) != 1;\n    \n  if ( is_pixel && is_not_broken )\n  {\n    float val = (orig.r+orig.g+orig.b)/3.0;\n    int shade = min(3,int(4.0*log(1.0+val*1.71))); // log(1+x*(e-1))\n    col = palette[shade];\n      \n    // the following is optional: it's just some gradient across the screen.\n    // like a bit of sunlight screwing up the contrast :D\n    vec2 offs = 3.*vec2(0.5+0.5*sin(iTime), 0.5+0.5*cos(iTime/1.2));\n    vec2 cen = vec2(0.5,0.5) + offs;\n    col += vec3(0.1,0.14,0.01)*(0.5+0.5*sin(atan(cen.x,cen.y))); // slight loss of contrast, moving with time\n    col -= vec3(0.8,1.0,0.5)*5.0*sin(loudness)*length(uv-coord); // slight pixel 3d-ness\n  }\n\n  // slight vignette\n  col *= 1.1 - 0.3*distance(coord,vec2(0.5,0.5));\n\n  col = mix(orig,col,blend_factor);\n\n  fragColor = vec4(col,1.0);\n}\n","name":"Image","description":"","type":"image"}]}