{"ver":"0.1","info":{"id":"3dG3Rd","date":"1570717582","viewed":159,"name":"misty mountains","username":"oskanberg","description":"Reimplementation of magic mountains with 'mist'.","likes":5,"published":1,"flags":0,"usePreview":0,"tags":["raymarching"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"XdfGRn","filepath":"/media/a/e6e5631ce1237ae4c05b3563eda686400a401df4548d0f9fad40ecac1659c46c.jpg","previewfilepath":"/media/ap/e6e5631ce1237ae4c05b3563eda686400a401df4548d0f9fad40ecac1659c46c.jpg","type":"texture","channel":0,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"\n#ifdef GL_ES\nprecision mediump float;\n#endif\n\nconst float SCALE = 50.;\nconst int MAX_STEPS = 350;\n\nvoid mainImage(out vec4 fragColor, vec2 fragCoord)\n{\n    // normalise to [-0.5, +0.5]\n    vec2 nFragCoord = fragCoord / iResolution.xy - 0.5;\n    vec2 nMouse = iMouse.xy / iResolution.xy - 0.5;\n    \n    // start above the ground\n    vec3 ray = vec3(0.0, 8.6 + (iTime / 2.0), 1.0);\n    vec3 direction = normalize(vec3(nFragCoord.x, 0.5, nFragCoord.y)) / 100.;\n    \n    float r;\n    float steps;\n    float height;\n    while (steps++ < float(MAX_STEPS)) {\n        r = texture(iChannel0, ray.xy / SCALE).r * 1.5;\n        height = ray.z - r;\n        \n        // if it's this high it'll probably never hit anything\n        // stop here for efficiency\n        if (height > 4.) {\n   \t\t\tfragColor = 1. - vec4(height/8.,0.5,0.5,0.);\n            return;\n        }\n        \n        if (height <= 0.0) {           \n            fragColor = vec4(steps*1.1/float(MAX_STEPS), 0.5, 0.5, 0.5);\n        \treturn;\n        }\n \n        ray += direction * steps * 0.01;\n    }\n    \n    fragColor = 1. - vec4(height/8.,0.5,0.5,0.);\n}\n","name":"Image","description":"","type":"image"}]}