{"ver":"0.1","info":{"id":"4dyXD3","date":"1466964868","viewed":866,"name":"Glass Voxels","username":"akohdr","description":"Pseudo glass voxel viewer for dense voxel fields.  V() provides colour tint of voxel at 3D position p or Z if no such voxel exists.  For demo we use random texture and cull to some suitable threshold.\nvec4 Z serves double duty as ordinal and basis vector.","likes":22,"published":1,"flags":0,"usePreview":0,"tags":["voxel"],"hasliked":0,"parentid":"","parentname":""},"renderpass":[{"inputs":[{"id":"Xsf3zn","filepath":"/media/a/f735bee5b64ef98879dc618b016ecf7939a5756040c2cde21ccb15e69a6e1cfb.png","previewfilepath":"/media/ap/f735bee5b64ef98879dc618b016ecf7939a5756040c2cde21ccb15e69a6e1cfb.png","type":"texture","channel":0,"sampler":{"filter":"linear","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":"4dfGRr","channel":0}],"code":"// Created by Andrew Wild - akohdr/2016\n// License Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License.\n\n#define iR iResolution\n#define Z vec4(-1,0,1,.5)\n\n#define FR vec3(40,20,20)\n#define FD vec3(floor(iR.xy/FR.xy),FR.z)\n\n#define p3D2D(p) (FR.xy * floor(vec2(mod(p.z,FD.x),p.z/FD.x)) + mod(p.xy,FR.xy))\n\nvec4 V(vec4 p)\n{\n    p = texture(iChannel0, p3D2D(p)/iR.xy);\t\t// reuse p for voxel colour (k)\n    return p.r + p.g + p.b > 2.1 ? p : Z;\t\t\t// cull at suitable threshold\n}\n\nvoid mainImage(out vec4 k, vec2 p)\n{\n\tp = p/iR.xy-.5;\t\t\t\t\t\t\t\t\t// normalized coords +/- .5\n\tk = sin(p.xyyx)/2.;\t\t\t\t\t\t\t\t// swizzled ambient background\n    \n    vec4 c, m = Z.yyyy,\t\t\t\t\t\t\t\t// m init prevents corruption\n         t = sin(Z+iTime/2.) * Z.xzxx,\t\t// timebase / rotation\n         r = p.xyxy * vec4(iR.y/iR.x,Z*t).wxyz-t,\n         f = ceil(t *= 50.),\t\t\t\t\t\t// eye distance\n         d = abs(dot(r,r)/r),\n    \t s = ((f-t-.5)*(r=sign(r))+.5)*d;\t\t\t// .5 prevents sweeping artifacts\n    \n    for(int i=147; i>0; i--){\n    \tif((c = V(f += m*r)) !=  Z\t\t\t\t\t// is Voxel? what colour?\n\t       && all(lessThan(abs(f.xyz),FR/2.)) \t\t// bounds check, kills repetition\n          ) {\n//\t         k += .2*c;\t\t\t\t\t\t\t\t// glass voxel colour tint\n//\t         if(m.x>0.) k += vec4(m.y>.0 ? .1 : .2);// face shading / faux reflection\n\t         k += (m.x>.0 ?.1 : m.y>.0 ?.2 : .4)*c; // combined tint/reflection\n            }\n\t    else\t\t\t\t\t\t\t\t\t\t// else provides faux refract\n//            s += d*(m = vec4(lessThan(s,s.yzxw)) * vec4(lessThan(s,s.zxyw)));\n            s += d*(m = step(s,s.yzxw) * step(s,s.zxyw));  // @Shane suggestion\n        \n    }\n\tk = clamp(k,0.,1.);\n}\n","name":"Image","description":"","type":"image"}]}